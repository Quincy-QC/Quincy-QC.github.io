{"meta":{"version":1,"warehouse":"2.2.0"},"models":{"Asset":[{"_id":"source/img/icon_wechat.png","path":"img/icon_wechat.png","modified":0,"renderable":0},{"_id":"source/img/header_img/about.jpg","path":"img/header_img/about.jpg","modified":0,"renderable":0},{"_id":"themes/huweihuang/source/css/archive.styl","path":"css/archive.styl","modified":0,"renderable":1},{"_id":"themes/huweihuang/source/css/beantech.min.css","path":"css/beantech.min.css","modified":0,"renderable":1},{"_id":"themes/huweihuang/source/css/beantech.css","path":"css/beantech.css","modified":0,"renderable":1},{"_id":"themes/huweihuang/source/css/hux-blog.min.css","path":"css/hux-blog.min.css","modified":0,"renderable":1},{"_id":"themes/huweihuang/source/css/highlight.styl","path":"css/highlight.styl","modified":0,"renderable":1},{"_id":"themes/huweihuang/source/css/donate.css","path":"css/donate.css","modified":0,"renderable":1},{"_id":"themes/huweihuang/source/css/signature.styl","path":"css/signature.styl","modified":0,"renderable":1},{"_id":"themes/huweihuang/source/css/toc.styl","path":"css/toc.styl","modified":0,"renderable":1},{"_id":"themes/huweihuang/source/css/rocket.styl","path":"css/rocket.styl","modified":0,"renderable":1},{"_id":"themes/huweihuang/source/css/widget.styl","path":"css/widget.styl","modified":0,"renderable":1},{"_id":"themes/huweihuang/source/fonts/glyphicons-halflings-regular.eot","path":"fonts/glyphicons-halflings-regular.eot","modified":0,"renderable":1},{"_id":"themes/huweihuang/source/fonts/glyphicons-halflings-regular.woff","path":"fonts/glyphicons-halflings-regular.woff","modified":0,"renderable":1},{"_id":"themes/huweihuang/source/fonts/glyphicons-halflings-regular.woff2","path":"fonts/glyphicons-halflings-regular.woff2","modified":0,"renderable":1},{"_id":"themes/huweihuang/source/fonts/glyphicons-halflings-regular.ttf","path":"fonts/glyphicons-halflings-regular.ttf","modified":0,"renderable":1},{"_id":"themes/huweihuang/source/js/hux-blog.min.js","path":"js/hux-blog.min.js","modified":0,"renderable":1},{"_id":"themes/huweihuang/source/js/hux-blog.js","path":"js/hux-blog.js","modified":0,"renderable":1},{"_id":"themes/huweihuang/source/js/bootstrap.min.js","path":"js/bootstrap.min.js","modified":0,"renderable":1},{"_id":"themes/huweihuang/source/js/jquery.nav.js","path":"js/jquery.nav.js","modified":0,"renderable":1},{"_id":"themes/huweihuang/source/js/jquery.tagcloud.js","path":"js/jquery.tagcloud.js","modified":0,"renderable":1},{"_id":"themes/huweihuang/source/js/totop.js","path":"js/totop.js","modified":0,"renderable":1},{"_id":"themes/huweihuang/source/js/toc.js","path":"js/toc.js","modified":0,"renderable":1},{"_id":"source/img/header_img/archives-widget.jpg","path":"img/header_img/archives-widget.jpg","modified":0,"renderable":0},{"_id":"themes/huweihuang/source/css/bootstrap.min.css","path":"css/bootstrap.min.css","modified":0,"renderable":1},{"_id":"themes/huweihuang/source/fonts/glyphicons-halflings-regular.svg","path":"fonts/glyphicons-halflings-regular.svg","modified":0,"renderable":1},{"_id":"themes/huweihuang/source/js/bootstrap.js","path":"js/bootstrap.js","modified":0,"renderable":1},{"_id":"themes/huweihuang/source/js/jquery.min.js","path":"js/jquery.min.js","modified":0,"renderable":1},{"_id":"source/img/article/20190418/1.png","path":"img/article/20190418/1.png","modified":0,"renderable":0},{"_id":"source/img/article/20190418/2.png","path":"img/article/20190418/2.png","modified":0,"renderable":0},{"_id":"source/img/article/20190503/1.png","path":"img/article/20190503/1.png","modified":0,"renderable":0},{"_id":"source/img/article/20190503/5.png","path":"img/article/20190503/5.png","modified":0,"renderable":0},{"_id":"source/img/article/20190503/9.png","path":"img/article/20190503/9.png","modified":0,"renderable":0},{"_id":"source/img/article/20190519/10.png","path":"img/article/20190519/10.png","modified":0,"renderable":0},{"_id":"source/img/article/20190519/1.png","path":"img/article/20190519/1.png","modified":0,"renderable":0},{"_id":"source/img/article/20190519/11.png","path":"img/article/20190519/11.png","modified":0,"renderable":0},{"_id":"source/img/article/20190519/14.png","path":"img/article/20190519/14.png","modified":0,"renderable":0},{"_id":"source/img/article/20190519/2.png","path":"img/article/20190519/2.png","modified":0,"renderable":0},{"_id":"source/img/article/20190519/4.png","path":"img/article/20190519/4.png","modified":0,"renderable":0},{"_id":"source/img/article/20190519/5.png","path":"img/article/20190519/5.png","modified":0,"renderable":0},{"_id":"source/img/article/20190519/6.png","path":"img/article/20190519/6.png","modified":0,"renderable":0},{"_id":"source/img/article/20190519/7.png","path":"img/article/20190519/7.png","modified":0,"renderable":0},{"_id":"source/img/article/20190519/8.png","path":"img/article/20190519/8.png","modified":0,"renderable":0},{"_id":"source/img/article/20190606/1.png","path":"img/article/20190606/1.png","modified":0,"renderable":0},{"_id":"source/img/article/20190519/9.png","path":"img/article/20190519/9.png","modified":0,"renderable":0},{"_id":"source/img/article/20190801/2.png","path":"img/article/20190801/2.png","modified":0,"renderable":0},{"_id":"source/img/article/20190801/3.png","path":"img/article/20190801/3.png","modified":0,"renderable":0},{"_id":"source/img/article/20190801/4.png","path":"img/article/20190801/4.png","modified":0,"renderable":0},{"_id":"source/img/article/20190801/5.png","path":"img/article/20190801/5.png","modified":0,"renderable":0},{"_id":"source/img/article/20190801/6.png","path":"img/article/20190801/6.png","modified":0,"renderable":0},{"_id":"source/img/article/20190801/7.png","path":"img/article/20190801/7.png","modified":0,"renderable":0},{"_id":"source/img/article/20190801/8.png","path":"img/article/20190801/8.png","modified":0,"renderable":0},{"_id":"source/img/article/20190810/1.png","path":"img/article/20190810/1.png","modified":0,"renderable":0},{"_id":"source/img/article/20190810/2.png","path":"img/article/20190810/2.png","modified":0,"renderable":0},{"_id":"source/img/article/20190810/3.png","path":"img/article/20190810/3.png","modified":0,"renderable":0},{"_id":"source/img/article/20190816/1.png","path":"img/article/20190816/1.png","modified":0,"renderable":0},{"_id":"source/img/article/20190816/5.png","path":"img/article/20190816/5.png","modified":0,"renderable":0},{"_id":"source/img/article/20190816/3.png","path":"img/article/20190816/3.png","modified":0,"renderable":0},{"_id":"source/img/article/20190816/4.png","path":"img/article/20190816/4.png","modified":0,"renderable":0},{"_id":"source/img/article/20190816/6.png","path":"img/article/20190816/6.png","modified":0,"renderable":0},{"_id":"source/img/article/20190902/2.png","path":"img/article/20190902/2.png","modified":0,"renderable":0},{"_id":"source/img/article/20190816/7.png","path":"img/article/20190816/7.png","modified":0,"renderable":0},{"_id":"source/img/article/20190902/1.png","path":"img/article/20190902/1.png","modified":0,"renderable":0},{"_id":"source/img/article/20190902/3.png","path":"img/article/20190902/3.png","modified":0,"renderable":0},{"_id":"source/img/article/20190902/4.png","path":"img/article/20190902/4.png","modified":0,"renderable":0},{"_id":"source/img/article/20190902/6.png","path":"img/article/20190902/6.png","modified":0,"renderable":0},{"_id":"source/img/article/20190902/5.png","path":"img/article/20190902/5.png","modified":0,"renderable":0},{"_id":"source/img/article/20190902/7.png","path":"img/article/20190902/7.png","modified":0,"renderable":0},{"_id":"source/img/article/20190902/9.png","path":"img/article/20190902/9.png","modified":0,"renderable":0},{"_id":"source/img/article/20190825/1.png","path":"img/article/20190825/1.png","modified":0,"renderable":0},{"_id":"source/img/article/20190825/3.png","path":"img/article/20190825/3.png","modified":0,"renderable":0},{"_id":"source/img/article/20190825/4.png","path":"img/article/20190825/4.png","modified":0,"renderable":0},{"_id":"source/img/article/20190825/5.png","path":"img/article/20190825/5.png","modified":0,"renderable":0},{"_id":"source/img/article/20190825/7.png","path":"img/article/20190825/7.png","modified":0,"renderable":0},{"_id":"source/img/article/20190825/6.png","path":"img/article/20190825/6.png","modified":0,"renderable":0},{"_id":"source/img/article/20190825/2.png","path":"img/article/20190825/2.png","modified":0,"renderable":0},{"_id":"source/img/article/20191216/1.png","path":"img/article/20191216/1.png","modified":0,"renderable":0},{"_id":"source/img/article/20200226/1.png","path":"img/article/20200226/1.png","modified":0,"renderable":0},{"_id":"source/img/article/20200330/1.png","path":"img/article/20200330/1.png","modified":0,"renderable":0},{"_id":"source/img/article/20210621/1.png","path":"img/article/20210621/1.png","modified":0,"renderable":0},{"_id":"source/img/article/20210621/2.png","path":"img/article/20210621/2.png","modified":0,"renderable":0},{"_id":"source/img/header_img/archive.jpg","path":"img/header_img/archive.jpg","modified":0,"renderable":0},{"_id":"source/img/signature/BeanTechSign-white.png","path":"img/signature/BeanTechSign-white.png","modified":0,"renderable":0},{"_id":"source/img/article/20200330/2.png","path":"img/article/20200330/2.png","modified":0,"renderable":0},{"_id":"themes/huweihuang/source/css/bootstrap.css","path":"css/bootstrap.css","modified":0,"renderable":1},{"_id":"themes/huweihuang/source/css/images/ironman.png","path":"css/images/ironman.png","modified":0,"renderable":1},{"_id":"themes/huweihuang/source/css/images/rocket.png","path":"css/images/rocket.png","modified":0,"renderable":1},{"_id":"source/img/article/20190212/2.png","path":"img/article/20190212/2.png","modified":0,"renderable":0},{"_id":"source/img/article/20190425/1.png","path":"img/article/20190425/1.png","modified":0,"renderable":0},{"_id":"source/img/article/20190418/3.png","path":"img/article/20190418/3.png","modified":0,"renderable":0},{"_id":"source/img/article/20190503/11.png","path":"img/article/20190503/11.png","modified":0,"renderable":0},{"_id":"source/img/article/20190503/2.png","path":"img/article/20190503/2.png","modified":0,"renderable":0},{"_id":"source/img/article/20190503/3.png","path":"img/article/20190503/3.png","modified":0,"renderable":0},{"_id":"source/img/article/20190503/4.png","path":"img/article/20190503/4.png","modified":0,"renderable":0},{"_id":"source/img/article/20190503/7.png","path":"img/article/20190503/7.png","modified":0,"renderable":0},{"_id":"source/img/article/20190503/8.png","path":"img/article/20190503/8.png","modified":0,"renderable":0},{"_id":"source/img/article/20190519/12.png","path":"img/article/20190519/12.png","modified":0,"renderable":0},{"_id":"source/img/article/20190519/3.png","path":"img/article/20190519/3.png","modified":0,"renderable":0},{"_id":"source/img/article/20190519/13.png","path":"img/article/20190519/13.png","modified":0,"renderable":0},{"_id":"source/img/article/20190801/1.png","path":"img/article/20190801/1.png","modified":0,"renderable":0},{"_id":"source/img/article/20190803/1.png","path":"img/article/20190803/1.png","modified":0,"renderable":0},{"_id":"source/img/article/20190810/6.png","path":"img/article/20190810/6.png","modified":0,"renderable":0},{"_id":"source/img/article/20190819/1.png","path":"img/article/20190819/1.png","modified":0,"renderable":0},{"_id":"source/img/article/20190902/8.png","path":"img/article/20190902/8.png","modified":0,"renderable":0},{"_id":"source/img/article/20191122/3.png","path":"img/article/20191122/3.png","modified":0,"renderable":0},{"_id":"source/img/article/20200226/5.png","path":"img/article/20200226/5.png","modified":0,"renderable":0},{"_id":"source/img/header_img/tag.png","path":"img/header_img/tag.png","modified":0,"renderable":0},{"_id":"source/img/article/20190212/1.png","path":"img/article/20190212/1.png","modified":0,"renderable":0},{"_id":"source/img/article/20190212/3.png","path":"img/article/20190212/3.png","modified":0,"renderable":0},{"_id":"source/img/article/20190212/4.png","path":"img/article/20190212/4.png","modified":0,"renderable":0},{"_id":"source/img/article/20190425/3.png","path":"img/article/20190425/3.png","modified":0,"renderable":0},{"_id":"themes/huweihuang/source/js/jquery.js","path":"js/jquery.js","modified":0,"renderable":1},{"_id":"source/img/article/20190815/1.png","path":"img/article/20190815/1.png","modified":0,"renderable":0},{"_id":"source/img/article/20190816/2.png","path":"img/article/20190816/2.png","modified":0,"renderable":0},{"_id":"source/img/header_img/home-bg-o.png","path":"img/header_img/home-bg-o.png","modified":0,"renderable":0},{"_id":"source/img/article/20190503/10.png","path":"img/article/20190503/10.png","modified":0,"renderable":0},{"_id":"source/img/article/20190425/2.png","path":"img/article/20190425/2.png","modified":0,"renderable":0},{"_id":"source/img/article/20190706/1.png","path":"img/article/20190706/1.png","modified":0,"renderable":0},{"_id":"source/img/article/20190810/4.png","path":"img/article/20190810/4.png","modified":0,"renderable":0},{"_id":"source/img/article/20190810/5.png","path":"img/article/20190810/5.png","modified":0,"renderable":0},{"_id":"source/img/header_img/home2.png","path":"img/header_img/home2.png","modified":0,"renderable":0},{"_id":"source/img/signature/BeanTechSign-black.png","path":"img/signature/BeanTechSign-black.png","modified":0,"renderable":0},{"_id":"source/img/header_img/home.jpg","path":"img/header_img/home.jpg","modified":0,"renderable":0},{"_id":"source/img/article/20190503/6.png","path":"img/article/20190503/6.png","modified":0,"renderable":0},{"_id":"source/img/article/20190810/8.png","path":"img/article/20190810/8.png","modified":0,"renderable":0},{"_id":"source/img/article/20210621/3.png","path":"img/article/20210621/3.png","modified":0,"renderable":0},{"_id":"source/img/header_img/404.png","path":"img/header_img/404.png","modified":0,"renderable":0},{"_id":"source/img/article/20200226/3.png","path":"img/article/20200226/3.png","modified":0,"renderable":0},{"_id":"source/img/article/20200226/4.png","path":"img/article/20200226/4.png","modified":0,"renderable":0},{"_id":"source/img/avatar/icon.png","path":"img/avatar/icon.png","modified":0,"renderable":0},{"_id":"source/img/article/20190810/7.png","path":"img/article/20190810/7.png","modified":0,"renderable":0},{"_id":"source/img/article/20191121/1.png","path":"img/article/20191121/1.png","modified":0,"renderable":0},{"_id":"source/img/article/20200226/2.png","path":"img/article/20200226/2.png","modified":0,"renderable":0},{"_id":"source/img/article/20191122/2.png","path":"img/article/20191122/2.png","modified":0,"renderable":0},{"_id":"source/img/article/20191122/1.png","path":"img/article/20191122/1.png","modified":0,"renderable":0},{"_id":"source/img/article_header/article_header.png","path":"img/article_header/article_header.png","modified":0,"renderable":0},{"_id":"source/img/article/20210830/1.png","path":"img/article/20210830/1.png","modified":1,"renderable":0},{"_id":"source/img/article/20210830/2.mp4","path":"img/article/20210830/2.mp4","modified":1,"renderable":0}],"Cache":[{"_id":"source/404.md","hash":"8aa56af7bcd7cd23667cbf3eb5b5c9fa4533eb60","modified":1624278892090},{"_id":"themes/huweihuang/LICENSE","hash":"2b209f06bebeb2a8c2b7e187e436f3e1e1fbc8a7","modified":1624278892242},{"_id":"themes/huweihuang/_config.yml","hash":"e800e32847df32dacddb5202823a004557023bcd","modified":1624278892242},{"_id":"source/_posts/.DS_Store","hash":"026cdd156a5b6bd3e1a402eae75a353ffdb9b392","modified":1624278892090},{"_id":"source/archive/index.md","hash":"40c6d6d8a40f8133e48eaf8111df4a361d6ac30d","modified":1624278892101},{"_id":"source/about/index.md","hash":"dd8408f951bc3c52eb61b475404fdd48849f7e4a","modified":1624278892101},{"_id":"source/img/.DS_Store","hash":"1a5a7b1e9248ee851e5acbbd4f85b11cf939e6eb","modified":1624278892102},{"_id":"source/img/icon_wechat.png","hash":"4188058026609de06c6cac88b349a2da831a1783","modified":1624278892237},{"_id":"source/tags/index.md","hash":"f6ad1039c242795de5cd7d81781148f8c5298c28","modified":1624278892242},{"_id":"themes/huweihuang/languages_to_be_added/de.yml","hash":"424a9c1e6ab69334d7873f6574da02ca960aa572","modified":1624278892242},{"_id":"themes/huweihuang/languages_to_be_added/default.yml","hash":"97326c9e6518d9f379778178b3b8f9a58434725d","modified":1624278892242},{"_id":"themes/huweihuang/languages_to_be_added/en.yml","hash":"97326c9e6518d9f379778178b3b8f9a58434725d","modified":1624278892242},{"_id":"themes/huweihuang/languages_to_be_added/es.yml","hash":"cb4eeca0ed3768a77e0cd216300f2b2549628b1b","modified":1624278892243},{"_id":"themes/huweihuang/languages_to_be_added/no.yml","hash":"8ca475a3b4f8efe6603030f0013aae39668230e1","modified":1624278892243},{"_id":"themes/huweihuang/languages_to_be_added/pl.yml","hash":"de7eb5850ae65ba7638e907c805fea90617a988c","modified":1624278892243},{"_id":"themes/huweihuang/languages_to_be_added/ru.yml","hash":"42df7afeb7a35dc46d272b7f4fb880a9d9ebcaa5","modified":1624278892243},{"_id":"themes/huweihuang/languages_to_be_added/zh-CN.yml","hash":"7bfcb0b8e97d7e5edcfca8ab26d55d9da2573c1c","modified":1624278892243},{"_id":"themes/huweihuang/languages_to_be_added/zh-TW.yml","hash":"9acac6cc4f8002c3fa53ff69fb8cf66c915bd016","modified":1624278892243},{"_id":"themes/huweihuang/layout/404.ejs","hash":"40de38bd399f6f4aef0d6c63c7b13b02d74f1c56","modified":1624278892243},{"_id":"themes/huweihuang/layout/about.ejs","hash":"406ee87558145a1c321a4867c3bcb716dc8796ce","modified":1624278892246},{"_id":"themes/huweihuang/layout/archive.ejs","hash":"72a150c8dff0031a9107d12eaa7c2e6c6ce950d2","modified":1624278892246},{"_id":"themes/huweihuang/layout/index.ejs","hash":"dc8a6eaa00d1e7c33a40979afe0953ed5d7b512e","modified":1624278892246},{"_id":"themes/huweihuang/layout/keynote.ejs","hash":"b956cc63454c5158b0dd1b9f730eb36246ad77e7","modified":1624278892246},{"_id":"themes/huweihuang/layout/layout.ejs","hash":"a5af5b99ac3456ab5da1a319455904b979b91601","modified":1624278892247},{"_id":"themes/huweihuang/layout/page.ejs","hash":"ece58c2de372f2f10d245f880fea4d008bc16811","modified":1624278892247},{"_id":"themes/huweihuang/layout/tags.ejs","hash":"2c72eb2e89130658aa068d80d27b561b509c5dcd","modified":1624278892247},{"_id":"themes/huweihuang/layout/post.ejs","hash":"2477fd011180cf367f21b9107f5fdf17b2f5a737","modified":1624278892247},{"_id":"source/_posts/2019/.DS_Store","hash":"df2fbeb1400acda0909a32c1cf6bf492f1121e07","modified":1624278892091},{"_id":"source/_posts/2019/cocoapods-create-pods-1121.md","hash":"e6d21b4e295b52a18782c9c944b17f1d584ba2ba","modified":1624278892091},{"_id":"source/_posts/2019/core-animation-study-0503.md","hash":"5576a953c796d75e65038e1b650a254fe64860a0","modified":1624278892091},{"_id":"source/_posts/2019/core-graphics-study-0418.md","hash":"2eb2b19072f6f5e16c11358f9100e9f7dcca6a81","modified":1624278892091},{"_id":"source/_posts/2019/core-image-study-0425.md","hash":"d5511cbefad6a3ab4b286e89f55d2fcb4b93e1bd","modified":1624278892092},{"_id":"source/_posts/2019/create-github-pages-0212.md","hash":"b8d414bef33805796e174899a47ccd18b4494ef7","modified":1624278892092},{"_id":"source/_posts/2019/leetcode-kth-problems-1216.md","hash":"a34df662e89b62db7d84b73b681d8e7731a78519","modified":1624278892092},{"_id":"source/_posts/2019/leetcode-substring-search-problems-1007.md","hash":"36bcdc89bc3bc329d2138a0bb209c513dc100804","modified":1624278892092},{"_id":"source/_posts/2019/opengl-es-coordinated-system-0825.md","hash":"9e47d8991e31d19368cc3f2a1987ceeb7094acc6","modified":1624278892092},{"_id":"source/_posts/2019/opengl-es-draw-triangles-0606.md","hash":"72c7469e1d875472048272b49b0cb6c171b8ab68","modified":1624278892093},{"_id":"source/_posts/2019/opengl-es-fragment-operation-0816.md","hash":"df352e3ca9c6caab5c45e5e7a420994897b717f4","modified":1624278892093},{"_id":"source/_posts/2019/opengl-es-framebuffer-0819.md","hash":"d7d146fbce6d17491c29900048cce64346345fa5","modified":1624278892094},{"_id":"source/_posts/2019/opengl-es-fragment-shader-0815.md","hash":"e283ec0d3f322bfa7fdb164c03caf7a2aa8ec24d","modified":1624278892093},{"_id":"source/_posts/2019/opengl-es-glsl-0715.md","hash":"0850c3810724dae34ba679c2472a1385bcb0d26d","modified":1624278892094},{"_id":"source/_posts/2019/opengl-es-illuminate-0902.md","hash":"2cf9e1a2a53aef7418ee6f5268a24bb5a76a2309","modified":1624278892094},{"_id":"source/_posts/2019/opengl-es-primitive-0801.md","hash":"8ba18da3073289bb4d39e12aa30501398030a3f1","modified":1624278892095},{"_id":"source/_posts/2019/opengl-es-shader-and-program-0706.md","hash":"ee1182bffcae32759ddd3a8c0913ee588734c98d","modified":1624278892095},{"_id":"source/_posts/2019/opengl-es-sync-and-fence-0821.md","hash":"cbdbe765f737e0195aca9fabf558a9431f025380","modified":1624278892096},{"_id":"source/_posts/2019/opengl-es-vertex-0720.md","hash":"2ee6752a8f69187f2332ef622a372711afe13a3e","modified":1624278892097},{"_id":"source/_posts/2019/opengl-es-vertex-shader-0803.md","hash":"52cd4c33e1c47f20b1fb2ab883c4b0c5a802350f","modified":1624278892098},{"_id":"source/_posts/2019/refactoring-massive-app-delegate-0215.md","hash":"1fa8171aaa7f7b9caca0699454a14d95e82d02a9","modified":1624278892098},{"_id":"source/_posts/2019/swift-package-manager-1122.md","hash":"3c4a3aa81352f4096e63f19c5a12fcadfcb6dee3","modified":1624278892098},{"_id":"source/_posts/2019/ubuntu-core-update-and-bbr-accelerate-1101.md","hash":"bf6001e044ad6dd7f1b96131bf5d0c361d3cf4fb","modified":1624278892099},{"_id":"source/_posts/2019/talk-about-design-pattern-0326.md","hash":"51fa67de2894934552c754e23edee362e7e13fca","modified":1624278892098},{"_id":"source/_posts/2020/load-pdf-with-signature-0226.md","hash":"fb79157d4a2cf033ffa6d93659c5326e75227444","modified":1624278892099},{"_id":"source/_posts/2020/nstimer-circular-reference-issue-0330.md","hash":"e610d65447b8d1b631ebe10c50440f95834c9595","modified":1624278892099},{"_id":"source/_posts/2021/realitykit-0621.md","hash":"051674445727ecc44ec5750eb15368ead362aa09","modified":1630392247485},{"_id":"source/_posts/2020/talk-about-map-flatmap-compactmap-0119.md","hash":"0c5340f676ce3b8d595160b31050e4e93edd30cb","modified":1624278892099},{"_id":"source/_posts/2021/realitykit-coordinate-light-0830.md","hash":"6d4d9730a5ee4782ce24d94695da67437b29f2b8","modified":1630391647616},{"_id":"source/img/article/.DS_Store","hash":"16437191288e8bd726c36f27a3629508309de40b","modified":1624614572033},{"_id":"source/img/avatar/.DS_Store","hash":"df2fbeb1400acda0909a32c1cf6bf492f1121e07","modified":1624278892221},{"_id":"source/img/article_header/.DS_Store","hash":"df2fbeb1400acda0909a32c1cf6bf492f1121e07","modified":1624278892213},{"_id":"source/img/header_img/.DS_Store","hash":"df2fbeb1400acda0909a32c1cf6bf492f1121e07","modified":1624278892224},{"_id":"source/img/header_img/about.jpg","hash":"9623612fa0c03f8065b9ff2052e78bf4bdb1e6fa","modified":1624278892227},{"_id":"themes/huweihuang/layout/_partial/footer.ejs","hash":"616204beba8f3a64723bd9061a1c62faaeb16722","modified":1624278892244},{"_id":"themes/huweihuang/layout/_partial/header.ejs","hash":"3bd09df76e0622d76d186b020393fcab361e6c97","modified":1624278892244},{"_id":"themes/huweihuang/layout/_partial/head.ejs","hash":"720349195a5ea7b610a82ce3ce74298fb2bc7347","modified":1624278892244},{"_id":"themes/huweihuang/layout/_partial/nav.ejs","hash":"4c905166c960852e9b9a3c9d5c680091e37b481f","modified":1624278892244},{"_id":"themes/huweihuang/layout/_partial/toc.ejs","hash":"40e11b303df113c64a5ca35b79dd53c824010c09","modified":1624278892244},{"_id":"themes/huweihuang/layout/_partial/sidebar.ejs","hash":"2e4e528a555917b2a267da4db2440bcc4a7a65ab","modified":1624278892244},{"_id":"themes/huweihuang/layout/_partial/pagination.ejs","hash":"557d6bb069a1d48af49ae912994653f44b32a570","modified":1624278892244},{"_id":"themes/huweihuang/layout/_widget/archive.ejs","hash":"7594929d472806ca4c64d9906d9903a96de111a0","modified":1624278892245},{"_id":"themes/huweihuang/layout/_widget/category.ejs","hash":"1cf485def07dc06e870dc9613767c6c614bcf428","modified":1624278892245},{"_id":"themes/huweihuang/layout/_widget/featured-tags.ejs","hash":"0c9ce1942f1943dc8891a9302a922ef1ffe300c5","modified":1624278892245},{"_id":"themes/huweihuang/layout/_widget/friends-blog.ejs","hash":"734d3775017aedac185028924baf890a71a74548","modified":1624278892245},{"_id":"themes/huweihuang/layout/_widget/recent-posts.ejs","hash":"e08ab8ba60e31638006acf27f066b989a0a3c433","modified":1624278892245},{"_id":"themes/huweihuang/layout/_widget/short-about.ejs","hash":"315de02246f07c747c32495e107ad7b19cb3ff54","modified":1624278892246},{"_id":"themes/huweihuang/source/css/archive.styl","hash":"715bcbd085eb95ec26c9805c11c374919cde971c","modified":1624278892248},{"_id":"themes/huweihuang/source/css/beantech.min.css","hash":"05a06230b1a9eca0b30cece54a397008cb77dc50","modified":1624278892249},{"_id":"themes/huweihuang/source/css/beantech.css","hash":"4c361354fd8e9851923fb21a620bc079380ebcd8","modified":1624278892248},{"_id":"themes/huweihuang/source/css/hux-blog.min.css","hash":"1baef04de262aeb7023d835429b49a805ac4ab40","modified":1624278892251},{"_id":"themes/huweihuang/source/css/highlight.styl","hash":"e842080e6d580f0f70a7df71fbde3c4e49463c19","modified":1624278892251},{"_id":"themes/huweihuang/source/css/donate.css","hash":"f65ac8363d8d215adb896158e7b45165db259a47","modified":1624278892250},{"_id":"themes/huweihuang/source/css/signature.styl","hash":"88159b31c59d59c01a0b534af57242662a2a3969","modified":1624278892252},{"_id":"themes/huweihuang/source/css/toc.styl","hash":"631e97f634d30f53314e2fec8bdde267c1c49f4c","modified":1624278892252},{"_id":"themes/huweihuang/source/css/rocket.styl","hash":"e15c51c8566ecd943112e57592888dd318b6fa6a","modified":1624278892252},{"_id":"themes/huweihuang/source/css/widget.styl","hash":"7a9f735f5ef323dc2950fbd9d76daa16c9a0f1a9","modified":1624278892252},{"_id":"themes/huweihuang/source/fonts/glyphicons-halflings-regular.eot","hash":"86b6f62b7853e67d3e635f6512a5a5efc58ea3c3","modified":1624278892253},{"_id":"themes/huweihuang/source/fonts/glyphicons-halflings-regular.woff","hash":"278e49a86e634da6f2a02f3b47dd9d2a8f26210f","modified":1624278892254},{"_id":"themes/huweihuang/source/fonts/glyphicons-halflings-regular.woff2","hash":"ca35b697d99cae4d1b60f2d60fcd37771987eb07","modified":1624278892255},{"_id":"themes/huweihuang/source/fonts/glyphicons-halflings-regular.ttf","hash":"44bc1850f570972267b169ae18f1cb06b611ffa2","modified":1624278892254},{"_id":"themes/huweihuang/source/js/hux-blog.min.js","hash":"1563e7f70550ac6b30803d6f449719b853200e35","modified":1624278892256},{"_id":"themes/huweihuang/source/js/hux-blog.js","hash":"4b4d3c557405d04c3087d36c13e2834fe05c0f73","modified":1624278892256},{"_id":"themes/huweihuang/source/js/bootstrap.min.js","hash":"b3f2ef9f985e7906c9360756b73cd64bf7733647","modified":1624278892256},{"_id":"themes/huweihuang/source/js/jquery.nav.js","hash":"ef2160a456176a4d09cc0b95d52b27dfbbadf2d8","modified":1624278892259},{"_id":"themes/huweihuang/source/js/jquery.tagcloud.js","hash":"4e5fd0b07f3bd935f2e603710447e039e3677211","modified":1624278892259},{"_id":"themes/huweihuang/source/js/totop.js","hash":"c05360f6fc699ac12e794b1764b4a952713a3017","modified":1624278892259},{"_id":"themes/huweihuang/source/js/toc.js","hash":"41e52551731854224c249d53010c1bae5aa92ffa","modified":1624278892259},{"_id":"source/_posts/2019/opengl-es-study-0519.md","hash":"ffff115507bbe0d4ccc794619b082794066797e4","modified":1624278892096},{"_id":"source/_posts/2019/opengl-es-texture-0810.md","hash":"8a47fce748fb56f7c8a7f3e34a0e8f5360032545","modified":1624278892097},{"_id":"source/img/header_img/archives-widget.jpg","hash":"d0877c46663ef0626d7c69821b0a711af3192c87","modified":1624278892230},{"_id":"themes/huweihuang/source/css/bootstrap.min.css","hash":"fec7b176a4b9a67c0eb5d184f57b84297efc23aa","modified":1624278892250},{"_id":"themes/huweihuang/source/fonts/glyphicons-halflings-regular.svg","hash":"de51a8494180a6db074af2dee2383f0a363c5b08","modified":1624278892254},{"_id":"themes/huweihuang/source/js/bootstrap.js","hash":"f8752e9ae24daec0a0baffd7819122f8c6fd9103","modified":1624278892255},{"_id":"themes/huweihuang/source/js/jquery.min.js","hash":"41b4bfbaa96be6d1440db6e78004ade1c134e276","modified":1624278892259},{"_id":"source/img/article/20190418/1.png","hash":"0299377ec17fb68fdb9b3798046d87ffd774eb7a","modified":1624278892109},{"_id":"source/img/article/20190418/2.png","hash":"f9ba932744e87143ce181fbfd3e0db605a3c5288","modified":1624278892109},{"_id":"source/img/article/20190503/1.png","hash":"6f240153476c4d24fc80a677363e6f26aed69bcf","modified":1624278892113},{"_id":"source/img/article/20190503/5.png","hash":"e1e65e49f2e8138c96b0022758884e5f5cb5e59b","modified":1624278892118},{"_id":"source/img/article/20190503/9.png","hash":"630fe7f8c7413a9e96a457d592340041e9cd3511","modified":1624278892121},{"_id":"source/img/article/20190519/10.png","hash":"08fca75419543d5f04c19a8604c6934a77f096bf","modified":1624278892122},{"_id":"source/img/article/20190519/1.png","hash":"4f56d9b4392028cf952bf3b26977409a22cb101e","modified":1624278892122},{"_id":"source/img/article/20190519/11.png","hash":"aa42b46311fc91f83bd6a42a78b89dff75f0c003","modified":1624278892123},{"_id":"source/img/article/20190519/14.png","hash":"4c29af5bda7d07eae47f8ae8af2af83f5319ed22","modified":1624278892125},{"_id":"source/img/article/20190519/2.png","hash":"44a12f97d35898ebdfe9f2a52dc350e9efab5e86","modified":1624278892125},{"_id":"source/img/article/20190519/4.png","hash":"38d0d5edbbbeb4fd2d020c052c8f625ef85583ea","modified":1624278892126},{"_id":"source/img/article/20190519/5.png","hash":"cb7320b63dfce559ff7780b33656985d77543128","modified":1624278892127},{"_id":"source/img/article/20190519/6.png","hash":"51633cf88c4cbb921a3bc94b3b0375a5c2cd2297","modified":1624278892127},{"_id":"source/img/article/20190519/7.png","hash":"565c7d3a251051b983777a130589e649a2be83b3","modified":1624278892127},{"_id":"source/img/article/20190519/8.png","hash":"0b3e0dc786e709d96100192acc9ac686d8202b47","modified":1624278892127},{"_id":"source/img/article/20190606/1.png","hash":"45ea9c91ddbd66d8cb0735e55a066fb6d779728c","modified":1624278892128},{"_id":"source/img/article/20190519/9.png","hash":"7b2b12f67f62e17f13f32b5cfefe4a7c18591542","modified":1624278892128},{"_id":"source/img/article/20190801/2.png","hash":"22efb5534b4e5a57422a89887cd6a866767ef1a7","modified":1624278892132},{"_id":"source/img/article/20190801/3.png","hash":"33505616b521b93e9dab4c7bc07fa0f03f80d2a2","modified":1624278892132},{"_id":"source/img/article/20190801/4.png","hash":"54921ec9b919ce2071528f3198c51e1461fb9a5f","modified":1624278892132},{"_id":"source/img/article/20190801/5.png","hash":"7c5137d66c0998581e5832dcaf771d77da2a72fc","modified":1624278892133},{"_id":"source/img/article/20190801/6.png","hash":"10ae506b1780fd5ab3c526f23975a57fad40538d","modified":1624278892133},{"_id":"source/img/article/20190801/7.png","hash":"c12a993069d9fc02ea39d57bb2485496e4442ce7","modified":1624278892134},{"_id":"source/img/article/20190801/8.png","hash":"2a855490ecf07738172e286c329774d7c1865086","modified":1624278892134},{"_id":"source/img/article/20190810/1.png","hash":"528f24a7103f74831b49695c0dd7f6dd5aea77f9","modified":1624278892135},{"_id":"source/img/article/20190810/2.png","hash":"48c3f5a2f9892b7f507775695a5a0fa4a89b93a6","modified":1624278892136},{"_id":"source/img/article/20190810/3.png","hash":"0b41f0fe71e16c4b4ee1ed713fcc77e778876e31","modified":1624278892136},{"_id":"source/img/article/20190816/1.png","hash":"5daf59c316be2f25fea863ec1239679225f6bdfd","modified":1624278892149},{"_id":"source/img/article/20190816/5.png","hash":"83222a6a978d48ec66bb6440f1dff5b91fda2b11","modified":1624278892153},{"_id":"source/img/article/20190816/3.png","hash":"50d43f764006415bd47630b56ce2db49f57372c8","modified":1624278892152},{"_id":"source/img/article/20190816/4.png","hash":"67642ea36e06b8c0c95317e38a8b57ece049bf8a","modified":1624278892152},{"_id":"source/img/article/20190816/6.png","hash":"bad8407e53c80c91e86700a258da5c8c25fc425f","modified":1624278892153},{"_id":"source/img/article/20190902/2.png","hash":"1503429560ec6973b6a8ca89aa8ced7983c57731","modified":1624278892158},{"_id":"source/img/article/20190816/7.png","hash":"6fe7da47e2cec2bc97b339c40459b0e8923597e6","modified":1624278892154},{"_id":"source/img/article/20190902/1.png","hash":"32c8c70ec762944cd8ce116eb9877625c311a481","modified":1624278892158},{"_id":"source/img/article/20190902/3.png","hash":"fda5d1ddbc74229a3b6c6a97d46d60ae851b349a","modified":1624278892159},{"_id":"source/img/article/20190902/4.png","hash":"2649634a7a1552770a5947f4000480840af38203","modified":1624278892159},{"_id":"source/img/article/20190902/6.png","hash":"eacb5ec59175ed496ec7c5a3e521f19d200f2bd8","modified":1624278892160},{"_id":"source/img/article/20190902/5.png","hash":"2cea088af4f9cd9326cb9ebec959bd77cb970668","modified":1624278892160},{"_id":"source/img/article/20190902/7.png","hash":"cea671bee72c7caaad347f73b58f8ce2f96e9c59","modified":1624278892161},{"_id":"source/img/article/20190902/9.png","hash":"8a3d2bdbc8af8d56c34802c07034680f2cbacb79","modified":1624278892162},{"_id":"source/img/article/20190825/1.png","hash":"da4408a55494257720ccc75e59c1aeed84145210","modified":1624278892156},{"_id":"source/img/article/20190825/3.png","hash":"b4463590e06bbabc63f55ed2b103aec0c315b249","modified":1624278892157},{"_id":"source/img/article/20190825/4.png","hash":"68d3c65af31a379925038df4dc1c5a7af71a6df6","modified":1624278892157},{"_id":"source/img/article/20190825/5.png","hash":"8a4e1e22e18f4e3ef3696dd024c2c353f6ce4f6b","modified":1624278892157},{"_id":"source/img/article/20190825/7.png","hash":"0e95a0d583e28e3503f97f9337e9363c0f618e8c","modified":1624278892158},{"_id":"source/img/article/20190825/6.png","hash":"7cc0f3cbbc80ad14598bbd844f49df3b45e55a46","modified":1624278892158},{"_id":"source/img/article/20190825/2.png","hash":"454dd47ee77ddf467a4fe9eb6e47a06d872a52c2","modified":1624278892156},{"_id":"source/img/article/20191216/1.png","hash":"0ce6818316b968e5b4278f4bd6edf0174251ebb9","modified":1624278892189},{"_id":"source/img/article/20200226/1.png","hash":"b61f5e9f0c096fc07fd296f67ead0bfa7c030fd9","modified":1624278892189},{"_id":"source/img/article/20200330/1.png","hash":"c49780142d9a0fb566331891e27943c5b4c2b4be","modified":1624278892208},{"_id":"source/img/article/20210621/1.png","hash":"5a175761b1e4ffd36d0367300ed41ce207c104c4","modified":1624326529139},{"_id":"source/img/article/20210621/2.png","hash":"81450394d91e92fc4a6d46399f1703daa0b88514","modified":1624326532169},{"_id":"source/img/header_img/archive.jpg","hash":"e2d32262ba6cf34af93ee21ffb63fa2a17505988","modified":1624278892229},{"_id":"source/img/signature/BeanTechSign-white.png","hash":"34289ed41cf9ddac2d56be46fbb1515b7d5913cd","modified":1624278892241},{"_id":"source/img/article/20200330/2.png","hash":"3c852a8fd87610d23575dd7ddacd2c6f64014774","modified":1624278892208},{"_id":"themes/huweihuang/source/css/bootstrap.css","hash":"41c54bf695145ae0b4d9020a1da308ceb05dcaf3","modified":1624278892249},{"_id":"themes/huweihuang/source/css/images/ironman.png","hash":"2f0db0ab15d466c4065d9f6102fdf829726d9e3f","modified":1624278892251},{"_id":"themes/huweihuang/source/css/images/rocket.png","hash":"6dee0406955aa9b7a261161d30f2538a671e806b","modified":1624278892251},{"_id":"source/img/article/20190212/2.png","hash":"a2e320aba940339a36f25924d6d649af928e2beb","modified":1624278892106},{"_id":"source/img/article/20190425/1.png","hash":"7f5b7b45f09c7c16b48ea7910b4549aa7d5cabaa","modified":1624278892111},{"_id":"source/img/article/20190418/3.png","hash":"be3f40208e2b8aa7cfc78ed1927948e09cae18bc","modified":1624278892110},{"_id":"source/img/article/20190503/11.png","hash":"02036c4390c93a7d885e9be85f3979fa3086c244","modified":1624278892116},{"_id":"source/img/article/20190503/2.png","hash":"e1dacc10efd084aed772294d128b8b40b03a807c","modified":1624278892116},{"_id":"source/img/article/20190503/3.png","hash":"4b96360a64964ed5922a7d7a75ba4e093b940d52","modified":1624278892117},{"_id":"source/img/article/20190503/4.png","hash":"d67473d97b4fd8d0ded1c27487ebd45989c7f04e","modified":1624278892117},{"_id":"source/img/article/20190503/7.png","hash":"4369866580a35ca3fec026adb9f4b24f10c17aa8","modified":1624278892120},{"_id":"source/img/article/20190503/8.png","hash":"b7c962936ff663442e141b1755beb60bbf15b2b7","modified":1624278892121},{"_id":"source/img/article/20190519/12.png","hash":"36020292a72d28e69ab6af29ff7e96579b1da2fc","modified":1624278892124},{"_id":"source/img/article/20190519/3.png","hash":"6afa47435e8a47fbe68a3f7e0003e7650b2532e1","modified":1624278892126},{"_id":"source/img/article/20190519/13.png","hash":"ff74b655acca2f0fdc3bd8149cc63321fab5b8fb","modified":1624278892124},{"_id":"source/img/article/20190801/1.png","hash":"a70d4a300eab5fafca25fbab2f87be8dfe7b2fee","modified":1624278892131},{"_id":"source/img/article/20190803/1.png","hash":"fe08cce605be6102ac59d97614f7b0e8be9bd63a","modified":1624278892135},{"_id":"source/img/article/20190810/6.png","hash":"962cc9b03bd42f70f3e31820fd2761ec93febd94","modified":1624278892141},{"_id":"source/img/article/20190819/1.png","hash":"11da9b99cb19c57edbd27bb5aded54e02bcd42a2","modified":1624278892155},{"_id":"source/img/article/20190902/8.png","hash":"e555c91472cc977c5531125bed0f023b79f94b5c","modified":1624278892161},{"_id":"source/img/article/20191122/3.png","hash":"0b4290dcd3a69161dfe84f0159687898b4addbbc","modified":1624278892189},{"_id":"source/img/article/20200226/5.png","hash":"5077dbd03fc9886f01963d83fd903d9a80742f47","modified":1624278892207},{"_id":"source/img/header_img/tag.png","hash":"fe9af631de776eaec7dcc8a90ad4a388e19a6dd0","modified":1624278892237},{"_id":"source/img/article/20190212/1.png","hash":"a34dc632eae4b0f4fcf1667782f91f174f042bf5","modified":1624278892104},{"_id":"source/img/article/20190212/3.png","hash":"6eb5545f10dd97761986fa431eccf7cbbb719d5a","modified":1624278892108},{"_id":"source/img/article/20190212/4.png","hash":"0332a0d27cb323a46f06c85290ab5e0381712478","modified":1624278892109},{"_id":"source/img/article/20190425/3.png","hash":"4c95725be63a4d0c2b6e91e7f0f04d1b0eb820fd","modified":1624278892113},{"_id":"themes/huweihuang/source/js/jquery.js","hash":"1852661bd11a09ca9b9cb63d1aa6ff390fffaf4e","modified":1624278892258},{"_id":"source/img/article/20190815/1.png","hash":"13db577bbc8b5f6a1286b82e93ebb69998e240b6","modified":1624278892148},{"_id":"source/img/article/20190816/2.png","hash":"91d85b5e9f2c66e985c62167e676dc422326afc2","modified":1624278892151},{"_id":"source/img/header_img/home-bg-o.png","hash":"a2a9c8e1e68fd40363661f136337c7722e1b72e0","modified":1624278892231},{"_id":"source/img/article/20190503/10.png","hash":"f7440ae13cf915c04019406764d71801b023547e","modified":1624278892115},{"_id":"source/img/article/20190425/2.png","hash":"845cac70dc0b859b371a22942d4f1dd012191c63","modified":1624278892112},{"_id":"source/img/article/20190706/1.png","hash":"08a4c59a43c4b7f624b528e1966b845811153f31","modified":1624278892130},{"_id":"source/img/article/20190810/4.png","hash":"84f2e331782eda2aa9ebdf612a34abc2e05219b8","modified":1624278892138},{"_id":"source/img/article/20190810/5.png","hash":"f2eddb4b848c2c8b098ad3f09873ee48e275d446","modified":1624278892140},{"_id":"source/img/header_img/home2.png","hash":"a9dd324e77f502a367eaf1091e6529cfa57d80e5","modified":1624278892236},{"_id":"source/img/signature/BeanTechSign-black.png","hash":"94b7102e819fd6ee082d3fb0166f4de7458c22ff","modified":1624278892240},{"_id":"source/img/header_img/home.jpg","hash":"8761377c2a6b7a0d06575e11576169bf7b400f32","modified":1624278892234},{"_id":"source/img/article/20190503/6.png","hash":"ffc821ab8c5517fd7de654bf2414fd79798bbb49","modified":1624278892119},{"_id":"source/img/article/20190810/8.png","hash":"c5a7414b18a147aceae3aa739b411b05a3f179a9","modified":1624278892146},{"_id":"source/img/article/20210621/3.png","hash":"d0eb2e3e72af8f4cb63d34e44637a2294e00aff3","modified":1624278892211},{"_id":"source/img/header_img/404.png","hash":"ea6155e5bea83f7c2a12195583999b0d8c741e99","modified":1624278892227},{"_id":"source/img/article/20200226/3.png","hash":"fe99d79c0f0790b21fba571806f0f1a8b38a41e7","modified":1624278892202},{"_id":"source/img/article/20200226/4.png","hash":"ec765873f7e88a2753f3d28078e4c61b99297850","modified":1624278892206},{"_id":"source/img/avatar/icon.png","hash":"6b1084810816f6465fd095349d6a87d09a97f9a2","modified":1624278892224},{"_id":"source/img/article/20190810/7.png","hash":"86c98c0c0160e635a05ff3d53dd0f57f36db3fca","modified":1624278892144},{"_id":"source/img/article/20191121/1.png","hash":"612ac8295677696bfca9c8b1a2bee9c00371aa76","modified":1624278892166},{"_id":"source/img/article/20200226/2.png","hash":"c74b63eaaef2c8470d8983d363e3d0b0d22d0958","modified":1624278892198},{"_id":"source/img/article/20191122/2.png","hash":"9f5048ebbb4fc01dba87634fd537aad8c3c79291","modified":1624278892188},{"_id":"source/img/article/20191122/1.png","hash":"030a7d5b85f3bcada7db70e0e56c2291333b3b94","modified":1624278892181},{"_id":"source/img/article_header/article_header.png","hash":"d9fa12f1e40924a0db57761d09d52dce450b4f7b","modified":1624278892221},{"_id":"public/post-sitemap.xml","hash":"2bd06f2c8d5d362c5765ff668a7fd47a6286e84e","modified":1630391677690},{"_id":"public/tag-sitemap.xml","hash":"44a00c6fb31e2106270c025b4ef0ec4e049e6292","modified":1630391678439},{"_id":"public/sitemap.xsl","hash":"4321fa69dc1b8811d32b7a1478e5603e038cea1a","modified":1630391678544},{"_id":"public/page-sitemap.xml","hash":"3a3677bb2608714a5dfb587f21cf5e51b8e692ec","modified":1630391678582},{"_id":"public/sitemap.xml","hash":"4cc309dc6e62f3730fadad56900c32f8b6ff4dd8","modified":1630391678589},{"_id":"public/404.html","hash":"53cf764ffa4f735d3115c62c4499b9914d81b9f8","modified":1630391678597},{"_id":"public/tags/index.html","hash":"b2466544683f3ba0a642a0e9829f438420c86955","modified":1630391678600},{"_id":"public/article/2020/load-pdf-with-signature-0226/index.html","hash":"7647378f17fef66532c78f1d12c077551caeffc6","modified":1630391678602},{"_id":"public/article/2021/realitykit-0621/index.html","hash":"bfcb1a4fc7625e235bc9cba90af9c24dc4ff1625","modified":1630391678602},{"_id":"public/article/2020/nstimer-circular-reference-issue-0330/index.html","hash":"339d98cda6df977b009179568b16082522095fae","modified":1630391678602},{"_id":"public/article/2020/talk-about-map-flatmap-compactmap-0119/index.html","hash":"26ee740ac7c1f7d5c9616062a7fa27558a72b38b","modified":1630391678602},{"_id":"public/article/2019/cocoapods-create-pods-1121/index.html","hash":"08024d24b37416b0f218d6282a61d383751949cb","modified":1630391678602},{"_id":"public/article/2019/leetcode-kth-problems-1216/index.html","hash":"5d22ddf985f2a6860ad50a0197b05d63a9159435","modified":1630391678602},{"_id":"public/article/2019/swift-package-manager-1122/index.html","hash":"8d4f83f75aad7836b26681a5cfd40d7423e5bcc4","modified":1630391678603},{"_id":"public/article/2019/ubuntu-core-update-and-bbr-accelerate-1101/index.html","hash":"3e9b59b08d9fe99f7703222f2d0b6a63cab9952a","modified":1630391678603},{"_id":"public/article/2019/leetcode-substring-search-problems-1007/index.html","hash":"4b1fdcd13409fa65916191c7e498c384300861da","modified":1630391678603},{"_id":"public/article/2019/opengl-es-illuminate-0902/index.html","hash":"f0834942b97efc4cc8f3a099a3f51a92da6a907b","modified":1630391678603},{"_id":"public/article/2019/opengl-es-coordinated-system-0825/index.html","hash":"84a1be2a507881b108cbb0f0e0950d58cac37237","modified":1630391678603},{"_id":"public/article/2019/opengl-es-sync-and-fence-0821/index.html","hash":"40dd54f79807f86f26f1df94513feb5c8330a290","modified":1630391678603},{"_id":"public/article/2019/opengl-es-framebuffer-0819/index.html","hash":"1c70663d52fb736112808684b7c1712e81934a8c","modified":1630391678603},{"_id":"public/article/2019/opengl-es-fragment-operation-0816/index.html","hash":"bd81169cb48e8d4124a8793a5ddd34ad14fafb5b","modified":1630391678603},{"_id":"public/article/2019/opengl-es-vertex-shader-0803/index.html","hash":"ad14218d09f9e09c8543b887f45bb2b3803a31a8","modified":1630391678603},{"_id":"public/article/2019/opengl-es-fragment-shader-0815/index.html","hash":"d00c79013bd8c648ee6ccfdc60de78498ddf1325","modified":1630391678603},{"_id":"public/article/2019/opengl-es-texture-0810/index.html","hash":"ce75fbe51dcd0d7bd8417f52dfac3a0067727308","modified":1630391678603},{"_id":"public/article/2019/opengl-es-primitive-0801/index.html","hash":"58cafae1807c2f0c3b5c45823097c9fd634fb999","modified":1630391678603},{"_id":"public/article/2019/opengl-es-vertex-0720/index.html","hash":"1efea9b80746d547838416960251a8aecbdd4b17","modified":1630391678603},{"_id":"public/article/2019/opengl-es-glsl-0715/index.html","hash":"28d634291c5025999b26880999ae4c229be712de","modified":1630391678604},{"_id":"public/article/2019/opengl-es-draw-triangles-0606/index.html","hash":"685b27c19e9159bca1c0680ba53358fffcdb8c4f","modified":1630391678604},{"_id":"public/article/2019/opengl-es-shader-and-program-0706/index.html","hash":"ca9c840c9bc8f42ba82caf664c467fde94861470","modified":1630391678604},{"_id":"public/article/2019/opengl-es-study-0519/index.html","hash":"aeccefbe5b5e6394fd4f06356e02b381ba03c5fc","modified":1630391678604},{"_id":"public/article/2019/core-animation-study-0503/index.html","hash":"caa9e4a57d3b15044bc047cc7fd9166eeab38e69","modified":1630391678604},{"_id":"public/article/2019/core-image-study-0425/index.html","hash":"3377668147c0aacbee654544500eedfdc6d2fd2f","modified":1630391678604},{"_id":"public/article/2019/core-graphics-study-0418/index.html","hash":"913e1d377d2c84eac449b74e2c3c165e79a61fb2","modified":1630391678604},{"_id":"public/article/2019/talk-about-design-pattern-0326/index.html","hash":"135071de6e2fc3f49c95ee89d5c0ad787a14fad2","modified":1630391678604},{"_id":"public/article/2019/refactoring-massive-app-delegate-0215/index.html","hash":"92b0fea83dd3987bbc0b576616a79c24ceb61960","modified":1630391678604},{"_id":"public/article/2019/create-github-pages-0212/index.html","hash":"f31ce8643409c6ae46a785d398d85c2a14d0fd00","modified":1630391678604},{"_id":"public/about/index.html","hash":"75a93acbf34e1428f68acc91f11dafd817632df6","modified":1630391678604},{"_id":"public/archive/index.html","hash":"212d98cf8e4f5e63bb23881ead11f5cea46aca0c","modified":1630391678604},{"_id":"public/index.html","hash":"726de549041de183a3fc7128a56b4d2f0ac92115","modified":1630391678604},{"_id":"public/archives/index.html","hash":"7fe82ff7cbce847e61435e6deec7d09640f8cb07","modified":1630391678605},{"_id":"public/archives/2/index.html","hash":"fbd538f204dab86024ac6b59d2224503da91b7c4","modified":1630391678605},{"_id":"public/archives/3/index.html","hash":"abad813adf6b0a057e8b1d861f858c9cacd4e57f","modified":1630391678605},{"_id":"public/archives/archives/2/index.html","hash":"22d654774b8afd8930caa123012e501bc2022237","modified":1630391678605},{"_id":"public/archives/archives/3/index.html","hash":"db420187f521bbae11d584ec5cf8cfdd159f8587","modified":1630391678605},{"_id":"public/archives/2019/index.html","hash":"4ae8c6d1411698b1f182b7d3120140e23fa7d0b4","modified":1630391678605},{"_id":"public/archives/2019/02/index.html","hash":"7f28be020192c8b28def33850a8444be25f40477","modified":1630391678605},{"_id":"public/archives/2019/archives/2/index.html","hash":"96db32b749a347700968639c139b20513a0613f3","modified":1630391678605},{"_id":"public/archives/2019/archives/3/index.html","hash":"e465ef4531d88274e39dd27039e606a8a3aef3b9","modified":1630391678605},{"_id":"public/archives/2019/03/index.html","hash":"5523b3afecb9d04c906e47b87c659d500a6dd9d4","modified":1630391678605},{"_id":"public/archives/2019/05/index.html","hash":"a9da89cdac9b8e59926b7215534bd1a3c5793648","modified":1630391678605},{"_id":"public/archives/2019/04/index.html","hash":"cd9163d61982489add20cf054f6eafa19a190af2","modified":1630391678605},{"_id":"public/archives/2019/06/index.html","hash":"55d0516bd26a987b186e7313d591d6b5f12fb3e6","modified":1630391678605},{"_id":"public/archives/2019/08/index.html","hash":"6f78219735f0164ebc401e4c240b5b5fb172b821","modified":1630391678605},{"_id":"public/archives/2019/10/index.html","hash":"3022202ff28a7963e465d209334657a7db242461","modified":1630391678605},{"_id":"public/archives/2019/07/index.html","hash":"6e0cd59fb571759b7a912dd07079b37ecb58a684","modified":1630391678605},{"_id":"public/archives/2019/09/index.html","hash":"6713ab6bb8ffb9acca66d5a3399ab24c60de1edb","modified":1630391678605},{"_id":"public/archives/2019/12/index.html","hash":"c7e5ead6c415ad8d4f46352ff754f6bf0974dbc7","modified":1630391678606},{"_id":"public/archives/2019/11/index.html","hash":"4656dcd21270dd7c74b6145317ef1009d3cfb762","modified":1630391678606},{"_id":"public/archives/2020/01/index.html","hash":"e29ae6c17c12a9d7bbf55e154c707d993570178b","modified":1630391678606},{"_id":"public/archives/2020/index.html","hash":"d71e30ffdbacdb45fd935d6cb296927decd9c5ed","modified":1630391678606},{"_id":"public/archives/2020/02/index.html","hash":"8417eb063376d475e115966677749113b5436c72","modified":1630391678606},{"_id":"public/archives/2021/index.html","hash":"9f80aedb7a60cafc4d4556058b830a16d8474673","modified":1630391678606},{"_id":"public/archives/2020/03/index.html","hash":"e95bd1cd764786db8d574a495b1606fb7a9f20b9","modified":1630391678606},{"_id":"public/archives/2021/06/index.html","hash":"37dd89211c316166b992b3ab3993a2c836abb9c9","modified":1630391678606},{"_id":"public/tags/iOS/index.html","hash":"366ea3d6b4195deb62f55899f36039414f5b21c0","modified":1630391678606},{"_id":"public/tags/GitHub/index.html","hash":"b99f22ee6f82b6af1f65d5f94888cb0b92d0df65","modified":1630391678606},{"_id":"public/tags/iOS-Swift/index.html","hash":"e00802a690da0a0596c2c4bcd5141a966db1ab98","modified":1630391678606},{"_id":"public/tags/iOS/archives/2/index.html","hash":"eb35158434b805cd66f158ec95c247e786fc518d","modified":1630391678606},{"_id":"public/tags/iOS-Objective-C/index.html","hash":"2eb99e3f1110cb2e80d9d4d0642de8c7863ac401","modified":1630391678606},{"_id":"public/tags/Tech/index.html","hash":"c385466045affe000cdbf592296d3d1ac14fb9bc","modified":1630391678606},{"_id":"public/article/2021/realitykit-coordinate-light-0830/index.html","hash":"94a700d7d23f35180f76d25a1ac86739fc2aa5bd","modified":1630391678608},{"_id":"public/archives/2021/08/index.html","hash":"a072649a31f80f3d27bc23cbba197b9ac17cf579","modified":1630391678608},{"_id":"source/_posts/2021/realitykit-live-ar-0830.md","hash":"baf3c1a6d8d2e3a30e7e866013686978705e43c0","modified":1630406607557},{"_id":"source/img/article/20210830/1.png","hash":"81e59707a9e4635d65b9f5c2cf6f71c8aeceb888","modified":1630399581354},{"_id":"source/img/article/20210830/2.mp4","hash":"b7aee484b1ef57e8e6d756b3922abf8805e4d108","modified":1630406449131}],"Category":[],"Data":[],"Page":[{"layout":"404","description":"","header-img":"/img/header_img/404.png","_content":"","source":"404.md","raw":"---\nlayout: 404\ndescription: \"\"\nheader-img: \"/img/header_img/404.png\"\n---\n","date":"2021-06-21T12:34:52.090Z","updated":"2021-06-21T12:34:52.090Z","path":"404.html","title":"","comments":1,"_id":"ckszp3n950000ifntlg5fzrup","content":"","site":{"data":{}},"excerpt":"","more":""},{"layout":"about","title":"About","date":"2017-10-03T02:48:33.000Z","description":"Just do IT","header-img":"/img/header_img/about.jpg","aplayer":false,"comments":1,"fixed":false,"_content":"\n### \n\n>\n>\n>\n\n### \n\n> iOS \n\n### \n\n > Github:https://github.com/Quincy-QC\n >\n > :https://gitee.com/qiuchong\n >\n > leetCode:https://leetcode.com/quincy-qc\n\n### \n\n>Email: quincy.qiuchong@gmail.com\n\n","source":"about/index.md","raw":"---\nlayout: \"about\"\ntitle: \"About\"\ndate: 2017-10-03 10:48:33\ndescription: \"Just do IT\"\nheader-img: \"/img/header_img/about.jpg\"\naplayer: false\ncomments: true\nfixed: false\n---\n\n### \n\n>\n>\n>\n\n### \n\n> iOS \n\n### \n\n > Github:https://github.com/Quincy-QC\n >\n > :https://gitee.com/qiuchong\n >\n > leetCode:https://leetcode.com/quincy-qc\n\n### \n\n>Email: quincy.qiuchong@gmail.com\n\n","updated":"2021-06-21T12:34:52.101Z","path":"about/index.html","_id":"ckszp3nb40001ifntqp3tdoen","content":"<h3 id=\"\"></h3>\n<blockquote>\n<p></p>\n<p></p>\n</blockquote>\n<h3 id=\"\"></h3>\n<blockquote>\n<p>iOS </p>\n</blockquote>\n<h3 id=\"\"></h3>\n<blockquote>\n<p>Github:<a href=\"https://github.com/Quincy-QC\" target=\"_blank\" rel=\"noopener\">https://github.com/Quincy-QC</a></p>\n<p>:<a href=\"https://gitee.com/qiuchong\" target=\"_blank\" rel=\"noopener\">https://gitee.com/qiuchong</a></p>\n<p>leetCode:<a href=\"https://leetcode.com/quincy-qc\" target=\"_blank\" rel=\"noopener\">https://leetcode.com/quincy-qc</a></p>\n</blockquote>\n<h3 id=\"\"></h3>\n<blockquote>\n<p>Email: <a href=\"mailto:quincy.qiuchong@gmail.com\" target=\"_blank\" rel=\"noopener\">quincy.qiuchong@gmail.com</a></p>\n</blockquote>\n","site":{"data":{}},"excerpt":"","more":"<h3></h3>\n<blockquote>\n<p></p>\n<p></p>\n</blockquote>\n<h3></h3>\n<blockquote>\n<p>iOS </p>\n</blockquote>\n<h3></h3>\n<blockquote>\n<p>Github:<a href=\"https://github.com/Quincy-QC\" target=\"_blank\" rel=\"noopener\">https://github.com/Quincy-QC</a></p>\n<p>:<a href=\"https://gitee.com/qiuchong\" target=\"_blank\" rel=\"noopener\">https://gitee.com/qiuchong</a></p>\n<p>leetCode:<a href=\"https://leetcode.com/quincy-qc\" target=\"_blank\" rel=\"noopener\">https://leetcode.com/quincy-qc</a></p>\n</blockquote>\n<h3></h3>\n<blockquote>\n<p>Email: <a href=\"mailto:quincy.qiuchong@gmail.com\" target=\"_blank\" rel=\"noopener\">quincy.qiuchong@gmail.com</a></p>\n</blockquote>\n"},{"layout":"archive","title":"Archives","header-img":"/img/header_img/archive.jpg","comments":0,"date":"2017-09-20T12:49:56.000Z","description":"Hey, this is archives","_content":"","source":"archive/index.md","raw":"---\nlayout: \"archive\"\ntitle: \"Archives\"\nheader-img: \"/img/header_img/archive.jpg\"\ncomments: false\ndate: 2017-09-20 20:49:56\ndescription: \"Hey, this is archives\"\n---\n","updated":"2021-06-21T12:34:52.101Z","path":"archive/index.html","_id":"ckszp3nb60002ifntm5yz3niv","content":"","site":{"data":{}},"excerpt":"","more":""},{"layout":"tags","title":"Tags","description":"Hey, this is Tags.","header-img":"/img/header_img/tag.png","_content":"","source":"tags/index.md","raw":"---\nlayout: \"tags\"\ntitle: \"Tags\"\ndescription: \"Hey, this is Tags.\"\nheader-img: \"/img/header_img/tag.png\"\n---\n","date":"2021-06-21T12:34:52.242Z","updated":"2021-06-21T12:34:52.242Z","path":"tags/index.html","comments":1,"_id":"ckszp3nb80003ifntmk5azqqb","content":"","site":{"data":{}},"excerpt":"","more":""}],"Post":[{"title":"Cocoapods","catalog":true,"toc_nav_num":true,"date":"2019-11-21T10:30:24.000Z","subtitle":"Making a Cocoapod","header-img":"/img/article_header/article_header.png","busuanzi":true,"_content":"\n# \n\nCocoapods\n\n# \n\n## pod\n\n`pod lib create projectName``--template-url=URL`\n\n\n``` zsh\nWhat platform do you want to use?? [ iOS / macOS ]\n > iOS\n\nWhat language do you want to use?? [ Swift / ObjC ]\n > Swift\n\nWould you like to include a demo application with your library? [ Yes / No ]\n > NO\n\nWhich testing frameworks will you use? [ Quick / None ]\n > None\n\nWould you like to do view based testing? [ Yes / No ]\n > No\n```\n\n## \n\nXcode`Podspec Metadata``Project.podspec`\n\n![](/img/article/20191121/1.png)\n\n\n\n1. `s.name`\n2. `s.version`podGithub`tag`\n3. `s.homepage``s.source`\n4. `s.framework``s.frameworks`\n5. `s.dependency`\n6. `s.subspec 'Core' do |ss|``end`\n\n\n\n## \n\n`pod lib lint Project.podsepc --verbose --allow-warnings``pod spec lint Project.podspec`\n\n\n``` objc\nThe 'Pods-App' target has transitive dependencies that include static binaries: during validation.\n```\ns.dependency.apod`--use-libraries`\n\n`--resources=xxx.git`\n\n\n## Tag\n\nTag\n\n## \n\n`pod repo push  --allow-warnings`podspecgitlabpodspec`pod search`\n\n## \n\ncocoapods`pod trunk register xxx@email.com userName --verbose`\n\n`pod trunk me`\n\n`pod trunk push Project.podspec --verbose --use-libraries --allow-warnings`\n\n`pod repo update``rm ~/Library/Caches/CocoaPods/search_index.json``pod search`\n\n# pod\n\npod\n\n`pod trunk delete podName version`\n\npod\n\n`pod trunk deprecate podName`\n\n# \n\n","source":"_posts/2019/cocoapods-create-pods-1121.md","raw":"---\ntitle: \"Cocoapods\"\ncatalog: true\ntoc_nav_num: true\ndate: 2019-11-21 18:30:24\nsubtitle: \"Making a Cocoapod\"\nheader-img: \"/img/article_header/article_header.png\"\nbusuanzi: true\ntags:\n- iOS\n\n---\n\n# \n\nCocoapods\n\n# \n\n## pod\n\n`pod lib create projectName``--template-url=URL`\n\n\n``` zsh\nWhat platform do you want to use?? [ iOS / macOS ]\n > iOS\n\nWhat language do you want to use?? [ Swift / ObjC ]\n > Swift\n\nWould you like to include a demo application with your library? [ Yes / No ]\n > NO\n\nWhich testing frameworks will you use? [ Quick / None ]\n > None\n\nWould you like to do view based testing? [ Yes / No ]\n > No\n```\n\n## \n\nXcode`Podspec Metadata``Project.podspec`\n\n![](/img/article/20191121/1.png)\n\n\n\n1. `s.name`\n2. `s.version`podGithub`tag`\n3. `s.homepage``s.source`\n4. `s.framework``s.frameworks`\n5. `s.dependency`\n6. `s.subspec 'Core' do |ss|``end`\n\n\n\n## \n\n`pod lib lint Project.podsepc --verbose --allow-warnings``pod spec lint Project.podspec`\n\n\n``` objc\nThe 'Pods-App' target has transitive dependencies that include static binaries: during validation.\n```\ns.dependency.apod`--use-libraries`\n\n`--resources=xxx.git`\n\n\n## Tag\n\nTag\n\n## \n\n`pod repo push  --allow-warnings`podspecgitlabpodspec`pod search`\n\n## \n\ncocoapods`pod trunk register xxx@email.com userName --verbose`\n\n`pod trunk me`\n\n`pod trunk push Project.podspec --verbose --use-libraries --allow-warnings`\n\n`pod repo update``rm ~/Library/Caches/CocoaPods/search_index.json``pod search`\n\n# pod\n\npod\n\n`pod trunk delete podName version`\n\npod\n\n`pod trunk deprecate podName`\n\n# \n\n","slug":"2019/cocoapods-create-pods-1121","published":1,"updated":"2021-06-21T12:34:52.091Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckszp3ncr0004ifnt7dskl8yk","content":"<h1 id=\"\"></h1>\n<p>Cocoapods</p>\n<h1 id=\"\"></h1>\n<h2 id=\"pod\">pod</h2>\n<p><code>pod lib create projectName</code><code>--template-url=URL</code></p>\n<p></p>\n<figure class=\"highlight zsh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">What platform <span class=\"keyword\">do</span> you want to use?? [ iOS / macOS ]</span><br><span class=\"line\"> &gt; iOS</span><br><span class=\"line\"></span><br><span class=\"line\">What language <span class=\"keyword\">do</span> you want to use?? [ Swift / ObjC ]</span><br><span class=\"line\"> &gt; Swift</span><br><span class=\"line\"></span><br><span class=\"line\">Would you like to include a demo application with your library? [ Yes / No ]</span><br><span class=\"line\"> &gt; NO</span><br><span class=\"line\"></span><br><span class=\"line\">Which testing frameworks will you use? [ Quick / None ]</span><br><span class=\"line\"> &gt; None</span><br><span class=\"line\"></span><br><span class=\"line\">Would you like to <span class=\"keyword\">do</span> view based testing? [ Yes / No ]</span><br><span class=\"line\"> &gt; No</span><br></pre></td></tr></table></figure>\n<h2 id=\"\"></h2>\n<p>Xcode<code>Podspec Metadata</code><code>Project.podspec</code></p>\n<p><img src=\"/img/article/20191121/1.png\" alt=\"\"></p>\n<p></p>\n<ol>\n<li><code>s.name</code></li>\n<li><code>s.version</code>podGithub<code>tag</code></li>\n<li><code>s.homepage</code><code>s.source</code></li>\n<li><code>s.framework</code><code>s.frameworks</code></li>\n<li><code>s.dependency</code></li>\n<li><code>s.subspec 'Core' do |ss|</code><code>end</code></li>\n</ol>\n<p></p>\n<h2 id=\"\"></h2>\n<p><code>pod lib lint Project.podsepc --verbose --allow-warnings</code><code>pod spec lint Project.podspec</code></p>\n<p></p>\n<figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">The 'Pods-App' target has transitive dependencies that include static binaries: during validation.</span><br></pre></td></tr></table></figure>\n<p>s.dependency.apod<code>--use-libraries</code></p>\n<p><code>--resources=xxx.git</code></p>\n<h2 id=\"tag\">Tag</h2>\n<p>Tag</p>\n<h2 id=\"\"></h2>\n<p><code>pod repo push  --allow-warnings</code>podspecgitlabpodspec<code>pod search</code></p>\n<h2 id=\"\"></h2>\n<p>cocoapods<code>pod trunk register xxx@email.com userName --verbose</code></p>\n<p><code>pod trunk me</code></p>\n<p><code>pod trunk push Project.podspec --verbose --use-libraries --allow-warnings</code></p>\n<p><code>pod repo update</code><code>rm ~/Library/Caches/CocoaPods/search_index.json</code><code>pod search</code></p>\n<h1 id=\"pod\">pod</h1>\n<p>pod</p>\n<p><code>pod trunk delete podName version</code></p>\n<p>pod</p>\n<p><code>pod trunk deprecate podName</code></p>\n<h1 id=\"\"></h1>\n<p></p>\n","site":{"data":{}},"excerpt":"","more":"<h1></h1>\n<p>Cocoapods</p>\n<h1></h1>\n<h2>pod</h2>\n<p><code>pod lib create projectName</code><code>--template-url=URL</code></p>\n<p></p>\n<figure class=\"highlight zsh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">What platform <span class=\"keyword\">do</span> you want to use?? [ iOS / macOS ]</span><br><span class=\"line\"> &gt; iOS</span><br><span class=\"line\"></span><br><span class=\"line\">What language <span class=\"keyword\">do</span> you want to use?? [ Swift / ObjC ]</span><br><span class=\"line\"> &gt; Swift</span><br><span class=\"line\"></span><br><span class=\"line\">Would you like to include a demo application with your library? [ Yes / No ]</span><br><span class=\"line\"> &gt; NO</span><br><span class=\"line\"></span><br><span class=\"line\">Which testing frameworks will you use? [ Quick / None ]</span><br><span class=\"line\"> &gt; None</span><br><span class=\"line\"></span><br><span class=\"line\">Would you like to <span class=\"keyword\">do</span> view based testing? [ Yes / No ]</span><br><span class=\"line\"> &gt; No</span><br></pre></td></tr></table></figure>\n<h2></h2>\n<p>Xcode<code>Podspec Metadata</code><code>Project.podspec</code></p>\n<p><img src=\"/img/article/20191121/1.png\" alt=\"\"></p>\n<p></p>\n<ol>\n<li><code>s.name</code></li>\n<li><code>s.version</code>podGithub<code>tag</code></li>\n<li><code>s.homepage</code><code>s.source</code></li>\n<li><code>s.framework</code><code>s.frameworks</code></li>\n<li><code>s.dependency</code></li>\n<li><code>s.subspec 'Core' do |ss|</code><code>end</code></li>\n</ol>\n<p></p>\n<h2></h2>\n<p><code>pod lib lint Project.podsepc --verbose --allow-warnings</code><code>pod spec lint Project.podspec</code></p>\n<p></p>\n<figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">The 'Pods-App' target has transitive dependencies that include static binaries: during validation.</span><br></pre></td></tr></table></figure>\n<p>s.dependency.apod<code>--use-libraries</code></p>\n<p><code>--resources=xxx.git</code></p>\n<h2>Tag</h2>\n<p>Tag</p>\n<h2></h2>\n<p><code>pod repo push  --allow-warnings</code>podspecgitlabpodspec<code>pod search</code></p>\n<h2></h2>\n<p>cocoapods<code>pod trunk register xxx@email.com userName --verbose</code></p>\n<p><code>pod trunk me</code></p>\n<p><code>pod trunk push Project.podspec --verbose --use-libraries --allow-warnings</code></p>\n<p><code>pod repo update</code><code>rm ~/Library/Caches/CocoaPods/search_index.json</code><code>pod search</code></p>\n<h1>pod</h1>\n<p>pod</p>\n<p><code>pod trunk delete podName version</code></p>\n<p>pod</p>\n<p><code>pod trunk deprecate podName</code></p>\n<h1></h1>\n<p></p>\n"},{"title":" -- Core Animation","catalog":true,"toc_nav_num":true,"date":"2019-05-03T07:30:10.000Z","subtitle":"About Core Animation","header-img":"/img/article_header/article_header.png","busuanzi":true,"_content":"\n# Introduction\n\nCore AnimationiOSOS XCore AnimationCore AnimationCPU\niOSCore AnimationOS XCore AnimationCore AnimationAppKitUIKitCocoaCocoa TouchCore Animation\n\n![Core Animation](/img/article/20190503/1.png)\n\n# Core Animation Basics\n\nCore AnimationViewCore Animation\n\n## Layers\n\nLayerCore AnimationViewView\n\n### \n\nLayer****Core Animation\n\n![How Core Animation draws content](/img/article/20190503/2.png)\n\n`drawRect:`CPUCore Animation\n\nCore Animation\n\n### \n\nCore AnimationCore Animation\n\n![Examples of animations I can perform on layers](/img/article/20190503/3.png)\n\nCore AnimationCore AnimationCore Animation\n\n## \n\nboundsViewframeboundsView\n\n### Layers\n\nLayerspoint-basedunitpoint-basedunit\n\npoint-basedboundspositionframeboudnspositionboundsframe\n\n![The default layer geometries for iOS and OS X](/img/article/20190503/4.png)\n\npositionunitCore Animationunitunitunit0.0-1.0\n\n![The default unit coordinate systems for iOS and OS X](/img/article/20190503/5.png)\n\n### \n\n\n\n![How the anchor point affects the layer's position property](/img/article/20190503/6.png)\n\n\n\n![How the anchor point affects layer transformations](/img/article/20190503/7.png)\n\n## \n\nCore Animation\n- Objects in the model layer tree\n- Objects in the presentation tree\n- Objects in the render treeCore Animation\n\n\n\n![The layer trees for a window](/img/article/20190503/8.png)\n\n\n## LayersViews\n\nLayersViews--LayersViewsLayersLayers\n\n# Settign Up Layer Objects\n\nLayerCore Animation\n\n## ViewLayer\n\niOSViewCALayerCore Animation[Layer](https://developer.apple.com/library/archive/documentation/Cocoa/Conceptual/CoreAnimation_guide/SettingUpLayerObjects/SettingUpLayerObjects.html#//apple_ref/doc/uid/TP40004514-CH13-SW25)\n\nViewLayer\n``` Swift\noverride var layer: CALayer {\n    return CAShapeLayer()\n}\n```\n\n## LayerContent\n\nLayers\n- `contents`\n- LayerView\n- Layer`drawing`Layer\n\n### Content\n\n`Contents`*CGImageRef*`ContentsScale`\n\n### Content\n\nContent\n- `displayLayer:``contents`\n- `drawLayer:inContext:`Core Animation\n\n`displayLayer:``drawLayer:inContext``displayLayer`\n\n`displayLayer:`\n``` objectivec\n- (void)displayLayer:(CALayer *)theLayer {\n    // Check the value of some state property\n    if (self.displayYesImage) {\n        // Display the Yes image\n        theLayer.contents = [someHelperObject loadStateYesImage];\n    }\n    else {\n        // Display the No image\n        theLayer.contents = [someHelperObject loadStateNoImage];\n    }\n}\n```\n\n> PSUIKit`drawRect`OS XLayerView`drawRect``drawLayer``drawRect`View`drawLayer`Layer`drawLayer``drawLayer``drawRect``drawLayer``setNeedsDisplay``drawRect`Layer`drawLayer`Layer`drawRect`Layer[](https://stackoverflow.com/questions/4979192/ios-using-uiviews-drawrect-vs-its-layers-delegate-drawlayerincontext/36050120#36050120)\n\n`drawLayer`\n``` objectivec\n- (void)drawLayer:(CALayer *)theLayer inContext:(CGContextRef)theContext {\n    CGMutablePathRef thePath = CGPathCreateMutable();\n \n    CGPathMoveToPoint(thePath,NULL,15.0f,15.f);\n    CGPathAddCurveToPoint(thePath,\n                          NULL,\n                          15.f,250.0f,\n                          295.0f,250.0f,\n                          295.0f,15.0f);\n \n    CGContextBeginPath(theContext);\n    CGContextAddPath(theContext, thePath);\n \n    CGContextSetLineWidth(theContext, 5);\n    CGContextStrokePath(theContext);\n \n    // Release the path\n    CFRelease(thePath);\n}\n```\n\nUIView`drawRect`.\n\n### Content\n\nLayerLayer\n- `display``contents`\n- `drawInContext:`\n\n### Content\n\n`contents``contentsGravity`\n`contentsGravity`\n- \n- \n\nPosition-based gravity constants for layers:\n![Position-based gravity constants for layers](/img/article/20190503/9.png)\n\nScaling-based gravity constants for layers:\n![Scaling-based gravity constants for layers](/img/article/20190503/10.png)\n\n## Layer\n\n\n\n### Layers\n\n\n\n`opaque`YESalpha\n\n### Layers\n\n`maskToBounds`YES\n\n### Layers\n\nCALayer\n\n0Core Animation\n\n![Applying a shadow to a layer](/img/article/20190503/11.png)\n\n`maskToBounds``maskTobounds`\n\n# Animating Layer Content\n\nCore Animation\n\n## \n\n\n\nCore AnimationCore Animation\n\n``` Swift\ntheLayer.opacity = 0.0\n```\n\n*CABasicAnimation*`addAnimation:forKey:`\n\n``` Swift\nlet fadeAnimation = CABasicAnimation(keyPath: \"opacity\")\nfadeAnimation.fromValue = 1.0\nfadeAnimation.toValue = 0.0\nfadeAnimation.duration = 1.0\nlayer.add(fadeAnimation, forKey: \"opacity\")\n\n// Change the actual data value in the layer to the final layer\nlayer.opacity = 0.0\n```\n\n> Tip`fromValue`Core Animation\n\nCore Animation\n\nrunlooprunloop\n\n## \n\n*CAKeyframeAnimation*\n\n``` Swift\nlet path = CGMutablePath()\npath.move(to: CGPoint(x: 0, y: 0))\npath.addCurve(to: CGPoint(x: 300, y: 600), control1: CGPoint(x: 200, y: 50), control2: CGPoint(x: 400, y: 350))\n\nlet animation = CAKeyframeAnimation(keyPath: \"position\")\nanimation.path = path\nanimation.duration = 2.0\nmyView.layer.add(animation, forKey: \"position\")\n```\n\n### \n\n*CGPoint**CGPathRef*id\n- *CGRect**NSValue*\n- *CATransform3D**NSValue*\n- *borderColo**CGColorRef**id*\n- *CGFloat**NSNumber*\n- *Contents**CGImageRef*\n\n*CGPoint**NSValue**CGPathRef**CGPathRef*\n\n### \n\n\n- *calculationMode*\n    1.  -- *calculationMode**kCAAnimationLinear**kCAAnimationCubic` -- \n    2.  -- *calculationMode**kCAAnimationPaced**kCAAnimationCubicPaced* -- *keyTimes**timingFunctions*\n    3.  -- *calculationMode**kCAAnimationDiscrete* -- *keyTimes**timeingFunctions*\n- *keyTimes**kCAAnimationLinear**kCAAnimationDiscrete*, *kCAAnimationCubic*\n- *timingFunctions*\n\n## \n\n\n- `removeAnimationForKey:``addAnimation:forKey`\n- `removeAllAnimations`\n\n## \n\n*CAAnimationGroup*\n\n``` Swift\nlet path = CGMutablePath()\npath.move(to: CGPoint(x: 0, y: 0))\npath.addCurve(to: CGPoint(x: 300, y: 600), control1: CGPoint(x: 200, y: 50), control2: CGPoint(x: 400, y: 350))\n\nlet positionAnimation = CAKeyframeAnimation(keyPath: \"position\")\npositionAnimation.path = path\n\nlet colorAnimation = CAKeyframeAnimation(keyPath: \"backgroundColor\")\nlet colorValues = [UIColor.red.cgColor, UIColor.yellow.cgColor, UIColor.cyan.cgColor]\ncolorAnimation.values = colorValues\ncolorAnimation.calculationMode = .paced\n\nlet group = CAAnimationGroup()\ngroup.animations = [positionAnimation, colorAnimation]\ngroup.duration = 5.0\nmyView.layer.add(group, forKey: \"group\")\n```\n\n*CATransaction*\n\n## \n\nCore Animation\n- *CATransaction*`setCompletionBlock:`\n- *CAAnimation*`animationDidStart:``animationDidStop:finished:`\n\n*beginTime*\n\n## Layer-Backed\n\nUIKitCore Animation\n\n*UIView*LayerCore AnimationUIView\n\nCore AnimationCore Animation*UIView*()\n\n``` Swift\nUIView.animate(withDuration: 2.0) {\n    self.view.layer.opacity = 0.0\n}\n```\n\n# Advanced Animation Tricks\n\n\n\n## \n\n\n\n*CATransition*\n\nmyView1myView2*isHidden*\n\n``` Swift\nlet transition = CATransition()\ntransition.startProgress = 0.0\ntransition.endProgress = 1.0\ntransition.type = .push\ntransition.subtype = .fromRight\ntransition.duration = 2.0\n\nmyView1.layer.add(transition, forKey: \"transition\")\nmyView2.layer.add(transition, forKey: \"transition\")\n\nmyView1.isHidden = false\nmyView2.isHidden = true\n```\n\n\n\n## \n\nCore Animation*CAMediaTiming**CAAnimation**CALayer*\n\n*speed*\n\n*CALayer*`convertTime:fromLayer:``convertTime:toLayer:``CACurrentMediaTime`\n\n``` Swift\nlet localLayerTime = view.layer.convertTime(CACurrentMediaTime(), from: nil)\n```\n\n\n- *beginTime**fillMode**kCAFillModeBackwards*\n- *autoreverses**repeatCount*1.5\n- *timeOffset*\n\n## \n\n*CAMediaTiming*0.0\n\n``` Swift\nfunc pauseLayer(layer: CALayer) {\n    let pausedTime = layer.convertTime(CACurrentMediaTime(), from: nil)\n    layer.speed = 0.0\n    layer.timeOffset = pausedTime   // \n}\n\nfunc resumeLayer(layer: CALayer) {\n    let pausedTime = layer.timeOffset\n    layer.speed = 1.0\n    layer.timeOffset = 0.0\n    layer.beginTime = 0.0\n    let timeSincePause = layer.convertTime(CACurrentMediaTime(), from: nil) - pausedTime\n    layer.beginTime = timeSincePause    // \n}\n```\n\n## Transactions\n\nTransactions*CATransaction*TransactionsCore Animationtransactiontransactions\n\n*CATransaction*transactions`begin`transaction`commit`transactiontransaction\n\n``` Swift\nCATransaction.begin()\nmyView.layer.zPosition = 200.0\nmyView.layer.opacity = 0.0\nCATransaction.commit()\n```\n\ntransactionstransactiontransaction`setValue:forKey:`\n\n``` Swift\nCATransaction.begin()\nCATransaction.setValue(10.0, forKey: kCATransactionAnimationDuration)\n// perform the animations\nCATransaction.commit()\n```\n\ntransactions*begin*transaction*begin**commit*transactionCore Animation\n\n## \n\nCore Animation*zPosition*z\n\n*sublayerTransform*\n\n```\nvar perspective = CATransform3DIdentity\nperspective.m34 = -1.0/eyePosition\nview.layer.sublayerTransform = perspective\n```\n\n# Changing a Layer's Default Bahavior\n\nCore Animationactionaction*CAAction**CAAnimation*\n\nactionactionsaction\n\n## CAActionAction\n\naction*CAAction*`runActionForKey:object:arguments:`\n\nactionactionactionkey\n- actionsaction\n- *kCAOnOrderIn*\n- *kCAOnOrderOut*\n- *kCATransition*\n\n## action\n\nactionactionaction*actionForKey:*actionaction\n\nCore Animationaction\n1. `actionForLayer:forKey:`\n    - action\n    - nilaction\n    - NSNull\n2. actions\n3. [style](https://developer.apple.com/documentation/quartzcore/calayer/1410875-style)actionsactionsstyle\n4. `defaultActionForKey:`\n5. Core Animationaction\n\nactionactionaction`runActionForKey:object:arguments:`action*CAAnimation**CAAction*\n\naction\n- actions`actionForLayer:forKey`\n- actionactions\n- actionsstyleaction\n- actions`defaultActionForKey:`\n\n``` objectivec\n- (id<CAAction>)actionForLayer:(CALayer *)theLayer\n                        forKey:(NSString *)theKey {\n    CATransition *theAnimation=nil;\n \n    if ([theKey isEqualToString:@\"contents\"]) {\n \n        theAnimation = [[CATransition alloc] init];\n        theAnimation.duration = 1.0;\n        theAnimation.timingFunction = [CAMediaTimingFunction functionWithName:kCAMediaTimingFunctionEaseIn];\n        theAnimation.type = kCATransitionPush;\n        theAnimation.subtype = kCATransitionFromRight;\n    }\n    return theAnimation;\n}\n```\n\n## CATransactionactions\n\n*CATransaction*actionsCore Animationtransactiontransaction*kCATransactionDisableActions*true\n\n``` objectivec\n[CATransaction begin];\n[CATransaction setValue:(id)kCFBooleanTrue\n                 forKey:kCATransactionDisableActions];\n[aLayer removeFromSuperlayer];\n[CATransaction commit];\n```\n\n# Ending\n\nLayer\n\n# Reference\n\n> [About Core Animation](https://developer.apple.com/library/archive/documentation/Cocoa/Conceptual/CoreAnimation_guide/Introduction/Introduction.html#//apple_ref/doc/uid/TP40004514-CH1-SW1)","source":"_posts/2019/core-animation-study-0503.md","raw":"---\ntitle: \" -- Core Animation\"\ncatalog: true\ntoc_nav_num: true\ndate: 2019-05-03 15:30:10\nsubtitle: \"About Core Animation\"\nheader-img: \"/img/article_header/article_header.png\"\nbusuanzi: true\ntags:\n- iOS\n\n---\n\n# Introduction\n\nCore AnimationiOSOS XCore AnimationCore AnimationCPU\niOSCore AnimationOS XCore AnimationCore AnimationAppKitUIKitCocoaCocoa TouchCore Animation\n\n![Core Animation](/img/article/20190503/1.png)\n\n# Core Animation Basics\n\nCore AnimationViewCore Animation\n\n## Layers\n\nLayerCore AnimationViewView\n\n### \n\nLayer****Core Animation\n\n![How Core Animation draws content](/img/article/20190503/2.png)\n\n`drawRect:`CPUCore Animation\n\nCore Animation\n\n### \n\nCore AnimationCore Animation\n\n![Examples of animations I can perform on layers](/img/article/20190503/3.png)\n\nCore AnimationCore AnimationCore Animation\n\n## \n\nboundsViewframeboundsView\n\n### Layers\n\nLayerspoint-basedunitpoint-basedunit\n\npoint-basedboundspositionframeboudnspositionboundsframe\n\n![The default layer geometries for iOS and OS X](/img/article/20190503/4.png)\n\npositionunitCore Animationunitunitunit0.0-1.0\n\n![The default unit coordinate systems for iOS and OS X](/img/article/20190503/5.png)\n\n### \n\n\n\n![How the anchor point affects the layer's position property](/img/article/20190503/6.png)\n\n\n\n![How the anchor point affects layer transformations](/img/article/20190503/7.png)\n\n## \n\nCore Animation\n- Objects in the model layer tree\n- Objects in the presentation tree\n- Objects in the render treeCore Animation\n\n\n\n![The layer trees for a window](/img/article/20190503/8.png)\n\n\n## LayersViews\n\nLayersViews--LayersViewsLayersLayers\n\n# Settign Up Layer Objects\n\nLayerCore Animation\n\n## ViewLayer\n\niOSViewCALayerCore Animation[Layer](https://developer.apple.com/library/archive/documentation/Cocoa/Conceptual/CoreAnimation_guide/SettingUpLayerObjects/SettingUpLayerObjects.html#//apple_ref/doc/uid/TP40004514-CH13-SW25)\n\nViewLayer\n``` Swift\noverride var layer: CALayer {\n    return CAShapeLayer()\n}\n```\n\n## LayerContent\n\nLayers\n- `contents`\n- LayerView\n- Layer`drawing`Layer\n\n### Content\n\n`Contents`*CGImageRef*`ContentsScale`\n\n### Content\n\nContent\n- `displayLayer:``contents`\n- `drawLayer:inContext:`Core Animation\n\n`displayLayer:``drawLayer:inContext``displayLayer`\n\n`displayLayer:`\n``` objectivec\n- (void)displayLayer:(CALayer *)theLayer {\n    // Check the value of some state property\n    if (self.displayYesImage) {\n        // Display the Yes image\n        theLayer.contents = [someHelperObject loadStateYesImage];\n    }\n    else {\n        // Display the No image\n        theLayer.contents = [someHelperObject loadStateNoImage];\n    }\n}\n```\n\n> PSUIKit`drawRect`OS XLayerView`drawRect``drawLayer``drawRect`View`drawLayer`Layer`drawLayer``drawLayer``drawRect``drawLayer``setNeedsDisplay``drawRect`Layer`drawLayer`Layer`drawRect`Layer[](https://stackoverflow.com/questions/4979192/ios-using-uiviews-drawrect-vs-its-layers-delegate-drawlayerincontext/36050120#36050120)\n\n`drawLayer`\n``` objectivec\n- (void)drawLayer:(CALayer *)theLayer inContext:(CGContextRef)theContext {\n    CGMutablePathRef thePath = CGPathCreateMutable();\n \n    CGPathMoveToPoint(thePath,NULL,15.0f,15.f);\n    CGPathAddCurveToPoint(thePath,\n                          NULL,\n                          15.f,250.0f,\n                          295.0f,250.0f,\n                          295.0f,15.0f);\n \n    CGContextBeginPath(theContext);\n    CGContextAddPath(theContext, thePath);\n \n    CGContextSetLineWidth(theContext, 5);\n    CGContextStrokePath(theContext);\n \n    // Release the path\n    CFRelease(thePath);\n}\n```\n\nUIView`drawRect`.\n\n### Content\n\nLayerLayer\n- `display``contents`\n- `drawInContext:`\n\n### Content\n\n`contents``contentsGravity`\n`contentsGravity`\n- \n- \n\nPosition-based gravity constants for layers:\n![Position-based gravity constants for layers](/img/article/20190503/9.png)\n\nScaling-based gravity constants for layers:\n![Scaling-based gravity constants for layers](/img/article/20190503/10.png)\n\n## Layer\n\n\n\n### Layers\n\n\n\n`opaque`YESalpha\n\n### Layers\n\n`maskToBounds`YES\n\n### Layers\n\nCALayer\n\n0Core Animation\n\n![Applying a shadow to a layer](/img/article/20190503/11.png)\n\n`maskToBounds``maskTobounds`\n\n# Animating Layer Content\n\nCore Animation\n\n## \n\n\n\nCore AnimationCore Animation\n\n``` Swift\ntheLayer.opacity = 0.0\n```\n\n*CABasicAnimation*`addAnimation:forKey:`\n\n``` Swift\nlet fadeAnimation = CABasicAnimation(keyPath: \"opacity\")\nfadeAnimation.fromValue = 1.0\nfadeAnimation.toValue = 0.0\nfadeAnimation.duration = 1.0\nlayer.add(fadeAnimation, forKey: \"opacity\")\n\n// Change the actual data value in the layer to the final layer\nlayer.opacity = 0.0\n```\n\n> Tip`fromValue`Core Animation\n\nCore Animation\n\nrunlooprunloop\n\n## \n\n*CAKeyframeAnimation*\n\n``` Swift\nlet path = CGMutablePath()\npath.move(to: CGPoint(x: 0, y: 0))\npath.addCurve(to: CGPoint(x: 300, y: 600), control1: CGPoint(x: 200, y: 50), control2: CGPoint(x: 400, y: 350))\n\nlet animation = CAKeyframeAnimation(keyPath: \"position\")\nanimation.path = path\nanimation.duration = 2.0\nmyView.layer.add(animation, forKey: \"position\")\n```\n\n### \n\n*CGPoint**CGPathRef*id\n- *CGRect**NSValue*\n- *CATransform3D**NSValue*\n- *borderColo**CGColorRef**id*\n- *CGFloat**NSNumber*\n- *Contents**CGImageRef*\n\n*CGPoint**NSValue**CGPathRef**CGPathRef*\n\n### \n\n\n- *calculationMode*\n    1.  -- *calculationMode**kCAAnimationLinear**kCAAnimationCubic` -- \n    2.  -- *calculationMode**kCAAnimationPaced**kCAAnimationCubicPaced* -- *keyTimes**timingFunctions*\n    3.  -- *calculationMode**kCAAnimationDiscrete* -- *keyTimes**timeingFunctions*\n- *keyTimes**kCAAnimationLinear**kCAAnimationDiscrete*, *kCAAnimationCubic*\n- *timingFunctions*\n\n## \n\n\n- `removeAnimationForKey:``addAnimation:forKey`\n- `removeAllAnimations`\n\n## \n\n*CAAnimationGroup*\n\n``` Swift\nlet path = CGMutablePath()\npath.move(to: CGPoint(x: 0, y: 0))\npath.addCurve(to: CGPoint(x: 300, y: 600), control1: CGPoint(x: 200, y: 50), control2: CGPoint(x: 400, y: 350))\n\nlet positionAnimation = CAKeyframeAnimation(keyPath: \"position\")\npositionAnimation.path = path\n\nlet colorAnimation = CAKeyframeAnimation(keyPath: \"backgroundColor\")\nlet colorValues = [UIColor.red.cgColor, UIColor.yellow.cgColor, UIColor.cyan.cgColor]\ncolorAnimation.values = colorValues\ncolorAnimation.calculationMode = .paced\n\nlet group = CAAnimationGroup()\ngroup.animations = [positionAnimation, colorAnimation]\ngroup.duration = 5.0\nmyView.layer.add(group, forKey: \"group\")\n```\n\n*CATransaction*\n\n## \n\nCore Animation\n- *CATransaction*`setCompletionBlock:`\n- *CAAnimation*`animationDidStart:``animationDidStop:finished:`\n\n*beginTime*\n\n## Layer-Backed\n\nUIKitCore Animation\n\n*UIView*LayerCore AnimationUIView\n\nCore AnimationCore Animation*UIView*()\n\n``` Swift\nUIView.animate(withDuration: 2.0) {\n    self.view.layer.opacity = 0.0\n}\n```\n\n# Advanced Animation Tricks\n\n\n\n## \n\n\n\n*CATransition*\n\nmyView1myView2*isHidden*\n\n``` Swift\nlet transition = CATransition()\ntransition.startProgress = 0.0\ntransition.endProgress = 1.0\ntransition.type = .push\ntransition.subtype = .fromRight\ntransition.duration = 2.0\n\nmyView1.layer.add(transition, forKey: \"transition\")\nmyView2.layer.add(transition, forKey: \"transition\")\n\nmyView1.isHidden = false\nmyView2.isHidden = true\n```\n\n\n\n## \n\nCore Animation*CAMediaTiming**CAAnimation**CALayer*\n\n*speed*\n\n*CALayer*`convertTime:fromLayer:``convertTime:toLayer:``CACurrentMediaTime`\n\n``` Swift\nlet localLayerTime = view.layer.convertTime(CACurrentMediaTime(), from: nil)\n```\n\n\n- *beginTime**fillMode**kCAFillModeBackwards*\n- *autoreverses**repeatCount*1.5\n- *timeOffset*\n\n## \n\n*CAMediaTiming*0.0\n\n``` Swift\nfunc pauseLayer(layer: CALayer) {\n    let pausedTime = layer.convertTime(CACurrentMediaTime(), from: nil)\n    layer.speed = 0.0\n    layer.timeOffset = pausedTime   // \n}\n\nfunc resumeLayer(layer: CALayer) {\n    let pausedTime = layer.timeOffset\n    layer.speed = 1.0\n    layer.timeOffset = 0.0\n    layer.beginTime = 0.0\n    let timeSincePause = layer.convertTime(CACurrentMediaTime(), from: nil) - pausedTime\n    layer.beginTime = timeSincePause    // \n}\n```\n\n## Transactions\n\nTransactions*CATransaction*TransactionsCore Animationtransactiontransactions\n\n*CATransaction*transactions`begin`transaction`commit`transactiontransaction\n\n``` Swift\nCATransaction.begin()\nmyView.layer.zPosition = 200.0\nmyView.layer.opacity = 0.0\nCATransaction.commit()\n```\n\ntransactionstransactiontransaction`setValue:forKey:`\n\n``` Swift\nCATransaction.begin()\nCATransaction.setValue(10.0, forKey: kCATransactionAnimationDuration)\n// perform the animations\nCATransaction.commit()\n```\n\ntransactions*begin*transaction*begin**commit*transactionCore Animation\n\n## \n\nCore Animation*zPosition*z\n\n*sublayerTransform*\n\n```\nvar perspective = CATransform3DIdentity\nperspective.m34 = -1.0/eyePosition\nview.layer.sublayerTransform = perspective\n```\n\n# Changing a Layer's Default Bahavior\n\nCore Animationactionaction*CAAction**CAAnimation*\n\nactionactionsaction\n\n## CAActionAction\n\naction*CAAction*`runActionForKey:object:arguments:`\n\nactionactionactionkey\n- actionsaction\n- *kCAOnOrderIn*\n- *kCAOnOrderOut*\n- *kCATransition*\n\n## action\n\nactionactionaction*actionForKey:*actionaction\n\nCore Animationaction\n1. `actionForLayer:forKey:`\n    - action\n    - nilaction\n    - NSNull\n2. actions\n3. [style](https://developer.apple.com/documentation/quartzcore/calayer/1410875-style)actionsactionsstyle\n4. `defaultActionForKey:`\n5. Core Animationaction\n\nactionactionaction`runActionForKey:object:arguments:`action*CAAnimation**CAAction*\n\naction\n- actions`actionForLayer:forKey`\n- actionactions\n- actionsstyleaction\n- actions`defaultActionForKey:`\n\n``` objectivec\n- (id<CAAction>)actionForLayer:(CALayer *)theLayer\n                        forKey:(NSString *)theKey {\n    CATransition *theAnimation=nil;\n \n    if ([theKey isEqualToString:@\"contents\"]) {\n \n        theAnimation = [[CATransition alloc] init];\n        theAnimation.duration = 1.0;\n        theAnimation.timingFunction = [CAMediaTimingFunction functionWithName:kCAMediaTimingFunctionEaseIn];\n        theAnimation.type = kCATransitionPush;\n        theAnimation.subtype = kCATransitionFromRight;\n    }\n    return theAnimation;\n}\n```\n\n## CATransactionactions\n\n*CATransaction*actionsCore Animationtransactiontransaction*kCATransactionDisableActions*true\n\n``` objectivec\n[CATransaction begin];\n[CATransaction setValue:(id)kCFBooleanTrue\n                 forKey:kCATransactionDisableActions];\n[aLayer removeFromSuperlayer];\n[CATransaction commit];\n```\n\n# Ending\n\nLayer\n\n# Reference\n\n> [About Core Animation](https://developer.apple.com/library/archive/documentation/Cocoa/Conceptual/CoreAnimation_guide/Introduction/Introduction.html#//apple_ref/doc/uid/TP40004514-CH1-SW1)","slug":"2019/core-animation-study-0503","published":1,"updated":"2021-06-21T12:34:52.091Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckszp3ncu0005ifnt4fot484z","content":"<h1 id=\"introduction\">Introduction</h1>\n<p>Core AnimationiOSOS XCore AnimationCore AnimationCPU<br>\niOSCore AnimationOS XCore AnimationCore AnimationAppKitUIKitCocoaCocoa TouchCore Animation</p>\n<p><img src=\"/img/article/20190503/1.png\" alt=\"Core Animation\"></p>\n<h1 id=\"core-animation-basics\">Core Animation Basics</h1>\n<p>Core AnimationViewCore Animation</p>\n<h2 id=\"layers\">Layers</h2>\n<p>LayerCore AnimationViewView</p>\n<h3 id=\"\"></h3>\n<p>Layer<strong></strong>Core Animation</p>\n<p><img src=\"/img/article/20190503/2.png\" alt=\"How Core Animation draws content\"></p>\n<p><code>drawRect:</code>CPUCore Animation</p>\n<p>Core Animation</p>\n<h3 id=\"\"></h3>\n<p>Core AnimationCore Animation</p>\n<p><img src=\"/img/article/20190503/3.png\" alt=\"Examples of animations I can perform on layers\"></p>\n<p>Core AnimationCore AnimationCore Animation</p>\n<h2 id=\"\"></h2>\n<p>boundsViewframeboundsView</p>\n<h3 id=\"layers\">Layers</h3>\n<p>Layerspoint-basedunitpoint-basedunit</p>\n<p>point-basedboundspositionframeboudnspositionboundsframe</p>\n<p><img src=\"/img/article/20190503/4.png\" alt=\"The default layer geometries for iOS and OS X\"></p>\n<p>positionunitCore Animationunitunitunit0.0-1.0</p>\n<p><img src=\"/img/article/20190503/5.png\" alt=\"The default unit coordinate systems for iOS and OS X\"></p>\n<h3 id=\"\"></h3>\n<p></p>\n<p><img src=\"/img/article/20190503/6.png\" alt=\"How the anchor point affects the layer's position property\"></p>\n<p></p>\n<p><img src=\"/img/article/20190503/7.png\" alt=\"How the anchor point affects layer transformations\"></p>\n<h2 id=\"\"></h2>\n<p>Core Animation</p>\n<ul>\n<li>Objects in the model layer tree</li>\n<li>Objects in the presentation tree</li>\n<li>Objects in the render treeCore Animation</li>\n</ul>\n<p></p>\n<p><img src=\"/img/article/20190503/8.png\" alt=\"The layer trees for a window\"></p>\n<h2 id=\"layersviews\">LayersViews</h2>\n<p>LayersViewsLayersViewsLayersLayers</p>\n<h1 id=\"settign-up-layer-objects\">Settign Up Layer Objects</h1>\n<p>LayerCore Animation</p>\n<h2 id=\"viewlayer\">ViewLayer</h2>\n<p>iOSViewCALayerCore Animation<a href=\"https://developer.apple.com/library/archive/documentation/Cocoa/Conceptual/CoreAnimation_guide/SettingUpLayerObjects/SettingUpLayerObjects.html#//apple_ref/doc/uid/TP40004514-CH13-SW25\" target=\"_blank\" rel=\"noopener\">Layer</a></p>\n<p>ViewLayer</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">override</span> <span class=\"keyword\">var</span> layer: <span class=\"type\">CALayer</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"type\">CAShapeLayer</span>()</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"layercontent\">LayerContent</h2>\n<p>Layers</p>\n<ul>\n<li><code>contents</code></li>\n<li>LayerView</li>\n<li>Layer<code>drawing</code>Layer</li>\n</ul>\n<h3 id=\"content\">Content</h3>\n<p><code>Contents</code><em>CGImageRef</em><code>ContentsScale</code></p>\n<h3 id=\"content\">Content</h3>\n<p>Content</p>\n<ul>\n<li><code>displayLayer:</code><code>contents</code></li>\n<li><code>drawLayer:inContext:</code>Core Animation</li>\n</ul>\n<p><code>displayLayer:</code><code>drawLayer:inContext</code><code>displayLayer</code></p>\n<p><code>displayLayer:</code></p>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">- (<span class=\"keyword\">void</span>)displayLayer:(<span class=\"built_in\">CALayer</span> *)theLayer &#123;</span><br><span class=\"line\">    <span class=\"comment\">// Check the value of some state property</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"keyword\">self</span>.displayYesImage) &#123;</span><br><span class=\"line\">        <span class=\"comment\">// Display the Yes image</span></span><br><span class=\"line\">        theLayer.contents = [someHelperObject loadStateYesImage];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">// Display the No image</span></span><br><span class=\"line\">        theLayer.contents = [someHelperObject loadStateNoImage];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>PSUIKit<code>drawRect</code>OS XLayerView<code>drawRect</code><code>drawLayer</code><code>drawRect</code>View<code>drawLayer</code>Layer<code>drawLayer</code><code>drawLayer</code><code>drawRect</code><code>drawLayer</code><code>setNeedsDisplay</code><code>drawRect</code>Layer<code>drawLayer</code>Layer<code>drawRect</code>Layer<a href=\"https://stackoverflow.com/questions/4979192/ios-using-uiviews-drawrect-vs-its-layers-delegate-drawlayerincontext/36050120#36050120\" target=\"_blank\" rel=\"noopener\"></a></p>\n</blockquote>\n<p><code>drawLayer</code></p>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">- (<span class=\"keyword\">void</span>)drawLayer:(<span class=\"built_in\">CALayer</span> *)theLayer inContext:(<span class=\"built_in\">CGContextRef</span>)theContext &#123;</span><br><span class=\"line\">    <span class=\"built_in\">CGMutablePathRef</span> thePath = <span class=\"built_in\">CGPathCreateMutable</span>();</span><br><span class=\"line\"> </span><br><span class=\"line\">    <span class=\"built_in\">CGPathMoveToPoint</span>(thePath,<span class=\"literal\">NULL</span>,<span class=\"number\">15.0</span>f,<span class=\"number\">15.</span>f);</span><br><span class=\"line\">    <span class=\"built_in\">CGPathAddCurveToPoint</span>(thePath,</span><br><span class=\"line\">                          <span class=\"literal\">NULL</span>,</span><br><span class=\"line\">                          <span class=\"number\">15.</span>f,<span class=\"number\">250.0</span>f,</span><br><span class=\"line\">                          <span class=\"number\">295.0</span>f,<span class=\"number\">250.0</span>f,</span><br><span class=\"line\">                          <span class=\"number\">295.0</span>f,<span class=\"number\">15.0</span>f);</span><br><span class=\"line\"> </span><br><span class=\"line\">    <span class=\"built_in\">CGContextBeginPath</span>(theContext);</span><br><span class=\"line\">    <span class=\"built_in\">CGContextAddPath</span>(theContext, thePath);</span><br><span class=\"line\"> </span><br><span class=\"line\">    <span class=\"built_in\">CGContextSetLineWidth</span>(theContext, <span class=\"number\">5</span>);</span><br><span class=\"line\">    <span class=\"built_in\">CGContextStrokePath</span>(theContext);</span><br><span class=\"line\"> </span><br><span class=\"line\">    <span class=\"comment\">// Release the path</span></span><br><span class=\"line\">    <span class=\"built_in\">CFRelease</span>(thePath);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>UIView<code>drawRect</code>.</p>\n<h3 id=\"content\">Content</h3>\n<p>LayerLayer</p>\n<ul>\n<li><code>display</code><code>contents</code></li>\n<li><code>drawInContext:</code></li>\n</ul>\n<h3 id=\"content\">Content</h3>\n<p><code>contents</code><code>contentsGravity</code><br>\n<code>contentsGravity</code></p>\n<ul>\n<li></li>\n<li></li>\n</ul>\n<p>Position-based gravity constants for layers:<br>\n<img src=\"/img/article/20190503/9.png\" alt=\"Position-based gravity constants for layers\"></p>\n<p>Scaling-based gravity constants for layers:<br>\n<img src=\"/img/article/20190503/10.png\" alt=\"Scaling-based gravity constants for layers\"></p>\n<h2 id=\"layer\">Layer</h2>\n<p></p>\n<h3 id=\"layers\">Layers</h3>\n<p></p>\n<p><code>opaque</code>YESalpha</p>\n<h3 id=\"layers\">Layers</h3>\n<p><code>maskToBounds</code>YES</p>\n<h3 id=\"layers\">Layers</h3>\n<p>CALayer</p>\n<p>0Core Animation</p>\n<p><img src=\"/img/article/20190503/11.png\" alt=\"Applying a shadow to a layer\"></p>\n<p><code>maskToBounds</code><code>maskTobounds</code></p>\n<h1 id=\"animating-layer-content\">Animating Layer Content</h1>\n<p>Core Animation</p>\n<h2 id=\"\"></h2>\n<p></p>\n<p>Core AnimationCore Animation</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">theLayer.opacity = <span class=\"number\">0.0</span></span><br></pre></td></tr></table></figure>\n<p><em>CABasicAnimation</em><code>addAnimation:forKey:</code></p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> fadeAnimation = <span class=\"type\">CABasicAnimation</span>(keyPath: <span class=\"string\">\"opacity\"</span>)</span><br><span class=\"line\">fadeAnimation.fromValue = <span class=\"number\">1.0</span></span><br><span class=\"line\">fadeAnimation.toValue = <span class=\"number\">0.0</span></span><br><span class=\"line\">fadeAnimation.duration = <span class=\"number\">1.0</span></span><br><span class=\"line\">layer.add(fadeAnimation, forKey: <span class=\"string\">\"opacity\"</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// Change the actual data value in the layer to the final layer</span></span><br><span class=\"line\">layer.opacity = <span class=\"number\">0.0</span></span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>Tip<code>fromValue</code>Core Animation</p>\n</blockquote>\n<p>Core Animation</p>\n<p>runlooprunloop</p>\n<h2 id=\"\"></h2>\n<p><em>CAKeyframeAnimation</em></p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> path = <span class=\"type\">CGMutablePath</span>()</span><br><span class=\"line\">path.move(to: <span class=\"type\">CGPoint</span>(x: <span class=\"number\">0</span>, y: <span class=\"number\">0</span>))</span><br><span class=\"line\">path.addCurve(to: <span class=\"type\">CGPoint</span>(x: <span class=\"number\">300</span>, y: <span class=\"number\">600</span>), control1: <span class=\"type\">CGPoint</span>(x: <span class=\"number\">200</span>, y: <span class=\"number\">50</span>), control2: <span class=\"type\">CGPoint</span>(x: <span class=\"number\">400</span>, y: <span class=\"number\">350</span>))</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">let</span> animation = <span class=\"type\">CAKeyframeAnimation</span>(keyPath: <span class=\"string\">\"position\"</span>)</span><br><span class=\"line\">animation.path = path</span><br><span class=\"line\">animation.duration = <span class=\"number\">2.0</span></span><br><span class=\"line\">myView.layer.add(animation, forKey: <span class=\"string\">\"position\"</span>)</span><br></pre></td></tr></table></figure>\n<h3 id=\"\"></h3>\n<p><em>CGPoint</em><em>CGPathRef</em>id</p>\n<ul>\n<li><em>CGRect</em><em>NSValue</em></li>\n<li><em>CATransform3D</em><em>NSValue</em></li>\n<li><em>borderColo</em><em>CGColorRef</em><em>id</em></li>\n<li><em>CGFloat</em><em>NSNumber</em></li>\n<li><em>Contents</em><em>CGImageRef</em></li>\n</ul>\n<p><em>CGPoint</em><em>NSValue</em><em>CGPathRef</em><em>CGPathRef</em></p>\n<h3 id=\"\"></h3>\n<p></p>\n<ul>\n<li><em>calculationMode</em>\n<ol>\n<li>  <em>calculationMode</em><em>kCAAnimationLinear</em>*kCAAnimationCubic`  </li>\n<li>  <em>calculationMode</em><em>kCAAnimationPaced</em><em>kCAAnimationCubicPaced</em>  <em>keyTimes</em><em>timingFunctions</em></li>\n<li>  <em>calculationMode</em><em>kCAAnimationDiscrete</em>  <em>keyTimes</em><em>timeingFunctions</em></li>\n</ol>\n</li>\n<li><em>keyTimes</em><em>kCAAnimationLinear</em><em>kCAAnimationDiscrete</em>, <em>kCAAnimationCubic</em></li>\n<li><em>timingFunctions</em></li>\n</ul>\n<h2 id=\"\"></h2>\n<p></p>\n<ul>\n<li><code>removeAnimationForKey:</code><code>addAnimation:forKey</code></li>\n<li><code>removeAllAnimations</code></li>\n</ul>\n<h2 id=\"\"></h2>\n<p><em>CAAnimationGroup</em></p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> path = <span class=\"type\">CGMutablePath</span>()</span><br><span class=\"line\">path.move(to: <span class=\"type\">CGPoint</span>(x: <span class=\"number\">0</span>, y: <span class=\"number\">0</span>))</span><br><span class=\"line\">path.addCurve(to: <span class=\"type\">CGPoint</span>(x: <span class=\"number\">300</span>, y: <span class=\"number\">600</span>), control1: <span class=\"type\">CGPoint</span>(x: <span class=\"number\">200</span>, y: <span class=\"number\">50</span>), control2: <span class=\"type\">CGPoint</span>(x: <span class=\"number\">400</span>, y: <span class=\"number\">350</span>))</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">let</span> positionAnimation = <span class=\"type\">CAKeyframeAnimation</span>(keyPath: <span class=\"string\">\"position\"</span>)</span><br><span class=\"line\">positionAnimation.path = path</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">let</span> colorAnimation = <span class=\"type\">CAKeyframeAnimation</span>(keyPath: <span class=\"string\">\"backgroundColor\"</span>)</span><br><span class=\"line\"><span class=\"keyword\">let</span> colorValues = [<span class=\"type\">UIColor</span>.red.cgColor, <span class=\"type\">UIColor</span>.yellow.cgColor, <span class=\"type\">UIColor</span>.cyan.cgColor]</span><br><span class=\"line\">colorAnimation.values = colorValues</span><br><span class=\"line\">colorAnimation.calculationMode = .paced</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">let</span> group = <span class=\"type\">CAAnimationGroup</span>()</span><br><span class=\"line\">group.animations = [positionAnimation, colorAnimation]</span><br><span class=\"line\">group.duration = <span class=\"number\">5.0</span></span><br><span class=\"line\">myView.layer.add(group, forKey: <span class=\"string\">\"group\"</span>)</span><br></pre></td></tr></table></figure>\n<p><em>CATransaction</em></p>\n<h2 id=\"\"></h2>\n<p>Core Animation</p>\n<ul>\n<li><em>CATransaction</em><code>setCompletionBlock:</code></li>\n<li><em>CAAnimation</em><code>animationDidStart:</code><code>animationDidStop:finished:</code></li>\n</ul>\n<p><em>beginTime</em></p>\n<h2 id=\"layer-backed\">Layer-Backed</h2>\n<p>UIKitCore Animation</p>\n<p><em>UIView</em>LayerCore AnimationUIView</p>\n<p>Core AnimationCore Animation<em>UIView</em>()</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"type\">UIView</span>.animate(withDuration: <span class=\"number\">2.0</span>) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">self</span>.view.layer.opacity = <span class=\"number\">0.0</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h1 id=\"advanced-animation-tricks\">Advanced Animation Tricks</h1>\n<p></p>\n<h2 id=\"\"></h2>\n<p></p>\n<p><em>CATransition</em></p>\n<p>myView1myView2<em>isHidden</em></p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> transition = <span class=\"type\">CATransition</span>()</span><br><span class=\"line\">transition.startProgress = <span class=\"number\">0.0</span></span><br><span class=\"line\">transition.endProgress = <span class=\"number\">1.0</span></span><br><span class=\"line\">transition.type = .push</span><br><span class=\"line\">transition.subtype = .fromRight</span><br><span class=\"line\">transition.duration = <span class=\"number\">2.0</span></span><br><span class=\"line\"></span><br><span class=\"line\">myView1.layer.add(transition, forKey: <span class=\"string\">\"transition\"</span>)</span><br><span class=\"line\">myView2.layer.add(transition, forKey: <span class=\"string\">\"transition\"</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">myView1.isHidden = <span class=\"literal\">false</span></span><br><span class=\"line\">myView2.isHidden = <span class=\"literal\">true</span></span><br></pre></td></tr></table></figure>\n<p></p>\n<h2 id=\"\"></h2>\n<p>Core Animation<em>CAMediaTiming</em><em>CAAnimation</em><em>CALayer</em></p>\n<p><em>speed</em></p>\n<p><em>CALayer</em><code>convertTime:fromLayer:</code><code>convertTime:toLayer:</code><code>CACurrentMediaTime</code></p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> localLayerTime = view.layer.convertTime(<span class=\"type\">CACurrentMediaTime</span>(), from: <span class=\"literal\">nil</span>)</span><br></pre></td></tr></table></figure>\n<p></p>\n<ul>\n<li><em>beginTime</em><em>fillMode</em><em>kCAFillModeBackwards</em></li>\n<li><em>autoreverses</em><em>repeatCount</em>1.5</li>\n<li><em>timeOffset</em></li>\n</ul>\n<h2 id=\"-\"></h2>\n<p><em>CAMediaTiming</em>0.0</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">pauseLayer</span><span class=\"params\">(layer: CALayer)</span></span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> pausedTime = layer.convertTime(<span class=\"type\">CACurrentMediaTime</span>(), from: <span class=\"literal\">nil</span>)</span><br><span class=\"line\">    layer.speed = <span class=\"number\">0.0</span></span><br><span class=\"line\">    layer.timeOffset = pausedTime   <span class=\"comment\">// </span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">resumeLayer</span><span class=\"params\">(layer: CALayer)</span></span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> pausedTime = layer.timeOffset</span><br><span class=\"line\">    layer.speed = <span class=\"number\">1.0</span></span><br><span class=\"line\">    layer.timeOffset = <span class=\"number\">0.0</span></span><br><span class=\"line\">    layer.beginTime = <span class=\"number\">0.0</span></span><br><span class=\"line\">    <span class=\"keyword\">let</span> timeSincePause = layer.convertTime(<span class=\"type\">CACurrentMediaTime</span>(), from: <span class=\"literal\">nil</span>) - pausedTime</span><br><span class=\"line\">    layer.beginTime = timeSincePause    <span class=\"comment\">// </span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"transactions\">Transactions</h2>\n<p>Transactions<em>CATransaction</em>TransactionsCore Animationtransactiontransactions</p>\n<p><em>CATransaction</em>transactions<code>begin</code>transaction<code>commit</code>transactiontransaction</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"type\">CATransaction</span>.begin()</span><br><span class=\"line\">myView.layer.zPosition = <span class=\"number\">200.0</span></span><br><span class=\"line\">myView.layer.opacity = <span class=\"number\">0.0</span></span><br><span class=\"line\"><span class=\"type\">CATransaction</span>.commit()</span><br></pre></td></tr></table></figure>\n<p>transactionstransactiontransaction<code>setValue:forKey:</code></p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"type\">CATransaction</span>.begin()</span><br><span class=\"line\"><span class=\"type\">CATransaction</span>.setValue(<span class=\"number\">10.0</span>, forKey: kCATransactionAnimationDuration)</span><br><span class=\"line\"><span class=\"comment\">// perform the animations</span></span><br><span class=\"line\"><span class=\"type\">CATransaction</span>.commit()</span><br></pre></td></tr></table></figure>\n<p>transactions<em>begin</em>transaction<em>begin</em><em>commit</em>transactionCore Animation</p>\n<h2 id=\"\"></h2>\n<p>Core Animation<em>zPosition</em>z</p>\n<p><em>sublayerTransform</em></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">var perspective = CATransform3DIdentity</span><br><span class=\"line\">perspective.m34 = -1.0/eyePosition</span><br><span class=\"line\">view.layer.sublayerTransform = perspective</span><br></pre></td></tr></table></figure>\n<h1 id=\"changing-a-layers-default-bahavior\">Changing a Layers Default Bahavior</h1>\n<p>Core Animationactionaction<em>CAAction</em><em>CAAnimation</em></p>\n<p>actionactionsaction</p>\n<h2 id=\"caactionaction\">CAActionAction</h2>\n<p>action<em>CAAction</em><code>runActionForKey:object:arguments:</code></p>\n<p>actionactionactionkey</p>\n<ul>\n<li>actionsaction</li>\n<li><em>kCAOnOrderIn</em></li>\n<li><em>kCAOnOrderOut</em></li>\n<li><em>kCATransition</em></li>\n</ul>\n<h2 id=\"action\">action</h2>\n<p>actionactionaction*actionForKey:*actionaction</p>\n<p>Core Animationaction</p>\n<ol>\n<li><code>actionForLayer:forKey:</code>\n<ul>\n<li>action</li>\n<li>nilaction</li>\n<li>NSNull</li>\n</ul>\n</li>\n<li>actions</li>\n<li><a href=\"https://developer.apple.com/documentation/quartzcore/calayer/1410875-style\" target=\"_blank\" rel=\"noopener\">style</a>actionsactionsstyle</li>\n<li><code>defaultActionForKey:</code></li>\n<li>Core Animationaction</li>\n</ol>\n<p>actionactionaction<code>runActionForKey:object:arguments:</code>action<em>CAAnimation</em><em>CAAction</em></p>\n<p>action</p>\n<ul>\n<li>actions<code>actionForLayer:forKey</code></li>\n<li>actionactions</li>\n<li>actionsstyleaction</li>\n<li>actions<code>defaultActionForKey:</code></li>\n</ul>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">- (<span class=\"keyword\">id</span>&lt;<span class=\"built_in\">CAAction</span>&gt;)actionForLayer:(<span class=\"built_in\">CALayer</span> *)theLayer</span><br><span class=\"line\">                        forKey:(<span class=\"built_in\">NSString</span> *)theKey &#123;</span><br><span class=\"line\">    <span class=\"built_in\">CATransition</span> *theAnimation=<span class=\"literal\">nil</span>;</span><br><span class=\"line\"> </span><br><span class=\"line\">    <span class=\"keyword\">if</span> ([theKey isEqualToString:<span class=\"string\">@\"contents\"</span>]) &#123;</span><br><span class=\"line\"> </span><br><span class=\"line\">        theAnimation = [[<span class=\"built_in\">CATransition</span> alloc] init];</span><br><span class=\"line\">        theAnimation.duration = <span class=\"number\">1.0</span>;</span><br><span class=\"line\">        theAnimation.timingFunction = [<span class=\"built_in\">CAMediaTimingFunction</span> functionWithName:kCAMediaTimingFunctionEaseIn];</span><br><span class=\"line\">        theAnimation.type = kCATransitionPush;</span><br><span class=\"line\">        theAnimation.subtype = kCATransitionFromRight;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> theAnimation;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"catransactionactions\">CATransactionactions</h2>\n<p><em>CATransaction</em>actionsCore Animationtransactiontransaction<em>kCATransactionDisableActions</em>true</p>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[<span class=\"built_in\">CATransaction</span> begin];</span><br><span class=\"line\">[<span class=\"built_in\">CATransaction</span> setValue:(<span class=\"keyword\">id</span>)kCFBooleanTrue</span><br><span class=\"line\">                 forKey:kCATransactionDisableActions];</span><br><span class=\"line\">[aLayer removeFromSuperlayer];</span><br><span class=\"line\">[<span class=\"built_in\">CATransaction</span> commit];</span><br></pre></td></tr></table></figure>\n<h1 id=\"ending\">Ending</h1>\n<p>Layer</p>\n<h1 id=\"reference\">Reference</h1>\n<blockquote>\n<p><a href=\"https://developer.apple.com/library/archive/documentation/Cocoa/Conceptual/CoreAnimation_guide/Introduction/Introduction.html#//apple_ref/doc/uid/TP40004514-CH1-SW1\" target=\"_blank\" rel=\"noopener\">About Core Animation</a></p>\n</blockquote>\n","site":{"data":{}},"excerpt":"","more":"<h1>Introduction</h1>\n<p>Core AnimationiOSOS XCore AnimationCore AnimationCPU<br>\niOSCore AnimationOS XCore AnimationCore AnimationAppKitUIKitCocoaCocoa TouchCore Animation</p>\n<p><img src=\"/img/article/20190503/1.png\" alt=\"Core Animation\"></p>\n<h1>Core Animation Basics</h1>\n<p>Core AnimationViewCore Animation</p>\n<h2>Layers</h2>\n<p>LayerCore AnimationViewView</p>\n<h3></h3>\n<p>Layer<strong></strong>Core Animation</p>\n<p><img src=\"/img/article/20190503/2.png\" alt=\"How Core Animation draws content\"></p>\n<p><code>drawRect:</code>CPUCore Animation</p>\n<p>Core Animation</p>\n<h3></h3>\n<p>Core AnimationCore Animation</p>\n<p><img src=\"/img/article/20190503/3.png\" alt=\"Examples of animations I can perform on layers\"></p>\n<p>Core AnimationCore AnimationCore Animation</p>\n<h2></h2>\n<p>boundsViewframeboundsView</p>\n<h3>Layers</h3>\n<p>Layerspoint-basedunitpoint-basedunit</p>\n<p>point-basedboundspositionframeboudnspositionboundsframe</p>\n<p><img src=\"/img/article/20190503/4.png\" alt=\"The default layer geometries for iOS and OS X\"></p>\n<p>positionunitCore Animationunitunitunit0.0-1.0</p>\n<p><img src=\"/img/article/20190503/5.png\" alt=\"The default unit coordinate systems for iOS and OS X\"></p>\n<h3></h3>\n<p></p>\n<p><img src=\"/img/article/20190503/6.png\" alt=\"How the anchor point affects the layer's position property\"></p>\n<p></p>\n<p><img src=\"/img/article/20190503/7.png\" alt=\"How the anchor point affects layer transformations\"></p>\n<h2></h2>\n<p>Core Animation</p>\n<ul>\n<li>Objects in the model layer tree</li>\n<li>Objects in the presentation tree</li>\n<li>Objects in the render treeCore Animation</li>\n</ul>\n<p></p>\n<p><img src=\"/img/article/20190503/8.png\" alt=\"The layer trees for a window\"></p>\n<h2>LayersViews</h2>\n<p>LayersViewsLayersViewsLayersLayers</p>\n<h1>Settign Up Layer Objects</h1>\n<p>LayerCore Animation</p>\n<h2>ViewLayer</h2>\n<p>iOSViewCALayerCore Animation<a href=\"https://developer.apple.com/library/archive/documentation/Cocoa/Conceptual/CoreAnimation_guide/SettingUpLayerObjects/SettingUpLayerObjects.html#//apple_ref/doc/uid/TP40004514-CH13-SW25\" target=\"_blank\" rel=\"noopener\">Layer</a></p>\n<p>ViewLayer</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">override</span> <span class=\"keyword\">var</span> layer: <span class=\"type\">CALayer</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"type\">CAShapeLayer</span>()</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2>LayerContent</h2>\n<p>Layers</p>\n<ul>\n<li><code>contents</code></li>\n<li>LayerView</li>\n<li>Layer<code>drawing</code>Layer</li>\n</ul>\n<h3>Content</h3>\n<p><code>Contents</code><em>CGImageRef</em><code>ContentsScale</code></p>\n<h3>Content</h3>\n<p>Content</p>\n<ul>\n<li><code>displayLayer:</code><code>contents</code></li>\n<li><code>drawLayer:inContext:</code>Core Animation</li>\n</ul>\n<p><code>displayLayer:</code><code>drawLayer:inContext</code><code>displayLayer</code></p>\n<p><code>displayLayer:</code></p>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">- (<span class=\"keyword\">void</span>)displayLayer:(<span class=\"built_in\">CALayer</span> *)theLayer &#123;</span><br><span class=\"line\">    <span class=\"comment\">// Check the value of some state property</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"keyword\">self</span>.displayYesImage) &#123;</span><br><span class=\"line\">        <span class=\"comment\">// Display the Yes image</span></span><br><span class=\"line\">        theLayer.contents = [someHelperObject loadStateYesImage];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">// Display the No image</span></span><br><span class=\"line\">        theLayer.contents = [someHelperObject loadStateNoImage];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>PSUIKit<code>drawRect</code>OS XLayerView<code>drawRect</code><code>drawLayer</code><code>drawRect</code>View<code>drawLayer</code>Layer<code>drawLayer</code><code>drawLayer</code><code>drawRect</code><code>drawLayer</code><code>setNeedsDisplay</code><code>drawRect</code>Layer<code>drawLayer</code>Layer<code>drawRect</code>Layer<a href=\"https://stackoverflow.com/questions/4979192/ios-using-uiviews-drawrect-vs-its-layers-delegate-drawlayerincontext/36050120#36050120\" target=\"_blank\" rel=\"noopener\"></a></p>\n</blockquote>\n<p><code>drawLayer</code></p>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">- (<span class=\"keyword\">void</span>)drawLayer:(<span class=\"built_in\">CALayer</span> *)theLayer inContext:(<span class=\"built_in\">CGContextRef</span>)theContext &#123;</span><br><span class=\"line\">    <span class=\"built_in\">CGMutablePathRef</span> thePath = <span class=\"built_in\">CGPathCreateMutable</span>();</span><br><span class=\"line\"> </span><br><span class=\"line\">    <span class=\"built_in\">CGPathMoveToPoint</span>(thePath,<span class=\"literal\">NULL</span>,<span class=\"number\">15.0</span>f,<span class=\"number\">15.</span>f);</span><br><span class=\"line\">    <span class=\"built_in\">CGPathAddCurveToPoint</span>(thePath,</span><br><span class=\"line\">                          <span class=\"literal\">NULL</span>,</span><br><span class=\"line\">                          <span class=\"number\">15.</span>f,<span class=\"number\">250.0</span>f,</span><br><span class=\"line\">                          <span class=\"number\">295.0</span>f,<span class=\"number\">250.0</span>f,</span><br><span class=\"line\">                          <span class=\"number\">295.0</span>f,<span class=\"number\">15.0</span>f);</span><br><span class=\"line\"> </span><br><span class=\"line\">    <span class=\"built_in\">CGContextBeginPath</span>(theContext);</span><br><span class=\"line\">    <span class=\"built_in\">CGContextAddPath</span>(theContext, thePath);</span><br><span class=\"line\"> </span><br><span class=\"line\">    <span class=\"built_in\">CGContextSetLineWidth</span>(theContext, <span class=\"number\">5</span>);</span><br><span class=\"line\">    <span class=\"built_in\">CGContextStrokePath</span>(theContext);</span><br><span class=\"line\"> </span><br><span class=\"line\">    <span class=\"comment\">// Release the path</span></span><br><span class=\"line\">    <span class=\"built_in\">CFRelease</span>(thePath);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>UIView<code>drawRect</code>.</p>\n<h3>Content</h3>\n<p>LayerLayer</p>\n<ul>\n<li><code>display</code><code>contents</code></li>\n<li><code>drawInContext:</code></li>\n</ul>\n<h3>Content</h3>\n<p><code>contents</code><code>contentsGravity</code><br>\n<code>contentsGravity</code></p>\n<ul>\n<li></li>\n<li></li>\n</ul>\n<p>Position-based gravity constants for layers:<br>\n<img src=\"/img/article/20190503/9.png\" alt=\"Position-based gravity constants for layers\"></p>\n<p>Scaling-based gravity constants for layers:<br>\n<img src=\"/img/article/20190503/10.png\" alt=\"Scaling-based gravity constants for layers\"></p>\n<h2>Layer</h2>\n<p></p>\n<h3>Layers</h3>\n<p></p>\n<p><code>opaque</code>YESalpha</p>\n<h3>Layers</h3>\n<p><code>maskToBounds</code>YES</p>\n<h3>Layers</h3>\n<p>CALayer</p>\n<p>0Core Animation</p>\n<p><img src=\"/img/article/20190503/11.png\" alt=\"Applying a shadow to a layer\"></p>\n<p><code>maskToBounds</code><code>maskTobounds</code></p>\n<h1>Animating Layer Content</h1>\n<p>Core Animation</p>\n<h2></h2>\n<p></p>\n<p>Core AnimationCore Animation</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">theLayer.opacity = <span class=\"number\">0.0</span></span><br></pre></td></tr></table></figure>\n<p><em>CABasicAnimation</em><code>addAnimation:forKey:</code></p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> fadeAnimation = <span class=\"type\">CABasicAnimation</span>(keyPath: <span class=\"string\">\"opacity\"</span>)</span><br><span class=\"line\">fadeAnimation.fromValue = <span class=\"number\">1.0</span></span><br><span class=\"line\">fadeAnimation.toValue = <span class=\"number\">0.0</span></span><br><span class=\"line\">fadeAnimation.duration = <span class=\"number\">1.0</span></span><br><span class=\"line\">layer.add(fadeAnimation, forKey: <span class=\"string\">\"opacity\"</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// Change the actual data value in the layer to the final layer</span></span><br><span class=\"line\">layer.opacity = <span class=\"number\">0.0</span></span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>Tip<code>fromValue</code>Core Animation</p>\n</blockquote>\n<p>Core Animation</p>\n<p>runlooprunloop</p>\n<h2></h2>\n<p><em>CAKeyframeAnimation</em></p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> path = <span class=\"type\">CGMutablePath</span>()</span><br><span class=\"line\">path.move(to: <span class=\"type\">CGPoint</span>(x: <span class=\"number\">0</span>, y: <span class=\"number\">0</span>))</span><br><span class=\"line\">path.addCurve(to: <span class=\"type\">CGPoint</span>(x: <span class=\"number\">300</span>, y: <span class=\"number\">600</span>), control1: <span class=\"type\">CGPoint</span>(x: <span class=\"number\">200</span>, y: <span class=\"number\">50</span>), control2: <span class=\"type\">CGPoint</span>(x: <span class=\"number\">400</span>, y: <span class=\"number\">350</span>))</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">let</span> animation = <span class=\"type\">CAKeyframeAnimation</span>(keyPath: <span class=\"string\">\"position\"</span>)</span><br><span class=\"line\">animation.path = path</span><br><span class=\"line\">animation.duration = <span class=\"number\">2.0</span></span><br><span class=\"line\">myView.layer.add(animation, forKey: <span class=\"string\">\"position\"</span>)</span><br></pre></td></tr></table></figure>\n<h3></h3>\n<p><em>CGPoint</em><em>CGPathRef</em>id</p>\n<ul>\n<li><em>CGRect</em><em>NSValue</em></li>\n<li><em>CATransform3D</em><em>NSValue</em></li>\n<li><em>borderColo</em><em>CGColorRef</em><em>id</em></li>\n<li><em>CGFloat</em><em>NSNumber</em></li>\n<li><em>Contents</em><em>CGImageRef</em></li>\n</ul>\n<p><em>CGPoint</em><em>NSValue</em><em>CGPathRef</em><em>CGPathRef</em></p>\n<h3></h3>\n<p></p>\n<ul>\n<li><em>calculationMode</em>\n<ol>\n<li>  <em>calculationMode</em><em>kCAAnimationLinear</em>*kCAAnimationCubic`  </li>\n<li>  <em>calculationMode</em><em>kCAAnimationPaced</em><em>kCAAnimationCubicPaced</em>  <em>keyTimes</em><em>timingFunctions</em></li>\n<li>  <em>calculationMode</em><em>kCAAnimationDiscrete</em>  <em>keyTimes</em><em>timeingFunctions</em></li>\n</ol>\n</li>\n<li><em>keyTimes</em><em>kCAAnimationLinear</em><em>kCAAnimationDiscrete</em>, <em>kCAAnimationCubic</em></li>\n<li><em>timingFunctions</em></li>\n</ul>\n<h2></h2>\n<p></p>\n<ul>\n<li><code>removeAnimationForKey:</code><code>addAnimation:forKey</code></li>\n<li><code>removeAllAnimations</code></li>\n</ul>\n<h2></h2>\n<p><em>CAAnimationGroup</em></p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> path = <span class=\"type\">CGMutablePath</span>()</span><br><span class=\"line\">path.move(to: <span class=\"type\">CGPoint</span>(x: <span class=\"number\">0</span>, y: <span class=\"number\">0</span>))</span><br><span class=\"line\">path.addCurve(to: <span class=\"type\">CGPoint</span>(x: <span class=\"number\">300</span>, y: <span class=\"number\">600</span>), control1: <span class=\"type\">CGPoint</span>(x: <span class=\"number\">200</span>, y: <span class=\"number\">50</span>), control2: <span class=\"type\">CGPoint</span>(x: <span class=\"number\">400</span>, y: <span class=\"number\">350</span>))</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">let</span> positionAnimation = <span class=\"type\">CAKeyframeAnimation</span>(keyPath: <span class=\"string\">\"position\"</span>)</span><br><span class=\"line\">positionAnimation.path = path</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">let</span> colorAnimation = <span class=\"type\">CAKeyframeAnimation</span>(keyPath: <span class=\"string\">\"backgroundColor\"</span>)</span><br><span class=\"line\"><span class=\"keyword\">let</span> colorValues = [<span class=\"type\">UIColor</span>.red.cgColor, <span class=\"type\">UIColor</span>.yellow.cgColor, <span class=\"type\">UIColor</span>.cyan.cgColor]</span><br><span class=\"line\">colorAnimation.values = colorValues</span><br><span class=\"line\">colorAnimation.calculationMode = .paced</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">let</span> group = <span class=\"type\">CAAnimationGroup</span>()</span><br><span class=\"line\">group.animations = [positionAnimation, colorAnimation]</span><br><span class=\"line\">group.duration = <span class=\"number\">5.0</span></span><br><span class=\"line\">myView.layer.add(group, forKey: <span class=\"string\">\"group\"</span>)</span><br></pre></td></tr></table></figure>\n<p><em>CATransaction</em></p>\n<h2></h2>\n<p>Core Animation</p>\n<ul>\n<li><em>CATransaction</em><code>setCompletionBlock:</code></li>\n<li><em>CAAnimation</em><code>animationDidStart:</code><code>animationDidStop:finished:</code></li>\n</ul>\n<p><em>beginTime</em></p>\n<h2>Layer-Backed</h2>\n<p>UIKitCore Animation</p>\n<p><em>UIView</em>LayerCore AnimationUIView</p>\n<p>Core AnimationCore Animation<em>UIView</em>()</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"type\">UIView</span>.animate(withDuration: <span class=\"number\">2.0</span>) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">self</span>.view.layer.opacity = <span class=\"number\">0.0</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h1>Advanced Animation Tricks</h1>\n<p></p>\n<h2></h2>\n<p></p>\n<p><em>CATransition</em></p>\n<p>myView1myView2<em>isHidden</em></p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> transition = <span class=\"type\">CATransition</span>()</span><br><span class=\"line\">transition.startProgress = <span class=\"number\">0.0</span></span><br><span class=\"line\">transition.endProgress = <span class=\"number\">1.0</span></span><br><span class=\"line\">transition.type = .push</span><br><span class=\"line\">transition.subtype = .fromRight</span><br><span class=\"line\">transition.duration = <span class=\"number\">2.0</span></span><br><span class=\"line\"></span><br><span class=\"line\">myView1.layer.add(transition, forKey: <span class=\"string\">\"transition\"</span>)</span><br><span class=\"line\">myView2.layer.add(transition, forKey: <span class=\"string\">\"transition\"</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">myView1.isHidden = <span class=\"literal\">false</span></span><br><span class=\"line\">myView2.isHidden = <span class=\"literal\">true</span></span><br></pre></td></tr></table></figure>\n<p></p>\n<h2></h2>\n<p>Core Animation<em>CAMediaTiming</em><em>CAAnimation</em><em>CALayer</em></p>\n<p><em>speed</em></p>\n<p><em>CALayer</em><code>convertTime:fromLayer:</code><code>convertTime:toLayer:</code><code>CACurrentMediaTime</code></p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> localLayerTime = view.layer.convertTime(<span class=\"type\">CACurrentMediaTime</span>(), from: <span class=\"literal\">nil</span>)</span><br></pre></td></tr></table></figure>\n<p></p>\n<ul>\n<li><em>beginTime</em><em>fillMode</em><em>kCAFillModeBackwards</em></li>\n<li><em>autoreverses</em><em>repeatCount</em>1.5</li>\n<li><em>timeOffset</em></li>\n</ul>\n<h2></h2>\n<p><em>CAMediaTiming</em>0.0</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">pauseLayer</span><span class=\"params\">(layer: CALayer)</span></span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> pausedTime = layer.convertTime(<span class=\"type\">CACurrentMediaTime</span>(), from: <span class=\"literal\">nil</span>)</span><br><span class=\"line\">    layer.speed = <span class=\"number\">0.0</span></span><br><span class=\"line\">    layer.timeOffset = pausedTime   <span class=\"comment\">// </span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">resumeLayer</span><span class=\"params\">(layer: CALayer)</span></span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> pausedTime = layer.timeOffset</span><br><span class=\"line\">    layer.speed = <span class=\"number\">1.0</span></span><br><span class=\"line\">    layer.timeOffset = <span class=\"number\">0.0</span></span><br><span class=\"line\">    layer.beginTime = <span class=\"number\">0.0</span></span><br><span class=\"line\">    <span class=\"keyword\">let</span> timeSincePause = layer.convertTime(<span class=\"type\">CACurrentMediaTime</span>(), from: <span class=\"literal\">nil</span>) - pausedTime</span><br><span class=\"line\">    layer.beginTime = timeSincePause    <span class=\"comment\">// </span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2>Transactions</h2>\n<p>Transactions<em>CATransaction</em>TransactionsCore Animationtransactiontransactions</p>\n<p><em>CATransaction</em>transactions<code>begin</code>transaction<code>commit</code>transactiontransaction</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"type\">CATransaction</span>.begin()</span><br><span class=\"line\">myView.layer.zPosition = <span class=\"number\">200.0</span></span><br><span class=\"line\">myView.layer.opacity = <span class=\"number\">0.0</span></span><br><span class=\"line\"><span class=\"type\">CATransaction</span>.commit()</span><br></pre></td></tr></table></figure>\n<p>transactionstransactiontransaction<code>setValue:forKey:</code></p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"type\">CATransaction</span>.begin()</span><br><span class=\"line\"><span class=\"type\">CATransaction</span>.setValue(<span class=\"number\">10.0</span>, forKey: kCATransactionAnimationDuration)</span><br><span class=\"line\"><span class=\"comment\">// perform the animations</span></span><br><span class=\"line\"><span class=\"type\">CATransaction</span>.commit()</span><br></pre></td></tr></table></figure>\n<p>transactions<em>begin</em>transaction<em>begin</em><em>commit</em>transactionCore Animation</p>\n<h2></h2>\n<p>Core Animation<em>zPosition</em>z</p>\n<p><em>sublayerTransform</em></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">var perspective = CATransform3DIdentity</span><br><span class=\"line\">perspective.m34 = -1.0/eyePosition</span><br><span class=\"line\">view.layer.sublayerTransform = perspective</span><br></pre></td></tr></table></figure>\n<h1>Changing a Layers Default Bahavior</h1>\n<p>Core Animationactionaction<em>CAAction</em><em>CAAnimation</em></p>\n<p>actionactionsaction</p>\n<h2>CAActionAction</h2>\n<p>action<em>CAAction</em><code>runActionForKey:object:arguments:</code></p>\n<p>actionactionactionkey</p>\n<ul>\n<li>actionsaction</li>\n<li><em>kCAOnOrderIn</em></li>\n<li><em>kCAOnOrderOut</em></li>\n<li><em>kCATransition</em></li>\n</ul>\n<h2>action</h2>\n<p>actionactionaction*actionForKey:*actionaction</p>\n<p>Core Animationaction</p>\n<ol>\n<li><code>actionForLayer:forKey:</code>\n<ul>\n<li>action</li>\n<li>nilaction</li>\n<li>NSNull</li>\n</ul>\n</li>\n<li>actions</li>\n<li><a href=\"https://developer.apple.com/documentation/quartzcore/calayer/1410875-style\" target=\"_blank\" rel=\"noopener\">style</a>actionsactionsstyle</li>\n<li><code>defaultActionForKey:</code></li>\n<li>Core Animationaction</li>\n</ol>\n<p>actionactionaction<code>runActionForKey:object:arguments:</code>action<em>CAAnimation</em><em>CAAction</em></p>\n<p>action</p>\n<ul>\n<li>actions<code>actionForLayer:forKey</code></li>\n<li>actionactions</li>\n<li>actionsstyleaction</li>\n<li>actions<code>defaultActionForKey:</code></li>\n</ul>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">- (<span class=\"keyword\">id</span>&lt;<span class=\"built_in\">CAAction</span>&gt;)actionForLayer:(<span class=\"built_in\">CALayer</span> *)theLayer</span><br><span class=\"line\">                        forKey:(<span class=\"built_in\">NSString</span> *)theKey &#123;</span><br><span class=\"line\">    <span class=\"built_in\">CATransition</span> *theAnimation=<span class=\"literal\">nil</span>;</span><br><span class=\"line\"> </span><br><span class=\"line\">    <span class=\"keyword\">if</span> ([theKey isEqualToString:<span class=\"string\">@\"contents\"</span>]) &#123;</span><br><span class=\"line\"> </span><br><span class=\"line\">        theAnimation = [[<span class=\"built_in\">CATransition</span> alloc] init];</span><br><span class=\"line\">        theAnimation.duration = <span class=\"number\">1.0</span>;</span><br><span class=\"line\">        theAnimation.timingFunction = [<span class=\"built_in\">CAMediaTimingFunction</span> functionWithName:kCAMediaTimingFunctionEaseIn];</span><br><span class=\"line\">        theAnimation.type = kCATransitionPush;</span><br><span class=\"line\">        theAnimation.subtype = kCATransitionFromRight;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> theAnimation;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2>CATransactionactions</h2>\n<p><em>CATransaction</em>actionsCore Animationtransactiontransaction<em>kCATransactionDisableActions</em>true</p>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[<span class=\"built_in\">CATransaction</span> begin];</span><br><span class=\"line\">[<span class=\"built_in\">CATransaction</span> setValue:(<span class=\"keyword\">id</span>)kCFBooleanTrue</span><br><span class=\"line\">                 forKey:kCATransactionDisableActions];</span><br><span class=\"line\">[aLayer removeFromSuperlayer];</span><br><span class=\"line\">[<span class=\"built_in\">CATransaction</span> commit];</span><br></pre></td></tr></table></figure>\n<h1>Ending</h1>\n<p>Layer</p>\n<h1>Reference</h1>\n<blockquote>\n<p><a href=\"https://developer.apple.com/library/archive/documentation/Cocoa/Conceptual/CoreAnimation_guide/Introduction/Introduction.html#//apple_ref/doc/uid/TP40004514-CH1-SW1\" target=\"_blank\" rel=\"noopener\">About Core Animation</a></p>\n</blockquote>\n"},{"title":" -- Quartz 2D","catalog":true,"toc_nav_num":true,"date":"2019-04-18T09:40:24.000Z","subtitle":"Quartz 2D Programming Guide","header-img":"/img/article_header/article_header.png","busuanzi":true,"_content":"\n> [ iOS  GLSL ](http://www.lymanli.com/2019/04/05/ios-opengles-filter/) OpenGL  OpenGL  OpenGL \n OpenGL 3 iOS \n -- iOS  Core Graphics\n\n# Introduction\n\nQuartz 2D iOS  Mac OS X  Quartz 2D API PDF PDF  iOS Quartz 2D  Core Animation, OpenGL ES, UIKit  iOS \n\n# Concepts\n\n## The Graphics Context\n\nCGContextRef Quartz  PDF Quartz \n\n\n1. A bitmap graphics context RGB CMYK \n\n2. A PDF graphics contextPDF  PDF  PDF PDF \n- PDF \n-  PDF \n- PDF --\n\n3. A window graphics context Mac OS X\n\n4. A layer context\n\n## Graphics States\n\nQuartz  Quartz \n``` objectivec\nCGContextSaveGState();  // \nCGContextRestoreGState();   // \n```\n\n## Quartz 2D Coordinate Systems\n\nQuartz 2D\n![Quartz 2D](/img/article/20190418/1.png \"Quartz 2D\")\n\nQuartz --------CTM\n\n Quartz  Quartz Quartz y\n- Mac OS X NSView  *isFlipped*  YES\n- iOSUIView \n- iOS*UIGraphicsBeginImageContextWithOptions* \n\n UIKit  Quartz  Quartz \n\n# Paths\n\n\n\n## \n``` objectivec\n///  Points\nCGContextMoveToPoint(context, x, y);\n\n///  Lines\nCGContextAddLineToPoint(context, x, y);\nCGContextAddLines(context, [points], count)\n\n/// \nCGContextAddArc(context, x, y, radius, startAngle, endAngle, clockwise);\nCGContextAddArcToPoint(context, x1, y1, x2, y2, radius);    // \n\n///  Curves\nCGContextAddCurveToPoint(context, x1, y1, x2, y2, x, y);    // \nCGContextAddQuadCurveToPoint(context, x1, y1, x, y)         // \n\n/// \nCGContextClosePath(context);\n\n///  Ellipses\nCGContextAddEllipseInRect(context, rect);\n\n///  Rectangles\nCGContextAddRect(context, rect);\nCGContextAddRects(context, [rects], count);\n\n/// \nCGContextBeginPath(context);\n\n```\n\n## \n```objectivec\n/// \nCGMutablePathRef mutablePath = CGPathCreateMutable();\nCGPathRef path = CGContextCopyPath(context);\n\n/// \nCGPathMoveToPoint(path, NULL, x, y);    // CGContextTranslateCTM, CGContextScaleCTM, or CGContextRotateCTM\n\n///  ...\n```\n\n## \n\n- \n``` objectivec\n/// \nCGContextSetLineWidth(context, width);\n\n/// \nCGContextSetLineJoin(context, join);        // kCGLineJoinMiter (the default), kCGLineJoinRound , or kCGLineJoinBevel \n\n///  Miter \nCGContextSetMiterLimit(context, limit);     // Bevel\n\n/// \nCGContextSetLineCap(context, cap);          // kCGLineCapButt (the default), kCGLineCapRound , or kCGLineCapSquare \n\n///  \nCGContextSetLineDash(context, phase, [lengths], count);     // phase: \n\n/// \nCGContextSetStrokeColorWithColor(context, color);\n```\n\n- \n``` objectivec\n/// \nCGContextStrokePath(context);\n\n/// \nCGContextStrokeRect(context, rect);\n\n/// \nCGContextStrokeRectWithWidth(context, rect, width);      // width: \n\n/// \nCGContextStrokeEllipseInRect(context, rect);\n\n/// \nCGContextStrokeLineSegments(context, [points], count);      // points: \n\n/// \nCGContextDrawPath(context, kCGPathFillStroke || kCGPathEOFillStroke);\n```\n\n## \n\n\n```objectivec\n///   even-odd rule\nCGContextEOFillPath(context);   // +1\n\n///   nonzero winding number rule\nCGContextFillPath(context);     // +1-100\n\n/// \nCGContextFillRect(context, rect);\n\n/// \nCGContextFillEllipseInRect(context, rect);\n\n/// \nCGContextDrawPath(context, kCGPathFill || kCGPathEOFill);\n```\n\n## \n\n``` objectivec\n///   nonzero winding number rule\nCGContextClip(context);\n\n///   even-odd rule\nCGContextEOClip(context);\n\n/// \nCGContextClipToRect(context, rect);\n\n/// \nCGContextClipToMask(context, rect, mask);\n```\n\n# Transforms\n\n## \n\n``` objectivec\n/// \nCGContextTranslateCTM(context, x, y);\n    \n/// \nCGContextRotateCTM(context, angle);\n    \n/// \nCGContextScaleCTM(context, x, y);\n\n/// \nCGContextConcatCTM(context, transform);\n```\n\n## \n\n``` objectivec\n/// \nCGAffineTransformMakeTranslation(x, y);\n\n/// transform\nCGAffineTransformTranslate(transform, x, y);\n\n/// \nCGAffineTransformMakeRotation(angle);\n\n/// transform\nCGAffineTransformRotate(transform, angle);\n\n/// \nCGAffineTransformMakeScale(x, y);\n\n/// transform\nCGAffineTransformScale(transform, x, y);\n\n/// point\nCGPointApplyAffineTransform(point, transform);\n\n/// size\nCGSizeApplyAffineTransform(size, transform);\n\n/// rect\nCGRectApplyAffineTransform(rect, transform);\n```\n\n## \n\n``` objectivec\n/// \nCGAffineTransformEqualToTransform(transform1, transform2);\n\n/// \nCGAffineTransformIsIdentity(transform);\n\n/// \nCGAffineTransformIdentity;\n```\n\n## \n\n``` objectivec\n/// point\nCGContextConvertPointToDeviceSpace(context, point);\nCGContextConvertPointToUserSpace(context, point);\n\n/// size\nCGContextConvertSizeToDeviceSpace(context, size);\nCGContextConvertRectToUserSpace(context, size);\n\n/// rect\nCGContextConvertRectToDeviceSpace(context, rect);\nCGContextConvertRectToUserSpace(context, rect);\n```\n\n# Patterns\n\nPattern  PatternQuartz  Pattern  Pattern \n![A Pattern drawn to a window](/img/article/20190418/2.png)\n\n## \n\n``` objectivec\n/**\n \n\n @param info \n @param myContext \n */\nvoid MyDrawColoredPattern(void *info, CGContextRef myContext) {\n    CGFloat subunit = 5;\n    \n    CGRect myRect1 = {{0, 0}, {subunit, subunit}},\n    myRect2 = {{subunit, subunit}, {subunit, subunit}},\n    myRect3 = {{0, subunit}, {subunit, subunit}},\n    myRect4 = {{subunit, 0}, {subunit, subunit}};\n    \n    CGContextSetRGBFillColor(myContext, 0, 0, 1, .5);\n    CGContextFillRect(myContext, myRect1);\n    CGContextSetRGBFillColor(myContext, 1, 0, 0, .5);\n    CGContextFillRect(myContext, myRect2);\n    CGContextSetRGBFillColor(myContext, 0, 1, 0, .5);\n    CGContextFillRect(myContext, myRect3);\n    CGContextSetRGBFillColor(myContext, .5, 0, .5, .5);\n    CGContextFillRect(myContext, myRect4);\n}\n```\n\n## \n\n*MyDrawColoredPattern*NULL\n\n``` objectivec\nCGColorSpaceRef patternSpace;\npatternSpace = CGColorSpaceCreatePattern(NULL);\nCGContextSetFillColorSpace(context, patternSpace);\nCGColorSpaceRelease(patternSpace);\n```\n\n## \n\n``` objectivec\n/**\n \n\n @param NULL *MyDrawColoredPattern*info\n @param patternRect rect\n @param CGAffineTransformIdentity \n @param 16 \n @param 18 \n @param kCGPatternTilingConstantSpacing \n @param YES \n @param callbacks \n @return \n */\nCGPatternRef myPattern = CGPatternCreate(NULL, patternRect, CGAffineTransformIdentity, 16, 18, kCGPatternTilingConstantSpacing, YES, &callbacks);\n```\n\n## \n\n``` objectivec\nCGFloat alpha = 1;\nCGContextSetFillPattern(context, myPattern, &alpha);\n```\n\n## \n\n``` objectivec\nvoid MyColorPatternPainting(CGContextRef myContext, CGRect rect) {\n    CGPatternRef pattern;\n    CGColorSpaceRef patternSpace;\n    CGFloat alpha = 1;\n    static const CGPatternCallbacks callbacks = {0, &MyDrawColoredPattern, NULL};\n    CGContextSaveGState(myContext);\n    patternSpace = CGColorSpaceCreatePattern(NULL);\n    CGContextSetFillColorSpace(myContext, patternSpace);\n    CGColorSpaceRelease(patternSpace);\n    \n    pattern = CGPatternCreate(NULL, CGRectMake(0, 0, 16, 18), CGAffineTransformMake(1, 0, 0, 1, 0, 0), 16, 18, kCGPatternTilingConstantSpacing, true, &callbacks);\n    \n    CGContextSetFillPattern(myContext, pattern, &alpha);\n    CGPatternRelease(pattern);\n    CGContextFillRect(myContext, rect);\n    CGContextRestoreGState(myContext);\n}\n\nvoid MyDrawColoredPattern(void *info, CGContextRef myContext) {\n    CGFloat subunit = 5;\n    \n    CGRect myRect1 = {{0, 0}, {subunit, subunit}},\n    myRect2 = {{subunit, subunit}, {subunit, subunit}},\n    myRect3 = {{0, subunit}, {subunit, subunit}},\n    myRect4 = {{subunit, 0}, {subunit, subunit}};\n    \n    CGContextSetRGBFillColor(myContext, 0, 0, 1, .5);\n    CGContextFillRect(myContext, myRect1);\n    CGContextSetRGBFillColor(myContext, 1, 0, 0, .5);\n    CGContextFillRect(myContext, myRect2);\n    CGContextSetRGBFillColor(myContext, 0, 1, 0, .5);\n    CGContextFillRect(myContext, myRect3);\n    CGContextSetRGBFillColor(myContext, .5, 0, .5, .5);\n    CGContextFillRect(myContext, myRect4);\n}\n```\n\n# Shadows\n\n## \n\n``` objectivec\nCGContextSaveGState(context);\nCGContextSetShadow(context, offsetsize, blur);  // offsetUIKitxyblur0, 0, 0, 1.0/3.0\nCGContextSetShadowWithColor(context, offsetsize, blur, color);\n/*  */\nCGContextRestoreGState(context);\n```\n\n# Gradients\n\nQuartz  -- *CGShadingRef*  *CGGradientRef*(axial)(radial)\n\nAn axial gradient(a linear gradient) -- \nA radial gradient -- \n\n## CGShading  CGGradient \n\nCGShadingRef -- CGShadingCGFunction\n\nCGRadientRef -- CGShadingRefQuartzQuartz\n\n## CGGradient\n\n### \n\n``` objectivec\nCGGradientRef myGradient;\nCGColorSpaceRef myColorspace;\nsize_t num_locations = 2;\nCGFloat locations[2] = { 0.0, 1.0 };\nCGFloat components[8] = {\n    1.0, 0.5, 0.4, 1.0,  // Start color\n    0.8, 0.8, 0.3, 1.0   // End color\n};\nCGPoint myStartPoint, myEndPoint;\nmyColorspace = CGColorSpaceCreateWithName(kCGColorSpaceGenericRGB);\nmyGradient = CGGradientCreateWithColorComponents(myColorspace, components, locations, num_locations);\nCGContextDrawLinearGradient(context, myGradient, myStartPoint, myEndPoint, kCGGradientDrawsBeforeStartLocation | kCGGradientDrawsAfterEndLocation);\n```\n\n### \n\n``` objectivec\nCGGradientRef myGradient;\nCGColorSpaceRef myColorspace;\nsize_t num_locations = 2;\nCGFloat locations[2] = { 0.0, 1.0 };\nCGFloat components[8] = {\n    1.0, 0.5, 0.4, 1.0,  // Start color\n    0.8, 0.8, 0.3, 1.0   // End color\n};\nCGFloat myStartRadius, myEndRadius;\nCGPoint myStartPoint, myEndPoint;\nmyColorspace = CGColorSpaceCreateWithName(kCGColorSpaceGenericRGB);\nmyGradient = CGGradientCreateWithColorComponents(myColorspace, components, locations, num_locations);\nCGContextDrawRadialGradient(context, myGradient, myStartPoint, myStartRadius, myEndPoint, myEndRadius, 0);\n```\n\n## CGShading\n\n\n\n# Transparency Layers\n\n\n\n![Transparency Layers](/img/article/20190418/3.png)\n\n``` objectivec\nCGContextSetShadow(context, CGSizeMake(10, 20), 10);\nCGContextBeginTransparencyLayer(context, NULL);\n// your drawing code\nCGContextEndTransparencyLayer(context);\n```\n\n# Ending\n\nQuartz 2D iOS Core Image\n\n# Reference\n\n> [Quartz 2D Programming Guide](https://developer.apple.com/library/archive/documentation/GraphicsImaging/Conceptual/drawingwithquartz2d/dq_overview/dq_overview.html#//apple_ref/doc/uid/TP30001066-CH202-TPXREF101)","source":"_posts/2019/core-graphics-study-0418.md","raw":"---\ntitle: \" -- Quartz 2D\"\ncatalog: true\ntoc_nav_num: true\ndate: 2019-04-18 17:40:24\nsubtitle: \"Quartz 2D Programming Guide\"\nheader-img: \"/img/article_header/article_header.png\"\nbusuanzi: true\ntags:\n- iOS\n\n---\n\n> [ iOS  GLSL ](http://www.lymanli.com/2019/04/05/ios-opengles-filter/) OpenGL  OpenGL  OpenGL \n OpenGL 3 iOS \n -- iOS  Core Graphics\n\n# Introduction\n\nQuartz 2D iOS  Mac OS X  Quartz 2D API PDF PDF  iOS Quartz 2D  Core Animation, OpenGL ES, UIKit  iOS \n\n# Concepts\n\n## The Graphics Context\n\nCGContextRef Quartz  PDF Quartz \n\n\n1. A bitmap graphics context RGB CMYK \n\n2. A PDF graphics contextPDF  PDF  PDF PDF \n- PDF \n-  PDF \n- PDF --\n\n3. A window graphics context Mac OS X\n\n4. A layer context\n\n## Graphics States\n\nQuartz  Quartz \n``` objectivec\nCGContextSaveGState();  // \nCGContextRestoreGState();   // \n```\n\n## Quartz 2D Coordinate Systems\n\nQuartz 2D\n![Quartz 2D](/img/article/20190418/1.png \"Quartz 2D\")\n\nQuartz --------CTM\n\n Quartz  Quartz Quartz y\n- Mac OS X NSView  *isFlipped*  YES\n- iOSUIView \n- iOS*UIGraphicsBeginImageContextWithOptions* \n\n UIKit  Quartz  Quartz \n\n# Paths\n\n\n\n## \n``` objectivec\n///  Points\nCGContextMoveToPoint(context, x, y);\n\n///  Lines\nCGContextAddLineToPoint(context, x, y);\nCGContextAddLines(context, [points], count)\n\n/// \nCGContextAddArc(context, x, y, radius, startAngle, endAngle, clockwise);\nCGContextAddArcToPoint(context, x1, y1, x2, y2, radius);    // \n\n///  Curves\nCGContextAddCurveToPoint(context, x1, y1, x2, y2, x, y);    // \nCGContextAddQuadCurveToPoint(context, x1, y1, x, y)         // \n\n/// \nCGContextClosePath(context);\n\n///  Ellipses\nCGContextAddEllipseInRect(context, rect);\n\n///  Rectangles\nCGContextAddRect(context, rect);\nCGContextAddRects(context, [rects], count);\n\n/// \nCGContextBeginPath(context);\n\n```\n\n## \n```objectivec\n/// \nCGMutablePathRef mutablePath = CGPathCreateMutable();\nCGPathRef path = CGContextCopyPath(context);\n\n/// \nCGPathMoveToPoint(path, NULL, x, y);    // CGContextTranslateCTM, CGContextScaleCTM, or CGContextRotateCTM\n\n///  ...\n```\n\n## \n\n- \n``` objectivec\n/// \nCGContextSetLineWidth(context, width);\n\n/// \nCGContextSetLineJoin(context, join);        // kCGLineJoinMiter (the default), kCGLineJoinRound , or kCGLineJoinBevel \n\n///  Miter \nCGContextSetMiterLimit(context, limit);     // Bevel\n\n/// \nCGContextSetLineCap(context, cap);          // kCGLineCapButt (the default), kCGLineCapRound , or kCGLineCapSquare \n\n///  \nCGContextSetLineDash(context, phase, [lengths], count);     // phase: \n\n/// \nCGContextSetStrokeColorWithColor(context, color);\n```\n\n- \n``` objectivec\n/// \nCGContextStrokePath(context);\n\n/// \nCGContextStrokeRect(context, rect);\n\n/// \nCGContextStrokeRectWithWidth(context, rect, width);      // width: \n\n/// \nCGContextStrokeEllipseInRect(context, rect);\n\n/// \nCGContextStrokeLineSegments(context, [points], count);      // points: \n\n/// \nCGContextDrawPath(context, kCGPathFillStroke || kCGPathEOFillStroke);\n```\n\n## \n\n\n```objectivec\n///   even-odd rule\nCGContextEOFillPath(context);   // +1\n\n///   nonzero winding number rule\nCGContextFillPath(context);     // +1-100\n\n/// \nCGContextFillRect(context, rect);\n\n/// \nCGContextFillEllipseInRect(context, rect);\n\n/// \nCGContextDrawPath(context, kCGPathFill || kCGPathEOFill);\n```\n\n## \n\n``` objectivec\n///   nonzero winding number rule\nCGContextClip(context);\n\n///   even-odd rule\nCGContextEOClip(context);\n\n/// \nCGContextClipToRect(context, rect);\n\n/// \nCGContextClipToMask(context, rect, mask);\n```\n\n# Transforms\n\n## \n\n``` objectivec\n/// \nCGContextTranslateCTM(context, x, y);\n    \n/// \nCGContextRotateCTM(context, angle);\n    \n/// \nCGContextScaleCTM(context, x, y);\n\n/// \nCGContextConcatCTM(context, transform);\n```\n\n## \n\n``` objectivec\n/// \nCGAffineTransformMakeTranslation(x, y);\n\n/// transform\nCGAffineTransformTranslate(transform, x, y);\n\n/// \nCGAffineTransformMakeRotation(angle);\n\n/// transform\nCGAffineTransformRotate(transform, angle);\n\n/// \nCGAffineTransformMakeScale(x, y);\n\n/// transform\nCGAffineTransformScale(transform, x, y);\n\n/// point\nCGPointApplyAffineTransform(point, transform);\n\n/// size\nCGSizeApplyAffineTransform(size, transform);\n\n/// rect\nCGRectApplyAffineTransform(rect, transform);\n```\n\n## \n\n``` objectivec\n/// \nCGAffineTransformEqualToTransform(transform1, transform2);\n\n/// \nCGAffineTransformIsIdentity(transform);\n\n/// \nCGAffineTransformIdentity;\n```\n\n## \n\n``` objectivec\n/// point\nCGContextConvertPointToDeviceSpace(context, point);\nCGContextConvertPointToUserSpace(context, point);\n\n/// size\nCGContextConvertSizeToDeviceSpace(context, size);\nCGContextConvertRectToUserSpace(context, size);\n\n/// rect\nCGContextConvertRectToDeviceSpace(context, rect);\nCGContextConvertRectToUserSpace(context, rect);\n```\n\n# Patterns\n\nPattern  PatternQuartz  Pattern  Pattern \n![A Pattern drawn to a window](/img/article/20190418/2.png)\n\n## \n\n``` objectivec\n/**\n \n\n @param info \n @param myContext \n */\nvoid MyDrawColoredPattern(void *info, CGContextRef myContext) {\n    CGFloat subunit = 5;\n    \n    CGRect myRect1 = {{0, 0}, {subunit, subunit}},\n    myRect2 = {{subunit, subunit}, {subunit, subunit}},\n    myRect3 = {{0, subunit}, {subunit, subunit}},\n    myRect4 = {{subunit, 0}, {subunit, subunit}};\n    \n    CGContextSetRGBFillColor(myContext, 0, 0, 1, .5);\n    CGContextFillRect(myContext, myRect1);\n    CGContextSetRGBFillColor(myContext, 1, 0, 0, .5);\n    CGContextFillRect(myContext, myRect2);\n    CGContextSetRGBFillColor(myContext, 0, 1, 0, .5);\n    CGContextFillRect(myContext, myRect3);\n    CGContextSetRGBFillColor(myContext, .5, 0, .5, .5);\n    CGContextFillRect(myContext, myRect4);\n}\n```\n\n## \n\n*MyDrawColoredPattern*NULL\n\n``` objectivec\nCGColorSpaceRef patternSpace;\npatternSpace = CGColorSpaceCreatePattern(NULL);\nCGContextSetFillColorSpace(context, patternSpace);\nCGColorSpaceRelease(patternSpace);\n```\n\n## \n\n``` objectivec\n/**\n \n\n @param NULL *MyDrawColoredPattern*info\n @param patternRect rect\n @param CGAffineTransformIdentity \n @param 16 \n @param 18 \n @param kCGPatternTilingConstantSpacing \n @param YES \n @param callbacks \n @return \n */\nCGPatternRef myPattern = CGPatternCreate(NULL, patternRect, CGAffineTransformIdentity, 16, 18, kCGPatternTilingConstantSpacing, YES, &callbacks);\n```\n\n## \n\n``` objectivec\nCGFloat alpha = 1;\nCGContextSetFillPattern(context, myPattern, &alpha);\n```\n\n## \n\n``` objectivec\nvoid MyColorPatternPainting(CGContextRef myContext, CGRect rect) {\n    CGPatternRef pattern;\n    CGColorSpaceRef patternSpace;\n    CGFloat alpha = 1;\n    static const CGPatternCallbacks callbacks = {0, &MyDrawColoredPattern, NULL};\n    CGContextSaveGState(myContext);\n    patternSpace = CGColorSpaceCreatePattern(NULL);\n    CGContextSetFillColorSpace(myContext, patternSpace);\n    CGColorSpaceRelease(patternSpace);\n    \n    pattern = CGPatternCreate(NULL, CGRectMake(0, 0, 16, 18), CGAffineTransformMake(1, 0, 0, 1, 0, 0), 16, 18, kCGPatternTilingConstantSpacing, true, &callbacks);\n    \n    CGContextSetFillPattern(myContext, pattern, &alpha);\n    CGPatternRelease(pattern);\n    CGContextFillRect(myContext, rect);\n    CGContextRestoreGState(myContext);\n}\n\nvoid MyDrawColoredPattern(void *info, CGContextRef myContext) {\n    CGFloat subunit = 5;\n    \n    CGRect myRect1 = {{0, 0}, {subunit, subunit}},\n    myRect2 = {{subunit, subunit}, {subunit, subunit}},\n    myRect3 = {{0, subunit}, {subunit, subunit}},\n    myRect4 = {{subunit, 0}, {subunit, subunit}};\n    \n    CGContextSetRGBFillColor(myContext, 0, 0, 1, .5);\n    CGContextFillRect(myContext, myRect1);\n    CGContextSetRGBFillColor(myContext, 1, 0, 0, .5);\n    CGContextFillRect(myContext, myRect2);\n    CGContextSetRGBFillColor(myContext, 0, 1, 0, .5);\n    CGContextFillRect(myContext, myRect3);\n    CGContextSetRGBFillColor(myContext, .5, 0, .5, .5);\n    CGContextFillRect(myContext, myRect4);\n}\n```\n\n# Shadows\n\n## \n\n``` objectivec\nCGContextSaveGState(context);\nCGContextSetShadow(context, offsetsize, blur);  // offsetUIKitxyblur0, 0, 0, 1.0/3.0\nCGContextSetShadowWithColor(context, offsetsize, blur, color);\n/*  */\nCGContextRestoreGState(context);\n```\n\n# Gradients\n\nQuartz  -- *CGShadingRef*  *CGGradientRef*(axial)(radial)\n\nAn axial gradient(a linear gradient) -- \nA radial gradient -- \n\n## CGShading  CGGradient \n\nCGShadingRef -- CGShadingCGFunction\n\nCGRadientRef -- CGShadingRefQuartzQuartz\n\n## CGGradient\n\n### \n\n``` objectivec\nCGGradientRef myGradient;\nCGColorSpaceRef myColorspace;\nsize_t num_locations = 2;\nCGFloat locations[2] = { 0.0, 1.0 };\nCGFloat components[8] = {\n    1.0, 0.5, 0.4, 1.0,  // Start color\n    0.8, 0.8, 0.3, 1.0   // End color\n};\nCGPoint myStartPoint, myEndPoint;\nmyColorspace = CGColorSpaceCreateWithName(kCGColorSpaceGenericRGB);\nmyGradient = CGGradientCreateWithColorComponents(myColorspace, components, locations, num_locations);\nCGContextDrawLinearGradient(context, myGradient, myStartPoint, myEndPoint, kCGGradientDrawsBeforeStartLocation | kCGGradientDrawsAfterEndLocation);\n```\n\n### \n\n``` objectivec\nCGGradientRef myGradient;\nCGColorSpaceRef myColorspace;\nsize_t num_locations = 2;\nCGFloat locations[2] = { 0.0, 1.0 };\nCGFloat components[8] = {\n    1.0, 0.5, 0.4, 1.0,  // Start color\n    0.8, 0.8, 0.3, 1.0   // End color\n};\nCGFloat myStartRadius, myEndRadius;\nCGPoint myStartPoint, myEndPoint;\nmyColorspace = CGColorSpaceCreateWithName(kCGColorSpaceGenericRGB);\nmyGradient = CGGradientCreateWithColorComponents(myColorspace, components, locations, num_locations);\nCGContextDrawRadialGradient(context, myGradient, myStartPoint, myStartRadius, myEndPoint, myEndRadius, 0);\n```\n\n## CGShading\n\n\n\n# Transparency Layers\n\n\n\n![Transparency Layers](/img/article/20190418/3.png)\n\n``` objectivec\nCGContextSetShadow(context, CGSizeMake(10, 20), 10);\nCGContextBeginTransparencyLayer(context, NULL);\n// your drawing code\nCGContextEndTransparencyLayer(context);\n```\n\n# Ending\n\nQuartz 2D iOS Core Image\n\n# Reference\n\n> [Quartz 2D Programming Guide](https://developer.apple.com/library/archive/documentation/GraphicsImaging/Conceptual/drawingwithquartz2d/dq_overview/dq_overview.html#//apple_ref/doc/uid/TP30001066-CH202-TPXREF101)","slug":"2019/core-graphics-study-0418","published":1,"updated":"2021-06-21T12:34:52.091Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckszp3ncy0007ifntjtxk1haj","content":"<blockquote>\n<p><a href=\"http://www.lymanli.com/2019/04/05/ios-opengles-filter/\" target=\"_blank\" rel=\"noopener\"> iOS  GLSL </a> OpenGL  OpenGL  OpenGL <br>\n OpenGL 3 iOS <br>\n  iOS  Core Graphics</p>\n</blockquote>\n<h1 id=\"introduction\">Introduction</h1>\n<p>Quartz 2D iOS  Mac OS X  Quartz 2D API PDF PDF  iOS Quartz 2D  Core Animation, OpenGL ES, UIKit  iOS </p>\n<h1 id=\"concepts\">Concepts</h1>\n<h2 id=\"the-graphics-context\">The Graphics Context</h2>\n<p>CGContextRef Quartz  PDF Quartz <br>\n</p>\n<ol>\n<li>\n<p>A bitmap graphics context RGB CMYK </p>\n</li>\n<li>\n<p>A PDF graphics contextPDF  PDF  PDF PDF </p>\n</li>\n</ol>\n<ul>\n<li>PDF </li>\n<li> PDF </li>\n<li>PDF </li>\n</ul>\n<ol start=\"3\">\n<li>\n<p>A window graphics context Mac OS X</p>\n</li>\n<li>\n<p>A layer context</p>\n</li>\n</ol>\n<h2 id=\"graphics-states\">Graphics States</h2>\n<p>Quartz  Quartz </p>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">CGContextSaveGState</span>();  <span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"built_in\">CGContextRestoreGState</span>();   <span class=\"comment\">// </span></span><br></pre></td></tr></table></figure>\n<h2 id=\"quartz-2d-coordinate-systems\">Quartz 2D Coordinate Systems</h2>\n<p>Quartz 2D<br>\n<img src=\"/img/article/20190418/1.png\" alt=\"Quartz 2D\" title=\"Quartz 2D\"></p>\n<p>Quartz CTM</p>\n<p> Quartz  Quartz Quartz y</p>\n<ul>\n<li>Mac OS X NSView  <em>isFlipped</em>  YES</li>\n<li>iOSUIView </li>\n<li>iOS<em>UIGraphicsBeginImageContextWithOptions</em> </li>\n</ul>\n<p> UIKit  Quartz  Quartz </p>\n<h1 id=\"paths\">Paths</h1>\n<p></p>\n<h2 id=\"\"></h2>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">///  Points</span></span><br><span class=\"line\"><span class=\"built_in\">CGContextMoveToPoint</span>(context, x, y);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">///  Lines</span></span><br><span class=\"line\"><span class=\"built_in\">CGContextAddLineToPoint</span>(context, x, y);</span><br><span class=\"line\"><span class=\"built_in\">CGContextAddLines</span>(context, [points], count)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/// </span></span><br><span class=\"line\"><span class=\"built_in\">CGContextAddArc</span>(context, x, y, radius, startAngle, endAngle, clockwise);</span><br><span class=\"line\"><span class=\"built_in\">CGContextAddArcToPoint</span>(context, x1, y1, x2, y2, radius);    <span class=\"comment\">// </span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">///  Curves</span></span><br><span class=\"line\"><span class=\"built_in\">CGContextAddCurveToPoint</span>(context, x1, y1, x2, y2, x, y);    <span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"built_in\">CGContextAddQuadCurveToPoint</span>(context, x1, y1, x, y)         <span class=\"comment\">// </span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/// </span></span><br><span class=\"line\"><span class=\"built_in\">CGContextClosePath</span>(context);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">///  Ellipses</span></span><br><span class=\"line\"><span class=\"built_in\">CGContextAddEllipseInRect</span>(context, rect);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">///  Rectangles</span></span><br><span class=\"line\"><span class=\"built_in\">CGContextAddRect</span>(context, rect);</span><br><span class=\"line\"><span class=\"built_in\">CGContextAddRects</span>(context, [rects], count);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/// </span></span><br><span class=\"line\"><span class=\"built_in\">CGContextBeginPath</span>(context);</span><br></pre></td></tr></table></figure>\n<h2 id=\"\"></h2>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/// </span></span><br><span class=\"line\"><span class=\"built_in\">CGMutablePathRef</span> mutablePath = <span class=\"built_in\">CGPathCreateMutable</span>();</span><br><span class=\"line\"><span class=\"built_in\">CGPathRef</span> path = <span class=\"built_in\">CGContextCopyPath</span>(context);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/// </span></span><br><span class=\"line\"><span class=\"built_in\">CGPathMoveToPoint</span>(path, <span class=\"literal\">NULL</span>, x, y);    <span class=\"comment\">// CGContextTranslateCTM, CGContextScaleCTM, or CGContextRotateCTM</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">///  ...</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"\"></h2>\n<ul>\n<li></li>\n</ul>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/// </span></span><br><span class=\"line\"><span class=\"built_in\">CGContextSetLineWidth</span>(context, width);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/// </span></span><br><span class=\"line\"><span class=\"built_in\">CGContextSetLineJoin</span>(context, join);        <span class=\"comment\">// kCGLineJoinMiter (the default), kCGLineJoinRound , or kCGLineJoinBevel </span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">///  Miter </span></span><br><span class=\"line\"><span class=\"built_in\">CGContextSetMiterLimit</span>(context, limit);     <span class=\"comment\">// Bevel</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/// </span></span><br><span class=\"line\"><span class=\"built_in\">CGContextSetLineCap</span>(context, cap);          <span class=\"comment\">// kCGLineCapButt (the default), kCGLineCapRound , or kCGLineCapSquare </span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">///  </span></span><br><span class=\"line\"><span class=\"built_in\">CGContextSetLineDash</span>(context, phase, [lengths], count);     <span class=\"comment\">// phase: </span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/// </span></span><br><span class=\"line\"><span class=\"built_in\">CGContextSetStrokeColorWithColor</span>(context, color);</span><br></pre></td></tr></table></figure>\n<ul>\n<li></li>\n</ul>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/// </span></span><br><span class=\"line\"><span class=\"built_in\">CGContextStrokePath</span>(context);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/// </span></span><br><span class=\"line\"><span class=\"built_in\">CGContextStrokeRect</span>(context, rect);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/// </span></span><br><span class=\"line\"><span class=\"built_in\">CGContextStrokeRectWithWidth</span>(context, rect, width);      <span class=\"comment\">// width: </span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/// </span></span><br><span class=\"line\"><span class=\"built_in\">CGContextStrokeEllipseInRect</span>(context, rect);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/// </span></span><br><span class=\"line\"><span class=\"built_in\">CGContextStrokeLineSegments</span>(context, [points], count);      <span class=\"comment\">// points: </span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/// </span></span><br><span class=\"line\"><span class=\"built_in\">CGContextDrawPath</span>(context, kCGPathFillStroke || kCGPathEOFillStroke);</span><br></pre></td></tr></table></figure>\n<h2 id=\"\"></h2>\n<p></p>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">///   even-odd rule</span></span><br><span class=\"line\"><span class=\"built_in\">CGContextEOFillPath</span>(context);   <span class=\"comment\">// +1</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">///   nonzero winding number rule</span></span><br><span class=\"line\"><span class=\"built_in\">CGContextFillPath</span>(context);     <span class=\"comment\">// +1-100</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/// </span></span><br><span class=\"line\"><span class=\"built_in\">CGContextFillRect</span>(context, rect);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/// </span></span><br><span class=\"line\"><span class=\"built_in\">CGContextFillEllipseInRect</span>(context, rect);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/// </span></span><br><span class=\"line\"><span class=\"built_in\">CGContextDrawPath</span>(context, kCGPathFill || kCGPathEOFill);</span><br></pre></td></tr></table></figure>\n<h2 id=\"\"></h2>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">///   nonzero winding number rule</span></span><br><span class=\"line\"><span class=\"built_in\">CGContextClip</span>(context);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">///   even-odd rule</span></span><br><span class=\"line\"><span class=\"built_in\">CGContextEOClip</span>(context);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/// </span></span><br><span class=\"line\"><span class=\"built_in\">CGContextClipToRect</span>(context, rect);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/// </span></span><br><span class=\"line\"><span class=\"built_in\">CGContextClipToMask</span>(context, rect, mask);</span><br></pre></td></tr></table></figure>\n<h1 id=\"transforms\">Transforms</h1>\n<h2 id=\"\"></h2>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/// </span></span><br><span class=\"line\"><span class=\"built_in\">CGContextTranslateCTM</span>(context, x, y);</span><br><span class=\"line\">    </span><br><span class=\"line\"><span class=\"comment\">/// </span></span><br><span class=\"line\"><span class=\"built_in\">CGContextRotateCTM</span>(context, angle);</span><br><span class=\"line\">    </span><br><span class=\"line\"><span class=\"comment\">/// </span></span><br><span class=\"line\"><span class=\"built_in\">CGContextScaleCTM</span>(context, x, y);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/// </span></span><br><span class=\"line\"><span class=\"built_in\">CGContextConcatCTM</span>(context, transform);</span><br></pre></td></tr></table></figure>\n<h2 id=\"\"></h2>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/// </span></span><br><span class=\"line\"><span class=\"built_in\">CGAffineTransformMakeTranslation</span>(x, y);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/// transform</span></span><br><span class=\"line\"><span class=\"built_in\">CGAffineTransformTranslate</span>(transform, x, y);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/// </span></span><br><span class=\"line\"><span class=\"built_in\">CGAffineTransformMakeRotation</span>(angle);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/// transform</span></span><br><span class=\"line\"><span class=\"built_in\">CGAffineTransformRotate</span>(transform, angle);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/// </span></span><br><span class=\"line\"><span class=\"built_in\">CGAffineTransformMakeScale</span>(x, y);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/// transform</span></span><br><span class=\"line\"><span class=\"built_in\">CGAffineTransformScale</span>(transform, x, y);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/// point</span></span><br><span class=\"line\"><span class=\"built_in\">CGPointApplyAffineTransform</span>(point, transform);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/// size</span></span><br><span class=\"line\"><span class=\"built_in\">CGSizeApplyAffineTransform</span>(size, transform);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/// rect</span></span><br><span class=\"line\"><span class=\"built_in\">CGRectApplyAffineTransform</span>(rect, transform);</span><br></pre></td></tr></table></figure>\n<h2 id=\"\"></h2>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/// </span></span><br><span class=\"line\"><span class=\"built_in\">CGAffineTransformEqualToTransform</span>(transform1, transform2);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/// </span></span><br><span class=\"line\"><span class=\"built_in\">CGAffineTransformIsIdentity</span>(transform);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/// </span></span><br><span class=\"line\"><span class=\"built_in\">CGAffineTransformIdentity</span>;</span><br></pre></td></tr></table></figure>\n<h2 id=\"\"></h2>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/// point</span></span><br><span class=\"line\"><span class=\"built_in\">CGContextConvertPointToDeviceSpace</span>(context, point);</span><br><span class=\"line\"><span class=\"built_in\">CGContextConvertPointToUserSpace</span>(context, point);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/// size</span></span><br><span class=\"line\"><span class=\"built_in\">CGContextConvertSizeToDeviceSpace</span>(context, size);</span><br><span class=\"line\"><span class=\"built_in\">CGContextConvertRectToUserSpace</span>(context, size);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/// rect</span></span><br><span class=\"line\"><span class=\"built_in\">CGContextConvertRectToDeviceSpace</span>(context, rect);</span><br><span class=\"line\"><span class=\"built_in\">CGContextConvertRectToUserSpace</span>(context, rect);</span><br></pre></td></tr></table></figure>\n<h1 id=\"patterns\">Patterns</h1>\n<p>Pattern  PatternQuartz  Pattern  Pattern <br>\n<img src=\"/img/article/20190418/2.png\" alt=\"A Pattern drawn to a window\"></p>\n<h2 id=\"\"></h2>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param info </span></span><br><span class=\"line\"><span class=\"comment\"> @param myContext </span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">void</span> MyDrawColoredPattern(<span class=\"keyword\">void</span> *info, <span class=\"built_in\">CGContextRef</span> myContext) &#123;</span><br><span class=\"line\">    <span class=\"built_in\">CGFloat</span> subunit = <span class=\"number\">5</span>;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"built_in\">CGRect</span> myRect1 = &#123;&#123;<span class=\"number\">0</span>, <span class=\"number\">0</span>&#125;, &#123;subunit, subunit&#125;&#125;,</span><br><span class=\"line\">    myRect2 = &#123;&#123;subunit, subunit&#125;, &#123;subunit, subunit&#125;&#125;,</span><br><span class=\"line\">    myRect3 = &#123;&#123;<span class=\"number\">0</span>, subunit&#125;, &#123;subunit, subunit&#125;&#125;,</span><br><span class=\"line\">    myRect4 = &#123;&#123;subunit, <span class=\"number\">0</span>&#125;, &#123;subunit, subunit&#125;&#125;;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"built_in\">CGContextSetRGBFillColor</span>(myContext, <span class=\"number\">0</span>, <span class=\"number\">0</span>, <span class=\"number\">1</span>, <span class=\"number\">.5</span>);</span><br><span class=\"line\">    <span class=\"built_in\">CGContextFillRect</span>(myContext, myRect1);</span><br><span class=\"line\">    <span class=\"built_in\">CGContextSetRGBFillColor</span>(myContext, <span class=\"number\">1</span>, <span class=\"number\">0</span>, <span class=\"number\">0</span>, <span class=\"number\">.5</span>);</span><br><span class=\"line\">    <span class=\"built_in\">CGContextFillRect</span>(myContext, myRect2);</span><br><span class=\"line\">    <span class=\"built_in\">CGContextSetRGBFillColor</span>(myContext, <span class=\"number\">0</span>, <span class=\"number\">1</span>, <span class=\"number\">0</span>, <span class=\"number\">.5</span>);</span><br><span class=\"line\">    <span class=\"built_in\">CGContextFillRect</span>(myContext, myRect3);</span><br><span class=\"line\">    <span class=\"built_in\">CGContextSetRGBFillColor</span>(myContext, <span class=\"number\">.5</span>, <span class=\"number\">0</span>, <span class=\"number\">.5</span>, <span class=\"number\">.5</span>);</span><br><span class=\"line\">    <span class=\"built_in\">CGContextFillRect</span>(myContext, myRect4);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"\"></h2>\n<p><em>MyDrawColoredPattern</em>NULL</p>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">CGColorSpaceRef</span> patternSpace;</span><br><span class=\"line\">patternSpace = <span class=\"built_in\">CGColorSpaceCreatePattern</span>(<span class=\"literal\">NULL</span>);</span><br><span class=\"line\"><span class=\"built_in\">CGContextSetFillColorSpace</span>(context, patternSpace);</span><br><span class=\"line\"><span class=\"built_in\">CGColorSpaceRelease</span>(patternSpace);</span><br></pre></td></tr></table></figure>\n<h2 id=\"\"></h2>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param NULL *MyDrawColoredPattern*info</span></span><br><span class=\"line\"><span class=\"comment\"> @param patternRect rect</span></span><br><span class=\"line\"><span class=\"comment\"> @param CGAffineTransformIdentity </span></span><br><span class=\"line\"><span class=\"comment\"> @param 16 </span></span><br><span class=\"line\"><span class=\"comment\"> @param 18 </span></span><br><span class=\"line\"><span class=\"comment\"> @param kCGPatternTilingConstantSpacing </span></span><br><span class=\"line\"><span class=\"comment\"> @param YES </span></span><br><span class=\"line\"><span class=\"comment\"> @param callbacks </span></span><br><span class=\"line\"><span class=\"comment\"> @return </span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"built_in\">CGPatternRef</span> myPattern = <span class=\"built_in\">CGPatternCreate</span>(<span class=\"literal\">NULL</span>, patternRect, <span class=\"built_in\">CGAffineTransformIdentity</span>, <span class=\"number\">16</span>, <span class=\"number\">18</span>, kCGPatternTilingConstantSpacing, <span class=\"literal\">YES</span>, &amp;callbacks);</span><br></pre></td></tr></table></figure>\n<h2 id=\"-\"></h2>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">CGFloat</span> alpha = <span class=\"number\">1</span>;</span><br><span class=\"line\"><span class=\"built_in\">CGContextSetFillPattern</span>(context, myPattern, &amp;alpha);</span><br></pre></td></tr></table></figure>\n<h2 id=\"\"></h2>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">void</span> MyColorPatternPainting(<span class=\"built_in\">CGContextRef</span> myContext, <span class=\"built_in\">CGRect</span> rect) &#123;</span><br><span class=\"line\">    <span class=\"built_in\">CGPatternRef</span> pattern;</span><br><span class=\"line\">    <span class=\"built_in\">CGColorSpaceRef</span> patternSpace;</span><br><span class=\"line\">    <span class=\"built_in\">CGFloat</span> alpha = <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">static</span> <span class=\"keyword\">const</span> <span class=\"built_in\">CGPatternCallbacks</span> callbacks = &#123;<span class=\"number\">0</span>, &amp;MyDrawColoredPattern, <span class=\"literal\">NULL</span>&#125;;</span><br><span class=\"line\">    <span class=\"built_in\">CGContextSaveGState</span>(myContext);</span><br><span class=\"line\">    patternSpace = <span class=\"built_in\">CGColorSpaceCreatePattern</span>(<span class=\"literal\">NULL</span>);</span><br><span class=\"line\">    <span class=\"built_in\">CGContextSetFillColorSpace</span>(myContext, patternSpace);</span><br><span class=\"line\">    <span class=\"built_in\">CGColorSpaceRelease</span>(patternSpace);</span><br><span class=\"line\">    </span><br><span class=\"line\">    pattern = <span class=\"built_in\">CGPatternCreate</span>(<span class=\"literal\">NULL</span>, <span class=\"built_in\">CGRectMake</span>(<span class=\"number\">0</span>, <span class=\"number\">0</span>, <span class=\"number\">16</span>, <span class=\"number\">18</span>), <span class=\"built_in\">CGAffineTransformMake</span>(<span class=\"number\">1</span>, <span class=\"number\">0</span>, <span class=\"number\">0</span>, <span class=\"number\">1</span>, <span class=\"number\">0</span>, <span class=\"number\">0</span>), <span class=\"number\">16</span>, <span class=\"number\">18</span>, kCGPatternTilingConstantSpacing, <span class=\"literal\">true</span>, &amp;callbacks);</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"built_in\">CGContextSetFillPattern</span>(myContext, pattern, &amp;alpha);</span><br><span class=\"line\">    <span class=\"built_in\">CGPatternRelease</span>(pattern);</span><br><span class=\"line\">    <span class=\"built_in\">CGContextFillRect</span>(myContext, rect);</span><br><span class=\"line\">    <span class=\"built_in\">CGContextRestoreGState</span>(myContext);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">void</span> MyDrawColoredPattern(<span class=\"keyword\">void</span> *info, <span class=\"built_in\">CGContextRef</span> myContext) &#123;</span><br><span class=\"line\">    <span class=\"built_in\">CGFloat</span> subunit = <span class=\"number\">5</span>;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"built_in\">CGRect</span> myRect1 = &#123;&#123;<span class=\"number\">0</span>, <span class=\"number\">0</span>&#125;, &#123;subunit, subunit&#125;&#125;,</span><br><span class=\"line\">    myRect2 = &#123;&#123;subunit, subunit&#125;, &#123;subunit, subunit&#125;&#125;,</span><br><span class=\"line\">    myRect3 = &#123;&#123;<span class=\"number\">0</span>, subunit&#125;, &#123;subunit, subunit&#125;&#125;,</span><br><span class=\"line\">    myRect4 = &#123;&#123;subunit, <span class=\"number\">0</span>&#125;, &#123;subunit, subunit&#125;&#125;;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"built_in\">CGContextSetRGBFillColor</span>(myContext, <span class=\"number\">0</span>, <span class=\"number\">0</span>, <span class=\"number\">1</span>, <span class=\"number\">.5</span>);</span><br><span class=\"line\">    <span class=\"built_in\">CGContextFillRect</span>(myContext, myRect1);</span><br><span class=\"line\">    <span class=\"built_in\">CGContextSetRGBFillColor</span>(myContext, <span class=\"number\">1</span>, <span class=\"number\">0</span>, <span class=\"number\">0</span>, <span class=\"number\">.5</span>);</span><br><span class=\"line\">    <span class=\"built_in\">CGContextFillRect</span>(myContext, myRect2);</span><br><span class=\"line\">    <span class=\"built_in\">CGContextSetRGBFillColor</span>(myContext, <span class=\"number\">0</span>, <span class=\"number\">1</span>, <span class=\"number\">0</span>, <span class=\"number\">.5</span>);</span><br><span class=\"line\">    <span class=\"built_in\">CGContextFillRect</span>(myContext, myRect3);</span><br><span class=\"line\">    <span class=\"built_in\">CGContextSetRGBFillColor</span>(myContext, <span class=\"number\">.5</span>, <span class=\"number\">0</span>, <span class=\"number\">.5</span>, <span class=\"number\">.5</span>);</span><br><span class=\"line\">    <span class=\"built_in\">CGContextFillRect</span>(myContext, myRect4);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h1 id=\"shadows\">Shadows</h1>\n<h2 id=\"\"></h2>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">CGContextSaveGState</span>(context);</span><br><span class=\"line\"><span class=\"built_in\">CGContextSetShadow</span>(context, offsetsize, blur);  <span class=\"comment\">// offsetUIKitxyblur0, 0, 0, 1.0/3.0</span></span><br><span class=\"line\"><span class=\"built_in\">CGContextSetShadowWithColor</span>(context, offsetsize, blur, color);</span><br><span class=\"line\"><span class=\"comment\">/*  */</span></span><br><span class=\"line\"><span class=\"built_in\">CGContextRestoreGState</span>(context);</span><br></pre></td></tr></table></figure>\n<h1 id=\"gradients\">Gradients</h1>\n<p>Quartz   <em>CGShadingRef</em>  <em>CGGradientRef</em>(axial)(radial)</p>\n<p>An axial gradient(a linear gradient)  <br>\nA radial gradient  </p>\n<h2 id=\"cgshading--cggradient-\">CGShading  CGGradient </h2>\n<p>CGShadingRef  CGShadingCGFunction</p>\n<p>CGRadientRef  CGShadingRefQuartzQuartz</p>\n<h2 id=\"cggradient\">CGGradient</h2>\n<h3 id=\"\"></h3>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">CGGradientRef</span> myGradient;</span><br><span class=\"line\"><span class=\"built_in\">CGColorSpaceRef</span> myColorspace;</span><br><span class=\"line\">size_t num_locations = <span class=\"number\">2</span>;</span><br><span class=\"line\"><span class=\"built_in\">CGFloat</span> locations[<span class=\"number\">2</span>] = &#123; <span class=\"number\">0.0</span>, <span class=\"number\">1.0</span> &#125;;</span><br><span class=\"line\"><span class=\"built_in\">CGFloat</span> components[<span class=\"number\">8</span>] = &#123;</span><br><span class=\"line\">    <span class=\"number\">1.0</span>, <span class=\"number\">0.5</span>, <span class=\"number\">0.4</span>, <span class=\"number\">1.0</span>,  <span class=\"comment\">// Start color</span></span><br><span class=\"line\">    <span class=\"number\">0.8</span>, <span class=\"number\">0.8</span>, <span class=\"number\">0.3</span>, <span class=\"number\">1.0</span>   <span class=\"comment\">// End color</span></span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"><span class=\"built_in\">CGPoint</span> myStartPoint, myEndPoint;</span><br><span class=\"line\">myColorspace = <span class=\"built_in\">CGColorSpaceCreateWithName</span>(kCGColorSpaceGenericRGB);</span><br><span class=\"line\">myGradient = <span class=\"built_in\">CGGradientCreateWithColorComponents</span>(myColorspace, components, locations, num_locations);</span><br><span class=\"line\"><span class=\"built_in\">CGContextDrawLinearGradient</span>(context, myGradient, myStartPoint, myEndPoint, kCGGradientDrawsBeforeStartLocation | kCGGradientDrawsAfterEndLocation);</span><br></pre></td></tr></table></figure>\n<h3 id=\"\"></h3>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">CGGradientRef</span> myGradient;</span><br><span class=\"line\"><span class=\"built_in\">CGColorSpaceRef</span> myColorspace;</span><br><span class=\"line\">size_t num_locations = <span class=\"number\">2</span>;</span><br><span class=\"line\"><span class=\"built_in\">CGFloat</span> locations[<span class=\"number\">2</span>] = &#123; <span class=\"number\">0.0</span>, <span class=\"number\">1.0</span> &#125;;</span><br><span class=\"line\"><span class=\"built_in\">CGFloat</span> components[<span class=\"number\">8</span>] = &#123;</span><br><span class=\"line\">    <span class=\"number\">1.0</span>, <span class=\"number\">0.5</span>, <span class=\"number\">0.4</span>, <span class=\"number\">1.0</span>,  <span class=\"comment\">// Start color</span></span><br><span class=\"line\">    <span class=\"number\">0.8</span>, <span class=\"number\">0.8</span>, <span class=\"number\">0.3</span>, <span class=\"number\">1.0</span>   <span class=\"comment\">// End color</span></span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"><span class=\"built_in\">CGFloat</span> myStartRadius, myEndRadius;</span><br><span class=\"line\"><span class=\"built_in\">CGPoint</span> myStartPoint, myEndPoint;</span><br><span class=\"line\">myColorspace = <span class=\"built_in\">CGColorSpaceCreateWithName</span>(kCGColorSpaceGenericRGB);</span><br><span class=\"line\">myGradient = <span class=\"built_in\">CGGradientCreateWithColorComponents</span>(myColorspace, components, locations, num_locations);</span><br><span class=\"line\"><span class=\"built_in\">CGContextDrawRadialGradient</span>(context, myGradient, myStartPoint, myStartRadius, myEndPoint, myEndRadius, <span class=\"number\">0</span>);</span><br></pre></td></tr></table></figure>\n<h2 id=\"cgshading\">CGShading</h2>\n<p></p>\n<h1 id=\"transparency-layers\">Transparency Layers</h1>\n<p></p>\n<p><img src=\"/img/article/20190418/3.png\" alt=\"Transparency Layers\"></p>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">CGContextSetShadow</span>(context, <span class=\"built_in\">CGSizeMake</span>(<span class=\"number\">10</span>, <span class=\"number\">20</span>), <span class=\"number\">10</span>);</span><br><span class=\"line\"><span class=\"built_in\">CGContextBeginTransparencyLayer</span>(context, <span class=\"literal\">NULL</span>);</span><br><span class=\"line\"><span class=\"comment\">// your drawing code</span></span><br><span class=\"line\"><span class=\"built_in\">CGContextEndTransparencyLayer</span>(context);</span><br></pre></td></tr></table></figure>\n<h1 id=\"ending\">Ending</h1>\n<p>Quartz 2D iOS Core Image</p>\n<h1 id=\"reference\">Reference</h1>\n<blockquote>\n<p><a href=\"https://developer.apple.com/library/archive/documentation/GraphicsImaging/Conceptual/drawingwithquartz2d/dq_overview/dq_overview.html#//apple_ref/doc/uid/TP30001066-CH202-TPXREF101\" target=\"_blank\" rel=\"noopener\">Quartz 2D Programming Guide</a></p>\n</blockquote>\n","site":{"data":{}},"excerpt":"","more":"<blockquote>\n<p><a href=\"http://www.lymanli.com/2019/04/05/ios-opengles-filter/\" target=\"_blank\" rel=\"noopener\"> iOS  GLSL </a> OpenGL  OpenGL  OpenGL <br>\n OpenGL 3 iOS <br>\n  iOS  Core Graphics</p>\n</blockquote>\n<h1>Introduction</h1>\n<p>Quartz 2D iOS  Mac OS X  Quartz 2D API PDF PDF  iOS Quartz 2D  Core Animation, OpenGL ES, UIKit  iOS </p>\n<h1>Concepts</h1>\n<h2>The Graphics Context</h2>\n<p>CGContextRef Quartz  PDF Quartz <br>\n</p>\n<ol>\n<li>\n<p>A bitmap graphics context RGB CMYK </p>\n</li>\n<li>\n<p>A PDF graphics contextPDF  PDF  PDF PDF </p>\n</li>\n</ol>\n<ul>\n<li>PDF </li>\n<li> PDF </li>\n<li>PDF </li>\n</ul>\n<ol start=\"3\">\n<li>\n<p>A window graphics context Mac OS X</p>\n</li>\n<li>\n<p>A layer context</p>\n</li>\n</ol>\n<h2>Graphics States</h2>\n<p>Quartz  Quartz </p>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">CGContextSaveGState</span>();  <span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"built_in\">CGContextRestoreGState</span>();   <span class=\"comment\">// </span></span><br></pre></td></tr></table></figure>\n<h2>Quartz 2D Coordinate Systems</h2>\n<p>Quartz 2D<br>\n<img src=\"/img/article/20190418/1.png\" alt=\"Quartz 2D\" title=\"Quartz 2D\"></p>\n<p>Quartz CTM</p>\n<p> Quartz  Quartz Quartz y</p>\n<ul>\n<li>Mac OS X NSView  <em>isFlipped</em>  YES</li>\n<li>iOSUIView </li>\n<li>iOS<em>UIGraphicsBeginImageContextWithOptions</em> </li>\n</ul>\n<p> UIKit  Quartz  Quartz </p>\n<h1>Paths</h1>\n<p></p>\n<h2></h2>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">///  Points</span></span><br><span class=\"line\"><span class=\"built_in\">CGContextMoveToPoint</span>(context, x, y);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">///  Lines</span></span><br><span class=\"line\"><span class=\"built_in\">CGContextAddLineToPoint</span>(context, x, y);</span><br><span class=\"line\"><span class=\"built_in\">CGContextAddLines</span>(context, [points], count)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/// </span></span><br><span class=\"line\"><span class=\"built_in\">CGContextAddArc</span>(context, x, y, radius, startAngle, endAngle, clockwise);</span><br><span class=\"line\"><span class=\"built_in\">CGContextAddArcToPoint</span>(context, x1, y1, x2, y2, radius);    <span class=\"comment\">// </span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">///  Curves</span></span><br><span class=\"line\"><span class=\"built_in\">CGContextAddCurveToPoint</span>(context, x1, y1, x2, y2, x, y);    <span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"built_in\">CGContextAddQuadCurveToPoint</span>(context, x1, y1, x, y)         <span class=\"comment\">// </span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/// </span></span><br><span class=\"line\"><span class=\"built_in\">CGContextClosePath</span>(context);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">///  Ellipses</span></span><br><span class=\"line\"><span class=\"built_in\">CGContextAddEllipseInRect</span>(context, rect);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">///  Rectangles</span></span><br><span class=\"line\"><span class=\"built_in\">CGContextAddRect</span>(context, rect);</span><br><span class=\"line\"><span class=\"built_in\">CGContextAddRects</span>(context, [rects], count);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/// </span></span><br><span class=\"line\"><span class=\"built_in\">CGContextBeginPath</span>(context);</span><br></pre></td></tr></table></figure>\n<h2></h2>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/// </span></span><br><span class=\"line\"><span class=\"built_in\">CGMutablePathRef</span> mutablePath = <span class=\"built_in\">CGPathCreateMutable</span>();</span><br><span class=\"line\"><span class=\"built_in\">CGPathRef</span> path = <span class=\"built_in\">CGContextCopyPath</span>(context);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/// </span></span><br><span class=\"line\"><span class=\"built_in\">CGPathMoveToPoint</span>(path, <span class=\"literal\">NULL</span>, x, y);    <span class=\"comment\">// CGContextTranslateCTM, CGContextScaleCTM, or CGContextRotateCTM</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">///  ...</span></span><br></pre></td></tr></table></figure>\n<h2></h2>\n<ul>\n<li></li>\n</ul>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/// </span></span><br><span class=\"line\"><span class=\"built_in\">CGContextSetLineWidth</span>(context, width);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/// </span></span><br><span class=\"line\"><span class=\"built_in\">CGContextSetLineJoin</span>(context, join);        <span class=\"comment\">// kCGLineJoinMiter (the default), kCGLineJoinRound , or kCGLineJoinBevel </span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">///  Miter </span></span><br><span class=\"line\"><span class=\"built_in\">CGContextSetMiterLimit</span>(context, limit);     <span class=\"comment\">// Bevel</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/// </span></span><br><span class=\"line\"><span class=\"built_in\">CGContextSetLineCap</span>(context, cap);          <span class=\"comment\">// kCGLineCapButt (the default), kCGLineCapRound , or kCGLineCapSquare </span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">///  </span></span><br><span class=\"line\"><span class=\"built_in\">CGContextSetLineDash</span>(context, phase, [lengths], count);     <span class=\"comment\">// phase: </span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/// </span></span><br><span class=\"line\"><span class=\"built_in\">CGContextSetStrokeColorWithColor</span>(context, color);</span><br></pre></td></tr></table></figure>\n<ul>\n<li></li>\n</ul>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/// </span></span><br><span class=\"line\"><span class=\"built_in\">CGContextStrokePath</span>(context);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/// </span></span><br><span class=\"line\"><span class=\"built_in\">CGContextStrokeRect</span>(context, rect);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/// </span></span><br><span class=\"line\"><span class=\"built_in\">CGContextStrokeRectWithWidth</span>(context, rect, width);      <span class=\"comment\">// width: </span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/// </span></span><br><span class=\"line\"><span class=\"built_in\">CGContextStrokeEllipseInRect</span>(context, rect);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/// </span></span><br><span class=\"line\"><span class=\"built_in\">CGContextStrokeLineSegments</span>(context, [points], count);      <span class=\"comment\">// points: </span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/// </span></span><br><span class=\"line\"><span class=\"built_in\">CGContextDrawPath</span>(context, kCGPathFillStroke || kCGPathEOFillStroke);</span><br></pre></td></tr></table></figure>\n<h2></h2>\n<p></p>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">///   even-odd rule</span></span><br><span class=\"line\"><span class=\"built_in\">CGContextEOFillPath</span>(context);   <span class=\"comment\">// +1</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">///   nonzero winding number rule</span></span><br><span class=\"line\"><span class=\"built_in\">CGContextFillPath</span>(context);     <span class=\"comment\">// +1-100</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/// </span></span><br><span class=\"line\"><span class=\"built_in\">CGContextFillRect</span>(context, rect);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/// </span></span><br><span class=\"line\"><span class=\"built_in\">CGContextFillEllipseInRect</span>(context, rect);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/// </span></span><br><span class=\"line\"><span class=\"built_in\">CGContextDrawPath</span>(context, kCGPathFill || kCGPathEOFill);</span><br></pre></td></tr></table></figure>\n<h2></h2>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">///   nonzero winding number rule</span></span><br><span class=\"line\"><span class=\"built_in\">CGContextClip</span>(context);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">///   even-odd rule</span></span><br><span class=\"line\"><span class=\"built_in\">CGContextEOClip</span>(context);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/// </span></span><br><span class=\"line\"><span class=\"built_in\">CGContextClipToRect</span>(context, rect);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/// </span></span><br><span class=\"line\"><span class=\"built_in\">CGContextClipToMask</span>(context, rect, mask);</span><br></pre></td></tr></table></figure>\n<h1>Transforms</h1>\n<h2></h2>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/// </span></span><br><span class=\"line\"><span class=\"built_in\">CGContextTranslateCTM</span>(context, x, y);</span><br><span class=\"line\">    </span><br><span class=\"line\"><span class=\"comment\">/// </span></span><br><span class=\"line\"><span class=\"built_in\">CGContextRotateCTM</span>(context, angle);</span><br><span class=\"line\">    </span><br><span class=\"line\"><span class=\"comment\">/// </span></span><br><span class=\"line\"><span class=\"built_in\">CGContextScaleCTM</span>(context, x, y);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/// </span></span><br><span class=\"line\"><span class=\"built_in\">CGContextConcatCTM</span>(context, transform);</span><br></pre></td></tr></table></figure>\n<h2></h2>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/// </span></span><br><span class=\"line\"><span class=\"built_in\">CGAffineTransformMakeTranslation</span>(x, y);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/// transform</span></span><br><span class=\"line\"><span class=\"built_in\">CGAffineTransformTranslate</span>(transform, x, y);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/// </span></span><br><span class=\"line\"><span class=\"built_in\">CGAffineTransformMakeRotation</span>(angle);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/// transform</span></span><br><span class=\"line\"><span class=\"built_in\">CGAffineTransformRotate</span>(transform, angle);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/// </span></span><br><span class=\"line\"><span class=\"built_in\">CGAffineTransformMakeScale</span>(x, y);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/// transform</span></span><br><span class=\"line\"><span class=\"built_in\">CGAffineTransformScale</span>(transform, x, y);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/// point</span></span><br><span class=\"line\"><span class=\"built_in\">CGPointApplyAffineTransform</span>(point, transform);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/// size</span></span><br><span class=\"line\"><span class=\"built_in\">CGSizeApplyAffineTransform</span>(size, transform);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/// rect</span></span><br><span class=\"line\"><span class=\"built_in\">CGRectApplyAffineTransform</span>(rect, transform);</span><br></pre></td></tr></table></figure>\n<h2></h2>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/// </span></span><br><span class=\"line\"><span class=\"built_in\">CGAffineTransformEqualToTransform</span>(transform1, transform2);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/// </span></span><br><span class=\"line\"><span class=\"built_in\">CGAffineTransformIsIdentity</span>(transform);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/// </span></span><br><span class=\"line\"><span class=\"built_in\">CGAffineTransformIdentity</span>;</span><br></pre></td></tr></table></figure>\n<h2></h2>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/// point</span></span><br><span class=\"line\"><span class=\"built_in\">CGContextConvertPointToDeviceSpace</span>(context, point);</span><br><span class=\"line\"><span class=\"built_in\">CGContextConvertPointToUserSpace</span>(context, point);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/// size</span></span><br><span class=\"line\"><span class=\"built_in\">CGContextConvertSizeToDeviceSpace</span>(context, size);</span><br><span class=\"line\"><span class=\"built_in\">CGContextConvertRectToUserSpace</span>(context, size);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/// rect</span></span><br><span class=\"line\"><span class=\"built_in\">CGContextConvertRectToDeviceSpace</span>(context, rect);</span><br><span class=\"line\"><span class=\"built_in\">CGContextConvertRectToUserSpace</span>(context, rect);</span><br></pre></td></tr></table></figure>\n<h1>Patterns</h1>\n<p>Pattern  PatternQuartz  Pattern  Pattern <br>\n<img src=\"/img/article/20190418/2.png\" alt=\"A Pattern drawn to a window\"></p>\n<h2></h2>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param info </span></span><br><span class=\"line\"><span class=\"comment\"> @param myContext </span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">void</span> MyDrawColoredPattern(<span class=\"keyword\">void</span> *info, <span class=\"built_in\">CGContextRef</span> myContext) &#123;</span><br><span class=\"line\">    <span class=\"built_in\">CGFloat</span> subunit = <span class=\"number\">5</span>;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"built_in\">CGRect</span> myRect1 = &#123;&#123;<span class=\"number\">0</span>, <span class=\"number\">0</span>&#125;, &#123;subunit, subunit&#125;&#125;,</span><br><span class=\"line\">    myRect2 = &#123;&#123;subunit, subunit&#125;, &#123;subunit, subunit&#125;&#125;,</span><br><span class=\"line\">    myRect3 = &#123;&#123;<span class=\"number\">0</span>, subunit&#125;, &#123;subunit, subunit&#125;&#125;,</span><br><span class=\"line\">    myRect4 = &#123;&#123;subunit, <span class=\"number\">0</span>&#125;, &#123;subunit, subunit&#125;&#125;;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"built_in\">CGContextSetRGBFillColor</span>(myContext, <span class=\"number\">0</span>, <span class=\"number\">0</span>, <span class=\"number\">1</span>, <span class=\"number\">.5</span>);</span><br><span class=\"line\">    <span class=\"built_in\">CGContextFillRect</span>(myContext, myRect1);</span><br><span class=\"line\">    <span class=\"built_in\">CGContextSetRGBFillColor</span>(myContext, <span class=\"number\">1</span>, <span class=\"number\">0</span>, <span class=\"number\">0</span>, <span class=\"number\">.5</span>);</span><br><span class=\"line\">    <span class=\"built_in\">CGContextFillRect</span>(myContext, myRect2);</span><br><span class=\"line\">    <span class=\"built_in\">CGContextSetRGBFillColor</span>(myContext, <span class=\"number\">0</span>, <span class=\"number\">1</span>, <span class=\"number\">0</span>, <span class=\"number\">.5</span>);</span><br><span class=\"line\">    <span class=\"built_in\">CGContextFillRect</span>(myContext, myRect3);</span><br><span class=\"line\">    <span class=\"built_in\">CGContextSetRGBFillColor</span>(myContext, <span class=\"number\">.5</span>, <span class=\"number\">0</span>, <span class=\"number\">.5</span>, <span class=\"number\">.5</span>);</span><br><span class=\"line\">    <span class=\"built_in\">CGContextFillRect</span>(myContext, myRect4);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2></h2>\n<p><em>MyDrawColoredPattern</em>NULL</p>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">CGColorSpaceRef</span> patternSpace;</span><br><span class=\"line\">patternSpace = <span class=\"built_in\">CGColorSpaceCreatePattern</span>(<span class=\"literal\">NULL</span>);</span><br><span class=\"line\"><span class=\"built_in\">CGContextSetFillColorSpace</span>(context, patternSpace);</span><br><span class=\"line\"><span class=\"built_in\">CGColorSpaceRelease</span>(patternSpace);</span><br></pre></td></tr></table></figure>\n<h2></h2>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param NULL *MyDrawColoredPattern*info</span></span><br><span class=\"line\"><span class=\"comment\"> @param patternRect rect</span></span><br><span class=\"line\"><span class=\"comment\"> @param CGAffineTransformIdentity </span></span><br><span class=\"line\"><span class=\"comment\"> @param 16 </span></span><br><span class=\"line\"><span class=\"comment\"> @param 18 </span></span><br><span class=\"line\"><span class=\"comment\"> @param kCGPatternTilingConstantSpacing </span></span><br><span class=\"line\"><span class=\"comment\"> @param YES </span></span><br><span class=\"line\"><span class=\"comment\"> @param callbacks </span></span><br><span class=\"line\"><span class=\"comment\"> @return </span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"built_in\">CGPatternRef</span> myPattern = <span class=\"built_in\">CGPatternCreate</span>(<span class=\"literal\">NULL</span>, patternRect, <span class=\"built_in\">CGAffineTransformIdentity</span>, <span class=\"number\">16</span>, <span class=\"number\">18</span>, kCGPatternTilingConstantSpacing, <span class=\"literal\">YES</span>, &amp;callbacks);</span><br></pre></td></tr></table></figure>\n<h2></h2>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">CGFloat</span> alpha = <span class=\"number\">1</span>;</span><br><span class=\"line\"><span class=\"built_in\">CGContextSetFillPattern</span>(context, myPattern, &amp;alpha);</span><br></pre></td></tr></table></figure>\n<h2></h2>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">void</span> MyColorPatternPainting(<span class=\"built_in\">CGContextRef</span> myContext, <span class=\"built_in\">CGRect</span> rect) &#123;</span><br><span class=\"line\">    <span class=\"built_in\">CGPatternRef</span> pattern;</span><br><span class=\"line\">    <span class=\"built_in\">CGColorSpaceRef</span> patternSpace;</span><br><span class=\"line\">    <span class=\"built_in\">CGFloat</span> alpha = <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">static</span> <span class=\"keyword\">const</span> <span class=\"built_in\">CGPatternCallbacks</span> callbacks = &#123;<span class=\"number\">0</span>, &amp;MyDrawColoredPattern, <span class=\"literal\">NULL</span>&#125;;</span><br><span class=\"line\">    <span class=\"built_in\">CGContextSaveGState</span>(myContext);</span><br><span class=\"line\">    patternSpace = <span class=\"built_in\">CGColorSpaceCreatePattern</span>(<span class=\"literal\">NULL</span>);</span><br><span class=\"line\">    <span class=\"built_in\">CGContextSetFillColorSpace</span>(myContext, patternSpace);</span><br><span class=\"line\">    <span class=\"built_in\">CGColorSpaceRelease</span>(patternSpace);</span><br><span class=\"line\">    </span><br><span class=\"line\">    pattern = <span class=\"built_in\">CGPatternCreate</span>(<span class=\"literal\">NULL</span>, <span class=\"built_in\">CGRectMake</span>(<span class=\"number\">0</span>, <span class=\"number\">0</span>, <span class=\"number\">16</span>, <span class=\"number\">18</span>), <span class=\"built_in\">CGAffineTransformMake</span>(<span class=\"number\">1</span>, <span class=\"number\">0</span>, <span class=\"number\">0</span>, <span class=\"number\">1</span>, <span class=\"number\">0</span>, <span class=\"number\">0</span>), <span class=\"number\">16</span>, <span class=\"number\">18</span>, kCGPatternTilingConstantSpacing, <span class=\"literal\">true</span>, &amp;callbacks);</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"built_in\">CGContextSetFillPattern</span>(myContext, pattern, &amp;alpha);</span><br><span class=\"line\">    <span class=\"built_in\">CGPatternRelease</span>(pattern);</span><br><span class=\"line\">    <span class=\"built_in\">CGContextFillRect</span>(myContext, rect);</span><br><span class=\"line\">    <span class=\"built_in\">CGContextRestoreGState</span>(myContext);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">void</span> MyDrawColoredPattern(<span class=\"keyword\">void</span> *info, <span class=\"built_in\">CGContextRef</span> myContext) &#123;</span><br><span class=\"line\">    <span class=\"built_in\">CGFloat</span> subunit = <span class=\"number\">5</span>;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"built_in\">CGRect</span> myRect1 = &#123;&#123;<span class=\"number\">0</span>, <span class=\"number\">0</span>&#125;, &#123;subunit, subunit&#125;&#125;,</span><br><span class=\"line\">    myRect2 = &#123;&#123;subunit, subunit&#125;, &#123;subunit, subunit&#125;&#125;,</span><br><span class=\"line\">    myRect3 = &#123;&#123;<span class=\"number\">0</span>, subunit&#125;, &#123;subunit, subunit&#125;&#125;,</span><br><span class=\"line\">    myRect4 = &#123;&#123;subunit, <span class=\"number\">0</span>&#125;, &#123;subunit, subunit&#125;&#125;;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"built_in\">CGContextSetRGBFillColor</span>(myContext, <span class=\"number\">0</span>, <span class=\"number\">0</span>, <span class=\"number\">1</span>, <span class=\"number\">.5</span>);</span><br><span class=\"line\">    <span class=\"built_in\">CGContextFillRect</span>(myContext, myRect1);</span><br><span class=\"line\">    <span class=\"built_in\">CGContextSetRGBFillColor</span>(myContext, <span class=\"number\">1</span>, <span class=\"number\">0</span>, <span class=\"number\">0</span>, <span class=\"number\">.5</span>);</span><br><span class=\"line\">    <span class=\"built_in\">CGContextFillRect</span>(myContext, myRect2);</span><br><span class=\"line\">    <span class=\"built_in\">CGContextSetRGBFillColor</span>(myContext, <span class=\"number\">0</span>, <span class=\"number\">1</span>, <span class=\"number\">0</span>, <span class=\"number\">.5</span>);</span><br><span class=\"line\">    <span class=\"built_in\">CGContextFillRect</span>(myContext, myRect3);</span><br><span class=\"line\">    <span class=\"built_in\">CGContextSetRGBFillColor</span>(myContext, <span class=\"number\">.5</span>, <span class=\"number\">0</span>, <span class=\"number\">.5</span>, <span class=\"number\">.5</span>);</span><br><span class=\"line\">    <span class=\"built_in\">CGContextFillRect</span>(myContext, myRect4);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h1>Shadows</h1>\n<h2></h2>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">CGContextSaveGState</span>(context);</span><br><span class=\"line\"><span class=\"built_in\">CGContextSetShadow</span>(context, offsetsize, blur);  <span class=\"comment\">// offsetUIKitxyblur0, 0, 0, 1.0/3.0</span></span><br><span class=\"line\"><span class=\"built_in\">CGContextSetShadowWithColor</span>(context, offsetsize, blur, color);</span><br><span class=\"line\"><span class=\"comment\">/*  */</span></span><br><span class=\"line\"><span class=\"built_in\">CGContextRestoreGState</span>(context);</span><br></pre></td></tr></table></figure>\n<h1>Gradients</h1>\n<p>Quartz   <em>CGShadingRef</em>  <em>CGGradientRef</em>(axial)(radial)</p>\n<p>An axial gradient(a linear gradient)  <br>\nA radial gradient  </p>\n<h2>CGShading  CGGradient </h2>\n<p>CGShadingRef  CGShadingCGFunction</p>\n<p>CGRadientRef  CGShadingRefQuartzQuartz</p>\n<h2>CGGradient</h2>\n<h3></h3>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">CGGradientRef</span> myGradient;</span><br><span class=\"line\"><span class=\"built_in\">CGColorSpaceRef</span> myColorspace;</span><br><span class=\"line\">size_t num_locations = <span class=\"number\">2</span>;</span><br><span class=\"line\"><span class=\"built_in\">CGFloat</span> locations[<span class=\"number\">2</span>] = &#123; <span class=\"number\">0.0</span>, <span class=\"number\">1.0</span> &#125;;</span><br><span class=\"line\"><span class=\"built_in\">CGFloat</span> components[<span class=\"number\">8</span>] = &#123;</span><br><span class=\"line\">    <span class=\"number\">1.0</span>, <span class=\"number\">0.5</span>, <span class=\"number\">0.4</span>, <span class=\"number\">1.0</span>,  <span class=\"comment\">// Start color</span></span><br><span class=\"line\">    <span class=\"number\">0.8</span>, <span class=\"number\">0.8</span>, <span class=\"number\">0.3</span>, <span class=\"number\">1.0</span>   <span class=\"comment\">// End color</span></span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"><span class=\"built_in\">CGPoint</span> myStartPoint, myEndPoint;</span><br><span class=\"line\">myColorspace = <span class=\"built_in\">CGColorSpaceCreateWithName</span>(kCGColorSpaceGenericRGB);</span><br><span class=\"line\">myGradient = <span class=\"built_in\">CGGradientCreateWithColorComponents</span>(myColorspace, components, locations, num_locations);</span><br><span class=\"line\"><span class=\"built_in\">CGContextDrawLinearGradient</span>(context, myGradient, myStartPoint, myEndPoint, kCGGradientDrawsBeforeStartLocation | kCGGradientDrawsAfterEndLocation);</span><br></pre></td></tr></table></figure>\n<h3></h3>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">CGGradientRef</span> myGradient;</span><br><span class=\"line\"><span class=\"built_in\">CGColorSpaceRef</span> myColorspace;</span><br><span class=\"line\">size_t num_locations = <span class=\"number\">2</span>;</span><br><span class=\"line\"><span class=\"built_in\">CGFloat</span> locations[<span class=\"number\">2</span>] = &#123; <span class=\"number\">0.0</span>, <span class=\"number\">1.0</span> &#125;;</span><br><span class=\"line\"><span class=\"built_in\">CGFloat</span> components[<span class=\"number\">8</span>] = &#123;</span><br><span class=\"line\">    <span class=\"number\">1.0</span>, <span class=\"number\">0.5</span>, <span class=\"number\">0.4</span>, <span class=\"number\">1.0</span>,  <span class=\"comment\">// Start color</span></span><br><span class=\"line\">    <span class=\"number\">0.8</span>, <span class=\"number\">0.8</span>, <span class=\"number\">0.3</span>, <span class=\"number\">1.0</span>   <span class=\"comment\">// End color</span></span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"><span class=\"built_in\">CGFloat</span> myStartRadius, myEndRadius;</span><br><span class=\"line\"><span class=\"built_in\">CGPoint</span> myStartPoint, myEndPoint;</span><br><span class=\"line\">myColorspace = <span class=\"built_in\">CGColorSpaceCreateWithName</span>(kCGColorSpaceGenericRGB);</span><br><span class=\"line\">myGradient = <span class=\"built_in\">CGGradientCreateWithColorComponents</span>(myColorspace, components, locations, num_locations);</span><br><span class=\"line\"><span class=\"built_in\">CGContextDrawRadialGradient</span>(context, myGradient, myStartPoint, myStartRadius, myEndPoint, myEndRadius, <span class=\"number\">0</span>);</span><br></pre></td></tr></table></figure>\n<h2>CGShading</h2>\n<p></p>\n<h1>Transparency Layers</h1>\n<p></p>\n<p><img src=\"/img/article/20190418/3.png\" alt=\"Transparency Layers\"></p>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">CGContextSetShadow</span>(context, <span class=\"built_in\">CGSizeMake</span>(<span class=\"number\">10</span>, <span class=\"number\">20</span>), <span class=\"number\">10</span>);</span><br><span class=\"line\"><span class=\"built_in\">CGContextBeginTransparencyLayer</span>(context, <span class=\"literal\">NULL</span>);</span><br><span class=\"line\"><span class=\"comment\">// your drawing code</span></span><br><span class=\"line\"><span class=\"built_in\">CGContextEndTransparencyLayer</span>(context);</span><br></pre></td></tr></table></figure>\n<h1>Ending</h1>\n<p>Quartz 2D iOS Core Image</p>\n<h1>Reference</h1>\n<blockquote>\n<p><a href=\"https://developer.apple.com/library/archive/documentation/GraphicsImaging/Conceptual/drawingwithquartz2d/dq_overview/dq_overview.html#//apple_ref/doc/uid/TP30001066-CH202-TPXREF101\" target=\"_blank\" rel=\"noopener\">Quartz 2D Programming Guide</a></p>\n</blockquote>\n"},{"title":" -- Core Image","catalog":true,"toc_nav_num":true,"date":"2019-04-25T10:40:24.000Z","subtitle":"About Core Image","header-img":"/img/article_header/article_header.png","busuanzi":true,"_content":"\n# Introduction\n\nCore Image Core GraphicsCore VideoImage I/OGPUCPUCore ImageAPIOpenGLOpenGL ESMetalGPUGCDCore Image\n\n![Core Image](/img/article/20190425/1.png)\n\nCore Image \n- \n- \n- \n- \n- GPU\n- \nMacOS\n\n# Processing Images\n\n -- CIFilterCIImageCore ImageCIContext\n\n\n``` Swift\nlet context = CIContext()\nlet filter = CIFilter(name: \"CISepiaTone\")\nfilter?.setValue(0.8, forKey: kCIInputIntensityKey)\nlet image = CIImage(contentsOf: Bundle.main.url(forResource: \"\", withExtension: \"\")!)\nfilter?.setValue(image, forKey: kCIInputImageKey)\nlet result = filter?.outputImage\nif let result = result {\n    let cgImage = context.createCGImage(result, from: result.extent)\n}\n```\n\nCIImageCIImageCore Image \n\nCIImageCIImage\n- URLNSData\n- Quartz2DUIKitAppKitCGImageRefUIImageNSBitmapImageRep\n- MetalOpenGLOpenGl ES\n- CoreVideoCVImageBufferRefCVPixelBufferRef\n-  -- IOSurfaceRef\n- CIImageProvider\n\nCIImageCIFilteroutputImageCore Image\n\n##  -- \n\nCIFilterCIFilter[](https://developer.apple.com/library/archive/documentation/GraphicsImaging/Reference/CoreImageFilterReference/index.html#//apple_ref/doc/uid/TP40004346)\n\n###  -- \n\nCore ImageCIImage\n\n![Construct a filter chain by connecting filter inputs and outputs](/img/article/20190425/2.png)\n\nCore Image CIImageCore ImageCore Image\n\n![Core Image optimizes a filter chain to a single operation](/img/20190425/2.png)\n\nCropCore Image\n\n``` Swift\nfunc applyFilterChain(to image: CIImage) -> CIImage? {\n    let colorFilter = CIFilter(name: \"CIPhotoEffectProcess\", parameters: [kCIInputImageKey: image])\n    guard let image = colorFilter?.outputImage else {\n        return nil\n    }\n    let bloomImage = image.applyingFilter(\"CIBloom\", parameters: [kCIInputRadiusKey: 10.0, kCIInputIntensityKey: 1.0])\n    let cropRect = CGRect(x: 0, y: 0, width: 150, height: 150)  // \n    let croppedImage = bloomImage.cropped(to: cropRect) // croped, clamped\n    return croppedImage\n}\n```\n\n### \n\n[](https://developer.apple.com/library/archive/documentation/GraphicsImaging/Reference/CoreImageFilterReference/index.html#//apple_ref/doc/filter/ci/CIQRCodeGenerator)\n[](https://developer.apple.com/library/archive/documentation/GraphicsImaging/Reference/CoreImageFilterReference/index.html#//apple_ref/doc/filter/ci/CICode128BarcodeGenerator)\n[](https://developer.apple.com/library/archive/documentation/GraphicsImaging/Conceptual/CoreImaging/ci_tasks/ci_tasks.html#//apple_ref/doc/uid/TP30001185-CH3-DontLinkElementID_6)\n\n## Core Image\n\nMetalOpenGLOpenGL ESMetal\n\n# Detecting Faces in an Image\n\nCore ImageCore Image\n\n``` Swift\nDispatchQueue.global().async {\n    let image = CIImage(contentsOf: Bundle.main.url(forResource: \"7\", withExtension: \"jpg\")!)\n    let context = CIContext()\n    let opts = [CIDetectorAccuracy: CIDetectorAccuracyHigh]\n    let detector = CIDetector(ofType: CIDetectorTypeFace, context: context, options: opts)\n    let features = detector?.features(in: image!) as? [CIFaceFeature]\n    if let features = features {\n        for feature in features {\n            print(feature.bounds)\n            \n            if feature.hasLeftEyePosition {\n                print(\"Left eye \\(feature.leftEyePosition.x) \\(feature.leftEyePosition.y)\")\n            }\n            \n            if feature.hasRightEyePosition {\n                print(\"Right eye \\(feature.rightEyePosition.x) \\(feature.rightEyePosition.y)\")\n            }\n            \n            if feature.hasMouthPosition {\n                print(\"Mouth \\(feature.mouthPosition)\")\n            }\n        }\n    }\n}\n```\n\n# Auto Enhancing Images\n\nCore ImageCIFilter\n\nCore Image\n- CIRedEyeCorrection\n- CIFaceBalance\n- CIVibrance\n- CIToneCurve\n- CIHighlightShadowAdjust\n\n``` Swift\nlet adjustments = image.autoAdjustmentFilters()\nfor filter in adjustments {\n    filter.setValue(image, forKey: kCIInputImageKey)\n    image = filter.outputImage!\n}\n```\n\n# Subclassing CIFilter: Reciptes for Custom Effects\n\nCIFilter\n\n## Subclassing CIFilter to Create the CIColorInvert Filter\n\nCIFilterCore Image\n\n- `input`*inputImage*\n- `setDefaults`\n- `outputImage`\n\nCore ImageCIColorInvertCIColorMatrixCIColorInvertCIColorMatrix\n\n``` Swift\nclass CIColorInvert: CIFilter {\n    public var inputImage: CIImage?\n    \n    override var outputImage: CIImage? {\n        get {\n            guard let inputImage = inputImage else {\n                return nil\n            }\n            let filter = CIFilter(name: \"CIColorMatrix\",\n                                  parameters: [kCIInputImageKey: inputImage,\n                                               \"inputRVector\": CIVector(x: -1, y: 0, z: 0),\n                                               \"inputGVector\": CIVector(x: 0, y: -1, z: 0),\n                                               \"inputBVector\": CIVector(x: 0, y: 0, z: -1),\n                                               \"inputBiasVector\": CIVector(x: 1, y: 1, z: 1)])\n            return filter?.outputImage\n        }\n    }\n}\n```\n\n## Chrome Key Filter Recipe\n\n\n\n- \n- CIColorCube\n- CISourceOverCompositing\n\n### \n\n3DCIColorCube--\n0RGBAHSVHSVH\n0120\nalphaRGBalphaalpha01.0.\n\n``` Swift\nlet size = 64\nlet count = size * size * size * 4\nlet cubeData = UnsafeMutablePointer<Float>.allocate(capacity: count)\nvar rgb: [Double] = [0, 0, 0], hsv: [Double] = [0, 0, 0]\nfor z in 0..<size {\n    rgb[2] = (Double(z)) / Double(size - 1)\n    for y in 0..<size {\n        rgb[1] = Double(y) / Double(size - 1)\n        for x in 0..<size {\n            rgb[0] = Double(x) / Double(size - 1)\n            // rgbToHSV(rgb, hsv)\n            let alpha = (hsv[0] > minHugAngle && hsv[0] < maxHueAngle) ? 0.0f : 1.0f\n            let offset = x * 4 + y * size * 4 + z * size * size * 4\n            cubeData[offset] = Float(rgb[0] * alpha)\n            cubeData[offset + 1] = Float(rgb[1] * alpha)\n            cubeData[offset + 2] = Float(rgb[2] * alpha)\n            cubeData[offset + 3] = Float(alpha)\n            cubeData.moveAssign(from: cubeData + 3, count: 4)\n        }\n    }\n}\nlet data = Data(bytesNoCopy: cubeData, count: count, deallocator: .free)\nlet colorCube = CIFilter(name: \"CIColorCube\")\ncolorCube?.setValue(NSNumber(value: size), forKey: \"inputCubeDimension\")\ncolorCube?.setValue(data, forKey: \"inputCubeData\")\n```\n\n### \n\n``` Swift\ncolorCube?.setValue(inputImage, forKey: kCIInputImageKey)\nlet result = colorCube?.outputImage\n```\n\n### \n\nCISourceOverCompositing\n- inputImage\n- inputBackgroundImage\n\n# Getting the Best Performance\n\nCore Image\n- \n- \n- \n- \n\n## \n\n- CIContext\n- \n- GPUCIImageCore AnimationCPU\n- CPUGPUCIContextCPUGPU\n- \n- UIImageView\n- CPUGPU\n- \n- iOS 6.0YUVYUVRGBACore ImageCVPixelBufferYUB\n\n# Creating Custom Filters\n\n[What You Need to Know Before Writing a Custom Filter](https://developer.apple.com/library/archive/documentation/GraphicsImaging/Conceptual/CoreImaging/ci_advanced_concepts/ci.advanced_concepts.html#//apple_ref/doc/uid/TP30001185-CH9-SW1)\n\n[Creating Custom Filters](https://developer.apple.com/library/archive/documentation/GraphicsImaging/Conceptual/CoreImaging/ci_custom_filters/ci_custom_filters.html#//apple_ref/doc/uid/TP30001185-CH6-TPXREF101)\n\n# Ending\n\n\n\n# Reference\n\n> [About Core Image](https://developer.apple.com/library/archive/documentation/GraphicsImaging/Conceptual/CoreImaging/ci_intro/ci_intro.html#//apple_ref/doc/uid/TP30001185-CH1-TPXREF101)","source":"_posts/2019/core-image-study-0425.md","raw":"---\ntitle: \" -- Core Image\"\ncatalog: true\ntoc_nav_num: true\ndate: 2019-04-25 18:40:24\nsubtitle: \"About Core Image\"\nheader-img: \"/img/article_header/article_header.png\"\nbusuanzi: true\ntags:\n- iOS\n\n---\n\n# Introduction\n\nCore Image Core GraphicsCore VideoImage I/OGPUCPUCore ImageAPIOpenGLOpenGL ESMetalGPUGCDCore Image\n\n![Core Image](/img/article/20190425/1.png)\n\nCore Image \n- \n- \n- \n- \n- GPU\n- \nMacOS\n\n# Processing Images\n\n -- CIFilterCIImageCore ImageCIContext\n\n\n``` Swift\nlet context = CIContext()\nlet filter = CIFilter(name: \"CISepiaTone\")\nfilter?.setValue(0.8, forKey: kCIInputIntensityKey)\nlet image = CIImage(contentsOf: Bundle.main.url(forResource: \"\", withExtension: \"\")!)\nfilter?.setValue(image, forKey: kCIInputImageKey)\nlet result = filter?.outputImage\nif let result = result {\n    let cgImage = context.createCGImage(result, from: result.extent)\n}\n```\n\nCIImageCIImageCore Image \n\nCIImageCIImage\n- URLNSData\n- Quartz2DUIKitAppKitCGImageRefUIImageNSBitmapImageRep\n- MetalOpenGLOpenGl ES\n- CoreVideoCVImageBufferRefCVPixelBufferRef\n-  -- IOSurfaceRef\n- CIImageProvider\n\nCIImageCIFilteroutputImageCore Image\n\n##  -- \n\nCIFilterCIFilter[](https://developer.apple.com/library/archive/documentation/GraphicsImaging/Reference/CoreImageFilterReference/index.html#//apple_ref/doc/uid/TP40004346)\n\n###  -- \n\nCore ImageCIImage\n\n![Construct a filter chain by connecting filter inputs and outputs](/img/article/20190425/2.png)\n\nCore Image CIImageCore ImageCore Image\n\n![Core Image optimizes a filter chain to a single operation](/img/20190425/2.png)\n\nCropCore Image\n\n``` Swift\nfunc applyFilterChain(to image: CIImage) -> CIImage? {\n    let colorFilter = CIFilter(name: \"CIPhotoEffectProcess\", parameters: [kCIInputImageKey: image])\n    guard let image = colorFilter?.outputImage else {\n        return nil\n    }\n    let bloomImage = image.applyingFilter(\"CIBloom\", parameters: [kCIInputRadiusKey: 10.0, kCIInputIntensityKey: 1.0])\n    let cropRect = CGRect(x: 0, y: 0, width: 150, height: 150)  // \n    let croppedImage = bloomImage.cropped(to: cropRect) // croped, clamped\n    return croppedImage\n}\n```\n\n### \n\n[](https://developer.apple.com/library/archive/documentation/GraphicsImaging/Reference/CoreImageFilterReference/index.html#//apple_ref/doc/filter/ci/CIQRCodeGenerator)\n[](https://developer.apple.com/library/archive/documentation/GraphicsImaging/Reference/CoreImageFilterReference/index.html#//apple_ref/doc/filter/ci/CICode128BarcodeGenerator)\n[](https://developer.apple.com/library/archive/documentation/GraphicsImaging/Conceptual/CoreImaging/ci_tasks/ci_tasks.html#//apple_ref/doc/uid/TP30001185-CH3-DontLinkElementID_6)\n\n## Core Image\n\nMetalOpenGLOpenGL ESMetal\n\n# Detecting Faces in an Image\n\nCore ImageCore Image\n\n``` Swift\nDispatchQueue.global().async {\n    let image = CIImage(contentsOf: Bundle.main.url(forResource: \"7\", withExtension: \"jpg\")!)\n    let context = CIContext()\n    let opts = [CIDetectorAccuracy: CIDetectorAccuracyHigh]\n    let detector = CIDetector(ofType: CIDetectorTypeFace, context: context, options: opts)\n    let features = detector?.features(in: image!) as? [CIFaceFeature]\n    if let features = features {\n        for feature in features {\n            print(feature.bounds)\n            \n            if feature.hasLeftEyePosition {\n                print(\"Left eye \\(feature.leftEyePosition.x) \\(feature.leftEyePosition.y)\")\n            }\n            \n            if feature.hasRightEyePosition {\n                print(\"Right eye \\(feature.rightEyePosition.x) \\(feature.rightEyePosition.y)\")\n            }\n            \n            if feature.hasMouthPosition {\n                print(\"Mouth \\(feature.mouthPosition)\")\n            }\n        }\n    }\n}\n```\n\n# Auto Enhancing Images\n\nCore ImageCIFilter\n\nCore Image\n- CIRedEyeCorrection\n- CIFaceBalance\n- CIVibrance\n- CIToneCurve\n- CIHighlightShadowAdjust\n\n``` Swift\nlet adjustments = image.autoAdjustmentFilters()\nfor filter in adjustments {\n    filter.setValue(image, forKey: kCIInputImageKey)\n    image = filter.outputImage!\n}\n```\n\n# Subclassing CIFilter: Reciptes for Custom Effects\n\nCIFilter\n\n## Subclassing CIFilter to Create the CIColorInvert Filter\n\nCIFilterCore Image\n\n- `input`*inputImage*\n- `setDefaults`\n- `outputImage`\n\nCore ImageCIColorInvertCIColorMatrixCIColorInvertCIColorMatrix\n\n``` Swift\nclass CIColorInvert: CIFilter {\n    public var inputImage: CIImage?\n    \n    override var outputImage: CIImage? {\n        get {\n            guard let inputImage = inputImage else {\n                return nil\n            }\n            let filter = CIFilter(name: \"CIColorMatrix\",\n                                  parameters: [kCIInputImageKey: inputImage,\n                                               \"inputRVector\": CIVector(x: -1, y: 0, z: 0),\n                                               \"inputGVector\": CIVector(x: 0, y: -1, z: 0),\n                                               \"inputBVector\": CIVector(x: 0, y: 0, z: -1),\n                                               \"inputBiasVector\": CIVector(x: 1, y: 1, z: 1)])\n            return filter?.outputImage\n        }\n    }\n}\n```\n\n## Chrome Key Filter Recipe\n\n\n\n- \n- CIColorCube\n- CISourceOverCompositing\n\n### \n\n3DCIColorCube--\n0RGBAHSVHSVH\n0120\nalphaRGBalphaalpha01.0.\n\n``` Swift\nlet size = 64\nlet count = size * size * size * 4\nlet cubeData = UnsafeMutablePointer<Float>.allocate(capacity: count)\nvar rgb: [Double] = [0, 0, 0], hsv: [Double] = [0, 0, 0]\nfor z in 0..<size {\n    rgb[2] = (Double(z)) / Double(size - 1)\n    for y in 0..<size {\n        rgb[1] = Double(y) / Double(size - 1)\n        for x in 0..<size {\n            rgb[0] = Double(x) / Double(size - 1)\n            // rgbToHSV(rgb, hsv)\n            let alpha = (hsv[0] > minHugAngle && hsv[0] < maxHueAngle) ? 0.0f : 1.0f\n            let offset = x * 4 + y * size * 4 + z * size * size * 4\n            cubeData[offset] = Float(rgb[0] * alpha)\n            cubeData[offset + 1] = Float(rgb[1] * alpha)\n            cubeData[offset + 2] = Float(rgb[2] * alpha)\n            cubeData[offset + 3] = Float(alpha)\n            cubeData.moveAssign(from: cubeData + 3, count: 4)\n        }\n    }\n}\nlet data = Data(bytesNoCopy: cubeData, count: count, deallocator: .free)\nlet colorCube = CIFilter(name: \"CIColorCube\")\ncolorCube?.setValue(NSNumber(value: size), forKey: \"inputCubeDimension\")\ncolorCube?.setValue(data, forKey: \"inputCubeData\")\n```\n\n### \n\n``` Swift\ncolorCube?.setValue(inputImage, forKey: kCIInputImageKey)\nlet result = colorCube?.outputImage\n```\n\n### \n\nCISourceOverCompositing\n- inputImage\n- inputBackgroundImage\n\n# Getting the Best Performance\n\nCore Image\n- \n- \n- \n- \n\n## \n\n- CIContext\n- \n- GPUCIImageCore AnimationCPU\n- CPUGPUCIContextCPUGPU\n- \n- UIImageView\n- CPUGPU\n- \n- iOS 6.0YUVYUVRGBACore ImageCVPixelBufferYUB\n\n# Creating Custom Filters\n\n[What You Need to Know Before Writing a Custom Filter](https://developer.apple.com/library/archive/documentation/GraphicsImaging/Conceptual/CoreImaging/ci_advanced_concepts/ci.advanced_concepts.html#//apple_ref/doc/uid/TP30001185-CH9-SW1)\n\n[Creating Custom Filters](https://developer.apple.com/library/archive/documentation/GraphicsImaging/Conceptual/CoreImaging/ci_custom_filters/ci_custom_filters.html#//apple_ref/doc/uid/TP30001185-CH6-TPXREF101)\n\n# Ending\n\n\n\n# Reference\n\n> [About Core Image](https://developer.apple.com/library/archive/documentation/GraphicsImaging/Conceptual/CoreImaging/ci_intro/ci_intro.html#//apple_ref/doc/uid/TP30001185-CH1-TPXREF101)","slug":"2019/core-image-study-0425","published":1,"updated":"2021-06-21T12:34:52.092Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckszp3ncz0008ifntj1uliqcn","content":"<h1 id=\"introduction\">Introduction</h1>\n<p>Core Image Core GraphicsCore VideoImage I/OGPUCPUCore ImageAPIOpenGLOpenGL ESMetalGPUGCDCore Image</p>\n<p><img src=\"/img/article/20190425/1.png\" alt=\"Core Image\"></p>\n<p>Core Image </p>\n<ul>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li>GPU</li>\n<li><br>\nMacOS</li>\n</ul>\n<h1 id=\"processing-images\">Processing Images</h1>\n<p>  CIFilterCIImageCore ImageCIContext</p>\n<p></p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> context = <span class=\"type\">CIContext</span>()</span><br><span class=\"line\"><span class=\"keyword\">let</span> <span class=\"built_in\">filter</span> = <span class=\"type\">CIFilter</span>(name: <span class=\"string\">\"CISepiaTone\"</span>)</span><br><span class=\"line\"><span class=\"built_in\">filter</span>?.setValue(<span class=\"number\">0.8</span>, forKey: kCIInputIntensityKey)</span><br><span class=\"line\"><span class=\"keyword\">let</span> image = <span class=\"type\">CIImage</span>(contentsOf: <span class=\"type\">Bundle</span>.main.url(forResource: <span class=\"string\">\"\"</span>, withExtension: <span class=\"string\">\"\"</span>)!)</span><br><span class=\"line\"><span class=\"built_in\">filter</span>?.setValue(image, forKey: kCIInputImageKey)</span><br><span class=\"line\"><span class=\"keyword\">let</span> result = <span class=\"built_in\">filter</span>?.outputImage</span><br><span class=\"line\"><span class=\"keyword\">if</span> <span class=\"keyword\">let</span> result = result &#123;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> cgImage = context.createCGImage(result, from: result.extent)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>CIImageCIImageCore Image </p>\n<p>CIImageCIImage</p>\n<ul>\n<li>URLNSData</li>\n<li>Quartz2DUIKitAppKitCGImageRefUIImageNSBitmapImageRep</li>\n<li>MetalOpenGLOpenGl ES</li>\n<li>CoreVideoCVImageBufferRefCVPixelBufferRef</li>\n<li>  IOSurfaceRef</li>\n<li>CIImageProvider</li>\n</ul>\n<p>CIImageCIFilteroutputImageCore Image</p>\n<h2 id=\"-\">  </h2>\n<p>CIFilterCIFilter<a href=\"https://developer.apple.com/library/archive/documentation/GraphicsImaging/Reference/CoreImageFilterReference/index.html#//apple_ref/doc/uid/TP40004346\" target=\"_blank\" rel=\"noopener\"></a></p>\n<h3 id=\"-\">  </h3>\n<p>Core ImageCIImage</p>\n<p><img src=\"/img/article/20190425/2.png\" alt=\"Construct a filter chain by connecting filter inputs and outputs\"></p>\n<p>Core Image CIImageCore ImageCore Image</p>\n<p><img src=\"/img/20190425/2.png\" alt=\"Core Image optimizes a filter chain to a single operation\"></p>\n<p>CropCore Image</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">applyFilterChain</span><span class=\"params\">(to image: CIImage)</span></span> -&gt; <span class=\"type\">CIImage</span>? &#123;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> colorFilter = <span class=\"type\">CIFilter</span>(name: <span class=\"string\">\"CIPhotoEffectProcess\"</span>, parameters: [kCIInputImageKey: image])</span><br><span class=\"line\">    <span class=\"keyword\">guard</span> <span class=\"keyword\">let</span> image = colorFilter?.outputImage <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"literal\">nil</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> bloomImage = image.applyingFilter(<span class=\"string\">\"CIBloom\"</span>, parameters: [kCIInputRadiusKey: <span class=\"number\">10.0</span>, kCIInputIntensityKey: <span class=\"number\">1.0</span>])</span><br><span class=\"line\">    <span class=\"keyword\">let</span> cropRect = <span class=\"type\">CGRect</span>(x: <span class=\"number\">0</span>, y: <span class=\"number\">0</span>, width: <span class=\"number\">150</span>, height: <span class=\"number\">150</span>)  <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">let</span> croppedImage = bloomImage.cropped(to: cropRect) <span class=\"comment\">// croped, clamped</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> croppedImage</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"\"></h3>\n<p><a href=\"https://developer.apple.com/library/archive/documentation/GraphicsImaging/Reference/CoreImageFilterReference/index.html#//apple_ref/doc/filter/ci/CIQRCodeGenerator\" target=\"_blank\" rel=\"noopener\"></a><br>\n<a href=\"https://developer.apple.com/library/archive/documentation/GraphicsImaging/Reference/CoreImageFilterReference/index.html#//apple_ref/doc/filter/ci/CICode128BarcodeGenerator\" target=\"_blank\" rel=\"noopener\"></a><br>\n<a href=\"https://developer.apple.com/library/archive/documentation/GraphicsImaging/Conceptual/CoreImaging/ci_tasks/ci_tasks.html#//apple_ref/doc/uid/TP30001185-CH3-DontLinkElementID_6\" target=\"_blank\" rel=\"noopener\"></a></p>\n<h2 id=\"core-image\">Core Image</h2>\n<p>MetalOpenGLOpenGL ESMetal</p>\n<h1 id=\"detecting-faces-in-an-image\">Detecting Faces in an Image</h1>\n<p>Core ImageCore Image</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"type\">DispatchQueue</span>.global().async &#123;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> image = <span class=\"type\">CIImage</span>(contentsOf: <span class=\"type\">Bundle</span>.main.url(forResource: <span class=\"string\">\"7\"</span>, withExtension: <span class=\"string\">\"jpg\"</span>)!)</span><br><span class=\"line\">    <span class=\"keyword\">let</span> context = <span class=\"type\">CIContext</span>()</span><br><span class=\"line\">    <span class=\"keyword\">let</span> opts = [<span class=\"type\">CIDetectorAccuracy</span>: <span class=\"type\">CIDetectorAccuracyHigh</span>]</span><br><span class=\"line\">    <span class=\"keyword\">let</span> detector = <span class=\"type\">CIDetector</span>(ofType: <span class=\"type\">CIDetectorTypeFace</span>, context: context, options: opts)</span><br><span class=\"line\">    <span class=\"keyword\">let</span> features = detector?.features(<span class=\"keyword\">in</span>: image!) <span class=\"keyword\">as</span>? [<span class=\"type\">CIFaceFeature</span>]</span><br><span class=\"line\">    <span class=\"keyword\">if</span> <span class=\"keyword\">let</span> features = features &#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> feature <span class=\"keyword\">in</span> features &#123;</span><br><span class=\"line\">            <span class=\"built_in\">print</span>(feature.bounds)</span><br><span class=\"line\">            </span><br><span class=\"line\">            <span class=\"keyword\">if</span> feature.hasLeftEyePosition &#123;</span><br><span class=\"line\">                <span class=\"built_in\">print</span>(<span class=\"string\">\"Left eye \\(feature.leftEyePosition.x) \\(feature.leftEyePosition.y)\"</span>)</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            </span><br><span class=\"line\">            <span class=\"keyword\">if</span> feature.hasRightEyePosition &#123;</span><br><span class=\"line\">                <span class=\"built_in\">print</span>(<span class=\"string\">\"Right eye \\(feature.rightEyePosition.x) \\(feature.rightEyePosition.y)\"</span>)</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            </span><br><span class=\"line\">            <span class=\"keyword\">if</span> feature.hasMouthPosition &#123;</span><br><span class=\"line\">                <span class=\"built_in\">print</span>(<span class=\"string\">\"Mouth \\(feature.mouthPosition)\"</span>)</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h1 id=\"auto-enhancing-images\">Auto Enhancing Images</h1>\n<p>Core ImageCIFilter</p>\n<p>Core Image</p>\n<ul>\n<li>CIRedEyeCorrection</li>\n<li>CIFaceBalance</li>\n<li>CIVibrance</li>\n<li>CIToneCurve</li>\n<li>CIHighlightShadowAdjust</li>\n</ul>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> adjustments = image.autoAdjustmentFilters()</span><br><span class=\"line\"><span class=\"keyword\">for</span> <span class=\"built_in\">filter</span> <span class=\"keyword\">in</span> adjustments &#123;</span><br><span class=\"line\">    <span class=\"built_in\">filter</span>.setValue(image, forKey: kCIInputImageKey)</span><br><span class=\"line\">    image = <span class=\"built_in\">filter</span>.outputImage!</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h1 id=\"subclassing-cifilter-reciptes-for-custom-effects\">Subclassing CIFilter: Reciptes for Custom Effects</h1>\n<p>CIFilter</p>\n<h2 id=\"subclassing-cifilter-to-create-the-cicolorinvert-filter\">Subclassing CIFilter to Create the CIColorInvert Filter</h2>\n<p>CIFilterCore Image<br>\n</p>\n<ul>\n<li><code>input</code><em>inputImage</em></li>\n<li><code>setDefaults</code></li>\n<li><code>outputImage</code></li>\n</ul>\n<p>Core ImageCIColorInvertCIColorMatrixCIColorInvertCIColorMatrix</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">CIColorInvert</span>: <span class=\"title\">CIFilter</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">var</span> inputImage: <span class=\"type\">CIImage</span>?</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">override</span> <span class=\"keyword\">var</span> outputImage: <span class=\"type\">CIImage</span>? &#123;</span><br><span class=\"line\">        <span class=\"keyword\">get</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">guard</span> <span class=\"keyword\">let</span> inputImage = inputImage <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                <span class=\"keyword\">return</span> <span class=\"literal\">nil</span></span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">let</span> <span class=\"built_in\">filter</span> = <span class=\"type\">CIFilter</span>(name: <span class=\"string\">\"CIColorMatrix\"</span>,</span><br><span class=\"line\">                                  parameters: [kCIInputImageKey: inputImage,</span><br><span class=\"line\">                                               <span class=\"string\">\"inputRVector\"</span>: <span class=\"type\">CIVector</span>(x: -<span class=\"number\">1</span>, y: <span class=\"number\">0</span>, z: <span class=\"number\">0</span>),</span><br><span class=\"line\">                                               <span class=\"string\">\"inputGVector\"</span>: <span class=\"type\">CIVector</span>(x: <span class=\"number\">0</span>, y: -<span class=\"number\">1</span>, z: <span class=\"number\">0</span>),</span><br><span class=\"line\">                                               <span class=\"string\">\"inputBVector\"</span>: <span class=\"type\">CIVector</span>(x: <span class=\"number\">0</span>, y: <span class=\"number\">0</span>, z: -<span class=\"number\">1</span>),</span><br><span class=\"line\">                                               <span class=\"string\">\"inputBiasVector\"</span>: <span class=\"type\">CIVector</span>(x: <span class=\"number\">1</span>, y: <span class=\"number\">1</span>, z: <span class=\"number\">1</span>)])</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"built_in\">filter</span>?.outputImage</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"chrome-key-filter-recipe\">Chrome Key Filter Recipe</h2>\n<p><br>\n</p>\n<ul>\n<li></li>\n<li>CIColorCube</li>\n<li>CISourceOverCompositing</li>\n</ul>\n<h3 id=\"\"></h3>\n<p>3DCIColorCube<br>\n0RGBAHSVHSVH<br>\n0120<br>\nalphaRGBalphaalpha01.0.</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> size = <span class=\"number\">64</span></span><br><span class=\"line\"><span class=\"keyword\">let</span> <span class=\"built_in\">count</span> = size * size * size * <span class=\"number\">4</span></span><br><span class=\"line\"><span class=\"keyword\">let</span> cubeData = <span class=\"type\">UnsafeMutablePointer</span>&lt;<span class=\"type\">Float</span>&gt;.allocate(capacity: <span class=\"built_in\">count</span>)</span><br><span class=\"line\"><span class=\"keyword\">var</span> rgb: [<span class=\"type\">Double</span>] = [<span class=\"number\">0</span>, <span class=\"number\">0</span>, <span class=\"number\">0</span>], hsv: [<span class=\"type\">Double</span>] = [<span class=\"number\">0</span>, <span class=\"number\">0</span>, <span class=\"number\">0</span>]</span><br><span class=\"line\"><span class=\"keyword\">for</span> z <span class=\"keyword\">in</span> <span class=\"number\">0</span>..&lt;size &#123;</span><br><span class=\"line\">    rgb[<span class=\"number\">2</span>] = (<span class=\"type\">Double</span>(z)) / <span class=\"type\">Double</span>(size - <span class=\"number\">1</span>)</span><br><span class=\"line\">    <span class=\"keyword\">for</span> y <span class=\"keyword\">in</span> <span class=\"number\">0</span>..&lt;size &#123;</span><br><span class=\"line\">        rgb[<span class=\"number\">1</span>] = <span class=\"type\">Double</span>(y) / <span class=\"type\">Double</span>(size - <span class=\"number\">1</span>)</span><br><span class=\"line\">        <span class=\"keyword\">for</span> x <span class=\"keyword\">in</span> <span class=\"number\">0</span>..&lt;size &#123;</span><br><span class=\"line\">            rgb[<span class=\"number\">0</span>] = <span class=\"type\">Double</span>(x) / <span class=\"type\">Double</span>(size - <span class=\"number\">1</span>)</span><br><span class=\"line\">            <span class=\"comment\">// rgbToHSV(rgb, hsv)</span></span><br><span class=\"line\">            <span class=\"keyword\">let</span> alpha = (hsv[<span class=\"number\">0</span>] &gt; minHugAngle &amp;&amp; hsv[<span class=\"number\">0</span>] &lt; maxHueAngle) ? <span class=\"number\">0</span>.0f : <span class=\"number\">1</span>.0f</span><br><span class=\"line\">            <span class=\"keyword\">let</span> offset = x * <span class=\"number\">4</span> + y * size * <span class=\"number\">4</span> + z * size * size * <span class=\"number\">4</span></span><br><span class=\"line\">            cubeData[offset] = <span class=\"type\">Float</span>(rgb[<span class=\"number\">0</span>] * alpha)</span><br><span class=\"line\">            cubeData[offset + <span class=\"number\">1</span>] = <span class=\"type\">Float</span>(rgb[<span class=\"number\">1</span>] * alpha)</span><br><span class=\"line\">            cubeData[offset + <span class=\"number\">2</span>] = <span class=\"type\">Float</span>(rgb[<span class=\"number\">2</span>] * alpha)</span><br><span class=\"line\">            cubeData[offset + <span class=\"number\">3</span>] = <span class=\"type\">Float</span>(alpha)</span><br><span class=\"line\">            cubeData.moveAssign(from: cubeData + <span class=\"number\">3</span>, <span class=\"built_in\">count</span>: <span class=\"number\">4</span>)</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">let</span> data = <span class=\"type\">Data</span>(bytesNoCopy: cubeData, <span class=\"built_in\">count</span>: <span class=\"built_in\">count</span>, deallocator: .free)</span><br><span class=\"line\"><span class=\"keyword\">let</span> colorCube = <span class=\"type\">CIFilter</span>(name: <span class=\"string\">\"CIColorCube\"</span>)</span><br><span class=\"line\">colorCube?.setValue(<span class=\"type\">NSNumber</span>(value: size), forKey: <span class=\"string\">\"inputCubeDimension\"</span>)</span><br><span class=\"line\">colorCube?.setValue(data, forKey: <span class=\"string\">\"inputCubeData\"</span>)</span><br></pre></td></tr></table></figure>\n<h3 id=\"\"></h3>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">colorCube?.setValue(inputImage, forKey: kCIInputImageKey)</span><br><span class=\"line\"><span class=\"keyword\">let</span> result = colorCube?.outputImage</span><br></pre></td></tr></table></figure>\n<h3 id=\"\"></h3>\n<p>CISourceOverCompositing</p>\n<ul>\n<li>inputImage</li>\n<li>inputBackgroundImage</li>\n</ul>\n<h1 id=\"getting-the-best-performance\">Getting the Best Performance</h1>\n<p>Core Image</p>\n<ul>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n<h2 id=\"\"></h2>\n<ul>\n<li>CIContext</li>\n<li></li>\n<li>GPUCIImageCore AnimationCPU</li>\n<li>CPUGPUCIContextCPUGPU</li>\n<li></li>\n<li>UIImageView</li>\n<li>CPUGPU</li>\n<li></li>\n<li>iOS 6.0YUVYUVRGBACore ImageCVPixelBufferYUB</li>\n</ul>\n<h1 id=\"creating-custom-filters\">Creating Custom Filters</h1>\n<p><a href=\"https://developer.apple.com/library/archive/documentation/GraphicsImaging/Conceptual/CoreImaging/ci_advanced_concepts/ci.advanced_concepts.html#//apple_ref/doc/uid/TP30001185-CH9-SW1\" target=\"_blank\" rel=\"noopener\">What You Need to Know Before Writing a Custom Filter</a></p>\n<p><a href=\"https://developer.apple.com/library/archive/documentation/GraphicsImaging/Conceptual/CoreImaging/ci_custom_filters/ci_custom_filters.html#//apple_ref/doc/uid/TP30001185-CH6-TPXREF101\" target=\"_blank\" rel=\"noopener\">Creating Custom Filters</a></p>\n<h1 id=\"ending\">Ending</h1>\n<p></p>\n<h1 id=\"reference\">Reference</h1>\n<blockquote>\n<p><a href=\"https://developer.apple.com/library/archive/documentation/GraphicsImaging/Conceptual/CoreImaging/ci_intro/ci_intro.html#//apple_ref/doc/uid/TP30001185-CH1-TPXREF101\" target=\"_blank\" rel=\"noopener\">About Core Image</a></p>\n</blockquote>\n","site":{"data":{}},"excerpt":"","more":"<h1>Introduction</h1>\n<p>Core Image Core GraphicsCore VideoImage I/OGPUCPUCore ImageAPIOpenGLOpenGL ESMetalGPUGCDCore Image</p>\n<p><img src=\"/img/article/20190425/1.png\" alt=\"Core Image\"></p>\n<p>Core Image </p>\n<ul>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li>GPU</li>\n<li><br>\nMacOS</li>\n</ul>\n<h1>Processing Images</h1>\n<p>  CIFilterCIImageCore ImageCIContext</p>\n<p></p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> context = <span class=\"type\">CIContext</span>()</span><br><span class=\"line\"><span class=\"keyword\">let</span> <span class=\"built_in\">filter</span> = <span class=\"type\">CIFilter</span>(name: <span class=\"string\">\"CISepiaTone\"</span>)</span><br><span class=\"line\"><span class=\"built_in\">filter</span>?.setValue(<span class=\"number\">0.8</span>, forKey: kCIInputIntensityKey)</span><br><span class=\"line\"><span class=\"keyword\">let</span> image = <span class=\"type\">CIImage</span>(contentsOf: <span class=\"type\">Bundle</span>.main.url(forResource: <span class=\"string\">\"\"</span>, withExtension: <span class=\"string\">\"\"</span>)!)</span><br><span class=\"line\"><span class=\"built_in\">filter</span>?.setValue(image, forKey: kCIInputImageKey)</span><br><span class=\"line\"><span class=\"keyword\">let</span> result = <span class=\"built_in\">filter</span>?.outputImage</span><br><span class=\"line\"><span class=\"keyword\">if</span> <span class=\"keyword\">let</span> result = result &#123;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> cgImage = context.createCGImage(result, from: result.extent)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>CIImageCIImageCore Image </p>\n<p>CIImageCIImage</p>\n<ul>\n<li>URLNSData</li>\n<li>Quartz2DUIKitAppKitCGImageRefUIImageNSBitmapImageRep</li>\n<li>MetalOpenGLOpenGl ES</li>\n<li>CoreVideoCVImageBufferRefCVPixelBufferRef</li>\n<li>  IOSurfaceRef</li>\n<li>CIImageProvider</li>\n</ul>\n<p>CIImageCIFilteroutputImageCore Image</p>\n<h2>  </h2>\n<p>CIFilterCIFilter<a href=\"https://developer.apple.com/library/archive/documentation/GraphicsImaging/Reference/CoreImageFilterReference/index.html#//apple_ref/doc/uid/TP40004346\" target=\"_blank\" rel=\"noopener\"></a></p>\n<h3>  </h3>\n<p>Core ImageCIImage</p>\n<p><img src=\"/img/article/20190425/2.png\" alt=\"Construct a filter chain by connecting filter inputs and outputs\"></p>\n<p>Core Image CIImageCore ImageCore Image</p>\n<p><img src=\"/img/20190425/2.png\" alt=\"Core Image optimizes a filter chain to a single operation\"></p>\n<p>CropCore Image</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">applyFilterChain</span><span class=\"params\">(to image: CIImage)</span></span> -&gt; <span class=\"type\">CIImage</span>? &#123;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> colorFilter = <span class=\"type\">CIFilter</span>(name: <span class=\"string\">\"CIPhotoEffectProcess\"</span>, parameters: [kCIInputImageKey: image])</span><br><span class=\"line\">    <span class=\"keyword\">guard</span> <span class=\"keyword\">let</span> image = colorFilter?.outputImage <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"literal\">nil</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> bloomImage = image.applyingFilter(<span class=\"string\">\"CIBloom\"</span>, parameters: [kCIInputRadiusKey: <span class=\"number\">10.0</span>, kCIInputIntensityKey: <span class=\"number\">1.0</span>])</span><br><span class=\"line\">    <span class=\"keyword\">let</span> cropRect = <span class=\"type\">CGRect</span>(x: <span class=\"number\">0</span>, y: <span class=\"number\">0</span>, width: <span class=\"number\">150</span>, height: <span class=\"number\">150</span>)  <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">let</span> croppedImage = bloomImage.cropped(to: cropRect) <span class=\"comment\">// croped, clamped</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> croppedImage</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3></h3>\n<p><a href=\"https://developer.apple.com/library/archive/documentation/GraphicsImaging/Reference/CoreImageFilterReference/index.html#//apple_ref/doc/filter/ci/CIQRCodeGenerator\" target=\"_blank\" rel=\"noopener\"></a><br>\n<a href=\"https://developer.apple.com/library/archive/documentation/GraphicsImaging/Reference/CoreImageFilterReference/index.html#//apple_ref/doc/filter/ci/CICode128BarcodeGenerator\" target=\"_blank\" rel=\"noopener\"></a><br>\n<a href=\"https://developer.apple.com/library/archive/documentation/GraphicsImaging/Conceptual/CoreImaging/ci_tasks/ci_tasks.html#//apple_ref/doc/uid/TP30001185-CH3-DontLinkElementID_6\" target=\"_blank\" rel=\"noopener\"></a></p>\n<h2>Core Image</h2>\n<p>MetalOpenGLOpenGL ESMetal</p>\n<h1>Detecting Faces in an Image</h1>\n<p>Core ImageCore Image</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"type\">DispatchQueue</span>.global().async &#123;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> image = <span class=\"type\">CIImage</span>(contentsOf: <span class=\"type\">Bundle</span>.main.url(forResource: <span class=\"string\">\"7\"</span>, withExtension: <span class=\"string\">\"jpg\"</span>)!)</span><br><span class=\"line\">    <span class=\"keyword\">let</span> context = <span class=\"type\">CIContext</span>()</span><br><span class=\"line\">    <span class=\"keyword\">let</span> opts = [<span class=\"type\">CIDetectorAccuracy</span>: <span class=\"type\">CIDetectorAccuracyHigh</span>]</span><br><span class=\"line\">    <span class=\"keyword\">let</span> detector = <span class=\"type\">CIDetector</span>(ofType: <span class=\"type\">CIDetectorTypeFace</span>, context: context, options: opts)</span><br><span class=\"line\">    <span class=\"keyword\">let</span> features = detector?.features(<span class=\"keyword\">in</span>: image!) <span class=\"keyword\">as</span>? [<span class=\"type\">CIFaceFeature</span>]</span><br><span class=\"line\">    <span class=\"keyword\">if</span> <span class=\"keyword\">let</span> features = features &#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> feature <span class=\"keyword\">in</span> features &#123;</span><br><span class=\"line\">            <span class=\"built_in\">print</span>(feature.bounds)</span><br><span class=\"line\">            </span><br><span class=\"line\">            <span class=\"keyword\">if</span> feature.hasLeftEyePosition &#123;</span><br><span class=\"line\">                <span class=\"built_in\">print</span>(<span class=\"string\">\"Left eye \\(feature.leftEyePosition.x) \\(feature.leftEyePosition.y)\"</span>)</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            </span><br><span class=\"line\">            <span class=\"keyword\">if</span> feature.hasRightEyePosition &#123;</span><br><span class=\"line\">                <span class=\"built_in\">print</span>(<span class=\"string\">\"Right eye \\(feature.rightEyePosition.x) \\(feature.rightEyePosition.y)\"</span>)</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            </span><br><span class=\"line\">            <span class=\"keyword\">if</span> feature.hasMouthPosition &#123;</span><br><span class=\"line\">                <span class=\"built_in\">print</span>(<span class=\"string\">\"Mouth \\(feature.mouthPosition)\"</span>)</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h1>Auto Enhancing Images</h1>\n<p>Core ImageCIFilter</p>\n<p>Core Image</p>\n<ul>\n<li>CIRedEyeCorrection</li>\n<li>CIFaceBalance</li>\n<li>CIVibrance</li>\n<li>CIToneCurve</li>\n<li>CIHighlightShadowAdjust</li>\n</ul>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> adjustments = image.autoAdjustmentFilters()</span><br><span class=\"line\"><span class=\"keyword\">for</span> <span class=\"built_in\">filter</span> <span class=\"keyword\">in</span> adjustments &#123;</span><br><span class=\"line\">    <span class=\"built_in\">filter</span>.setValue(image, forKey: kCIInputImageKey)</span><br><span class=\"line\">    image = <span class=\"built_in\">filter</span>.outputImage!</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h1>Subclassing CIFilter: Reciptes for Custom Effects</h1>\n<p>CIFilter</p>\n<h2>Subclassing CIFilter to Create the CIColorInvert Filter</h2>\n<p>CIFilterCore Image<br>\n</p>\n<ul>\n<li><code>input</code><em>inputImage</em></li>\n<li><code>setDefaults</code></li>\n<li><code>outputImage</code></li>\n</ul>\n<p>Core ImageCIColorInvertCIColorMatrixCIColorInvertCIColorMatrix</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">CIColorInvert</span>: <span class=\"title\">CIFilter</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">var</span> inputImage: <span class=\"type\">CIImage</span>?</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">override</span> <span class=\"keyword\">var</span> outputImage: <span class=\"type\">CIImage</span>? &#123;</span><br><span class=\"line\">        <span class=\"keyword\">get</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">guard</span> <span class=\"keyword\">let</span> inputImage = inputImage <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                <span class=\"keyword\">return</span> <span class=\"literal\">nil</span></span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">let</span> <span class=\"built_in\">filter</span> = <span class=\"type\">CIFilter</span>(name: <span class=\"string\">\"CIColorMatrix\"</span>,</span><br><span class=\"line\">                                  parameters: [kCIInputImageKey: inputImage,</span><br><span class=\"line\">                                               <span class=\"string\">\"inputRVector\"</span>: <span class=\"type\">CIVector</span>(x: -<span class=\"number\">1</span>, y: <span class=\"number\">0</span>, z: <span class=\"number\">0</span>),</span><br><span class=\"line\">                                               <span class=\"string\">\"inputGVector\"</span>: <span class=\"type\">CIVector</span>(x: <span class=\"number\">0</span>, y: -<span class=\"number\">1</span>, z: <span class=\"number\">0</span>),</span><br><span class=\"line\">                                               <span class=\"string\">\"inputBVector\"</span>: <span class=\"type\">CIVector</span>(x: <span class=\"number\">0</span>, y: <span class=\"number\">0</span>, z: -<span class=\"number\">1</span>),</span><br><span class=\"line\">                                               <span class=\"string\">\"inputBiasVector\"</span>: <span class=\"type\">CIVector</span>(x: <span class=\"number\">1</span>, y: <span class=\"number\">1</span>, z: <span class=\"number\">1</span>)])</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"built_in\">filter</span>?.outputImage</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2>Chrome Key Filter Recipe</h2>\n<p><br>\n</p>\n<ul>\n<li></li>\n<li>CIColorCube</li>\n<li>CISourceOverCompositing</li>\n</ul>\n<h3></h3>\n<p>3DCIColorCube<br>\n0RGBAHSVHSVH<br>\n0120<br>\nalphaRGBalphaalpha01.0.</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> size = <span class=\"number\">64</span></span><br><span class=\"line\"><span class=\"keyword\">let</span> <span class=\"built_in\">count</span> = size * size * size * <span class=\"number\">4</span></span><br><span class=\"line\"><span class=\"keyword\">let</span> cubeData = <span class=\"type\">UnsafeMutablePointer</span>&lt;<span class=\"type\">Float</span>&gt;.allocate(capacity: <span class=\"built_in\">count</span>)</span><br><span class=\"line\"><span class=\"keyword\">var</span> rgb: [<span class=\"type\">Double</span>] = [<span class=\"number\">0</span>, <span class=\"number\">0</span>, <span class=\"number\">0</span>], hsv: [<span class=\"type\">Double</span>] = [<span class=\"number\">0</span>, <span class=\"number\">0</span>, <span class=\"number\">0</span>]</span><br><span class=\"line\"><span class=\"keyword\">for</span> z <span class=\"keyword\">in</span> <span class=\"number\">0</span>..&lt;size &#123;</span><br><span class=\"line\">    rgb[<span class=\"number\">2</span>] = (<span class=\"type\">Double</span>(z)) / <span class=\"type\">Double</span>(size - <span class=\"number\">1</span>)</span><br><span class=\"line\">    <span class=\"keyword\">for</span> y <span class=\"keyword\">in</span> <span class=\"number\">0</span>..&lt;size &#123;</span><br><span class=\"line\">        rgb[<span class=\"number\">1</span>] = <span class=\"type\">Double</span>(y) / <span class=\"type\">Double</span>(size - <span class=\"number\">1</span>)</span><br><span class=\"line\">        <span class=\"keyword\">for</span> x <span class=\"keyword\">in</span> <span class=\"number\">0</span>..&lt;size &#123;</span><br><span class=\"line\">            rgb[<span class=\"number\">0</span>] = <span class=\"type\">Double</span>(x) / <span class=\"type\">Double</span>(size - <span class=\"number\">1</span>)</span><br><span class=\"line\">            <span class=\"comment\">// rgbToHSV(rgb, hsv)</span></span><br><span class=\"line\">            <span class=\"keyword\">let</span> alpha = (hsv[<span class=\"number\">0</span>] &gt; minHugAngle &amp;&amp; hsv[<span class=\"number\">0</span>] &lt; maxHueAngle) ? <span class=\"number\">0</span>.0f : <span class=\"number\">1</span>.0f</span><br><span class=\"line\">            <span class=\"keyword\">let</span> offset = x * <span class=\"number\">4</span> + y * size * <span class=\"number\">4</span> + z * size * size * <span class=\"number\">4</span></span><br><span class=\"line\">            cubeData[offset] = <span class=\"type\">Float</span>(rgb[<span class=\"number\">0</span>] * alpha)</span><br><span class=\"line\">            cubeData[offset + <span class=\"number\">1</span>] = <span class=\"type\">Float</span>(rgb[<span class=\"number\">1</span>] * alpha)</span><br><span class=\"line\">            cubeData[offset + <span class=\"number\">2</span>] = <span class=\"type\">Float</span>(rgb[<span class=\"number\">2</span>] * alpha)</span><br><span class=\"line\">            cubeData[offset + <span class=\"number\">3</span>] = <span class=\"type\">Float</span>(alpha)</span><br><span class=\"line\">            cubeData.moveAssign(from: cubeData + <span class=\"number\">3</span>, <span class=\"built_in\">count</span>: <span class=\"number\">4</span>)</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">let</span> data = <span class=\"type\">Data</span>(bytesNoCopy: cubeData, <span class=\"built_in\">count</span>: <span class=\"built_in\">count</span>, deallocator: .free)</span><br><span class=\"line\"><span class=\"keyword\">let</span> colorCube = <span class=\"type\">CIFilter</span>(name: <span class=\"string\">\"CIColorCube\"</span>)</span><br><span class=\"line\">colorCube?.setValue(<span class=\"type\">NSNumber</span>(value: size), forKey: <span class=\"string\">\"inputCubeDimension\"</span>)</span><br><span class=\"line\">colorCube?.setValue(data, forKey: <span class=\"string\">\"inputCubeData\"</span>)</span><br></pre></td></tr></table></figure>\n<h3></h3>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">colorCube?.setValue(inputImage, forKey: kCIInputImageKey)</span><br><span class=\"line\"><span class=\"keyword\">let</span> result = colorCube?.outputImage</span><br></pre></td></tr></table></figure>\n<h3></h3>\n<p>CISourceOverCompositing</p>\n<ul>\n<li>inputImage</li>\n<li>inputBackgroundImage</li>\n</ul>\n<h1>Getting the Best Performance</h1>\n<p>Core Image</p>\n<ul>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n<h2></h2>\n<ul>\n<li>CIContext</li>\n<li></li>\n<li>GPUCIImageCore AnimationCPU</li>\n<li>CPUGPUCIContextCPUGPU</li>\n<li></li>\n<li>UIImageView</li>\n<li>CPUGPU</li>\n<li></li>\n<li>iOS 6.0YUVYUVRGBACore ImageCVPixelBufferYUB</li>\n</ul>\n<h1>Creating Custom Filters</h1>\n<p><a href=\"https://developer.apple.com/library/archive/documentation/GraphicsImaging/Conceptual/CoreImaging/ci_advanced_concepts/ci.advanced_concepts.html#//apple_ref/doc/uid/TP30001185-CH9-SW1\" target=\"_blank\" rel=\"noopener\">What You Need to Know Before Writing a Custom Filter</a></p>\n<p><a href=\"https://developer.apple.com/library/archive/documentation/GraphicsImaging/Conceptual/CoreImaging/ci_custom_filters/ci_custom_filters.html#//apple_ref/doc/uid/TP30001185-CH6-TPXREF101\" target=\"_blank\" rel=\"noopener\">Creating Custom Filters</a></p>\n<h1>Ending</h1>\n<p></p>\n<h1>Reference</h1>\n<blockquote>\n<p><a href=\"https://developer.apple.com/library/archive/documentation/GraphicsImaging/Conceptual/CoreImaging/ci_intro/ci_intro.html#//apple_ref/doc/uid/TP30001185-CH1-TPXREF101\" target=\"_blank\" rel=\"noopener\">About Core Image</a></p>\n</blockquote>\n"},{"title":" GitHub ","catalog":true,"toc_nav_num":true,"date":"2019-02-12T05:40:24.000Z","subtitle":" Hexo  GitHub Pages","header-img":"/img/article_header/article_header.png","busuanzi":true,"_content":"\n# Introduction\n\n\n\n GitHub GitHub\n\n\n\n# Build GitHub Pages  \n\n1.  [GitHub](https://github.com/new) \n![GitHub](/img/article/20190212/1.png)\n\n2.  Setting GitHub Pages\n![GitHub](/img/article/20190212/2.png)\n **.github.io** \n\n# Set Up Hexo  \n\n1.  [Hexo](https://github.com/hexojs/hexo)\n``` Shell\n$ npm install hexo-cli -g\n```\n\n2. Hexo \n``` Shell\nhexo n == hexo new \nhexo g == hexo generate \nhexo s == hexo server \nhexo d == hexo deploy \nhexo clean \n```\n blog [](http://localhost:4000/)\n\n3.  [themes](https://hexo.io/themes/)\n blog \n``` Shell\nhexo clean\ngit clone https://github.com/huweihuang/hexo-theme-huweihuang.git ./hexo-huweihuang \n```\n blog  _config.yml  theme \n\n4.  GitHub\n _config.yml \n![blog](/img/article/20190212/3.png)\n **hexo d** GitHub\n\n# More Questions\n\n _config.yml  blog \n\n\n## Page View statistics - \n\n> \n\n1. \n``` JavaScript\n<script async src=\"//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js\">\n</script>\n```\n *themes/layout/_partial/footer.ejs* \n\n2. \n\napvnn\n``` CSS\n<span id=\"busuanzi_container_site_pv\">\n    <span id=\"busuanzi_value_site_pv\"></span>\n</span>\n```\nbuvn1\n``` CSS\n<span id=\"busuanzi_container_site_uv\">\n  <span id=\"busuanzi_value_site_uv\"></span>\n</span>\n```\n\n3. \npv11\n``` CSS\n<span id=\"busuanzi_container_page_pv\">\n  <span id=\"busuanzi_value_page_pv\"></span>\n</span>\n```\n\n4. \n''+stylecss\n- busuanzi_value_site_pv id\n- busuanzi_container_site_pv3id\n\n``` CSS\n<span id=\"busuanzi_value_site_pv\"></span>\n<span id=\"busuanzi_value_site_uv\"></span>\n<span id=\"busuanzi_value_page_pv\"></span>\n```\n\n## Add comments module - Disqus\n\n> 201761..\n\n   Disqus  _config.yml  disqus_username \n``` Shell\n# Disqus settings\ndisqus_username: username\n```\n\n\n1.  [Disqus](https://disqus.com) **-View Profile** disqus_username \n\n2. **-Install on Site** Shortname,  disqus_username \n![Disqus](/img/article/20190212/4.png)\n*We were unable to load Disqus.*\n\n3.  [issue #876](https://github.com/iissnan/hexo-theme-next/issues/876) disqus_url disqus_identifier Disqus  `window.location.href`Hexo \n\n# End\n\n\n2019\n\n# Reference\n\n> [Github Pages](https://www.cnblogs.com/jackyroc/p/7681938.html)\n> [](http://ibruce.info/2015/04/04/busuanzi/)\n> [Disqus](https://www.jianshu.com/p/7e4453421b8f)","source":"_posts/2019/create-github-pages-0212.md","raw":"---\ntitle: \" GitHub \"\ncatalog: true\ntoc_nav_num: true\ndate: 2019-02-12 13:40:24\nsubtitle: \" Hexo  GitHub Pages\"\nheader-img: \"/img/article_header/article_header.png\"\nbusuanzi: true\ntags:\n- GitHub\n\n---\n\n# Introduction\n\n\n\n GitHub GitHub\n\n\n\n# Build GitHub Pages  \n\n1.  [GitHub](https://github.com/new) \n![GitHub](/img/article/20190212/1.png)\n\n2.  Setting GitHub Pages\n![GitHub](/img/article/20190212/2.png)\n **.github.io** \n\n# Set Up Hexo  \n\n1.  [Hexo](https://github.com/hexojs/hexo)\n``` Shell\n$ npm install hexo-cli -g\n```\n\n2. Hexo \n``` Shell\nhexo n == hexo new \nhexo g == hexo generate \nhexo s == hexo server \nhexo d == hexo deploy \nhexo clean \n```\n blog [](http://localhost:4000/)\n\n3.  [themes](https://hexo.io/themes/)\n blog \n``` Shell\nhexo clean\ngit clone https://github.com/huweihuang/hexo-theme-huweihuang.git ./hexo-huweihuang \n```\n blog  _config.yml  theme \n\n4.  GitHub\n _config.yml \n![blog](/img/article/20190212/3.png)\n **hexo d** GitHub\n\n# More Questions\n\n _config.yml  blog \n\n\n## Page View statistics - \n\n> \n\n1. \n``` JavaScript\n<script async src=\"//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js\">\n</script>\n```\n *themes/layout/_partial/footer.ejs* \n\n2. \n\napvnn\n``` CSS\n<span id=\"busuanzi_container_site_pv\">\n    <span id=\"busuanzi_value_site_pv\"></span>\n</span>\n```\nbuvn1\n``` CSS\n<span id=\"busuanzi_container_site_uv\">\n  <span id=\"busuanzi_value_site_uv\"></span>\n</span>\n```\n\n3. \npv11\n``` CSS\n<span id=\"busuanzi_container_page_pv\">\n  <span id=\"busuanzi_value_page_pv\"></span>\n</span>\n```\n\n4. \n''+stylecss\n- busuanzi_value_site_pv id\n- busuanzi_container_site_pv3id\n\n``` CSS\n<span id=\"busuanzi_value_site_pv\"></span>\n<span id=\"busuanzi_value_site_uv\"></span>\n<span id=\"busuanzi_value_page_pv\"></span>\n```\n\n## Add comments module - Disqus\n\n> 201761..\n\n   Disqus  _config.yml  disqus_username \n``` Shell\n# Disqus settings\ndisqus_username: username\n```\n\n\n1.  [Disqus](https://disqus.com) **-View Profile** disqus_username \n\n2. **-Install on Site** Shortname,  disqus_username \n![Disqus](/img/article/20190212/4.png)\n*We were unable to load Disqus.*\n\n3.  [issue #876](https://github.com/iissnan/hexo-theme-next/issues/876) disqus_url disqus_identifier Disqus  `window.location.href`Hexo \n\n# End\n\n\n2019\n\n# Reference\n\n> [Github Pages](https://www.cnblogs.com/jackyroc/p/7681938.html)\n> [](http://ibruce.info/2015/04/04/busuanzi/)\n> [Disqus](https://www.jianshu.com/p/7e4453421b8f)","slug":"2019/create-github-pages-0212","published":1,"updated":"2021-06-21T12:34:52.092Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckszp3nd00009ifntzkqo6g27","content":"<h1 id=\"introduction\">Introduction</h1>\n<p></p>\n<p> GitHub GitHub</p>\n<p></p>\n<h1 id=\"build-github-pages\">Build GitHub Pages</h1>\n<ol>\n<li>\n<p> <a href=\"https://github.com/new\" target=\"_blank\" rel=\"noopener\">GitHub</a> <br>\n<img src=\"/img/article/20190212/1.png\" alt=\"GitHub\"></p>\n</li>\n<li>\n<p> Setting GitHub Pages<br>\n<img src=\"/img/article/20190212/2.png\" alt=\"GitHub\"><br>\n <strong><a href=\"http://xn--eqr924avxo.github.io\" target=\"_blank\" rel=\"noopener\">.github.io</a></strong> </p>\n</li>\n</ol>\n<h1 id=\"set-up-hexo\">Set Up Hexo</h1>\n<ol>\n<li> <a href=\"https://github.com/hexojs/hexo\" target=\"_blank\" rel=\"noopener\">Hexo</a></li>\n</ol>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> npm install hexo-cli -g</span></span><br></pre></td></tr></table></figure>\n<ol start=\"2\">\n<li>Hexo </li>\n</ol>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">hexo n == hexo new </span><br><span class=\"line\">hexo g == hexo generate </span><br><span class=\"line\">hexo s == hexo server </span><br><span class=\"line\">hexo d == hexo deploy </span><br><span class=\"line\">hexo clean </span><br></pre></td></tr></table></figure>\n<p> blog <a href=\"http://localhost:4000/\" target=\"_blank\" rel=\"noopener\"></a></p>\n<ol start=\"3\">\n<li> <a href=\"https://hexo.io/themes/\" target=\"_blank\" rel=\"noopener\">themes</a><br>\n blog </li>\n</ol>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">hexo clean</span><br><span class=\"line\">git clone https://github.com/huweihuang/hexo-theme-huweihuang.git ./hexo-huweihuang </span><br></pre></td></tr></table></figure>\n<p> blog  _config.yml  theme </p>\n<ol start=\"4\">\n<li> GitHub<br>\n _config.yml <br>\n<img src=\"/img/article/20190212/3.png\" alt=\"blog\"><br>\n <strong>hexo d</strong> GitHub</li>\n</ol>\n<h1 id=\"more-questions\">More Questions</h1>\n<p> _config.yml  blog <br>\n</p>\n<h2 id=\"page-view-statistics-\">Page View statistics - </h2>\n<blockquote>\n<p></p>\n</blockquote>\n<ol>\n<li></li>\n</ol>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;script <span class=\"keyword\">async</span> src=<span class=\"string\">\"//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js\"</span>&gt;</span><br><span class=\"line\">&lt;<span class=\"regexp\">/script&gt;</span></span><br></pre></td></tr></table></figure>\n<p> <em>themes/layout/_partial/footer.ejs</em> </p>\n<ol start=\"2\">\n<li><br>\n<br>\napvnn</li>\n</ol>\n<figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;span id=\"busuanzi_container_site_pv\"&gt;</span><br><span class=\"line\">    &lt;span id=\"busuanzi_value_site_pv\"&gt;&lt;/span&gt;</span><br><span class=\"line\">&lt;/span&gt;</span><br></pre></td></tr></table></figure>\n<p>buvn1</p>\n<figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;span id=\"busuanzi_container_site_uv\"&gt;</span><br><span class=\"line\">  &lt;span id=\"busuanzi_value_site_uv\"&gt;&lt;/span&gt;</span><br><span class=\"line\">&lt;/span&gt;</span><br></pre></td></tr></table></figure>\n<ol start=\"3\">\n<li><br>\npv11</li>\n</ol>\n<figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;span id=\"busuanzi_container_page_pv\"&gt;</span><br><span class=\"line\">  &lt;span id=\"busuanzi_value_page_pv\"&gt;&lt;/span&gt;</span><br><span class=\"line\">&lt;/span&gt;</span><br></pre></td></tr></table></figure>\n<ol start=\"4\">\n<li><br>\n+stylecss</li>\n</ol>\n<ul>\n<li>busuanzi_value_site_pv id</li>\n<li>busuanzi_container_site_pv3id<br>\n</li>\n</ul>\n<figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;span id=\"busuanzi_value_site_pv\"&gt;&lt;/span&gt;</span><br><span class=\"line\">&lt;span id=\"busuanzi_value_site_uv\"&gt;&lt;/span&gt;</span><br><span class=\"line\">&lt;span id=\"busuanzi_value_page_pv\"&gt;&lt;/span&gt;</span><br></pre></td></tr></table></figure>\n<h2 id=\"add-comments-module-disqus\">Add comments module - Disqus</h2>\n<blockquote>\n<p>201761</p>\n</blockquote>\n<p>   Disqus  _config.yml  disqus_username </p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> Disqus settings</span></span><br><span class=\"line\">disqus_username: username</span><br></pre></td></tr></table></figure>\n<p></p>\n<ol>\n<li>\n<p> <a href=\"https://disqus.com\" target=\"_blank\" rel=\"noopener\">Disqus</a> <strong>-View Profile</strong> disqus_username </p>\n</li>\n<li>\n<p><strong>-Install on Site</strong> Shortname,  disqus_username <br>\n<img src=\"/img/article/20190212/4.png\" alt=\"Disqus\"><br>\n<em>We were unable to load Disqus.</em></p>\n</li>\n<li>\n<p> <a href=\"https://github.com/iissnan/hexo-theme-next/issues/876\" target=\"_blank\" rel=\"noopener\">issue #876</a> disqus_url disqus_identifier Disqus  <code>window.location.href</code>Hexo </p>\n</li>\n</ol>\n<h1 id=\"end\">End</h1>\n<p><br>\n2019</p>\n<h1 id=\"reference\">Reference</h1>\n<blockquote>\n<p><a href=\"https://www.cnblogs.com/jackyroc/p/7681938.html\" target=\"_blank\" rel=\"noopener\">Github Pages</a><br>\n<a href=\"http://ibruce.info/2015/04/04/busuanzi/\" target=\"_blank\" rel=\"noopener\"></a><br>\n<a href=\"https://www.jianshu.com/p/7e4453421b8f\" target=\"_blank\" rel=\"noopener\">Disqus</a></p>\n</blockquote>\n","site":{"data":{}},"excerpt":"","more":"<h1>Introduction</h1>\n<p></p>\n<p> GitHub GitHub</p>\n<p></p>\n<h1>Build GitHub Pages</h1>\n<ol>\n<li>\n<p> <a href=\"https://github.com/new\" target=\"_blank\" rel=\"noopener\">GitHub</a> <br>\n<img src=\"/img/article/20190212/1.png\" alt=\"GitHub\"></p>\n</li>\n<li>\n<p> Setting GitHub Pages<br>\n<img src=\"/img/article/20190212/2.png\" alt=\"GitHub\"><br>\n <strong><a href=\"http://xn--eqr924avxo.github.io\" target=\"_blank\" rel=\"noopener\">.github.io</a></strong> </p>\n</li>\n</ol>\n<h1>Set Up Hexo</h1>\n<ol>\n<li> <a href=\"https://github.com/hexojs/hexo\" target=\"_blank\" rel=\"noopener\">Hexo</a></li>\n</ol>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> npm install hexo-cli -g</span></span><br></pre></td></tr></table></figure>\n<ol start=\"2\">\n<li>Hexo </li>\n</ol>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">hexo n == hexo new </span><br><span class=\"line\">hexo g == hexo generate </span><br><span class=\"line\">hexo s == hexo server </span><br><span class=\"line\">hexo d == hexo deploy </span><br><span class=\"line\">hexo clean </span><br></pre></td></tr></table></figure>\n<p> blog <a href=\"http://localhost:4000/\" target=\"_blank\" rel=\"noopener\"></a></p>\n<ol start=\"3\">\n<li> <a href=\"https://hexo.io/themes/\" target=\"_blank\" rel=\"noopener\">themes</a><br>\n blog </li>\n</ol>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">hexo clean</span><br><span class=\"line\">git clone https://github.com/huweihuang/hexo-theme-huweihuang.git ./hexo-huweihuang </span><br></pre></td></tr></table></figure>\n<p> blog  _config.yml  theme </p>\n<ol start=\"4\">\n<li> GitHub<br>\n _config.yml <br>\n<img src=\"/img/article/20190212/3.png\" alt=\"blog\"><br>\n <strong>hexo d</strong> GitHub</li>\n</ol>\n<h1>More Questions</h1>\n<p> _config.yml  blog <br>\n</p>\n<h2>Page View statistics - </h2>\n<blockquote>\n<p></p>\n</blockquote>\n<ol>\n<li></li>\n</ol>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;script <span class=\"keyword\">async</span> src=<span class=\"string\">\"//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js\"</span>&gt;</span><br><span class=\"line\">&lt;<span class=\"regexp\">/script&gt;</span></span><br></pre></td></tr></table></figure>\n<p> <em>themes/layout/_partial/footer.ejs</em> </p>\n<ol start=\"2\">\n<li><br>\n<br>\napvnn</li>\n</ol>\n<figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;span id=\"busuanzi_container_site_pv\"&gt;</span><br><span class=\"line\">    &lt;span id=\"busuanzi_value_site_pv\"&gt;&lt;/span&gt;</span><br><span class=\"line\">&lt;/span&gt;</span><br></pre></td></tr></table></figure>\n<p>buvn1</p>\n<figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;span id=\"busuanzi_container_site_uv\"&gt;</span><br><span class=\"line\">  &lt;span id=\"busuanzi_value_site_uv\"&gt;&lt;/span&gt;</span><br><span class=\"line\">&lt;/span&gt;</span><br></pre></td></tr></table></figure>\n<ol start=\"3\">\n<li><br>\npv11</li>\n</ol>\n<figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;span id=\"busuanzi_container_page_pv\"&gt;</span><br><span class=\"line\">  &lt;span id=\"busuanzi_value_page_pv\"&gt;&lt;/span&gt;</span><br><span class=\"line\">&lt;/span&gt;</span><br></pre></td></tr></table></figure>\n<ol start=\"4\">\n<li><br>\n+stylecss</li>\n</ol>\n<ul>\n<li>busuanzi_value_site_pv id</li>\n<li>busuanzi_container_site_pv3id<br>\n</li>\n</ul>\n<figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;span id=\"busuanzi_value_site_pv\"&gt;&lt;/span&gt;</span><br><span class=\"line\">&lt;span id=\"busuanzi_value_site_uv\"&gt;&lt;/span&gt;</span><br><span class=\"line\">&lt;span id=\"busuanzi_value_page_pv\"&gt;&lt;/span&gt;</span><br></pre></td></tr></table></figure>\n<h2>Add comments module - Disqus</h2>\n<blockquote>\n<p>201761</p>\n</blockquote>\n<p>   Disqus  _config.yml  disqus_username </p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> Disqus settings</span></span><br><span class=\"line\">disqus_username: username</span><br></pre></td></tr></table></figure>\n<p></p>\n<ol>\n<li>\n<p> <a href=\"https://disqus.com\" target=\"_blank\" rel=\"noopener\">Disqus</a> <strong>-View Profile</strong> disqus_username </p>\n</li>\n<li>\n<p><strong>-Install on Site</strong> Shortname,  disqus_username <br>\n<img src=\"/img/article/20190212/4.png\" alt=\"Disqus\"><br>\n<em>We were unable to load Disqus.</em></p>\n</li>\n<li>\n<p> <a href=\"https://github.com/iissnan/hexo-theme-next/issues/876\" target=\"_blank\" rel=\"noopener\">issue #876</a> disqus_url disqus_identifier Disqus  <code>window.location.href</code>Hexo </p>\n</li>\n</ol>\n<h1>End</h1>\n<p><br>\n2019</p>\n<h1>Reference</h1>\n<blockquote>\n<p><a href=\"https://www.cnblogs.com/jackyroc/p/7681938.html\" target=\"_blank\" rel=\"noopener\">Github Pages</a><br>\n<a href=\"http://ibruce.info/2015/04/04/busuanzi/\" target=\"_blank\" rel=\"noopener\"></a><br>\n<a href=\"https://www.jianshu.com/p/7e4453421b8f\" target=\"_blank\" rel=\"noopener\">Disqus</a></p>\n</blockquote>\n"},{"title":"Kth Smallest/Largest Element in ...","catalog":true,"toc_nav_num":true,"date":"2019-12-16T09:30:51.000Z","subtitle":"Leet Code","header-img":"/img/article_header/article_header.png","busuanzi":true,"_content":"\n# Introduction\n\nHere is the summary about the kth problems in LeetCode.\n\n# Kth Largest Element in an Array\n\nFind the kth largest element in an unsorted array. Note that it is the kth largest element in the sorted order, not the kth distinct element.\n\n**Example 1:**\n\n```\nInput: [3,2,1,5,6,4] and k = 2\nOutput: 5\n```\n\n**Example 2:**\n\n```\nInput: [3,2,3,1,2,4,5,5,6] and k = 4\nOutput: 4\n```\n\n**Algorithm**\n\n``` swift\nclass Solution {\n    func findKthLargest(_ nums: [Int], _ k: Int) -> Int {\n        func quickSort(_ nums: inout [Int], _ l: Int, _ r: Int) -> Int {\n            var l = l, r = r\n            let key = nums[l]\n            while l < r {\n                while l < r, key >= nums[r] {\n                    r -= 1\n                }\n                nums[l] = nums[r]\n                while l < r, key <= nums[l] {\n                    l += 1\n                }\n                nums[r] = nums[l]\n            }\n            nums[l] = key\n            return l\n        }\n        var l = 0, r = nums.count-1, nums = nums\n        while l < r {\n            let index = quickSort(&nums, l, r)\n            switch index {\n            case k - 1:\n                return nums[index]\n            case 0..<k-1:\n                l = index + 1\n                break\n            default:\n                r = index - 1\n                break\n            }\n        }\n        return nums[k-1]\n    }\n}\n```\n\nFrom leetCode [215. Kth Largest Element in an Array](https://leetcode.com/problems/kth-largest-element-in-an-array/)\n\n# Kth Smallest Element in a BST\n\nGiven a binary search tree, write a function kthSmallest to find the kth smallest element in it.\n\n**Note:**\n\nYou may assume k is always valid, 1  k  BST's total elements.\n\n**Example 1:**\n\n```\nInput: root = [3,1,4,null,2], k = 1\n   3\n  / \\\n 1   4\n  \\\n   2\nOutput: 1\n```\n\n**Exapmle 2:**\n\n```\nInput: root = [5,3,6,2,4,null,null,1], k = 3\n       5\n      / \\\n     3   6\n    / \\\n   2   4\n  /\n 1\nOutput: 3\n```\n\n**Algorithm:**\n\n``` swift\npublic class TreeNode {\n    public var val: Int\n    public var left: TreeNode?\n    public var right: TreeNode?\n    public init(_ val: Int) {\n        self.val = val\n        self.left = nil\n        self.right = nil\n    }\n}\nclass Solution {\n    func kthSmallest(_ root: TreeNode?, _ k: Int) -> Int {\n        var stack = [TreeNode]()\n        var cur = root\n        var k = k\n        while cur != nil || !stack.isEmpty {\n            if let temp = cur {\n                stack.append(temp)\n                cur = temp.left\n            } else {\n                let last = stack.removeLast()\n                k -= 1\n                if k == 0 {\n                    return last.val\n                }\n                cur = last.right\n            }\n        }\n        return 0\n    }\n}\n```\n\nFrom leetCode [230. Kth Smallest Element in a BST](https://leetcode.com/problems/kth-smallest-element-in-a-bst/)\n\n# Find K Pairs with Smallest Sums\n\nYou are given two integer arrays nums1 and nums2 sorted in ascending order and an integer k.\n\nDefine a pair (u,v) which consists of one element from the first array and one element from the second array.\n\nFind the k pairs (u1,v1),(u2,v2) ...(uk,vk) with the smallest sums.\n\n**Example 1:**\n\n```\nInput: nums1 = [1,7,11], nums2 = [2,4,6], k = 3\nOutput: [[1,2],[1,4],[1,6]] \nExplanation: The first 3 pairs are returned from the sequence: \n             [1,2],[1,4],[1,6],[7,2],[7,4],[11,2],[7,6],[11,4],[11,6]\n```\n\n**Example 2:**\n\n```\nInput: nums1 = [1,1,2], nums2 = [1,2,3], k = 2\nOutput: [1,1],[1,1]\nExplanation: The first 2 pairs are returned from the sequence: \n             [1,1],[1,1],[1,2],[2,1],[1,2],[2,2],[1,3],[1,3],[2,3]\n```\n\n**Example 3:**\n\n```\nInput: nums1 = [1,2], nums2 = [3], k = 3\nOutput: [1,3],[2,3]\nExplanation: All possible pairs are returned from the sequence: [1,3],[2,3]\n```\n\n**Algorithm:**\n\n``` swift\nclass Solution {\n    func kSmallestPairs(_ nums1: [Int], _ nums2: [Int], _ k: Int) -> [[Int]] {\n        guard !nums1.isEmpty, !nums2.isEmpty, k >= 0 else {\n            return []\n        }\n        func insert(_ arr: inout [(Int, Int, Int)], _ new: (Int, Int, Int)) {\n            var s = 0, e = arr.count-1\n            while s <= e {\n                let mid = (s + e) >> 1\n                if (mid == 0 && new.0 <= arr[mid].0) ||\n                    (mid > 0 && new.0 >= arr[mid-1].0 && new.0 <= arr[mid].0) {\n                    arr.insert(new, at: mid)\n                    return\n                } else if new.0 > arr[mid].0 {\n                    s = mid + 1\n                } else {\n                    e = mid - 1\n                }\n            }\n            arr.insert(new, at: arr.count)\n        }\n        var arr = [(Int, Int, Int)]()\n        for i in nums1.indices {\n            arr.append((nums1[i]+nums2[0], i, 0))\n        }\n        var res = [[Int]]()\n        while !arr.isEmpty, res.count < k {\n            let (_, i, j) = arr.removeFirst()\n            res.append([nums1[i], nums2[j]])\n            if j < nums2.count-1 {\n                insert(&arr, (nums1[i]+nums2[j+1], i, j+1))\n            }\n        }\n        return res\n    }\n}\n```\n\n**Comment:**\n\nHere is a simple example demonstrate how this algorithm works:\n\n![example](/img/article/20191216/1.png)\n\nFrom leetCode [373. Find K Pairs with Smallest Sums](https://leetcode.com/problems/find-k-pairs-with-smallest-sums/)\n\n# Kth Smallest Element in a Sorted Matrix\n\nGiven a n x n matrix where each of the rows and columns are sorted in ascending order, find the kth smallest element in the matrix.\n\nNote that it is the kth smallest element in the sorted order, not the kth distinct element.\n\n**Example:**\n\n```\nmatrix = [\n   [ 1,  5,  9],\n   [10, 11, 13],\n   [12, 13, 15]\n],\nk = 8,\n\nreturn 13.\n```\n\n**Algorithm:**\n\n``` swift\nclass Solution {\n    func kthSmallest(_ matrix: [[Int]], _ k: Int) -> Int {\n        guard !matrix.isEmpty, !matrix.first!.isEmpty, k > 0 else {\n            return 0\n        }\n        func insert(_ arr: inout [(Int, Int, Int)], _ new: (Int, Int, Int)) {\n            var s = 0, e = arr.count-1\n            while s <= e {\n                let mid = (s + e) >> 1\n                if (mid == 0 && new.0 <= arr[mid].0) ||\n                    (mid > 0 && new.0 > arr[mid-1].0 && new.0 <= arr[mid].0) {\n                    arr.insert(new, at: mid)\n                    return\n                } else if new.0 > arr[mid].0 {\n                    s = mid + 1\n                } else {\n                    e = mid - 1\n                }\n            }\n            arr.insert(new, at: arr.count)\n        }\n        var arr = [(Int, Int, Int)]()\n        for i in matrix.indices {\n            arr.append((matrix[i][0], i, 0))\n        }\n        var k = k, i = 0, j = 0\n        while !arr.isEmpty, k > 0 {\n            (_, i, j) = arr.removeFirst()\n            if j < matrix.first!.count-1 {\n                insert(&arr, (matrix[i][j+1], i, j+1))\n            }\n            k -= 1\n        }\n        return matrix[i][j]\n    }\n}\n```\n\n``` swift\nclass Solution {\n    func kthSmallest(_ matrix: [[Int]], _ k: Int) -> Int {\n        guard !matrix.isEmpty else {\n            return 0\n        }\n        let n = matrix.count-1\n        var lo = matrix[0][0], hi = matrix[n][n]\n        while lo < hi {\n            let mid = (lo + hi) >> 1\n            var count = 0, j = n\n            for i in 0...n {\n                while j >= 0, matrix[i][j] > mid {\n                    j -= 1\n                }\n                count += j + 1\n            }\n            if count < k {\n                lo = mid + 1\n            } else {\n                hi = mid\n            }\n        }\n        return lo\n    }\n}\n```\n\nFrom leetCode [378. Kth Smallest Element in a Sorted Matrix](https://leetcode.com/problems/kth-smallest-element-in-a-sorted-matrix/)\n\n# Kth Smallest Number in Multiplication Table\n\nNearly every one have used the Multiplication Table. But could you find out the k-th smallest number quickly from the multiplication table?\n\nGiven the height m and the length n of a m * n Multiplication Table, and a positive integer k, you need to return the k-th smallest number in this table.\n\n**Example 1:**\n\n```\nInput: m = 3, n = 3, k = 5\nOutput: \nExplanation: \nThe Multiplication Table:\n1\t2\t3\n2\t4\t6\n3\t6\t9\n\nThe 5-th smallest number is 3 (1, 2, 2, 3, 3).\n```\n\n**Example 2:**\n\n```\nInput: m = 2, n = 3, k = 6\nOutput: \nExplanation: \nThe Multiplication Table:\n1\t2\t3\n2\t4\t6\n\nThe 6-th smallest number is 6 (1, 2, 2, 3, 4, 6).\n```\n\n**Note:**\n\n1. The m and n will be in the range [1, 30000].\n2. The k will be in the range [1, m * n]\n\n**Algorithm:**\n\n``` swift\nclass Solution {\n    func findKthNumber(_ m: Int, _ n: Int, _ k: Int) -> Int {\n        guard m > 0, n > 0, k > 0 else {\n            return 0\n        }\n        var lo = 1, hi = m * n\n        while lo < hi {\n            let mid = (lo + hi) >> 1\n            var count = 0, nN = n\n            for i in 1...m {\n                while nN > 0, i * nN > mid {\n                    nN -= 1\n                }\n                count += nN\n            }\n            if count < k {\n                lo = mid + 1\n            } else {\n                hi = mid\n            }\n        }\n        return lo\n    }\n}\n```\n\nFrom leetCode [668. Kth Smallest Number in Multiplication Table](https://leetcode.com/problems/kth-smallest-number-in-multiplication-table/)\n\n# Find K-th Smallest Pair Distance\n\nGiven an integer array, return the k-th smallest distance among all the pairs. The distance of a pair (A, B) is defined as the absolute difference between A and B.\n\n**Example 1:**\n\n```\nInput:\nnums = [1,3,1]\nk = 1\nOutput: 0 \nExplanation:\nHere are all the pairs:\n(1,3) -> 2\n(1,1) -> 0\n(3,1) -> 2\nThen the 1st smallest distance pair is (1,1), and its distance is 0.\n```\n\n**Note:**\n\n1. 2 <= len(nums) <= 10000.\n2. 0 <= nums[i] < 1000000.\n3. 1 <= k <= len(nums) * (len(nums) - 1) / 2.\n\n**Algorithm:**\n\n``` swift\nclass Solution {\n    func smallestDistancePair(_ nums: [Int], _ k: Int) -> Int {\n        guard nums.count > 1 else {\n            return 0\n        }\n        let sortedNums = nums.sorted()\n        var lo = 0, hi = sortedNums.last! - sortedNums.first!\n        while lo < hi {\n            let mid = (lo + hi) >> 1\n            var count = 0, i = 0\n            for j in 0..<sortedNums.count {\n                while i < sortedNums.count, sortedNums[j] - sortedNums[i] > mid {\n                    i += 1\n                }\n                count += j-i\n            }\n            if count < k {\n                lo = mid + 1\n            } else {\n                hi = mid\n            }\n        }\n        return lo\n    }\n}\n```\n\nFrom leetCode [719. Find K-th Smallest Pair Distance](https://leetcode.com/problems/find-k-th-smallest-pair-distance/)\n\n# K-th Smallest Prime Fraction\n\nA sorted list A contains 1, plus some number of primes.  Then, for every p < q in the list, we consider the fraction p/q.\n\nWhat is the K-th smallest fraction considered?  Return your answer as an array of ints, where answer[0] = p and answer[1] = q.\n\n**Example:**\n\n```\nInput: A = [1, 2, 3, 5], K = 3\nOutput: [2, 5]\nExplanation:\nThe fractions to be considered in sorted order are:\n1/5, 1/3, 2/5, 1/2, 3/5, 2/3.\nThe third fraction is 2/5.\n\nInput: A = [1, 7], K = 1\nOutput: [1, 7]\n```\n\n**Note:**\n\n- A will have length between 2 and 2000.\n- Each A[i] will be between 1 and 30000.\n- K will be between 1 and A.length * (A.length - 1) / 2.\n\n**Algorithm:**\n\n``` swift\nclass Solution {\n    func kthSmallestPrimeFraction(_ A: [Int], _ K: Int) -> [Int] {\n        let n = A.count\n        guard n > 1, K > 0 else {\n            return []\n        }\n        var lo = 0.0, hi = 1.0\n        while lo < hi {\n            let mid = (lo + hi) / 2\n            var j = 1, count = 0, maxVal = 0.0, res = (0, 0)\n            for i in 0..<n-1 {\n                while j < n, Double(A[i]) > mid * Double(A[j]) {\n                    j += 1\n                }\n                if n == j {\n                    break\n                }\n                count += n-j\n                let val = Double(A[i]) / Double(A[j])\n                if val > maxVal {\n                    res = (i, j)\n                    maxVal = val\n                }\n            }\n            if count < K {\n                lo = mid\n            } else if count == K {\n                return [A[res.0], A[res.1]]\n            } else {\n                hi = mid\n            }\n        }\n        return []\n    }\n}\n```\n\nFrom leetCode [786. K-th Smallest Prime Fraction](https://leetcode.com/problems/k-th-smallest-prime-fraction/)\n\n# Minimum Cost to Hire K Workers\n\nThere are N workers.  The i-th worker has a quality[i] and a minimum wage expectation wage[i].\n\nNow we want to hire exactly K workers to form a paid group.  When hiring a group of K workers, we must pay them according to the following rules:\n1. Every worker in the paid group should be paid in the ratio of their quality compared to other workers in the paid group.\n2. Every worker in the paid group must be paid at least their minimum wage expectation.\n\nReturn the least amount of money needed to form a paid group satisfying the above conditions.\n\n**Example 1:**\n\n```\nInput: quality = [10,20,5], wage = [70,50,30], K = 2\nOutput: 105.00000\nExplanation: We pay 70 to 0-th worker and 35 to 2-th worker.\n```\n\n**Example 2:**\n\n```\nInput: quality = [3,1,10,10,1], wage = [4,8,2,2,7], K = 3\nOutput: 30.66667\nExplanation: We pay 4 to 0-th worker, 13.33333 to 2-th and 3-th workers seperately. \n```\n\n**Note:**\n\n1. 1 <= K <= N <= 10000, where N = quality.length = wage.length\n2. 1 <= quality[i] <= 10000\n3. 1 <= wage[i] <= 10000\n4. Answers within 10^-5 of the correct answer will be considered correct.\n\n**Algorithm:**\n\n``` swift\nclass Solution {\n    func mincostToHireWorkers(_ quality: [Int], _ wage: [Int], _ K: Int) -> Double {\n        func insert<T: Comparable>(_ new: (T, Int), _ arr: inout [(T, Int)]) {\n            var l = 0, r = arr.count-1\n            while l <= r {\n                let mid = (l+r) >> 1\n                if (mid == 0 && new.0 <= arr[mid].0) ||\n                    (mid > 0 && new.0 <= arr[mid].0 && new.0 > arr[mid-1].0) {\n                    arr.insert(new, at: mid)\n                    return\n                } else if new.0 > arr[mid].0 {\n                    l = mid + 1\n                } else {\n                    r = mid - 1\n                }\n            }\n            arr.insert(new, at: arr.count)\n        }\n        var arr = [(Double, Int)]()\n        for i in quality.indices {\n            insert((Double(wage[i]) / Double(quality[i]), i), &arr)\n        }\n        var res = pow(10.0, 10.0)\n        var qualities = [(Int, Int)]()\n        var sump = 0\n        for i in 0..<arr.count {\n            let temp = quality[arr[i].1]\n            insert((temp, arr[i].1), &qualities)\n            sump += temp\n            if qualities.count > K {\n                sump -= qualities.popLast()!.0\n            }\n            if qualities.count == K {\n                let ratio = arr[i].0\n                res = min(res, Double(sump) * ratio)\n            }\n        }\n        return res\n    }\n}\n```\n\nFrom leetCode [857. Minimum Cost to Hire K Workers](https://leetcode.com/problems/minimum-cost-to-hire-k-workers/)","source":"_posts/2019/leetcode-kth-problems-1216.md","raw":"---\ntitle: \"Kth Smallest/Largest Element in ...\"\ncatalog: true\ntoc_nav_num: true\ndate: 2019-12-16 17:30:51\nsubtitle: \"Leet Code\"\nheader-img: \"/img/article_header/article_header.png\"\nbusuanzi: true\ntags:\n- iOS - Swift\n\n---\n\n# Introduction\n\nHere is the summary about the kth problems in LeetCode.\n\n# Kth Largest Element in an Array\n\nFind the kth largest element in an unsorted array. Note that it is the kth largest element in the sorted order, not the kth distinct element.\n\n**Example 1:**\n\n```\nInput: [3,2,1,5,6,4] and k = 2\nOutput: 5\n```\n\n**Example 2:**\n\n```\nInput: [3,2,3,1,2,4,5,5,6] and k = 4\nOutput: 4\n```\n\n**Algorithm**\n\n``` swift\nclass Solution {\n    func findKthLargest(_ nums: [Int], _ k: Int) -> Int {\n        func quickSort(_ nums: inout [Int], _ l: Int, _ r: Int) -> Int {\n            var l = l, r = r\n            let key = nums[l]\n            while l < r {\n                while l < r, key >= nums[r] {\n                    r -= 1\n                }\n                nums[l] = nums[r]\n                while l < r, key <= nums[l] {\n                    l += 1\n                }\n                nums[r] = nums[l]\n            }\n            nums[l] = key\n            return l\n        }\n        var l = 0, r = nums.count-1, nums = nums\n        while l < r {\n            let index = quickSort(&nums, l, r)\n            switch index {\n            case k - 1:\n                return nums[index]\n            case 0..<k-1:\n                l = index + 1\n                break\n            default:\n                r = index - 1\n                break\n            }\n        }\n        return nums[k-1]\n    }\n}\n```\n\nFrom leetCode [215. Kth Largest Element in an Array](https://leetcode.com/problems/kth-largest-element-in-an-array/)\n\n# Kth Smallest Element in a BST\n\nGiven a binary search tree, write a function kthSmallest to find the kth smallest element in it.\n\n**Note:**\n\nYou may assume k is always valid, 1  k  BST's total elements.\n\n**Example 1:**\n\n```\nInput: root = [3,1,4,null,2], k = 1\n   3\n  / \\\n 1   4\n  \\\n   2\nOutput: 1\n```\n\n**Exapmle 2:**\n\n```\nInput: root = [5,3,6,2,4,null,null,1], k = 3\n       5\n      / \\\n     3   6\n    / \\\n   2   4\n  /\n 1\nOutput: 3\n```\n\n**Algorithm:**\n\n``` swift\npublic class TreeNode {\n    public var val: Int\n    public var left: TreeNode?\n    public var right: TreeNode?\n    public init(_ val: Int) {\n        self.val = val\n        self.left = nil\n        self.right = nil\n    }\n}\nclass Solution {\n    func kthSmallest(_ root: TreeNode?, _ k: Int) -> Int {\n        var stack = [TreeNode]()\n        var cur = root\n        var k = k\n        while cur != nil || !stack.isEmpty {\n            if let temp = cur {\n                stack.append(temp)\n                cur = temp.left\n            } else {\n                let last = stack.removeLast()\n                k -= 1\n                if k == 0 {\n                    return last.val\n                }\n                cur = last.right\n            }\n        }\n        return 0\n    }\n}\n```\n\nFrom leetCode [230. Kth Smallest Element in a BST](https://leetcode.com/problems/kth-smallest-element-in-a-bst/)\n\n# Find K Pairs with Smallest Sums\n\nYou are given two integer arrays nums1 and nums2 sorted in ascending order and an integer k.\n\nDefine a pair (u,v) which consists of one element from the first array and one element from the second array.\n\nFind the k pairs (u1,v1),(u2,v2) ...(uk,vk) with the smallest sums.\n\n**Example 1:**\n\n```\nInput: nums1 = [1,7,11], nums2 = [2,4,6], k = 3\nOutput: [[1,2],[1,4],[1,6]] \nExplanation: The first 3 pairs are returned from the sequence: \n             [1,2],[1,4],[1,6],[7,2],[7,4],[11,2],[7,6],[11,4],[11,6]\n```\n\n**Example 2:**\n\n```\nInput: nums1 = [1,1,2], nums2 = [1,2,3], k = 2\nOutput: [1,1],[1,1]\nExplanation: The first 2 pairs are returned from the sequence: \n             [1,1],[1,1],[1,2],[2,1],[1,2],[2,2],[1,3],[1,3],[2,3]\n```\n\n**Example 3:**\n\n```\nInput: nums1 = [1,2], nums2 = [3], k = 3\nOutput: [1,3],[2,3]\nExplanation: All possible pairs are returned from the sequence: [1,3],[2,3]\n```\n\n**Algorithm:**\n\n``` swift\nclass Solution {\n    func kSmallestPairs(_ nums1: [Int], _ nums2: [Int], _ k: Int) -> [[Int]] {\n        guard !nums1.isEmpty, !nums2.isEmpty, k >= 0 else {\n            return []\n        }\n        func insert(_ arr: inout [(Int, Int, Int)], _ new: (Int, Int, Int)) {\n            var s = 0, e = arr.count-1\n            while s <= e {\n                let mid = (s + e) >> 1\n                if (mid == 0 && new.0 <= arr[mid].0) ||\n                    (mid > 0 && new.0 >= arr[mid-1].0 && new.0 <= arr[mid].0) {\n                    arr.insert(new, at: mid)\n                    return\n                } else if new.0 > arr[mid].0 {\n                    s = mid + 1\n                } else {\n                    e = mid - 1\n                }\n            }\n            arr.insert(new, at: arr.count)\n        }\n        var arr = [(Int, Int, Int)]()\n        for i in nums1.indices {\n            arr.append((nums1[i]+nums2[0], i, 0))\n        }\n        var res = [[Int]]()\n        while !arr.isEmpty, res.count < k {\n            let (_, i, j) = arr.removeFirst()\n            res.append([nums1[i], nums2[j]])\n            if j < nums2.count-1 {\n                insert(&arr, (nums1[i]+nums2[j+1], i, j+1))\n            }\n        }\n        return res\n    }\n}\n```\n\n**Comment:**\n\nHere is a simple example demonstrate how this algorithm works:\n\n![example](/img/article/20191216/1.png)\n\nFrom leetCode [373. Find K Pairs with Smallest Sums](https://leetcode.com/problems/find-k-pairs-with-smallest-sums/)\n\n# Kth Smallest Element in a Sorted Matrix\n\nGiven a n x n matrix where each of the rows and columns are sorted in ascending order, find the kth smallest element in the matrix.\n\nNote that it is the kth smallest element in the sorted order, not the kth distinct element.\n\n**Example:**\n\n```\nmatrix = [\n   [ 1,  5,  9],\n   [10, 11, 13],\n   [12, 13, 15]\n],\nk = 8,\n\nreturn 13.\n```\n\n**Algorithm:**\n\n``` swift\nclass Solution {\n    func kthSmallest(_ matrix: [[Int]], _ k: Int) -> Int {\n        guard !matrix.isEmpty, !matrix.first!.isEmpty, k > 0 else {\n            return 0\n        }\n        func insert(_ arr: inout [(Int, Int, Int)], _ new: (Int, Int, Int)) {\n            var s = 0, e = arr.count-1\n            while s <= e {\n                let mid = (s + e) >> 1\n                if (mid == 0 && new.0 <= arr[mid].0) ||\n                    (mid > 0 && new.0 > arr[mid-1].0 && new.0 <= arr[mid].0) {\n                    arr.insert(new, at: mid)\n                    return\n                } else if new.0 > arr[mid].0 {\n                    s = mid + 1\n                } else {\n                    e = mid - 1\n                }\n            }\n            arr.insert(new, at: arr.count)\n        }\n        var arr = [(Int, Int, Int)]()\n        for i in matrix.indices {\n            arr.append((matrix[i][0], i, 0))\n        }\n        var k = k, i = 0, j = 0\n        while !arr.isEmpty, k > 0 {\n            (_, i, j) = arr.removeFirst()\n            if j < matrix.first!.count-1 {\n                insert(&arr, (matrix[i][j+1], i, j+1))\n            }\n            k -= 1\n        }\n        return matrix[i][j]\n    }\n}\n```\n\n``` swift\nclass Solution {\n    func kthSmallest(_ matrix: [[Int]], _ k: Int) -> Int {\n        guard !matrix.isEmpty else {\n            return 0\n        }\n        let n = matrix.count-1\n        var lo = matrix[0][0], hi = matrix[n][n]\n        while lo < hi {\n            let mid = (lo + hi) >> 1\n            var count = 0, j = n\n            for i in 0...n {\n                while j >= 0, matrix[i][j] > mid {\n                    j -= 1\n                }\n                count += j + 1\n            }\n            if count < k {\n                lo = mid + 1\n            } else {\n                hi = mid\n            }\n        }\n        return lo\n    }\n}\n```\n\nFrom leetCode [378. Kth Smallest Element in a Sorted Matrix](https://leetcode.com/problems/kth-smallest-element-in-a-sorted-matrix/)\n\n# Kth Smallest Number in Multiplication Table\n\nNearly every one have used the Multiplication Table. But could you find out the k-th smallest number quickly from the multiplication table?\n\nGiven the height m and the length n of a m * n Multiplication Table, and a positive integer k, you need to return the k-th smallest number in this table.\n\n**Example 1:**\n\n```\nInput: m = 3, n = 3, k = 5\nOutput: \nExplanation: \nThe Multiplication Table:\n1\t2\t3\n2\t4\t6\n3\t6\t9\n\nThe 5-th smallest number is 3 (1, 2, 2, 3, 3).\n```\n\n**Example 2:**\n\n```\nInput: m = 2, n = 3, k = 6\nOutput: \nExplanation: \nThe Multiplication Table:\n1\t2\t3\n2\t4\t6\n\nThe 6-th smallest number is 6 (1, 2, 2, 3, 4, 6).\n```\n\n**Note:**\n\n1. The m and n will be in the range [1, 30000].\n2. The k will be in the range [1, m * n]\n\n**Algorithm:**\n\n``` swift\nclass Solution {\n    func findKthNumber(_ m: Int, _ n: Int, _ k: Int) -> Int {\n        guard m > 0, n > 0, k > 0 else {\n            return 0\n        }\n        var lo = 1, hi = m * n\n        while lo < hi {\n            let mid = (lo + hi) >> 1\n            var count = 0, nN = n\n            for i in 1...m {\n                while nN > 0, i * nN > mid {\n                    nN -= 1\n                }\n                count += nN\n            }\n            if count < k {\n                lo = mid + 1\n            } else {\n                hi = mid\n            }\n        }\n        return lo\n    }\n}\n```\n\nFrom leetCode [668. Kth Smallest Number in Multiplication Table](https://leetcode.com/problems/kth-smallest-number-in-multiplication-table/)\n\n# Find K-th Smallest Pair Distance\n\nGiven an integer array, return the k-th smallest distance among all the pairs. The distance of a pair (A, B) is defined as the absolute difference between A and B.\n\n**Example 1:**\n\n```\nInput:\nnums = [1,3,1]\nk = 1\nOutput: 0 \nExplanation:\nHere are all the pairs:\n(1,3) -> 2\n(1,1) -> 0\n(3,1) -> 2\nThen the 1st smallest distance pair is (1,1), and its distance is 0.\n```\n\n**Note:**\n\n1. 2 <= len(nums) <= 10000.\n2. 0 <= nums[i] < 1000000.\n3. 1 <= k <= len(nums) * (len(nums) - 1) / 2.\n\n**Algorithm:**\n\n``` swift\nclass Solution {\n    func smallestDistancePair(_ nums: [Int], _ k: Int) -> Int {\n        guard nums.count > 1 else {\n            return 0\n        }\n        let sortedNums = nums.sorted()\n        var lo = 0, hi = sortedNums.last! - sortedNums.first!\n        while lo < hi {\n            let mid = (lo + hi) >> 1\n            var count = 0, i = 0\n            for j in 0..<sortedNums.count {\n                while i < sortedNums.count, sortedNums[j] - sortedNums[i] > mid {\n                    i += 1\n                }\n                count += j-i\n            }\n            if count < k {\n                lo = mid + 1\n            } else {\n                hi = mid\n            }\n        }\n        return lo\n    }\n}\n```\n\nFrom leetCode [719. Find K-th Smallest Pair Distance](https://leetcode.com/problems/find-k-th-smallest-pair-distance/)\n\n# K-th Smallest Prime Fraction\n\nA sorted list A contains 1, plus some number of primes.  Then, for every p < q in the list, we consider the fraction p/q.\n\nWhat is the K-th smallest fraction considered?  Return your answer as an array of ints, where answer[0] = p and answer[1] = q.\n\n**Example:**\n\n```\nInput: A = [1, 2, 3, 5], K = 3\nOutput: [2, 5]\nExplanation:\nThe fractions to be considered in sorted order are:\n1/5, 1/3, 2/5, 1/2, 3/5, 2/3.\nThe third fraction is 2/5.\n\nInput: A = [1, 7], K = 1\nOutput: [1, 7]\n```\n\n**Note:**\n\n- A will have length between 2 and 2000.\n- Each A[i] will be between 1 and 30000.\n- K will be between 1 and A.length * (A.length - 1) / 2.\n\n**Algorithm:**\n\n``` swift\nclass Solution {\n    func kthSmallestPrimeFraction(_ A: [Int], _ K: Int) -> [Int] {\n        let n = A.count\n        guard n > 1, K > 0 else {\n            return []\n        }\n        var lo = 0.0, hi = 1.0\n        while lo < hi {\n            let mid = (lo + hi) / 2\n            var j = 1, count = 0, maxVal = 0.0, res = (0, 0)\n            for i in 0..<n-1 {\n                while j < n, Double(A[i]) > mid * Double(A[j]) {\n                    j += 1\n                }\n                if n == j {\n                    break\n                }\n                count += n-j\n                let val = Double(A[i]) / Double(A[j])\n                if val > maxVal {\n                    res = (i, j)\n                    maxVal = val\n                }\n            }\n            if count < K {\n                lo = mid\n            } else if count == K {\n                return [A[res.0], A[res.1]]\n            } else {\n                hi = mid\n            }\n        }\n        return []\n    }\n}\n```\n\nFrom leetCode [786. K-th Smallest Prime Fraction](https://leetcode.com/problems/k-th-smallest-prime-fraction/)\n\n# Minimum Cost to Hire K Workers\n\nThere are N workers.  The i-th worker has a quality[i] and a minimum wage expectation wage[i].\n\nNow we want to hire exactly K workers to form a paid group.  When hiring a group of K workers, we must pay them according to the following rules:\n1. Every worker in the paid group should be paid in the ratio of their quality compared to other workers in the paid group.\n2. Every worker in the paid group must be paid at least their minimum wage expectation.\n\nReturn the least amount of money needed to form a paid group satisfying the above conditions.\n\n**Example 1:**\n\n```\nInput: quality = [10,20,5], wage = [70,50,30], K = 2\nOutput: 105.00000\nExplanation: We pay 70 to 0-th worker and 35 to 2-th worker.\n```\n\n**Example 2:**\n\n```\nInput: quality = [3,1,10,10,1], wage = [4,8,2,2,7], K = 3\nOutput: 30.66667\nExplanation: We pay 4 to 0-th worker, 13.33333 to 2-th and 3-th workers seperately. \n```\n\n**Note:**\n\n1. 1 <= K <= N <= 10000, where N = quality.length = wage.length\n2. 1 <= quality[i] <= 10000\n3. 1 <= wage[i] <= 10000\n4. Answers within 10^-5 of the correct answer will be considered correct.\n\n**Algorithm:**\n\n``` swift\nclass Solution {\n    func mincostToHireWorkers(_ quality: [Int], _ wage: [Int], _ K: Int) -> Double {\n        func insert<T: Comparable>(_ new: (T, Int), _ arr: inout [(T, Int)]) {\n            var l = 0, r = arr.count-1\n            while l <= r {\n                let mid = (l+r) >> 1\n                if (mid == 0 && new.0 <= arr[mid].0) ||\n                    (mid > 0 && new.0 <= arr[mid].0 && new.0 > arr[mid-1].0) {\n                    arr.insert(new, at: mid)\n                    return\n                } else if new.0 > arr[mid].0 {\n                    l = mid + 1\n                } else {\n                    r = mid - 1\n                }\n            }\n            arr.insert(new, at: arr.count)\n        }\n        var arr = [(Double, Int)]()\n        for i in quality.indices {\n            insert((Double(wage[i]) / Double(quality[i]), i), &arr)\n        }\n        var res = pow(10.0, 10.0)\n        var qualities = [(Int, Int)]()\n        var sump = 0\n        for i in 0..<arr.count {\n            let temp = quality[arr[i].1]\n            insert((temp, arr[i].1), &qualities)\n            sump += temp\n            if qualities.count > K {\n                sump -= qualities.popLast()!.0\n            }\n            if qualities.count == K {\n                let ratio = arr[i].0\n                res = min(res, Double(sump) * ratio)\n            }\n        }\n        return res\n    }\n}\n```\n\nFrom leetCode [857. Minimum Cost to Hire K Workers](https://leetcode.com/problems/minimum-cost-to-hire-k-workers/)","slug":"2019/leetcode-kth-problems-1216","published":1,"updated":"2021-06-21T12:34:52.092Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckszp3nd3000cifntxih0rn22","content":"<h1 id=\"introduction\">Introduction</h1>\n<p>Here is the summary about the kth problems in LeetCode.</p>\n<h1 id=\"kth-largest-element-in-an-array\">Kth Largest Element in an Array</h1>\n<p>Find the kth largest element in an unsorted array. Note that it is the kth largest element in the sorted order, not the kth distinct element.</p>\n<p><strong>Example 1:</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Input: [3,2,1,5,6,4] and k = 2</span><br><span class=\"line\">Output: 5</span><br></pre></td></tr></table></figure>\n<p><strong>Example 2:</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Input: [3,2,3,1,2,4,5,5,6] and k = 4</span><br><span class=\"line\">Output: 4</span><br></pre></td></tr></table></figure>\n<p><strong>Algorithm</strong></p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Solution</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">findKthLargest</span><span class=\"params\">(<span class=\"number\">_</span> nums: [Int], <span class=\"number\">_</span> k: Int)</span></span> -&gt; <span class=\"type\">Int</span> &#123;</span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">quickSort</span><span class=\"params\">(<span class=\"number\">_</span> nums: <span class=\"keyword\">inout</span> [Int], <span class=\"number\">_</span> l: Int, <span class=\"number\">_</span> r: Int)</span></span> -&gt; <span class=\"type\">Int</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">var</span> l = l, r = r</span><br><span class=\"line\">            <span class=\"keyword\">let</span> key = nums[l]</span><br><span class=\"line\">            <span class=\"keyword\">while</span> l &lt; r &#123;</span><br><span class=\"line\">                <span class=\"keyword\">while</span> l &lt; r, key &gt;= nums[r] &#123;</span><br><span class=\"line\">                    r -= <span class=\"number\">1</span></span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                nums[l] = nums[r]</span><br><span class=\"line\">                <span class=\"keyword\">while</span> l &lt; r, key &lt;= nums[l] &#123;</span><br><span class=\"line\">                    l += <span class=\"number\">1</span></span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                nums[r] = nums[l]</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            nums[l] = key</span><br><span class=\"line\">            <span class=\"keyword\">return</span> l</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">var</span> l = <span class=\"number\">0</span>, r = nums.<span class=\"built_in\">count</span>-<span class=\"number\">1</span>, nums = nums</span><br><span class=\"line\">        <span class=\"keyword\">while</span> l &lt; r &#123;</span><br><span class=\"line\">            <span class=\"keyword\">let</span> index = <span class=\"built_in\">quickSort</span>(&amp;nums, l, r)</span><br><span class=\"line\">            <span class=\"keyword\">switch</span> index &#123;</span><br><span class=\"line\">            <span class=\"keyword\">case</span> k - <span class=\"number\">1</span>:</span><br><span class=\"line\">                <span class=\"keyword\">return</span> nums[index]</span><br><span class=\"line\">            <span class=\"keyword\">case</span> <span class=\"number\">0</span>..&lt;k-<span class=\"number\">1</span>:</span><br><span class=\"line\">                l = index + <span class=\"number\">1</span></span><br><span class=\"line\">                <span class=\"keyword\">break</span></span><br><span class=\"line\">            <span class=\"keyword\">default</span>:</span><br><span class=\"line\">                r = index - <span class=\"number\">1</span></span><br><span class=\"line\">                <span class=\"keyword\">break</span></span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> nums[k-<span class=\"number\">1</span>]</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>From leetCode <a href=\"https://leetcode.com/problems/kth-largest-element-in-an-array/\" target=\"_blank\" rel=\"noopener\">215. Kth Largest Element in an Array</a></p>\n<h1 id=\"kth-smallest-element-in-a-bst\">Kth Smallest Element in a BST</h1>\n<p>Given a binary search tree, write a function kthSmallest to find the kth smallest element in it.</p>\n<p><strong>Note:</strong></p>\n<p>You may assume k is always valid, 1  k  BSTs total elements.</p>\n<p><strong>Example 1:</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Input: root = [3,1,4,null,2], k = 1</span><br><span class=\"line\">   3</span><br><span class=\"line\">  / \\</span><br><span class=\"line\"> 1   4</span><br><span class=\"line\">  \\</span><br><span class=\"line\">   2</span><br><span class=\"line\">Output: 1</span><br></pre></td></tr></table></figure>\n<p><strong>Exapmle 2:</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Input: root = [5,3,6,2,4,null,null,1], k = 3</span><br><span class=\"line\">       5</span><br><span class=\"line\">      / \\</span><br><span class=\"line\">     3   6</span><br><span class=\"line\">    / \\</span><br><span class=\"line\">   2   4</span><br><span class=\"line\">  /</span><br><span class=\"line\"> 1</span><br><span class=\"line\">Output: 3</span><br></pre></td></tr></table></figure>\n<p><strong>Algorithm:</strong></p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">TreeNode</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">var</span> val: <span class=\"type\">Int</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">var</span> <span class=\"keyword\">left</span>: <span class=\"type\">TreeNode</span>?</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">var</span> <span class=\"keyword\">right</span>: <span class=\"type\">TreeNode</span>?</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">init</span>(<span class=\"number\">_</span> val: <span class=\"type\">Int</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">self</span>.val = val</span><br><span class=\"line\">        <span class=\"keyword\">self</span>.<span class=\"keyword\">left</span> = <span class=\"literal\">nil</span></span><br><span class=\"line\">        <span class=\"keyword\">self</span>.<span class=\"keyword\">right</span> = <span class=\"literal\">nil</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Solution</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">kthSmallest</span><span class=\"params\">(<span class=\"number\">_</span> root: TreeNode?, <span class=\"number\">_</span> k: Int)</span></span> -&gt; <span class=\"type\">Int</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">var</span> stack = [<span class=\"type\">TreeNode</span>]()</span><br><span class=\"line\">        <span class=\"keyword\">var</span> cur = root</span><br><span class=\"line\">        <span class=\"keyword\">var</span> k = k</span><br><span class=\"line\">        <span class=\"keyword\">while</span> cur != <span class=\"literal\">nil</span> || !stack.isEmpty &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> <span class=\"keyword\">let</span> temp = cur &#123;</span><br><span class=\"line\">                stack.append(temp)</span><br><span class=\"line\">                cur = temp.<span class=\"keyword\">left</span></span><br><span class=\"line\">            &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                <span class=\"keyword\">let</span> last = stack.removeLast()</span><br><span class=\"line\">                k -= <span class=\"number\">1</span></span><br><span class=\"line\">                <span class=\"keyword\">if</span> k == <span class=\"number\">0</span> &#123;</span><br><span class=\"line\">                    <span class=\"keyword\">return</span> last.val</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                cur = last.<span class=\"keyword\">right</span></span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">0</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>From leetCode <a href=\"https://leetcode.com/problems/kth-smallest-element-in-a-bst/\" target=\"_blank\" rel=\"noopener\">230. Kth Smallest Element in a BST</a></p>\n<h1 id=\"find-k-pairs-with-smallest-sums\">Find K Pairs with Smallest Sums</h1>\n<p>You are given two integer arrays nums1 and nums2 sorted in ascending order and an integer k.</p>\n<p>Define a pair (u,v) which consists of one element from the first array and one element from the second array.</p>\n<p>Find the k pairs (u1,v1),(u2,v2) (uk,vk) with the smallest sums.</p>\n<p><strong>Example 1:</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Input: nums1 = [1,7,11], nums2 = [2,4,6], k = 3</span><br><span class=\"line\">Output: [[1,2],[1,4],[1,6]] </span><br><span class=\"line\">Explanation: The first 3 pairs are returned from the sequence: </span><br><span class=\"line\">             [1,2],[1,4],[1,6],[7,2],[7,4],[11,2],[7,6],[11,4],[11,6]</span><br></pre></td></tr></table></figure>\n<p><strong>Example 2:</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Input: nums1 = [1,1,2], nums2 = [1,2,3], k = 2</span><br><span class=\"line\">Output: [1,1],[1,1]</span><br><span class=\"line\">Explanation: The first 2 pairs are returned from the sequence: </span><br><span class=\"line\">             [1,1],[1,1],[1,2],[2,1],[1,2],[2,2],[1,3],[1,3],[2,3]</span><br></pre></td></tr></table></figure>\n<p><strong>Example 3:</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Input: nums1 = [1,2], nums2 = [3], k = 3</span><br><span class=\"line\">Output: [1,3],[2,3]</span><br><span class=\"line\">Explanation: All possible pairs are returned from the sequence: [1,3],[2,3]</span><br></pre></td></tr></table></figure>\n<p><strong>Algorithm:</strong></p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Solution</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">kSmallestPairs</span><span class=\"params\">(<span class=\"number\">_</span> nums1: [Int], <span class=\"number\">_</span> nums2: [Int], <span class=\"number\">_</span> k: Int)</span></span> -&gt; [[<span class=\"type\">Int</span>]] &#123;</span><br><span class=\"line\">        <span class=\"keyword\">guard</span> !nums1.isEmpty, !nums2.isEmpty, k &gt;= <span class=\"number\">0</span> <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> []</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">insert</span><span class=\"params\">(<span class=\"number\">_</span> arr: <span class=\"keyword\">inout</span> [<span class=\"params\">(Int, Int, Int)</span></span></span>], <span class=\"number\">_</span> new: (<span class=\"type\">Int</span>, <span class=\"type\">Int</span>, <span class=\"type\">Int</span>)) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">var</span> s = <span class=\"number\">0</span>, e = arr.<span class=\"built_in\">count</span>-<span class=\"number\">1</span></span><br><span class=\"line\">            <span class=\"keyword\">while</span> s &lt;= e &#123;</span><br><span class=\"line\">                <span class=\"keyword\">let</span> mid = (s + e) &gt;&gt; <span class=\"number\">1</span></span><br><span class=\"line\">                <span class=\"keyword\">if</span> (mid == <span class=\"number\">0</span> &amp;&amp; new.<span class=\"number\">0</span> &lt;= arr[mid].<span class=\"number\">0</span>) ||</span><br><span class=\"line\">                    (mid &gt; <span class=\"number\">0</span> &amp;&amp; new.<span class=\"number\">0</span> &gt;= arr[mid-<span class=\"number\">1</span>].<span class=\"number\">0</span> &amp;&amp; new.<span class=\"number\">0</span> &lt;= arr[mid].<span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">                    arr.insert(new, at: mid)</span><br><span class=\"line\">                    <span class=\"keyword\">return</span></span><br><span class=\"line\">                &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> new.<span class=\"number\">0</span> &gt; arr[mid].<span class=\"number\">0</span> &#123;</span><br><span class=\"line\">                    s = mid + <span class=\"number\">1</span></span><br><span class=\"line\">                &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                    e = mid - <span class=\"number\">1</span></span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            arr.insert(new, at: arr.<span class=\"built_in\">count</span>)</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">var</span> arr = [(<span class=\"type\">Int</span>, <span class=\"type\">Int</span>, <span class=\"type\">Int</span>)]()</span><br><span class=\"line\">        <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> nums1.<span class=\"built_in\">indices</span> &#123;</span><br><span class=\"line\">            arr.append((nums1[i]+nums2[<span class=\"number\">0</span>], i, <span class=\"number\">0</span>))</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">var</span> res = [[<span class=\"type\">Int</span>]]()</span><br><span class=\"line\">        <span class=\"keyword\">while</span> !arr.isEmpty, res.<span class=\"built_in\">count</span> &lt; k &#123;</span><br><span class=\"line\">            <span class=\"keyword\">let</span> (<span class=\"number\">_</span>, i, j) = arr.removeFirst()</span><br><span class=\"line\">            res.append([nums1[i], nums2[j]])</span><br><span class=\"line\">            <span class=\"keyword\">if</span> j &lt; nums2.<span class=\"built_in\">count</span>-<span class=\"number\">1</span> &#123;</span><br><span class=\"line\">                insert(&amp;arr, (nums1[i]+nums2[j+<span class=\"number\">1</span>], i, j+<span class=\"number\">1</span>))</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> res</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><strong>Comment:</strong></p>\n<p>Here is a simple example demonstrate how this algorithm works:</p>\n<p><img src=\"/img/article/20191216/1.png\" alt=\"example\"></p>\n<p>From leetCode <a href=\"https://leetcode.com/problems/find-k-pairs-with-smallest-sums/\" target=\"_blank\" rel=\"noopener\">373. Find K Pairs with Smallest Sums</a></p>\n<h1 id=\"kth-smallest-element-in-a-sorted-matrix\">Kth Smallest Element in a Sorted Matrix</h1>\n<p>Given a n x n matrix where each of the rows and columns are sorted in ascending order, find the kth smallest element in the matrix.</p>\n<p>Note that it is the kth smallest element in the sorted order, not the kth distinct element.</p>\n<p><strong>Example:</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">matrix = [</span><br><span class=\"line\">   [ 1,  5,  9],</span><br><span class=\"line\">   [10, 11, 13],</span><br><span class=\"line\">   [12, 13, 15]</span><br><span class=\"line\">],</span><br><span class=\"line\">k = 8,</span><br><span class=\"line\"></span><br><span class=\"line\">return 13.</span><br></pre></td></tr></table></figure>\n<p><strong>Algorithm:</strong></p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Solution</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">kthSmallest</span><span class=\"params\">(<span class=\"number\">_</span> matrix: [[Int]], <span class=\"number\">_</span> k: Int)</span></span> -&gt; <span class=\"type\">Int</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">guard</span> !matrix.isEmpty, !matrix.first!.isEmpty, k &gt; <span class=\"number\">0</span> <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"number\">0</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">insert</span><span class=\"params\">(<span class=\"number\">_</span> arr: <span class=\"keyword\">inout</span> [<span class=\"params\">(Int, Int, Int)</span></span></span>], <span class=\"number\">_</span> new: (<span class=\"type\">Int</span>, <span class=\"type\">Int</span>, <span class=\"type\">Int</span>)) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">var</span> s = <span class=\"number\">0</span>, e = arr.<span class=\"built_in\">count</span>-<span class=\"number\">1</span></span><br><span class=\"line\">            <span class=\"keyword\">while</span> s &lt;= e &#123;</span><br><span class=\"line\">                <span class=\"keyword\">let</span> mid = (s + e) &gt;&gt; <span class=\"number\">1</span></span><br><span class=\"line\">                <span class=\"keyword\">if</span> (mid == <span class=\"number\">0</span> &amp;&amp; new.<span class=\"number\">0</span> &lt;= arr[mid].<span class=\"number\">0</span>) ||</span><br><span class=\"line\">                    (mid &gt; <span class=\"number\">0</span> &amp;&amp; new.<span class=\"number\">0</span> &gt; arr[mid-<span class=\"number\">1</span>].<span class=\"number\">0</span> &amp;&amp; new.<span class=\"number\">0</span> &lt;= arr[mid].<span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">                    arr.insert(new, at: mid)</span><br><span class=\"line\">                    <span class=\"keyword\">return</span></span><br><span class=\"line\">                &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> new.<span class=\"number\">0</span> &gt; arr[mid].<span class=\"number\">0</span> &#123;</span><br><span class=\"line\">                    s = mid + <span class=\"number\">1</span></span><br><span class=\"line\">                &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                    e = mid - <span class=\"number\">1</span></span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            arr.insert(new, at: arr.<span class=\"built_in\">count</span>)</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">var</span> arr = [(<span class=\"type\">Int</span>, <span class=\"type\">Int</span>, <span class=\"type\">Int</span>)]()</span><br><span class=\"line\">        <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> matrix.<span class=\"built_in\">indices</span> &#123;</span><br><span class=\"line\">            arr.append((matrix[i][<span class=\"number\">0</span>], i, <span class=\"number\">0</span>))</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">var</span> k = k, i = <span class=\"number\">0</span>, j = <span class=\"number\">0</span></span><br><span class=\"line\">        <span class=\"keyword\">while</span> !arr.isEmpty, k &gt; <span class=\"number\">0</span> &#123;</span><br><span class=\"line\">            (<span class=\"number\">_</span>, i, j) = arr.removeFirst()</span><br><span class=\"line\">            <span class=\"keyword\">if</span> j &lt; matrix.first!.<span class=\"built_in\">count</span>-<span class=\"number\">1</span> &#123;</span><br><span class=\"line\">                insert(&amp;arr, (matrix[i][j+<span class=\"number\">1</span>], i, j+<span class=\"number\">1</span>))</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            k -= <span class=\"number\">1</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> matrix[i][j]</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Solution</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">kthSmallest</span><span class=\"params\">(<span class=\"number\">_</span> matrix: [[Int]], <span class=\"number\">_</span> k: Int)</span></span> -&gt; <span class=\"type\">Int</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">guard</span> !matrix.isEmpty <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"number\">0</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">let</span> n = matrix.<span class=\"built_in\">count</span>-<span class=\"number\">1</span></span><br><span class=\"line\">        <span class=\"keyword\">var</span> lo = matrix[<span class=\"number\">0</span>][<span class=\"number\">0</span>], hi = matrix[n][n]</span><br><span class=\"line\">        <span class=\"keyword\">while</span> lo &lt; hi &#123;</span><br><span class=\"line\">            <span class=\"keyword\">let</span> mid = (lo + hi) &gt;&gt; <span class=\"number\">1</span></span><br><span class=\"line\">            <span class=\"keyword\">var</span> <span class=\"built_in\">count</span> = <span class=\"number\">0</span>, j = n</span><br><span class=\"line\">            <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"number\">0</span>...n &#123;</span><br><span class=\"line\">                <span class=\"keyword\">while</span> j &gt;= <span class=\"number\">0</span>, matrix[i][j] &gt; mid &#123;</span><br><span class=\"line\">                    j -= <span class=\"number\">1</span></span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                <span class=\"built_in\">count</span> += j + <span class=\"number\">1</span></span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> <span class=\"built_in\">count</span> &lt; k &#123;</span><br><span class=\"line\">                lo = mid + <span class=\"number\">1</span></span><br><span class=\"line\">            &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                hi = mid</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> lo</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>From leetCode <a href=\"https://leetcode.com/problems/kth-smallest-element-in-a-sorted-matrix/\" target=\"_blank\" rel=\"noopener\">378. Kth Smallest Element in a Sorted Matrix</a></p>\n<h1 id=\"kth-smallest-number-in-multiplication-table\">Kth Smallest Number in Multiplication Table</h1>\n<p>Nearly every one have used the Multiplication Table. But could you find out the k-th smallest number quickly from the multiplication table?</p>\n<p>Given the height m and the length n of a m * n Multiplication Table, and a positive integer k, you need to return the k-th smallest number in this table.</p>\n<p><strong>Example 1:</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Input: m = 3, n = 3, k = 5</span><br><span class=\"line\">Output: </span><br><span class=\"line\">Explanation: </span><br><span class=\"line\">The Multiplication Table:</span><br><span class=\"line\">1\t2\t3</span><br><span class=\"line\">2\t4\t6</span><br><span class=\"line\">3\t6\t9</span><br><span class=\"line\"></span><br><span class=\"line\">The 5-th smallest number is 3 (1, 2, 2, 3, 3).</span><br></pre></td></tr></table></figure>\n<p><strong>Example 2:</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Input: m = 2, n = 3, k = 6</span><br><span class=\"line\">Output: </span><br><span class=\"line\">Explanation: </span><br><span class=\"line\">The Multiplication Table:</span><br><span class=\"line\">1\t2\t3</span><br><span class=\"line\">2\t4\t6</span><br><span class=\"line\"></span><br><span class=\"line\">The 6-th smallest number is 6 (1, 2, 2, 3, 4, 6).</span><br></pre></td></tr></table></figure>\n<p><strong>Note:</strong></p>\n<ol>\n<li>The m and n will be in the range [1, 30000].</li>\n<li>The k will be in the range [1, m * n]</li>\n</ol>\n<p><strong>Algorithm:</strong></p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Solution</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">findKthNumber</span><span class=\"params\">(<span class=\"number\">_</span> m: Int, <span class=\"number\">_</span> n: Int, <span class=\"number\">_</span> k: Int)</span></span> -&gt; <span class=\"type\">Int</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">guard</span> m &gt; <span class=\"number\">0</span>, n &gt; <span class=\"number\">0</span>, k &gt; <span class=\"number\">0</span> <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"number\">0</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">var</span> lo = <span class=\"number\">1</span>, hi = m * n</span><br><span class=\"line\">        <span class=\"keyword\">while</span> lo &lt; hi &#123;</span><br><span class=\"line\">            <span class=\"keyword\">let</span> mid = (lo + hi) &gt;&gt; <span class=\"number\">1</span></span><br><span class=\"line\">            <span class=\"keyword\">var</span> <span class=\"built_in\">count</span> = <span class=\"number\">0</span>, nN = n</span><br><span class=\"line\">            <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"number\">1</span>...m &#123;</span><br><span class=\"line\">                <span class=\"keyword\">while</span> nN &gt; <span class=\"number\">0</span>, i * nN &gt; mid &#123;</span><br><span class=\"line\">                    nN -= <span class=\"number\">1</span></span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                <span class=\"built_in\">count</span> += nN</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> <span class=\"built_in\">count</span> &lt; k &#123;</span><br><span class=\"line\">                lo = mid + <span class=\"number\">1</span></span><br><span class=\"line\">            &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                hi = mid</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> lo</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>From leetCode <a href=\"https://leetcode.com/problems/kth-smallest-number-in-multiplication-table/\" target=\"_blank\" rel=\"noopener\">668. Kth Smallest Number in Multiplication Table</a></p>\n<h1 id=\"find-k-th-smallest-pair-distance\">Find K-th Smallest Pair Distance</h1>\n<p>Given an integer array, return the k-th smallest distance among all the pairs. The distance of a pair (A, B) is defined as the absolute difference between A and B.</p>\n<p><strong>Example 1:</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Input:</span><br><span class=\"line\">nums = [1,3,1]</span><br><span class=\"line\">k = 1</span><br><span class=\"line\">Output: 0 </span><br><span class=\"line\">Explanation:</span><br><span class=\"line\">Here are all the pairs:</span><br><span class=\"line\">(1,3) -&gt; 2</span><br><span class=\"line\">(1,1) -&gt; 0</span><br><span class=\"line\">(3,1) -&gt; 2</span><br><span class=\"line\">Then the 1st smallest distance pair is (1,1), and its distance is 0.</span><br></pre></td></tr></table></figure>\n<p><strong>Note:</strong></p>\n<ol>\n<li>2 &lt;= len(nums) &lt;= 10000.</li>\n<li>0 &lt;= nums[i] &lt; 1000000.</li>\n<li>1 &lt;= k &lt;= len(nums) * (len(nums) - 1) / 2.</li>\n</ol>\n<p><strong>Algorithm:</strong></p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Solution</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">smallestDistancePair</span><span class=\"params\">(<span class=\"number\">_</span> nums: [Int], <span class=\"number\">_</span> k: Int)</span></span> -&gt; <span class=\"type\">Int</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">guard</span> nums.<span class=\"built_in\">count</span> &gt; <span class=\"number\">1</span> <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"number\">0</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">let</span> sortedNums = nums.sorted()</span><br><span class=\"line\">        <span class=\"keyword\">var</span> lo = <span class=\"number\">0</span>, hi = sortedNums.last! - sortedNums.first!</span><br><span class=\"line\">        <span class=\"keyword\">while</span> lo &lt; hi &#123;</span><br><span class=\"line\">            <span class=\"keyword\">let</span> mid = (lo + hi) &gt;&gt; <span class=\"number\">1</span></span><br><span class=\"line\">            <span class=\"keyword\">var</span> <span class=\"built_in\">count</span> = <span class=\"number\">0</span>, i = <span class=\"number\">0</span></span><br><span class=\"line\">            <span class=\"keyword\">for</span> j <span class=\"keyword\">in</span> <span class=\"number\">0</span>..&lt;sortedNums.<span class=\"built_in\">count</span> &#123;</span><br><span class=\"line\">                <span class=\"keyword\">while</span> i &lt; sortedNums.<span class=\"built_in\">count</span>, sortedNums[j] - sortedNums[i] &gt; mid &#123;</span><br><span class=\"line\">                    i += <span class=\"number\">1</span></span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                <span class=\"built_in\">count</span> += j-i</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> <span class=\"built_in\">count</span> &lt; k &#123;</span><br><span class=\"line\">                lo = mid + <span class=\"number\">1</span></span><br><span class=\"line\">            &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                hi = mid</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> lo</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>From leetCode <a href=\"https://leetcode.com/problems/find-k-th-smallest-pair-distance/\" target=\"_blank\" rel=\"noopener\">719. Find K-th Smallest Pair Distance</a></p>\n<h1 id=\"k-th-smallest-prime-fraction\">K-th Smallest Prime Fraction</h1>\n<p>A sorted list A contains 1, plus some number of primes.  Then, for every p &lt; q in the list, we consider the fraction p/q.</p>\n<p>What is the K-th smallest fraction considered?  Return your answer as an array of ints, where answer[0] = p and answer[1] = q.</p>\n<p><strong>Example:</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Input: A = [1, 2, 3, 5], K = 3</span><br><span class=\"line\">Output: [2, 5]</span><br><span class=\"line\">Explanation:</span><br><span class=\"line\">The fractions to be considered in sorted order are:</span><br><span class=\"line\">1/5, 1/3, 2/5, 1/2, 3/5, 2/3.</span><br><span class=\"line\">The third fraction is 2/5.</span><br><span class=\"line\"></span><br><span class=\"line\">Input: A = [1, 7], K = 1</span><br><span class=\"line\">Output: [1, 7]</span><br></pre></td></tr></table></figure>\n<p><strong>Note:</strong></p>\n<ul>\n<li>A will have length between 2 and 2000.</li>\n<li>Each A[i] will be between 1 and 30000.</li>\n<li>K will be between 1 and A.length * (A.length - 1) / 2.</li>\n</ul>\n<p><strong>Algorithm:</strong></p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Solution</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">kthSmallestPrimeFraction</span><span class=\"params\">(<span class=\"number\">_</span> A: [Int], <span class=\"number\">_</span> K: Int)</span></span> -&gt; [<span class=\"type\">Int</span>] &#123;</span><br><span class=\"line\">        <span class=\"keyword\">let</span> n = <span class=\"type\">A</span>.<span class=\"built_in\">count</span></span><br><span class=\"line\">        <span class=\"keyword\">guard</span> n &gt; <span class=\"number\">1</span>, <span class=\"type\">K</span> &gt; <span class=\"number\">0</span> <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> []</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">var</span> lo = <span class=\"number\">0.0</span>, hi = <span class=\"number\">1.0</span></span><br><span class=\"line\">        <span class=\"keyword\">while</span> lo &lt; hi &#123;</span><br><span class=\"line\">            <span class=\"keyword\">let</span> mid = (lo + hi) / <span class=\"number\">2</span></span><br><span class=\"line\">            <span class=\"keyword\">var</span> j = <span class=\"number\">1</span>, <span class=\"built_in\">count</span> = <span class=\"number\">0</span>, maxVal = <span class=\"number\">0.0</span>, res = (<span class=\"number\">0</span>, <span class=\"number\">0</span>)</span><br><span class=\"line\">            <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"number\">0</span>..&lt;n-<span class=\"number\">1</span> &#123;</span><br><span class=\"line\">                <span class=\"keyword\">while</span> j &lt; n, <span class=\"type\">Double</span>(<span class=\"type\">A</span>[i]) &gt; mid * <span class=\"type\">Double</span>(<span class=\"type\">A</span>[j]) &#123;</span><br><span class=\"line\">                    j += <span class=\"number\">1</span></span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> n == j &#123;</span><br><span class=\"line\">                    <span class=\"keyword\">break</span></span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                <span class=\"built_in\">count</span> += n-j</span><br><span class=\"line\">                <span class=\"keyword\">let</span> val = <span class=\"type\">Double</span>(<span class=\"type\">A</span>[i]) / <span class=\"type\">Double</span>(<span class=\"type\">A</span>[j])</span><br><span class=\"line\">                <span class=\"keyword\">if</span> val &gt; maxVal &#123;</span><br><span class=\"line\">                    res = (i, j)</span><br><span class=\"line\">                    maxVal = val</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> <span class=\"built_in\">count</span> &lt; <span class=\"type\">K</span> &#123;</span><br><span class=\"line\">                lo = mid</span><br><span class=\"line\">            &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> <span class=\"built_in\">count</span> == <span class=\"type\">K</span> &#123;</span><br><span class=\"line\">                <span class=\"keyword\">return</span> [<span class=\"type\">A</span>[res.<span class=\"number\">0</span>], <span class=\"type\">A</span>[res.<span class=\"number\">1</span>]]</span><br><span class=\"line\">            &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                hi = mid</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> []</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>From leetCode <a href=\"https://leetcode.com/problems/k-th-smallest-prime-fraction/\" target=\"_blank\" rel=\"noopener\">786. K-th Smallest Prime Fraction</a></p>\n<h1 id=\"minimum-cost-to-hire-k-workers\">Minimum Cost to Hire K Workers</h1>\n<p>There are N workers.  The i-th worker has a quality[i] and a minimum wage expectation wage[i].</p>\n<p>Now we want to hire exactly K workers to form a paid group.  When hiring a group of K workers, we must pay them according to the following rules:</p>\n<ol>\n<li>Every worker in the paid group should be paid in the ratio of their quality compared to other workers in the paid group.</li>\n<li>Every worker in the paid group must be paid at least their minimum wage expectation.</li>\n</ol>\n<p>Return the least amount of money needed to form a paid group satisfying the above conditions.</p>\n<p><strong>Example 1:</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Input: quality = [10,20,5], wage = [70,50,30], K = 2</span><br><span class=\"line\">Output: 105.00000</span><br><span class=\"line\">Explanation: We pay 70 to 0-th worker and 35 to 2-th worker.</span><br></pre></td></tr></table></figure>\n<p><strong>Example 2:</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Input: quality = [3,1,10,10,1], wage = [4,8,2,2,7], K = 3</span><br><span class=\"line\">Output: 30.66667</span><br><span class=\"line\">Explanation: We pay 4 to 0-th worker, 13.33333 to 2-th and 3-th workers seperately.</span><br></pre></td></tr></table></figure>\n<p><strong>Note:</strong></p>\n<ol>\n<li>1 &lt;= K &lt;= N &lt;= 10000, where N = quality.length = wage.length</li>\n<li>1 &lt;= quality[i] &lt;= 10000</li>\n<li>1 &lt;= wage[i] &lt;= 10000</li>\n<li>Answers within 10^-5 of the correct answer will be considered correct.</li>\n</ol>\n<p><strong>Algorithm:</strong></p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Solution</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">mincostToHireWorkers</span><span class=\"params\">(<span class=\"number\">_</span> quality: [Int], <span class=\"number\">_</span> wage: [Int], <span class=\"number\">_</span> K: Int)</span></span> -&gt; <span class=\"type\">Double</span> &#123;</span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">insert</span>&lt;T: Comparable&gt;<span class=\"params\">(<span class=\"number\">_</span> new: <span class=\"params\">(T, Int)</span></span></span>, <span class=\"number\">_</span> arr: <span class=\"keyword\">inout</span> [(<span class=\"type\">T</span>, <span class=\"type\">Int</span>)]) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">var</span> l = <span class=\"number\">0</span>, r = arr.<span class=\"built_in\">count</span>-<span class=\"number\">1</span></span><br><span class=\"line\">            <span class=\"keyword\">while</span> l &lt;= r &#123;</span><br><span class=\"line\">                <span class=\"keyword\">let</span> mid = (l+r) &gt;&gt; <span class=\"number\">1</span></span><br><span class=\"line\">                <span class=\"keyword\">if</span> (mid == <span class=\"number\">0</span> &amp;&amp; new.<span class=\"number\">0</span> &lt;= arr[mid].<span class=\"number\">0</span>) ||</span><br><span class=\"line\">                    (mid &gt; <span class=\"number\">0</span> &amp;&amp; new.<span class=\"number\">0</span> &lt;= arr[mid].<span class=\"number\">0</span> &amp;&amp; new.<span class=\"number\">0</span> &gt; arr[mid-<span class=\"number\">1</span>].<span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">                    arr.insert(new, at: mid)</span><br><span class=\"line\">                    <span class=\"keyword\">return</span></span><br><span class=\"line\">                &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> new.<span class=\"number\">0</span> &gt; arr[mid].<span class=\"number\">0</span> &#123;</span><br><span class=\"line\">                    l = mid + <span class=\"number\">1</span></span><br><span class=\"line\">                &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                    r = mid - <span class=\"number\">1</span></span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            arr.insert(new, at: arr.<span class=\"built_in\">count</span>)</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">var</span> arr = [(<span class=\"type\">Double</span>, <span class=\"type\">Int</span>)]()</span><br><span class=\"line\">        <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> quality.<span class=\"built_in\">indices</span> &#123;</span><br><span class=\"line\">            insert((<span class=\"type\">Double</span>(wage[i]) / <span class=\"type\">Double</span>(quality[i]), i), &amp;arr)</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">var</span> res = pow(<span class=\"number\">10.0</span>, <span class=\"number\">10.0</span>)</span><br><span class=\"line\">        <span class=\"keyword\">var</span> qualities = [(<span class=\"type\">Int</span>, <span class=\"type\">Int</span>)]()</span><br><span class=\"line\">        <span class=\"keyword\">var</span> sump = <span class=\"number\">0</span></span><br><span class=\"line\">        <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"number\">0</span>..&lt;arr.<span class=\"built_in\">count</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">let</span> temp = quality[arr[i].<span class=\"number\">1</span>]</span><br><span class=\"line\">            insert((temp, arr[i].<span class=\"number\">1</span>), &amp;qualities)</span><br><span class=\"line\">            sump += temp</span><br><span class=\"line\">            <span class=\"keyword\">if</span> qualities.<span class=\"built_in\">count</span> &gt; <span class=\"type\">K</span> &#123;</span><br><span class=\"line\">                sump -= qualities.popLast()!.<span class=\"number\">0</span></span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> qualities.<span class=\"built_in\">count</span> == <span class=\"type\">K</span> &#123;</span><br><span class=\"line\">                <span class=\"keyword\">let</span> ratio = arr[i].<span class=\"number\">0</span></span><br><span class=\"line\">                res = <span class=\"built_in\">min</span>(res, <span class=\"type\">Double</span>(sump) * ratio)</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> res</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>From leetCode <a href=\"https://leetcode.com/problems/minimum-cost-to-hire-k-workers/\" target=\"_blank\" rel=\"noopener\">857. Minimum Cost to Hire K Workers</a></p>\n","site":{"data":{}},"excerpt":"","more":"<h1>Introduction</h1>\n<p>Here is the summary about the kth problems in LeetCode.</p>\n<h1>Kth Largest Element in an Array</h1>\n<p>Find the kth largest element in an unsorted array. Note that it is the kth largest element in the sorted order, not the kth distinct element.</p>\n<p><strong>Example 1:</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Input: [3,2,1,5,6,4] and k = 2</span><br><span class=\"line\">Output: 5</span><br></pre></td></tr></table></figure>\n<p><strong>Example 2:</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Input: [3,2,3,1,2,4,5,5,6] and k = 4</span><br><span class=\"line\">Output: 4</span><br></pre></td></tr></table></figure>\n<p><strong>Algorithm</strong></p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Solution</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">findKthLargest</span><span class=\"params\">(<span class=\"number\">_</span> nums: [Int], <span class=\"number\">_</span> k: Int)</span></span> -&gt; <span class=\"type\">Int</span> &#123;</span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">quickSort</span><span class=\"params\">(<span class=\"number\">_</span> nums: <span class=\"keyword\">inout</span> [Int], <span class=\"number\">_</span> l: Int, <span class=\"number\">_</span> r: Int)</span></span> -&gt; <span class=\"type\">Int</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">var</span> l = l, r = r</span><br><span class=\"line\">            <span class=\"keyword\">let</span> key = nums[l]</span><br><span class=\"line\">            <span class=\"keyword\">while</span> l &lt; r &#123;</span><br><span class=\"line\">                <span class=\"keyword\">while</span> l &lt; r, key &gt;= nums[r] &#123;</span><br><span class=\"line\">                    r -= <span class=\"number\">1</span></span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                nums[l] = nums[r]</span><br><span class=\"line\">                <span class=\"keyword\">while</span> l &lt; r, key &lt;= nums[l] &#123;</span><br><span class=\"line\">                    l += <span class=\"number\">1</span></span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                nums[r] = nums[l]</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            nums[l] = key</span><br><span class=\"line\">            <span class=\"keyword\">return</span> l</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">var</span> l = <span class=\"number\">0</span>, r = nums.<span class=\"built_in\">count</span>-<span class=\"number\">1</span>, nums = nums</span><br><span class=\"line\">        <span class=\"keyword\">while</span> l &lt; r &#123;</span><br><span class=\"line\">            <span class=\"keyword\">let</span> index = <span class=\"built_in\">quickSort</span>(&amp;nums, l, r)</span><br><span class=\"line\">            <span class=\"keyword\">switch</span> index &#123;</span><br><span class=\"line\">            <span class=\"keyword\">case</span> k - <span class=\"number\">1</span>:</span><br><span class=\"line\">                <span class=\"keyword\">return</span> nums[index]</span><br><span class=\"line\">            <span class=\"keyword\">case</span> <span class=\"number\">0</span>..&lt;k-<span class=\"number\">1</span>:</span><br><span class=\"line\">                l = index + <span class=\"number\">1</span></span><br><span class=\"line\">                <span class=\"keyword\">break</span></span><br><span class=\"line\">            <span class=\"keyword\">default</span>:</span><br><span class=\"line\">                r = index - <span class=\"number\">1</span></span><br><span class=\"line\">                <span class=\"keyword\">break</span></span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> nums[k-<span class=\"number\">1</span>]</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>From leetCode <a href=\"https://leetcode.com/problems/kth-largest-element-in-an-array/\" target=\"_blank\" rel=\"noopener\">215. Kth Largest Element in an Array</a></p>\n<h1>Kth Smallest Element in a BST</h1>\n<p>Given a binary search tree, write a function kthSmallest to find the kth smallest element in it.</p>\n<p><strong>Note:</strong></p>\n<p>You may assume k is always valid, 1  k  BSTs total elements.</p>\n<p><strong>Example 1:</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Input: root = [3,1,4,null,2], k = 1</span><br><span class=\"line\">   3</span><br><span class=\"line\">  / \\</span><br><span class=\"line\"> 1   4</span><br><span class=\"line\">  \\</span><br><span class=\"line\">   2</span><br><span class=\"line\">Output: 1</span><br></pre></td></tr></table></figure>\n<p><strong>Exapmle 2:</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Input: root = [5,3,6,2,4,null,null,1], k = 3</span><br><span class=\"line\">       5</span><br><span class=\"line\">      / \\</span><br><span class=\"line\">     3   6</span><br><span class=\"line\">    / \\</span><br><span class=\"line\">   2   4</span><br><span class=\"line\">  /</span><br><span class=\"line\"> 1</span><br><span class=\"line\">Output: 3</span><br></pre></td></tr></table></figure>\n<p><strong>Algorithm:</strong></p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">TreeNode</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">var</span> val: <span class=\"type\">Int</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">var</span> <span class=\"keyword\">left</span>: <span class=\"type\">TreeNode</span>?</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">var</span> <span class=\"keyword\">right</span>: <span class=\"type\">TreeNode</span>?</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">init</span>(<span class=\"number\">_</span> val: <span class=\"type\">Int</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">self</span>.val = val</span><br><span class=\"line\">        <span class=\"keyword\">self</span>.<span class=\"keyword\">left</span> = <span class=\"literal\">nil</span></span><br><span class=\"line\">        <span class=\"keyword\">self</span>.<span class=\"keyword\">right</span> = <span class=\"literal\">nil</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Solution</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">kthSmallest</span><span class=\"params\">(<span class=\"number\">_</span> root: TreeNode?, <span class=\"number\">_</span> k: Int)</span></span> -&gt; <span class=\"type\">Int</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">var</span> stack = [<span class=\"type\">TreeNode</span>]()</span><br><span class=\"line\">        <span class=\"keyword\">var</span> cur = root</span><br><span class=\"line\">        <span class=\"keyword\">var</span> k = k</span><br><span class=\"line\">        <span class=\"keyword\">while</span> cur != <span class=\"literal\">nil</span> || !stack.isEmpty &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> <span class=\"keyword\">let</span> temp = cur &#123;</span><br><span class=\"line\">                stack.append(temp)</span><br><span class=\"line\">                cur = temp.<span class=\"keyword\">left</span></span><br><span class=\"line\">            &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                <span class=\"keyword\">let</span> last = stack.removeLast()</span><br><span class=\"line\">                k -= <span class=\"number\">1</span></span><br><span class=\"line\">                <span class=\"keyword\">if</span> k == <span class=\"number\">0</span> &#123;</span><br><span class=\"line\">                    <span class=\"keyword\">return</span> last.val</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                cur = last.<span class=\"keyword\">right</span></span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">0</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>From leetCode <a href=\"https://leetcode.com/problems/kth-smallest-element-in-a-bst/\" target=\"_blank\" rel=\"noopener\">230. Kth Smallest Element in a BST</a></p>\n<h1>Find K Pairs with Smallest Sums</h1>\n<p>You are given two integer arrays nums1 and nums2 sorted in ascending order and an integer k.</p>\n<p>Define a pair (u,v) which consists of one element from the first array and one element from the second array.</p>\n<p>Find the k pairs (u1,v1),(u2,v2) (uk,vk) with the smallest sums.</p>\n<p><strong>Example 1:</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Input: nums1 = [1,7,11], nums2 = [2,4,6], k = 3</span><br><span class=\"line\">Output: [[1,2],[1,4],[1,6]] </span><br><span class=\"line\">Explanation: The first 3 pairs are returned from the sequence: </span><br><span class=\"line\">             [1,2],[1,4],[1,6],[7,2],[7,4],[11,2],[7,6],[11,4],[11,6]</span><br></pre></td></tr></table></figure>\n<p><strong>Example 2:</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Input: nums1 = [1,1,2], nums2 = [1,2,3], k = 2</span><br><span class=\"line\">Output: [1,1],[1,1]</span><br><span class=\"line\">Explanation: The first 2 pairs are returned from the sequence: </span><br><span class=\"line\">             [1,1],[1,1],[1,2],[2,1],[1,2],[2,2],[1,3],[1,3],[2,3]</span><br></pre></td></tr></table></figure>\n<p><strong>Example 3:</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Input: nums1 = [1,2], nums2 = [3], k = 3</span><br><span class=\"line\">Output: [1,3],[2,3]</span><br><span class=\"line\">Explanation: All possible pairs are returned from the sequence: [1,3],[2,3]</span><br></pre></td></tr></table></figure>\n<p><strong>Algorithm:</strong></p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Solution</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">kSmallestPairs</span><span class=\"params\">(<span class=\"number\">_</span> nums1: [Int], <span class=\"number\">_</span> nums2: [Int], <span class=\"number\">_</span> k: Int)</span></span> -&gt; [[<span class=\"type\">Int</span>]] &#123;</span><br><span class=\"line\">        <span class=\"keyword\">guard</span> !nums1.isEmpty, !nums2.isEmpty, k &gt;= <span class=\"number\">0</span> <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> []</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">insert</span><span class=\"params\">(<span class=\"number\">_</span> arr: <span class=\"keyword\">inout</span> [<span class=\"params\">(Int, Int, Int)</span></span></span>], <span class=\"number\">_</span> new: (<span class=\"type\">Int</span>, <span class=\"type\">Int</span>, <span class=\"type\">Int</span>)) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">var</span> s = <span class=\"number\">0</span>, e = arr.<span class=\"built_in\">count</span>-<span class=\"number\">1</span></span><br><span class=\"line\">            <span class=\"keyword\">while</span> s &lt;= e &#123;</span><br><span class=\"line\">                <span class=\"keyword\">let</span> mid = (s + e) &gt;&gt; <span class=\"number\">1</span></span><br><span class=\"line\">                <span class=\"keyword\">if</span> (mid == <span class=\"number\">0</span> &amp;&amp; new.<span class=\"number\">0</span> &lt;= arr[mid].<span class=\"number\">0</span>) ||</span><br><span class=\"line\">                    (mid &gt; <span class=\"number\">0</span> &amp;&amp; new.<span class=\"number\">0</span> &gt;= arr[mid-<span class=\"number\">1</span>].<span class=\"number\">0</span> &amp;&amp; new.<span class=\"number\">0</span> &lt;= arr[mid].<span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">                    arr.insert(new, at: mid)</span><br><span class=\"line\">                    <span class=\"keyword\">return</span></span><br><span class=\"line\">                &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> new.<span class=\"number\">0</span> &gt; arr[mid].<span class=\"number\">0</span> &#123;</span><br><span class=\"line\">                    s = mid + <span class=\"number\">1</span></span><br><span class=\"line\">                &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                    e = mid - <span class=\"number\">1</span></span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            arr.insert(new, at: arr.<span class=\"built_in\">count</span>)</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">var</span> arr = [(<span class=\"type\">Int</span>, <span class=\"type\">Int</span>, <span class=\"type\">Int</span>)]()</span><br><span class=\"line\">        <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> nums1.<span class=\"built_in\">indices</span> &#123;</span><br><span class=\"line\">            arr.append((nums1[i]+nums2[<span class=\"number\">0</span>], i, <span class=\"number\">0</span>))</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">var</span> res = [[<span class=\"type\">Int</span>]]()</span><br><span class=\"line\">        <span class=\"keyword\">while</span> !arr.isEmpty, res.<span class=\"built_in\">count</span> &lt; k &#123;</span><br><span class=\"line\">            <span class=\"keyword\">let</span> (<span class=\"number\">_</span>, i, j) = arr.removeFirst()</span><br><span class=\"line\">            res.append([nums1[i], nums2[j]])</span><br><span class=\"line\">            <span class=\"keyword\">if</span> j &lt; nums2.<span class=\"built_in\">count</span>-<span class=\"number\">1</span> &#123;</span><br><span class=\"line\">                insert(&amp;arr, (nums1[i]+nums2[j+<span class=\"number\">1</span>], i, j+<span class=\"number\">1</span>))</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> res</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><strong>Comment:</strong></p>\n<p>Here is a simple example demonstrate how this algorithm works:</p>\n<p><img src=\"/img/article/20191216/1.png\" alt=\"example\"></p>\n<p>From leetCode <a href=\"https://leetcode.com/problems/find-k-pairs-with-smallest-sums/\" target=\"_blank\" rel=\"noopener\">373. Find K Pairs with Smallest Sums</a></p>\n<h1>Kth Smallest Element in a Sorted Matrix</h1>\n<p>Given a n x n matrix where each of the rows and columns are sorted in ascending order, find the kth smallest element in the matrix.</p>\n<p>Note that it is the kth smallest element in the sorted order, not the kth distinct element.</p>\n<p><strong>Example:</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">matrix = [</span><br><span class=\"line\">   [ 1,  5,  9],</span><br><span class=\"line\">   [10, 11, 13],</span><br><span class=\"line\">   [12, 13, 15]</span><br><span class=\"line\">],</span><br><span class=\"line\">k = 8,</span><br><span class=\"line\"></span><br><span class=\"line\">return 13.</span><br></pre></td></tr></table></figure>\n<p><strong>Algorithm:</strong></p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Solution</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">kthSmallest</span><span class=\"params\">(<span class=\"number\">_</span> matrix: [[Int]], <span class=\"number\">_</span> k: Int)</span></span> -&gt; <span class=\"type\">Int</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">guard</span> !matrix.isEmpty, !matrix.first!.isEmpty, k &gt; <span class=\"number\">0</span> <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"number\">0</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">insert</span><span class=\"params\">(<span class=\"number\">_</span> arr: <span class=\"keyword\">inout</span> [<span class=\"params\">(Int, Int, Int)</span></span></span>], <span class=\"number\">_</span> new: (<span class=\"type\">Int</span>, <span class=\"type\">Int</span>, <span class=\"type\">Int</span>)) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">var</span> s = <span class=\"number\">0</span>, e = arr.<span class=\"built_in\">count</span>-<span class=\"number\">1</span></span><br><span class=\"line\">            <span class=\"keyword\">while</span> s &lt;= e &#123;</span><br><span class=\"line\">                <span class=\"keyword\">let</span> mid = (s + e) &gt;&gt; <span class=\"number\">1</span></span><br><span class=\"line\">                <span class=\"keyword\">if</span> (mid == <span class=\"number\">0</span> &amp;&amp; new.<span class=\"number\">0</span> &lt;= arr[mid].<span class=\"number\">0</span>) ||</span><br><span class=\"line\">                    (mid &gt; <span class=\"number\">0</span> &amp;&amp; new.<span class=\"number\">0</span> &gt; arr[mid-<span class=\"number\">1</span>].<span class=\"number\">0</span> &amp;&amp; new.<span class=\"number\">0</span> &lt;= arr[mid].<span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">                    arr.insert(new, at: mid)</span><br><span class=\"line\">                    <span class=\"keyword\">return</span></span><br><span class=\"line\">                &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> new.<span class=\"number\">0</span> &gt; arr[mid].<span class=\"number\">0</span> &#123;</span><br><span class=\"line\">                    s = mid + <span class=\"number\">1</span></span><br><span class=\"line\">                &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                    e = mid - <span class=\"number\">1</span></span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            arr.insert(new, at: arr.<span class=\"built_in\">count</span>)</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">var</span> arr = [(<span class=\"type\">Int</span>, <span class=\"type\">Int</span>, <span class=\"type\">Int</span>)]()</span><br><span class=\"line\">        <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> matrix.<span class=\"built_in\">indices</span> &#123;</span><br><span class=\"line\">            arr.append((matrix[i][<span class=\"number\">0</span>], i, <span class=\"number\">0</span>))</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">var</span> k = k, i = <span class=\"number\">0</span>, j = <span class=\"number\">0</span></span><br><span class=\"line\">        <span class=\"keyword\">while</span> !arr.isEmpty, k &gt; <span class=\"number\">0</span> &#123;</span><br><span class=\"line\">            (<span class=\"number\">_</span>, i, j) = arr.removeFirst()</span><br><span class=\"line\">            <span class=\"keyword\">if</span> j &lt; matrix.first!.<span class=\"built_in\">count</span>-<span class=\"number\">1</span> &#123;</span><br><span class=\"line\">                insert(&amp;arr, (matrix[i][j+<span class=\"number\">1</span>], i, j+<span class=\"number\">1</span>))</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            k -= <span class=\"number\">1</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> matrix[i][j]</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Solution</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">kthSmallest</span><span class=\"params\">(<span class=\"number\">_</span> matrix: [[Int]], <span class=\"number\">_</span> k: Int)</span></span> -&gt; <span class=\"type\">Int</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">guard</span> !matrix.isEmpty <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"number\">0</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">let</span> n = matrix.<span class=\"built_in\">count</span>-<span class=\"number\">1</span></span><br><span class=\"line\">        <span class=\"keyword\">var</span> lo = matrix[<span class=\"number\">0</span>][<span class=\"number\">0</span>], hi = matrix[n][n]</span><br><span class=\"line\">        <span class=\"keyword\">while</span> lo &lt; hi &#123;</span><br><span class=\"line\">            <span class=\"keyword\">let</span> mid = (lo + hi) &gt;&gt; <span class=\"number\">1</span></span><br><span class=\"line\">            <span class=\"keyword\">var</span> <span class=\"built_in\">count</span> = <span class=\"number\">0</span>, j = n</span><br><span class=\"line\">            <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"number\">0</span>...n &#123;</span><br><span class=\"line\">                <span class=\"keyword\">while</span> j &gt;= <span class=\"number\">0</span>, matrix[i][j] &gt; mid &#123;</span><br><span class=\"line\">                    j -= <span class=\"number\">1</span></span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                <span class=\"built_in\">count</span> += j + <span class=\"number\">1</span></span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> <span class=\"built_in\">count</span> &lt; k &#123;</span><br><span class=\"line\">                lo = mid + <span class=\"number\">1</span></span><br><span class=\"line\">            &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                hi = mid</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> lo</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>From leetCode <a href=\"https://leetcode.com/problems/kth-smallest-element-in-a-sorted-matrix/\" target=\"_blank\" rel=\"noopener\">378. Kth Smallest Element in a Sorted Matrix</a></p>\n<h1>Kth Smallest Number in Multiplication Table</h1>\n<p>Nearly every one have used the Multiplication Table. But could you find out the k-th smallest number quickly from the multiplication table?</p>\n<p>Given the height m and the length n of a m * n Multiplication Table, and a positive integer k, you need to return the k-th smallest number in this table.</p>\n<p><strong>Example 1:</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Input: m = 3, n = 3, k = 5</span><br><span class=\"line\">Output: </span><br><span class=\"line\">Explanation: </span><br><span class=\"line\">The Multiplication Table:</span><br><span class=\"line\">1\t2\t3</span><br><span class=\"line\">2\t4\t6</span><br><span class=\"line\">3\t6\t9</span><br><span class=\"line\"></span><br><span class=\"line\">The 5-th smallest number is 3 (1, 2, 2, 3, 3).</span><br></pre></td></tr></table></figure>\n<p><strong>Example 2:</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Input: m = 2, n = 3, k = 6</span><br><span class=\"line\">Output: </span><br><span class=\"line\">Explanation: </span><br><span class=\"line\">The Multiplication Table:</span><br><span class=\"line\">1\t2\t3</span><br><span class=\"line\">2\t4\t6</span><br><span class=\"line\"></span><br><span class=\"line\">The 6-th smallest number is 6 (1, 2, 2, 3, 4, 6).</span><br></pre></td></tr></table></figure>\n<p><strong>Note:</strong></p>\n<ol>\n<li>The m and n will be in the range [1, 30000].</li>\n<li>The k will be in the range [1, m * n]</li>\n</ol>\n<p><strong>Algorithm:</strong></p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Solution</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">findKthNumber</span><span class=\"params\">(<span class=\"number\">_</span> m: Int, <span class=\"number\">_</span> n: Int, <span class=\"number\">_</span> k: Int)</span></span> -&gt; <span class=\"type\">Int</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">guard</span> m &gt; <span class=\"number\">0</span>, n &gt; <span class=\"number\">0</span>, k &gt; <span class=\"number\">0</span> <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"number\">0</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">var</span> lo = <span class=\"number\">1</span>, hi = m * n</span><br><span class=\"line\">        <span class=\"keyword\">while</span> lo &lt; hi &#123;</span><br><span class=\"line\">            <span class=\"keyword\">let</span> mid = (lo + hi) &gt;&gt; <span class=\"number\">1</span></span><br><span class=\"line\">            <span class=\"keyword\">var</span> <span class=\"built_in\">count</span> = <span class=\"number\">0</span>, nN = n</span><br><span class=\"line\">            <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"number\">1</span>...m &#123;</span><br><span class=\"line\">                <span class=\"keyword\">while</span> nN &gt; <span class=\"number\">0</span>, i * nN &gt; mid &#123;</span><br><span class=\"line\">                    nN -= <span class=\"number\">1</span></span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                <span class=\"built_in\">count</span> += nN</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> <span class=\"built_in\">count</span> &lt; k &#123;</span><br><span class=\"line\">                lo = mid + <span class=\"number\">1</span></span><br><span class=\"line\">            &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                hi = mid</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> lo</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>From leetCode <a href=\"https://leetcode.com/problems/kth-smallest-number-in-multiplication-table/\" target=\"_blank\" rel=\"noopener\">668. Kth Smallest Number in Multiplication Table</a></p>\n<h1>Find K-th Smallest Pair Distance</h1>\n<p>Given an integer array, return the k-th smallest distance among all the pairs. The distance of a pair (A, B) is defined as the absolute difference between A and B.</p>\n<p><strong>Example 1:</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Input:</span><br><span class=\"line\">nums = [1,3,1]</span><br><span class=\"line\">k = 1</span><br><span class=\"line\">Output: 0 </span><br><span class=\"line\">Explanation:</span><br><span class=\"line\">Here are all the pairs:</span><br><span class=\"line\">(1,3) -&gt; 2</span><br><span class=\"line\">(1,1) -&gt; 0</span><br><span class=\"line\">(3,1) -&gt; 2</span><br><span class=\"line\">Then the 1st smallest distance pair is (1,1), and its distance is 0.</span><br></pre></td></tr></table></figure>\n<p><strong>Note:</strong></p>\n<ol>\n<li>2 &lt;= len(nums) &lt;= 10000.</li>\n<li>0 &lt;= nums[i] &lt; 1000000.</li>\n<li>1 &lt;= k &lt;= len(nums) * (len(nums) - 1) / 2.</li>\n</ol>\n<p><strong>Algorithm:</strong></p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Solution</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">smallestDistancePair</span><span class=\"params\">(<span class=\"number\">_</span> nums: [Int], <span class=\"number\">_</span> k: Int)</span></span> -&gt; <span class=\"type\">Int</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">guard</span> nums.<span class=\"built_in\">count</span> &gt; <span class=\"number\">1</span> <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"number\">0</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">let</span> sortedNums = nums.sorted()</span><br><span class=\"line\">        <span class=\"keyword\">var</span> lo = <span class=\"number\">0</span>, hi = sortedNums.last! - sortedNums.first!</span><br><span class=\"line\">        <span class=\"keyword\">while</span> lo &lt; hi &#123;</span><br><span class=\"line\">            <span class=\"keyword\">let</span> mid = (lo + hi) &gt;&gt; <span class=\"number\">1</span></span><br><span class=\"line\">            <span class=\"keyword\">var</span> <span class=\"built_in\">count</span> = <span class=\"number\">0</span>, i = <span class=\"number\">0</span></span><br><span class=\"line\">            <span class=\"keyword\">for</span> j <span class=\"keyword\">in</span> <span class=\"number\">0</span>..&lt;sortedNums.<span class=\"built_in\">count</span> &#123;</span><br><span class=\"line\">                <span class=\"keyword\">while</span> i &lt; sortedNums.<span class=\"built_in\">count</span>, sortedNums[j] - sortedNums[i] &gt; mid &#123;</span><br><span class=\"line\">                    i += <span class=\"number\">1</span></span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                <span class=\"built_in\">count</span> += j-i</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> <span class=\"built_in\">count</span> &lt; k &#123;</span><br><span class=\"line\">                lo = mid + <span class=\"number\">1</span></span><br><span class=\"line\">            &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                hi = mid</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> lo</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>From leetCode <a href=\"https://leetcode.com/problems/find-k-th-smallest-pair-distance/\" target=\"_blank\" rel=\"noopener\">719. Find K-th Smallest Pair Distance</a></p>\n<h1>K-th Smallest Prime Fraction</h1>\n<p>A sorted list A contains 1, plus some number of primes.  Then, for every p &lt; q in the list, we consider the fraction p/q.</p>\n<p>What is the K-th smallest fraction considered?  Return your answer as an array of ints, where answer[0] = p and answer[1] = q.</p>\n<p><strong>Example:</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Input: A = [1, 2, 3, 5], K = 3</span><br><span class=\"line\">Output: [2, 5]</span><br><span class=\"line\">Explanation:</span><br><span class=\"line\">The fractions to be considered in sorted order are:</span><br><span class=\"line\">1/5, 1/3, 2/5, 1/2, 3/5, 2/3.</span><br><span class=\"line\">The third fraction is 2/5.</span><br><span class=\"line\"></span><br><span class=\"line\">Input: A = [1, 7], K = 1</span><br><span class=\"line\">Output: [1, 7]</span><br></pre></td></tr></table></figure>\n<p><strong>Note:</strong></p>\n<ul>\n<li>A will have length between 2 and 2000.</li>\n<li>Each A[i] will be between 1 and 30000.</li>\n<li>K will be between 1 and A.length * (A.length - 1) / 2.</li>\n</ul>\n<p><strong>Algorithm:</strong></p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Solution</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">kthSmallestPrimeFraction</span><span class=\"params\">(<span class=\"number\">_</span> A: [Int], <span class=\"number\">_</span> K: Int)</span></span> -&gt; [<span class=\"type\">Int</span>] &#123;</span><br><span class=\"line\">        <span class=\"keyword\">let</span> n = <span class=\"type\">A</span>.<span class=\"built_in\">count</span></span><br><span class=\"line\">        <span class=\"keyword\">guard</span> n &gt; <span class=\"number\">1</span>, <span class=\"type\">K</span> &gt; <span class=\"number\">0</span> <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> []</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">var</span> lo = <span class=\"number\">0.0</span>, hi = <span class=\"number\">1.0</span></span><br><span class=\"line\">        <span class=\"keyword\">while</span> lo &lt; hi &#123;</span><br><span class=\"line\">            <span class=\"keyword\">let</span> mid = (lo + hi) / <span class=\"number\">2</span></span><br><span class=\"line\">            <span class=\"keyword\">var</span> j = <span class=\"number\">1</span>, <span class=\"built_in\">count</span> = <span class=\"number\">0</span>, maxVal = <span class=\"number\">0.0</span>, res = (<span class=\"number\">0</span>, <span class=\"number\">0</span>)</span><br><span class=\"line\">            <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"number\">0</span>..&lt;n-<span class=\"number\">1</span> &#123;</span><br><span class=\"line\">                <span class=\"keyword\">while</span> j &lt; n, <span class=\"type\">Double</span>(<span class=\"type\">A</span>[i]) &gt; mid * <span class=\"type\">Double</span>(<span class=\"type\">A</span>[j]) &#123;</span><br><span class=\"line\">                    j += <span class=\"number\">1</span></span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> n == j &#123;</span><br><span class=\"line\">                    <span class=\"keyword\">break</span></span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                <span class=\"built_in\">count</span> += n-j</span><br><span class=\"line\">                <span class=\"keyword\">let</span> val = <span class=\"type\">Double</span>(<span class=\"type\">A</span>[i]) / <span class=\"type\">Double</span>(<span class=\"type\">A</span>[j])</span><br><span class=\"line\">                <span class=\"keyword\">if</span> val &gt; maxVal &#123;</span><br><span class=\"line\">                    res = (i, j)</span><br><span class=\"line\">                    maxVal = val</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> <span class=\"built_in\">count</span> &lt; <span class=\"type\">K</span> &#123;</span><br><span class=\"line\">                lo = mid</span><br><span class=\"line\">            &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> <span class=\"built_in\">count</span> == <span class=\"type\">K</span> &#123;</span><br><span class=\"line\">                <span class=\"keyword\">return</span> [<span class=\"type\">A</span>[res.<span class=\"number\">0</span>], <span class=\"type\">A</span>[res.<span class=\"number\">1</span>]]</span><br><span class=\"line\">            &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                hi = mid</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> []</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>From leetCode <a href=\"https://leetcode.com/problems/k-th-smallest-prime-fraction/\" target=\"_blank\" rel=\"noopener\">786. K-th Smallest Prime Fraction</a></p>\n<h1>Minimum Cost to Hire K Workers</h1>\n<p>There are N workers.  The i-th worker has a quality[i] and a minimum wage expectation wage[i].</p>\n<p>Now we want to hire exactly K workers to form a paid group.  When hiring a group of K workers, we must pay them according to the following rules:</p>\n<ol>\n<li>Every worker in the paid group should be paid in the ratio of their quality compared to other workers in the paid group.</li>\n<li>Every worker in the paid group must be paid at least their minimum wage expectation.</li>\n</ol>\n<p>Return the least amount of money needed to form a paid group satisfying the above conditions.</p>\n<p><strong>Example 1:</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Input: quality = [10,20,5], wage = [70,50,30], K = 2</span><br><span class=\"line\">Output: 105.00000</span><br><span class=\"line\">Explanation: We pay 70 to 0-th worker and 35 to 2-th worker.</span><br></pre></td></tr></table></figure>\n<p><strong>Example 2:</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Input: quality = [3,1,10,10,1], wage = [4,8,2,2,7], K = 3</span><br><span class=\"line\">Output: 30.66667</span><br><span class=\"line\">Explanation: We pay 4 to 0-th worker, 13.33333 to 2-th and 3-th workers seperately.</span><br></pre></td></tr></table></figure>\n<p><strong>Note:</strong></p>\n<ol>\n<li>1 &lt;= K &lt;= N &lt;= 10000, where N = quality.length = wage.length</li>\n<li>1 &lt;= quality[i] &lt;= 10000</li>\n<li>1 &lt;= wage[i] &lt;= 10000</li>\n<li>Answers within 10^-5 of the correct answer will be considered correct.</li>\n</ol>\n<p><strong>Algorithm:</strong></p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Solution</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">mincostToHireWorkers</span><span class=\"params\">(<span class=\"number\">_</span> quality: [Int], <span class=\"number\">_</span> wage: [Int], <span class=\"number\">_</span> K: Int)</span></span> -&gt; <span class=\"type\">Double</span> &#123;</span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">insert</span>&lt;T: Comparable&gt;<span class=\"params\">(<span class=\"number\">_</span> new: <span class=\"params\">(T, Int)</span></span></span>, <span class=\"number\">_</span> arr: <span class=\"keyword\">inout</span> [(<span class=\"type\">T</span>, <span class=\"type\">Int</span>)]) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">var</span> l = <span class=\"number\">0</span>, r = arr.<span class=\"built_in\">count</span>-<span class=\"number\">1</span></span><br><span class=\"line\">            <span class=\"keyword\">while</span> l &lt;= r &#123;</span><br><span class=\"line\">                <span class=\"keyword\">let</span> mid = (l+r) &gt;&gt; <span class=\"number\">1</span></span><br><span class=\"line\">                <span class=\"keyword\">if</span> (mid == <span class=\"number\">0</span> &amp;&amp; new.<span class=\"number\">0</span> &lt;= arr[mid].<span class=\"number\">0</span>) ||</span><br><span class=\"line\">                    (mid &gt; <span class=\"number\">0</span> &amp;&amp; new.<span class=\"number\">0</span> &lt;= arr[mid].<span class=\"number\">0</span> &amp;&amp; new.<span class=\"number\">0</span> &gt; arr[mid-<span class=\"number\">1</span>].<span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">                    arr.insert(new, at: mid)</span><br><span class=\"line\">                    <span class=\"keyword\">return</span></span><br><span class=\"line\">                &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> new.<span class=\"number\">0</span> &gt; arr[mid].<span class=\"number\">0</span> &#123;</span><br><span class=\"line\">                    l = mid + <span class=\"number\">1</span></span><br><span class=\"line\">                &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                    r = mid - <span class=\"number\">1</span></span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            arr.insert(new, at: arr.<span class=\"built_in\">count</span>)</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">var</span> arr = [(<span class=\"type\">Double</span>, <span class=\"type\">Int</span>)]()</span><br><span class=\"line\">        <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> quality.<span class=\"built_in\">indices</span> &#123;</span><br><span class=\"line\">            insert((<span class=\"type\">Double</span>(wage[i]) / <span class=\"type\">Double</span>(quality[i]), i), &amp;arr)</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">var</span> res = pow(<span class=\"number\">10.0</span>, <span class=\"number\">10.0</span>)</span><br><span class=\"line\">        <span class=\"keyword\">var</span> qualities = [(<span class=\"type\">Int</span>, <span class=\"type\">Int</span>)]()</span><br><span class=\"line\">        <span class=\"keyword\">var</span> sump = <span class=\"number\">0</span></span><br><span class=\"line\">        <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"number\">0</span>..&lt;arr.<span class=\"built_in\">count</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">let</span> temp = quality[arr[i].<span class=\"number\">1</span>]</span><br><span class=\"line\">            insert((temp, arr[i].<span class=\"number\">1</span>), &amp;qualities)</span><br><span class=\"line\">            sump += temp</span><br><span class=\"line\">            <span class=\"keyword\">if</span> qualities.<span class=\"built_in\">count</span> &gt; <span class=\"type\">K</span> &#123;</span><br><span class=\"line\">                sump -= qualities.popLast()!.<span class=\"number\">0</span></span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> qualities.<span class=\"built_in\">count</span> == <span class=\"type\">K</span> &#123;</span><br><span class=\"line\">                <span class=\"keyword\">let</span> ratio = arr[i].<span class=\"number\">0</span></span><br><span class=\"line\">                res = <span class=\"built_in\">min</span>(res, <span class=\"type\">Double</span>(sump) * ratio)</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> res</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>From leetCode <a href=\"https://leetcode.com/problems/minimum-cost-to-hire-k-workers/\" target=\"_blank\" rel=\"noopener\">857. Minimum Cost to Hire K Workers</a></p>\n"},{"title":"Sliding Window algorithm - substring search problems","catalog":true,"toc_nav_num":true,"date":"2019-10-07T10:39:23.000Z","subtitle":"Leet Code","header-img":"/img/article_header/article_header.png","busuanzi":true,"_content":"\n# Introduction\n\nSliding Window algorithm template to solve almost Leetcode substring search problem.\n\n# Find All Anagrams in a String\n\nGiven a string **s** and a **non-empty** string **p**, find all the start indices of **p**'s anagrams in **s**.\n\nStrings consists of lowercase English letters only and the length of both strings **s** and **p**will not be larger than 20,100.\n\nThe order of output does not matter.\n\n**Example 1:**\n```\nInput:\ns: \"cbaebabacd\" p: \"abc\"\n\nOutput:\n[0, 6]\n\nExplanation:\nThe substring with start index = 0 is \"cba\", which is an anagram of \"abc\".\nThe substring with start index = 6 is \"bac\", which is an anagram of \"abc\".\n```\n\n**Example 2:**\n```\nInput:\ns: \"abab\" p: \"ab\"\n\nOutput:\n[0, 1, 2]\n\nExplanation:\nThe substring with start index = 0 is \"ab\", which is an anagram of \"ab\".\nThe substring with start index = 1 is \"ba\", which is an anagram of \"ab\".\nThe substring with start index = 2 is \"ab\", which is an anagram of \"ab\".\n```\n\n**Algorithm:**\n``` swift\nclass Solution {\n    func findAnagrams(_ s: String, _ p: String) -> [Int] {\n        guard !s.isEmpty, !p.isEmpty, s.count >= p.count else {\n            return []\n        }\n        var map = [Character: Int]()\n        for c in p {\n            map.updateValue(map[c, default: 0] + 1, forKey: c)\n        }\n        var start = 0, end = 0\n        var result = [Int]()\n        var p = Array(p), s = Array(s)\n        var counter = map.count\n        while end < s.count {\n            let sE = s[end]\n            if let mapValue = map[sE] {\n                map.updateValue(mapValue-1, forKey: sE)\n                if mapValue == 1 {\n                    counter -= 1\n                }\n            }\n            end += 1\n            while counter == 0 {\n                let sS = s[start]\n                if let mapValue = map[sS] {\n                    map.updateValue(mapValue+1, forKey: sS)\n                    if mapValue >= 0 {\n                        counter += 1\n                    }\n                }\n                if end-start == p.count {\n                    result.append(start)\n                }\n                start += 1\n            }\n        }\n        return result\n    }\n}\n```\n\nFrom leetCode [438. Find All Anagrams in a String](https://leetcode.com/problems/find-all-anagrams-in-a-string/)\n\n# Minimum Window Substring\n\nGiven a string S and a string T, find the minimum window in S which will contain all the characters in T in complexity **O(n)**.\n\n**Example:**\n```\nInput: S = \"ADOBECODEBANC\", T = \"ABC\"\nOutput: \"BANC\"\n```\n\n**Note:**\n- If there is no such window in S that convers all characters in T, return the empty string \"\".\n- If there is such window, you are guaranteed that there will always be only one unique minimum window in S.\n\n**algorithm:**\n``` swift\nclass Solution {\n    func minWindow(_ s: String, _ t: String) -> String {\n        guard !s.isEmpty, !t.isEmpty, s.count >= t.count else {\n            return \"\"\n        }\n        var map = [Character: Int]()\n        for tS in t {\n            map.updateValue(map[tS, default: 0] + 1, forKey: tS)\n        }\n        var start = 0, end = 0, counter = map.count\n        let sA = Array(s)\n        var result = (-1, s.count+1)\n        while end < sA.count {\n            let sE = sA[end]\n            if let mapValue = map[sE] {\n                map.updateValue(mapValue-1, forKey: sE)\n                if mapValue == 1 {\n                    counter -= 1\n                }\n            }\n            end += 1\n            while counter == 0 {\n                let sS = sA[start]\n                if let mapValue = map[sS] {\n                    map.updateValue(mapValue+1, forKey: sS)\n                    if mapValue >= 0 {\n                        counter += 1\n                    }\n                }\n                if end-start < result.1 {\n                    result = (start, end-start)\n                }\n                start += 1\n            }\n        }\n        return result.0 == -1 ? \"\" : String(s[s.index(s.startIndex, offsetBy: result.0)..<s.index(s.startIndex, offsetBy: result.0+result.1)])\n    }\n}\n```\n\nFrom leetCode [76. Minimum Window Substring](https://leetcode.com/problems/minimum-window-substring/)\n\n# Longest Substring Without Repeating Characters\n\nGiven a string, find the length of the **longest substring** without repeating characters.\n\n**Example 1:**\n```\nInput: \"abcabcbb\"\nOutput: 3 \nExplanation: The answer is \"abc\", with the length of 3. \n```\n\n**Example 2:**\n```\nInput: \"bbbbb\"\nOutput: 1\nExplanation: The answer is \"b\", with the length of 1.\n```\n\n**Example 3:**\n```\nInput: \"pwwkew\"\nOutput: 3\nExplanation: The answer is \"wke\", with the length of 3. \nNote: that the answer must be a substring, \"pwke\" is a subsequence and not a substring.\n```\n\n**Algorithm:**\n``` swift\nclass Solution {\n    func lengthOfLongestSubstring(_ s: String) -> Int {\n        guard !s.isEmpty else {\n            return 0\n        }\n        let sA = Array(s)\n        var map = [Character: Int]()\n        var start = 0, end = 0, counter = 0, result = 0\n        while end < sA.count {\n            let sE = sA[end]\n            if let oldValue = map.updateValue(map[sE, default: 0] + 1, forKey: sE), oldValue > 0 {\n                counter += 1\n            }\n            end += 1\n            while counter > 0 {\n                let sS = sA[start]\n                if let oldValue = map.updateValue(map[sS, default: 0] - 1, forKey: sS), oldValue > 1 {\n                    counter -= 1\n                }\n                start += 1\n            }\n            result = max(result, end-start)\n        }\n        return result\n    }\n}\n```\n\nFrom leetCode [3. Longest Substring Without Repeating Characters](https://leetcode.com/problems/longest-substring-without-repeating-characters/)\n\n# Substring with Concatenation of All Words\n\nYou are given a string, **s**, and a list of words, **words**, that are all of the same length. Find all starting indices of substring(s) in **s** that is a concatenation of each words exactly once and without any intervening characters.\n\n**Example 1:**\n```\nInput:\n  s = \"barfoothefoobarman\",\n  words = [\"foo\",\"bar\"]\nOutput: [0,9]\nExplanation: Substrings starting at index 0 and 9 are \"barfoor\" and \"foobar\" respectively.\nThe output order does not matter, returning [9,0] is fine too.\n```\n\n**Example 2:**\n```\nInput:\n  s = \"wordgoodgoodgoodbestword\",\n  words = [\"word\",\"good\",\"best\",\"word\"]\nOutput: []\n```\n\n**Algorithm:**\n``` swift\nclass Solution {\n    func findSubstring(_ s: String, _ words: [String]) -> [Int] {\n        guard !s.isEmpty, !words.isEmpty, s.count >= words.first!.count else {\n            return []\n        }\n        var map = [String: Int]()\n        for word in words {\n            map.updateValue(map[word, default: 0] + 1, forKey: word)\n        }\n        let sA = Array(s)\n        var curMap = [String: Int]()\n        let wl = words.first!.count\n        var result = [Int]()\n        for i in 0..<wl {\n            var start = i\n            var count = 0\n            for j in stride(from: i, through: s.count-wl, by: wl) {\n                let str = String(sA[j..<j+wl])\n                if let mapValue = map[str] {\n                    curMap.updateValue(curMap[str, default: 0] + 1, forKey: str)\n                    if curMap[str]! <= mapValue {\n                        count += 1\n                    }\n                    \n                    while curMap[str]! > map[str]! {\n                        let tmp = String(sA[start..<start+wl])\n                        curMap.updateValue(curMap[tmp, default: 0] - 1, forKey: tmp)\n                        start += wl\n                        if curMap[tmp]! < map[tmp]! {\n                            count -= 1\n                        }\n                    }\n                    if count == words.count {\n                        result.append(start)\n                        let tmp = String(sA[start..<start+wl])\n                        curMap.updateValue(curMap[tmp, default: 0] - 1, forKey: tmp)\n                        start += wl\n                        count -= 1\n                    }\n                } else {\n                    start = j + wl\n                    count = 0\n                    curMap.removeAll()\n                }\n            }\n            curMap.removeAll()\n        }\n        return result\n    }\n}\n```\n\nFrom leetCode [30. Substring with Concatenation of All Words](https://leetcode.com/problems/substring-with-concatenation-of-all-words/)","source":"_posts/2019/leetcode-substring-search-problems-1007.md","raw":"---\ntitle: \"Sliding Window algorithm - substring search problems\"\ncatalog: true\ntoc_nav_num: true\ndate: 2019-10-07 18:39:23\nsubtitle: \"Leet Code\"\nheader-img: \"/img/article_header/article_header.png\"\nbusuanzi: true\ntags:\n- iOS - Swift\n\n---\n\n# Introduction\n\nSliding Window algorithm template to solve almost Leetcode substring search problem.\n\n# Find All Anagrams in a String\n\nGiven a string **s** and a **non-empty** string **p**, find all the start indices of **p**'s anagrams in **s**.\n\nStrings consists of lowercase English letters only and the length of both strings **s** and **p**will not be larger than 20,100.\n\nThe order of output does not matter.\n\n**Example 1:**\n```\nInput:\ns: \"cbaebabacd\" p: \"abc\"\n\nOutput:\n[0, 6]\n\nExplanation:\nThe substring with start index = 0 is \"cba\", which is an anagram of \"abc\".\nThe substring with start index = 6 is \"bac\", which is an anagram of \"abc\".\n```\n\n**Example 2:**\n```\nInput:\ns: \"abab\" p: \"ab\"\n\nOutput:\n[0, 1, 2]\n\nExplanation:\nThe substring with start index = 0 is \"ab\", which is an anagram of \"ab\".\nThe substring with start index = 1 is \"ba\", which is an anagram of \"ab\".\nThe substring with start index = 2 is \"ab\", which is an anagram of \"ab\".\n```\n\n**Algorithm:**\n``` swift\nclass Solution {\n    func findAnagrams(_ s: String, _ p: String) -> [Int] {\n        guard !s.isEmpty, !p.isEmpty, s.count >= p.count else {\n            return []\n        }\n        var map = [Character: Int]()\n        for c in p {\n            map.updateValue(map[c, default: 0] + 1, forKey: c)\n        }\n        var start = 0, end = 0\n        var result = [Int]()\n        var p = Array(p), s = Array(s)\n        var counter = map.count\n        while end < s.count {\n            let sE = s[end]\n            if let mapValue = map[sE] {\n                map.updateValue(mapValue-1, forKey: sE)\n                if mapValue == 1 {\n                    counter -= 1\n                }\n            }\n            end += 1\n            while counter == 0 {\n                let sS = s[start]\n                if let mapValue = map[sS] {\n                    map.updateValue(mapValue+1, forKey: sS)\n                    if mapValue >= 0 {\n                        counter += 1\n                    }\n                }\n                if end-start == p.count {\n                    result.append(start)\n                }\n                start += 1\n            }\n        }\n        return result\n    }\n}\n```\n\nFrom leetCode [438. Find All Anagrams in a String](https://leetcode.com/problems/find-all-anagrams-in-a-string/)\n\n# Minimum Window Substring\n\nGiven a string S and a string T, find the minimum window in S which will contain all the characters in T in complexity **O(n)**.\n\n**Example:**\n```\nInput: S = \"ADOBECODEBANC\", T = \"ABC\"\nOutput: \"BANC\"\n```\n\n**Note:**\n- If there is no such window in S that convers all characters in T, return the empty string \"\".\n- If there is such window, you are guaranteed that there will always be only one unique minimum window in S.\n\n**algorithm:**\n``` swift\nclass Solution {\n    func minWindow(_ s: String, _ t: String) -> String {\n        guard !s.isEmpty, !t.isEmpty, s.count >= t.count else {\n            return \"\"\n        }\n        var map = [Character: Int]()\n        for tS in t {\n            map.updateValue(map[tS, default: 0] + 1, forKey: tS)\n        }\n        var start = 0, end = 0, counter = map.count\n        let sA = Array(s)\n        var result = (-1, s.count+1)\n        while end < sA.count {\n            let sE = sA[end]\n            if let mapValue = map[sE] {\n                map.updateValue(mapValue-1, forKey: sE)\n                if mapValue == 1 {\n                    counter -= 1\n                }\n            }\n            end += 1\n            while counter == 0 {\n                let sS = sA[start]\n                if let mapValue = map[sS] {\n                    map.updateValue(mapValue+1, forKey: sS)\n                    if mapValue >= 0 {\n                        counter += 1\n                    }\n                }\n                if end-start < result.1 {\n                    result = (start, end-start)\n                }\n                start += 1\n            }\n        }\n        return result.0 == -1 ? \"\" : String(s[s.index(s.startIndex, offsetBy: result.0)..<s.index(s.startIndex, offsetBy: result.0+result.1)])\n    }\n}\n```\n\nFrom leetCode [76. Minimum Window Substring](https://leetcode.com/problems/minimum-window-substring/)\n\n# Longest Substring Without Repeating Characters\n\nGiven a string, find the length of the **longest substring** without repeating characters.\n\n**Example 1:**\n```\nInput: \"abcabcbb\"\nOutput: 3 \nExplanation: The answer is \"abc\", with the length of 3. \n```\n\n**Example 2:**\n```\nInput: \"bbbbb\"\nOutput: 1\nExplanation: The answer is \"b\", with the length of 1.\n```\n\n**Example 3:**\n```\nInput: \"pwwkew\"\nOutput: 3\nExplanation: The answer is \"wke\", with the length of 3. \nNote: that the answer must be a substring, \"pwke\" is a subsequence and not a substring.\n```\n\n**Algorithm:**\n``` swift\nclass Solution {\n    func lengthOfLongestSubstring(_ s: String) -> Int {\n        guard !s.isEmpty else {\n            return 0\n        }\n        let sA = Array(s)\n        var map = [Character: Int]()\n        var start = 0, end = 0, counter = 0, result = 0\n        while end < sA.count {\n            let sE = sA[end]\n            if let oldValue = map.updateValue(map[sE, default: 0] + 1, forKey: sE), oldValue > 0 {\n                counter += 1\n            }\n            end += 1\n            while counter > 0 {\n                let sS = sA[start]\n                if let oldValue = map.updateValue(map[sS, default: 0] - 1, forKey: sS), oldValue > 1 {\n                    counter -= 1\n                }\n                start += 1\n            }\n            result = max(result, end-start)\n        }\n        return result\n    }\n}\n```\n\nFrom leetCode [3. Longest Substring Without Repeating Characters](https://leetcode.com/problems/longest-substring-without-repeating-characters/)\n\n# Substring with Concatenation of All Words\n\nYou are given a string, **s**, and a list of words, **words**, that are all of the same length. Find all starting indices of substring(s) in **s** that is a concatenation of each words exactly once and without any intervening characters.\n\n**Example 1:**\n```\nInput:\n  s = \"barfoothefoobarman\",\n  words = [\"foo\",\"bar\"]\nOutput: [0,9]\nExplanation: Substrings starting at index 0 and 9 are \"barfoor\" and \"foobar\" respectively.\nThe output order does not matter, returning [9,0] is fine too.\n```\n\n**Example 2:**\n```\nInput:\n  s = \"wordgoodgoodgoodbestword\",\n  words = [\"word\",\"good\",\"best\",\"word\"]\nOutput: []\n```\n\n**Algorithm:**\n``` swift\nclass Solution {\n    func findSubstring(_ s: String, _ words: [String]) -> [Int] {\n        guard !s.isEmpty, !words.isEmpty, s.count >= words.first!.count else {\n            return []\n        }\n        var map = [String: Int]()\n        for word in words {\n            map.updateValue(map[word, default: 0] + 1, forKey: word)\n        }\n        let sA = Array(s)\n        var curMap = [String: Int]()\n        let wl = words.first!.count\n        var result = [Int]()\n        for i in 0..<wl {\n            var start = i\n            var count = 0\n            for j in stride(from: i, through: s.count-wl, by: wl) {\n                let str = String(sA[j..<j+wl])\n                if let mapValue = map[str] {\n                    curMap.updateValue(curMap[str, default: 0] + 1, forKey: str)\n                    if curMap[str]! <= mapValue {\n                        count += 1\n                    }\n                    \n                    while curMap[str]! > map[str]! {\n                        let tmp = String(sA[start..<start+wl])\n                        curMap.updateValue(curMap[tmp, default: 0] - 1, forKey: tmp)\n                        start += wl\n                        if curMap[tmp]! < map[tmp]! {\n                            count -= 1\n                        }\n                    }\n                    if count == words.count {\n                        result.append(start)\n                        let tmp = String(sA[start..<start+wl])\n                        curMap.updateValue(curMap[tmp, default: 0] - 1, forKey: tmp)\n                        start += wl\n                        count -= 1\n                    }\n                } else {\n                    start = j + wl\n                    count = 0\n                    curMap.removeAll()\n                }\n            }\n            curMap.removeAll()\n        }\n        return result\n    }\n}\n```\n\nFrom leetCode [30. Substring with Concatenation of All Words](https://leetcode.com/problems/substring-with-concatenation-of-all-words/)","slug":"2019/leetcode-substring-search-problems-1007","published":1,"updated":"2021-06-21T12:34:52.092Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckszp3nd4000eifnto182kh5u","content":"<h1 id=\"introduction\">Introduction</h1>\n<p>Sliding Window algorithm template to solve almost Leetcode substring search problem.</p>\n<h1 id=\"find-all-anagrams-in-a-string\">Find All Anagrams in a String</h1>\n<p>Given a string <strong>s</strong> and a <strong>non-empty</strong> string <strong>p</strong>, find all the start indices of <strong>p</strong>s anagrams in <strong>s</strong>.</p>\n<p>Strings consists of lowercase English letters only and the length of both strings <strong>s</strong> and <strong>p</strong>will not be larger than 20,100.</p>\n<p>The order of output does not matter.</p>\n<p><strong>Example 1:</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Input:</span><br><span class=\"line\">s: &quot;cbaebabacd&quot; p: &quot;abc&quot;</span><br><span class=\"line\"></span><br><span class=\"line\">Output:</span><br><span class=\"line\">[0, 6]</span><br><span class=\"line\"></span><br><span class=\"line\">Explanation:</span><br><span class=\"line\">The substring with start index = 0 is &quot;cba&quot;, which is an anagram of &quot;abc&quot;.</span><br><span class=\"line\">The substring with start index = 6 is &quot;bac&quot;, which is an anagram of &quot;abc&quot;.</span><br></pre></td></tr></table></figure>\n<p><strong>Example 2:</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Input:</span><br><span class=\"line\">s: &quot;abab&quot; p: &quot;ab&quot;</span><br><span class=\"line\"></span><br><span class=\"line\">Output:</span><br><span class=\"line\">[0, 1, 2]</span><br><span class=\"line\"></span><br><span class=\"line\">Explanation:</span><br><span class=\"line\">The substring with start index = 0 is &quot;ab&quot;, which is an anagram of &quot;ab&quot;.</span><br><span class=\"line\">The substring with start index = 1 is &quot;ba&quot;, which is an anagram of &quot;ab&quot;.</span><br><span class=\"line\">The substring with start index = 2 is &quot;ab&quot;, which is an anagram of &quot;ab&quot;.</span><br></pre></td></tr></table></figure>\n<p><strong>Algorithm:</strong></p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Solution</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">findAnagrams</span><span class=\"params\">(<span class=\"number\">_</span> s: String, <span class=\"number\">_</span> p: String)</span></span> -&gt; [<span class=\"type\">Int</span>] &#123;</span><br><span class=\"line\">        <span class=\"keyword\">guard</span> !s.isEmpty, !p.isEmpty, s.<span class=\"built_in\">count</span> &gt;= p.<span class=\"built_in\">count</span> <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> []</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">var</span> <span class=\"built_in\">map</span> = [<span class=\"type\">Character</span>: <span class=\"type\">Int</span>]()</span><br><span class=\"line\">        <span class=\"keyword\">for</span> <span class=\"built_in\">c</span> <span class=\"keyword\">in</span> p &#123;</span><br><span class=\"line\">            <span class=\"built_in\">map</span>.updateValue(<span class=\"built_in\">map</span>[<span class=\"built_in\">c</span>, <span class=\"keyword\">default</span>: <span class=\"number\">0</span>] + <span class=\"number\">1</span>, forKey: <span class=\"built_in\">c</span>)</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">var</span> start = <span class=\"number\">0</span>, end = <span class=\"number\">0</span></span><br><span class=\"line\">        <span class=\"keyword\">var</span> result = [<span class=\"type\">Int</span>]()</span><br><span class=\"line\">        <span class=\"keyword\">var</span> p = <span class=\"type\">Array</span>(p), s = <span class=\"type\">Array</span>(s)</span><br><span class=\"line\">        <span class=\"keyword\">var</span> counter = <span class=\"built_in\">map</span>.<span class=\"built_in\">count</span></span><br><span class=\"line\">        <span class=\"keyword\">while</span> end &lt; s.<span class=\"built_in\">count</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">let</span> sE = s[end]</span><br><span class=\"line\">            <span class=\"keyword\">if</span> <span class=\"keyword\">let</span> mapValue = <span class=\"built_in\">map</span>[sE] &#123;</span><br><span class=\"line\">                <span class=\"built_in\">map</span>.updateValue(mapValue-<span class=\"number\">1</span>, forKey: sE)</span><br><span class=\"line\">                <span class=\"keyword\">if</span> mapValue == <span class=\"number\">1</span> &#123;</span><br><span class=\"line\">                    counter -= <span class=\"number\">1</span></span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            end += <span class=\"number\">1</span></span><br><span class=\"line\">            <span class=\"keyword\">while</span> counter == <span class=\"number\">0</span> &#123;</span><br><span class=\"line\">                <span class=\"keyword\">let</span> sS = s[start]</span><br><span class=\"line\">                <span class=\"keyword\">if</span> <span class=\"keyword\">let</span> mapValue = <span class=\"built_in\">map</span>[sS] &#123;</span><br><span class=\"line\">                    <span class=\"built_in\">map</span>.updateValue(mapValue+<span class=\"number\">1</span>, forKey: sS)</span><br><span class=\"line\">                    <span class=\"keyword\">if</span> mapValue &gt;= <span class=\"number\">0</span> &#123;</span><br><span class=\"line\">                        counter += <span class=\"number\">1</span></span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> end-start == p.<span class=\"built_in\">count</span> &#123;</span><br><span class=\"line\">                    result.append(start)</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                start += <span class=\"number\">1</span></span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> result</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>From leetCode <a href=\"https://leetcode.com/problems/find-all-anagrams-in-a-string/\" target=\"_blank\" rel=\"noopener\">438. Find All Anagrams in a String</a></p>\n<h1 id=\"minimum-window-substring\">Minimum Window Substring</h1>\n<p>Given a string S and a string T, find the minimum window in S which will contain all the characters in T in complexity <strong>O(n)</strong>.</p>\n<p><strong>Example:</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Input: S = &quot;ADOBECODEBANC&quot;, T = &quot;ABC&quot;</span><br><span class=\"line\">Output: &quot;BANC&quot;</span><br></pre></td></tr></table></figure>\n<p><strong>Note:</strong></p>\n<ul>\n<li>If there is no such window in S that convers all characters in T, return the empty string .</li>\n<li>If there is such window, you are guaranteed that there will always be only one unique minimum window in S.</li>\n</ul>\n<p><strong>algorithm:</strong></p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Solution</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">minWindow</span><span class=\"params\">(<span class=\"number\">_</span> s: String, <span class=\"number\">_</span> t: String)</span></span> -&gt; <span class=\"type\">String</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">guard</span> !s.isEmpty, !t.isEmpty, s.<span class=\"built_in\">count</span> &gt;= t.<span class=\"built_in\">count</span> <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"string\">\"\"</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">var</span> <span class=\"built_in\">map</span> = [<span class=\"type\">Character</span>: <span class=\"type\">Int</span>]()</span><br><span class=\"line\">        <span class=\"keyword\">for</span> tS <span class=\"keyword\">in</span> t &#123;</span><br><span class=\"line\">            <span class=\"built_in\">map</span>.updateValue(<span class=\"built_in\">map</span>[tS, <span class=\"keyword\">default</span>: <span class=\"number\">0</span>] + <span class=\"number\">1</span>, forKey: tS)</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">var</span> start = <span class=\"number\">0</span>, end = <span class=\"number\">0</span>, counter = <span class=\"built_in\">map</span>.<span class=\"built_in\">count</span></span><br><span class=\"line\">        <span class=\"keyword\">let</span> sA = <span class=\"type\">Array</span>(s)</span><br><span class=\"line\">        <span class=\"keyword\">var</span> result = (-<span class=\"number\">1</span>, s.<span class=\"built_in\">count</span>+<span class=\"number\">1</span>)</span><br><span class=\"line\">        <span class=\"keyword\">while</span> end &lt; sA.<span class=\"built_in\">count</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">let</span> sE = sA[end]</span><br><span class=\"line\">            <span class=\"keyword\">if</span> <span class=\"keyword\">let</span> mapValue = <span class=\"built_in\">map</span>[sE] &#123;</span><br><span class=\"line\">                <span class=\"built_in\">map</span>.updateValue(mapValue-<span class=\"number\">1</span>, forKey: sE)</span><br><span class=\"line\">                <span class=\"keyword\">if</span> mapValue == <span class=\"number\">1</span> &#123;</span><br><span class=\"line\">                    counter -= <span class=\"number\">1</span></span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            end += <span class=\"number\">1</span></span><br><span class=\"line\">            <span class=\"keyword\">while</span> counter == <span class=\"number\">0</span> &#123;</span><br><span class=\"line\">                <span class=\"keyword\">let</span> sS = sA[start]</span><br><span class=\"line\">                <span class=\"keyword\">if</span> <span class=\"keyword\">let</span> mapValue = <span class=\"built_in\">map</span>[sS] &#123;</span><br><span class=\"line\">                    <span class=\"built_in\">map</span>.updateValue(mapValue+<span class=\"number\">1</span>, forKey: sS)</span><br><span class=\"line\">                    <span class=\"keyword\">if</span> mapValue &gt;= <span class=\"number\">0</span> &#123;</span><br><span class=\"line\">                        counter += <span class=\"number\">1</span></span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> end-start &lt; result.<span class=\"number\">1</span> &#123;</span><br><span class=\"line\">                    result = (start, end-start)</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                start += <span class=\"number\">1</span></span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> result.<span class=\"number\">0</span> == -<span class=\"number\">1</span> ? <span class=\"string\">\"\"</span> : <span class=\"type\">String</span>(s[s.index(s.startIndex, offsetBy: result.<span class=\"number\">0</span>)..&lt;s.index(s.startIndex, offsetBy: result.<span class=\"number\">0</span>+result.<span class=\"number\">1</span>)])</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>From leetCode <a href=\"https://leetcode.com/problems/minimum-window-substring/\" target=\"_blank\" rel=\"noopener\">76. Minimum Window Substring</a></p>\n<h1 id=\"longest-substring-without-repeating-characters\">Longest Substring Without Repeating Characters</h1>\n<p>Given a string, find the length of the <strong>longest substring</strong> without repeating characters.</p>\n<p><strong>Example 1:</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Input: &quot;abcabcbb&quot;</span><br><span class=\"line\">Output: 3 </span><br><span class=\"line\">Explanation: The answer is &quot;abc&quot;, with the length of 3.</span><br></pre></td></tr></table></figure>\n<p><strong>Example 2:</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Input: &quot;bbbbb&quot;</span><br><span class=\"line\">Output: 1</span><br><span class=\"line\">Explanation: The answer is &quot;b&quot;, with the length of 1.</span><br></pre></td></tr></table></figure>\n<p><strong>Example 3:</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Input: &quot;pwwkew&quot;</span><br><span class=\"line\">Output: 3</span><br><span class=\"line\">Explanation: The answer is &quot;wke&quot;, with the length of 3. </span><br><span class=\"line\">Note: that the answer must be a substring, &quot;pwke&quot; is a subsequence and not a substring.</span><br></pre></td></tr></table></figure>\n<p><strong>Algorithm:</strong></p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Solution</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">lengthOfLongestSubstring</span><span class=\"params\">(<span class=\"number\">_</span> s: String)</span></span> -&gt; <span class=\"type\">Int</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">guard</span> !s.isEmpty <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"number\">0</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">let</span> sA = <span class=\"type\">Array</span>(s)</span><br><span class=\"line\">        <span class=\"keyword\">var</span> <span class=\"built_in\">map</span> = [<span class=\"type\">Character</span>: <span class=\"type\">Int</span>]()</span><br><span class=\"line\">        <span class=\"keyword\">var</span> start = <span class=\"number\">0</span>, end = <span class=\"number\">0</span>, counter = <span class=\"number\">0</span>, result = <span class=\"number\">0</span></span><br><span class=\"line\">        <span class=\"keyword\">while</span> end &lt; sA.<span class=\"built_in\">count</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">let</span> sE = sA[end]</span><br><span class=\"line\">            <span class=\"keyword\">if</span> <span class=\"keyword\">let</span> oldValue = <span class=\"built_in\">map</span>.updateValue(<span class=\"built_in\">map</span>[sE, <span class=\"keyword\">default</span>: <span class=\"number\">0</span>] + <span class=\"number\">1</span>, forKey: sE), oldValue &gt; <span class=\"number\">0</span> &#123;</span><br><span class=\"line\">                counter += <span class=\"number\">1</span></span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            end += <span class=\"number\">1</span></span><br><span class=\"line\">            <span class=\"keyword\">while</span> counter &gt; <span class=\"number\">0</span> &#123;</span><br><span class=\"line\">                <span class=\"keyword\">let</span> sS = sA[start]</span><br><span class=\"line\">                <span class=\"keyword\">if</span> <span class=\"keyword\">let</span> oldValue = <span class=\"built_in\">map</span>.updateValue(<span class=\"built_in\">map</span>[sS, <span class=\"keyword\">default</span>: <span class=\"number\">0</span>] - <span class=\"number\">1</span>, forKey: sS), oldValue &gt; <span class=\"number\">1</span> &#123;</span><br><span class=\"line\">                    counter -= <span class=\"number\">1</span></span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                start += <span class=\"number\">1</span></span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            result = <span class=\"built_in\">max</span>(result, end-start)</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> result</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>From leetCode <a href=\"https://leetcode.com/problems/longest-substring-without-repeating-characters/\" target=\"_blank\" rel=\"noopener\">3. Longest Substring Without Repeating Characters</a></p>\n<h1 id=\"substring-with-concatenation-of-all-words\">Substring with Concatenation of All Words</h1>\n<p>You are given a string, <strong>s</strong>, and a list of words, <strong>words</strong>, that are all of the same length. Find all starting indices of substring(s) in <strong>s</strong> that is a concatenation of each words exactly once and without any intervening characters.</p>\n<p><strong>Example 1:</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Input:</span><br><span class=\"line\">  s = &quot;barfoothefoobarman&quot;,</span><br><span class=\"line\">  words = [&quot;foo&quot;,&quot;bar&quot;]</span><br><span class=\"line\">Output: [0,9]</span><br><span class=\"line\">Explanation: Substrings starting at index 0 and 9 are &quot;barfoor&quot; and &quot;foobar&quot; respectively.</span><br><span class=\"line\">The output order does not matter, returning [9,0] is fine too.</span><br></pre></td></tr></table></figure>\n<p><strong>Example 2:</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Input:</span><br><span class=\"line\">  s = &quot;wordgoodgoodgoodbestword&quot;,</span><br><span class=\"line\">  words = [&quot;word&quot;,&quot;good&quot;,&quot;best&quot;,&quot;word&quot;]</span><br><span class=\"line\">Output: []</span><br></pre></td></tr></table></figure>\n<p><strong>Algorithm:</strong></p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Solution</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">findSubstring</span><span class=\"params\">(<span class=\"number\">_</span> s: String, <span class=\"number\">_</span> words: [String])</span></span> -&gt; [<span class=\"type\">Int</span>] &#123;</span><br><span class=\"line\">        <span class=\"keyword\">guard</span> !s.isEmpty, !words.isEmpty, s.<span class=\"built_in\">count</span> &gt;= words.first!.<span class=\"built_in\">count</span> <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> []</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">var</span> <span class=\"built_in\">map</span> = [<span class=\"type\">String</span>: <span class=\"type\">Int</span>]()</span><br><span class=\"line\">        <span class=\"keyword\">for</span> word <span class=\"keyword\">in</span> words &#123;</span><br><span class=\"line\">            <span class=\"built_in\">map</span>.updateValue(<span class=\"built_in\">map</span>[word, <span class=\"keyword\">default</span>: <span class=\"number\">0</span>] + <span class=\"number\">1</span>, forKey: word)</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">let</span> sA = <span class=\"type\">Array</span>(s)</span><br><span class=\"line\">        <span class=\"keyword\">var</span> curMap = [<span class=\"type\">String</span>: <span class=\"type\">Int</span>]()</span><br><span class=\"line\">        <span class=\"keyword\">let</span> wl = words.first!.<span class=\"built_in\">count</span></span><br><span class=\"line\">        <span class=\"keyword\">var</span> result = [<span class=\"type\">Int</span>]()</span><br><span class=\"line\">        <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"number\">0</span>..&lt;wl &#123;</span><br><span class=\"line\">            <span class=\"keyword\">var</span> start = i</span><br><span class=\"line\">            <span class=\"keyword\">var</span> <span class=\"built_in\">count</span> = <span class=\"number\">0</span></span><br><span class=\"line\">            <span class=\"keyword\">for</span> j <span class=\"keyword\">in</span> <span class=\"built_in\">stride</span>(from: i, through: s.<span class=\"built_in\">count</span>-wl, by: wl) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">let</span> str = <span class=\"type\">String</span>(sA[j..&lt;j+wl])</span><br><span class=\"line\">                <span class=\"keyword\">if</span> <span class=\"keyword\">let</span> mapValue = <span class=\"built_in\">map</span>[str] &#123;</span><br><span class=\"line\">                    curMap.updateValue(curMap[str, <span class=\"keyword\">default</span>: <span class=\"number\">0</span>] + <span class=\"number\">1</span>, forKey: str)</span><br><span class=\"line\">                    <span class=\"keyword\">if</span> curMap[str]! &lt;= mapValue &#123;</span><br><span class=\"line\">                        <span class=\"built_in\">count</span> += <span class=\"number\">1</span></span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                    </span><br><span class=\"line\">                    <span class=\"keyword\">while</span> curMap[str]! &gt; <span class=\"built_in\">map</span>[str]! &#123;</span><br><span class=\"line\">                        <span class=\"keyword\">let</span> tmp = <span class=\"type\">String</span>(sA[start..&lt;start+wl])</span><br><span class=\"line\">                        curMap.updateValue(curMap[tmp, <span class=\"keyword\">default</span>: <span class=\"number\">0</span>] - <span class=\"number\">1</span>, forKey: tmp)</span><br><span class=\"line\">                        start += wl</span><br><span class=\"line\">                        <span class=\"keyword\">if</span> curMap[tmp]! &lt; <span class=\"built_in\">map</span>[tmp]! &#123;</span><br><span class=\"line\">                            <span class=\"built_in\">count</span> -= <span class=\"number\">1</span></span><br><span class=\"line\">                        &#125;</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                    <span class=\"keyword\">if</span> <span class=\"built_in\">count</span> == words.<span class=\"built_in\">count</span> &#123;</span><br><span class=\"line\">                        result.append(start)</span><br><span class=\"line\">                        <span class=\"keyword\">let</span> tmp = <span class=\"type\">String</span>(sA[start..&lt;start+wl])</span><br><span class=\"line\">                        curMap.updateValue(curMap[tmp, <span class=\"keyword\">default</span>: <span class=\"number\">0</span>] - <span class=\"number\">1</span>, forKey: tmp)</span><br><span class=\"line\">                        start += wl</span><br><span class=\"line\">                        <span class=\"built_in\">count</span> -= <span class=\"number\">1</span></span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                    start = j + wl</span><br><span class=\"line\">                    <span class=\"built_in\">count</span> = <span class=\"number\">0</span></span><br><span class=\"line\">                    curMap.removeAll()</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            curMap.removeAll()</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> result</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>From leetCode <a href=\"https://leetcode.com/problems/substring-with-concatenation-of-all-words/\" target=\"_blank\" rel=\"noopener\">30. Substring with Concatenation of All Words</a></p>\n","site":{"data":{}},"excerpt":"","more":"<h1>Introduction</h1>\n<p>Sliding Window algorithm template to solve almost Leetcode substring search problem.</p>\n<h1>Find All Anagrams in a String</h1>\n<p>Given a string <strong>s</strong> and a <strong>non-empty</strong> string <strong>p</strong>, find all the start indices of <strong>p</strong>s anagrams in <strong>s</strong>.</p>\n<p>Strings consists of lowercase English letters only and the length of both strings <strong>s</strong> and <strong>p</strong>will not be larger than 20,100.</p>\n<p>The order of output does not matter.</p>\n<p><strong>Example 1:</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Input:</span><br><span class=\"line\">s: &quot;cbaebabacd&quot; p: &quot;abc&quot;</span><br><span class=\"line\"></span><br><span class=\"line\">Output:</span><br><span class=\"line\">[0, 6]</span><br><span class=\"line\"></span><br><span class=\"line\">Explanation:</span><br><span class=\"line\">The substring with start index = 0 is &quot;cba&quot;, which is an anagram of &quot;abc&quot;.</span><br><span class=\"line\">The substring with start index = 6 is &quot;bac&quot;, which is an anagram of &quot;abc&quot;.</span><br></pre></td></tr></table></figure>\n<p><strong>Example 2:</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Input:</span><br><span class=\"line\">s: &quot;abab&quot; p: &quot;ab&quot;</span><br><span class=\"line\"></span><br><span class=\"line\">Output:</span><br><span class=\"line\">[0, 1, 2]</span><br><span class=\"line\"></span><br><span class=\"line\">Explanation:</span><br><span class=\"line\">The substring with start index = 0 is &quot;ab&quot;, which is an anagram of &quot;ab&quot;.</span><br><span class=\"line\">The substring with start index = 1 is &quot;ba&quot;, which is an anagram of &quot;ab&quot;.</span><br><span class=\"line\">The substring with start index = 2 is &quot;ab&quot;, which is an anagram of &quot;ab&quot;.</span><br></pre></td></tr></table></figure>\n<p><strong>Algorithm:</strong></p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Solution</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">findAnagrams</span><span class=\"params\">(<span class=\"number\">_</span> s: String, <span class=\"number\">_</span> p: String)</span></span> -&gt; [<span class=\"type\">Int</span>] &#123;</span><br><span class=\"line\">        <span class=\"keyword\">guard</span> !s.isEmpty, !p.isEmpty, s.<span class=\"built_in\">count</span> &gt;= p.<span class=\"built_in\">count</span> <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> []</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">var</span> <span class=\"built_in\">map</span> = [<span class=\"type\">Character</span>: <span class=\"type\">Int</span>]()</span><br><span class=\"line\">        <span class=\"keyword\">for</span> <span class=\"built_in\">c</span> <span class=\"keyword\">in</span> p &#123;</span><br><span class=\"line\">            <span class=\"built_in\">map</span>.updateValue(<span class=\"built_in\">map</span>[<span class=\"built_in\">c</span>, <span class=\"keyword\">default</span>: <span class=\"number\">0</span>] + <span class=\"number\">1</span>, forKey: <span class=\"built_in\">c</span>)</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">var</span> start = <span class=\"number\">0</span>, end = <span class=\"number\">0</span></span><br><span class=\"line\">        <span class=\"keyword\">var</span> result = [<span class=\"type\">Int</span>]()</span><br><span class=\"line\">        <span class=\"keyword\">var</span> p = <span class=\"type\">Array</span>(p), s = <span class=\"type\">Array</span>(s)</span><br><span class=\"line\">        <span class=\"keyword\">var</span> counter = <span class=\"built_in\">map</span>.<span class=\"built_in\">count</span></span><br><span class=\"line\">        <span class=\"keyword\">while</span> end &lt; s.<span class=\"built_in\">count</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">let</span> sE = s[end]</span><br><span class=\"line\">            <span class=\"keyword\">if</span> <span class=\"keyword\">let</span> mapValue = <span class=\"built_in\">map</span>[sE] &#123;</span><br><span class=\"line\">                <span class=\"built_in\">map</span>.updateValue(mapValue-<span class=\"number\">1</span>, forKey: sE)</span><br><span class=\"line\">                <span class=\"keyword\">if</span> mapValue == <span class=\"number\">1</span> &#123;</span><br><span class=\"line\">                    counter -= <span class=\"number\">1</span></span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            end += <span class=\"number\">1</span></span><br><span class=\"line\">            <span class=\"keyword\">while</span> counter == <span class=\"number\">0</span> &#123;</span><br><span class=\"line\">                <span class=\"keyword\">let</span> sS = s[start]</span><br><span class=\"line\">                <span class=\"keyword\">if</span> <span class=\"keyword\">let</span> mapValue = <span class=\"built_in\">map</span>[sS] &#123;</span><br><span class=\"line\">                    <span class=\"built_in\">map</span>.updateValue(mapValue+<span class=\"number\">1</span>, forKey: sS)</span><br><span class=\"line\">                    <span class=\"keyword\">if</span> mapValue &gt;= <span class=\"number\">0</span> &#123;</span><br><span class=\"line\">                        counter += <span class=\"number\">1</span></span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> end-start == p.<span class=\"built_in\">count</span> &#123;</span><br><span class=\"line\">                    result.append(start)</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                start += <span class=\"number\">1</span></span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> result</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>From leetCode <a href=\"https://leetcode.com/problems/find-all-anagrams-in-a-string/\" target=\"_blank\" rel=\"noopener\">438. Find All Anagrams in a String</a></p>\n<h1>Minimum Window Substring</h1>\n<p>Given a string S and a string T, find the minimum window in S which will contain all the characters in T in complexity <strong>O(n)</strong>.</p>\n<p><strong>Example:</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Input: S = &quot;ADOBECODEBANC&quot;, T = &quot;ABC&quot;</span><br><span class=\"line\">Output: &quot;BANC&quot;</span><br></pre></td></tr></table></figure>\n<p><strong>Note:</strong></p>\n<ul>\n<li>If there is no such window in S that convers all characters in T, return the empty string .</li>\n<li>If there is such window, you are guaranteed that there will always be only one unique minimum window in S.</li>\n</ul>\n<p><strong>algorithm:</strong></p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Solution</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">minWindow</span><span class=\"params\">(<span class=\"number\">_</span> s: String, <span class=\"number\">_</span> t: String)</span></span> -&gt; <span class=\"type\">String</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">guard</span> !s.isEmpty, !t.isEmpty, s.<span class=\"built_in\">count</span> &gt;= t.<span class=\"built_in\">count</span> <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"string\">\"\"</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">var</span> <span class=\"built_in\">map</span> = [<span class=\"type\">Character</span>: <span class=\"type\">Int</span>]()</span><br><span class=\"line\">        <span class=\"keyword\">for</span> tS <span class=\"keyword\">in</span> t &#123;</span><br><span class=\"line\">            <span class=\"built_in\">map</span>.updateValue(<span class=\"built_in\">map</span>[tS, <span class=\"keyword\">default</span>: <span class=\"number\">0</span>] + <span class=\"number\">1</span>, forKey: tS)</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">var</span> start = <span class=\"number\">0</span>, end = <span class=\"number\">0</span>, counter = <span class=\"built_in\">map</span>.<span class=\"built_in\">count</span></span><br><span class=\"line\">        <span class=\"keyword\">let</span> sA = <span class=\"type\">Array</span>(s)</span><br><span class=\"line\">        <span class=\"keyword\">var</span> result = (-<span class=\"number\">1</span>, s.<span class=\"built_in\">count</span>+<span class=\"number\">1</span>)</span><br><span class=\"line\">        <span class=\"keyword\">while</span> end &lt; sA.<span class=\"built_in\">count</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">let</span> sE = sA[end]</span><br><span class=\"line\">            <span class=\"keyword\">if</span> <span class=\"keyword\">let</span> mapValue = <span class=\"built_in\">map</span>[sE] &#123;</span><br><span class=\"line\">                <span class=\"built_in\">map</span>.updateValue(mapValue-<span class=\"number\">1</span>, forKey: sE)</span><br><span class=\"line\">                <span class=\"keyword\">if</span> mapValue == <span class=\"number\">1</span> &#123;</span><br><span class=\"line\">                    counter -= <span class=\"number\">1</span></span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            end += <span class=\"number\">1</span></span><br><span class=\"line\">            <span class=\"keyword\">while</span> counter == <span class=\"number\">0</span> &#123;</span><br><span class=\"line\">                <span class=\"keyword\">let</span> sS = sA[start]</span><br><span class=\"line\">                <span class=\"keyword\">if</span> <span class=\"keyword\">let</span> mapValue = <span class=\"built_in\">map</span>[sS] &#123;</span><br><span class=\"line\">                    <span class=\"built_in\">map</span>.updateValue(mapValue+<span class=\"number\">1</span>, forKey: sS)</span><br><span class=\"line\">                    <span class=\"keyword\">if</span> mapValue &gt;= <span class=\"number\">0</span> &#123;</span><br><span class=\"line\">                        counter += <span class=\"number\">1</span></span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> end-start &lt; result.<span class=\"number\">1</span> &#123;</span><br><span class=\"line\">                    result = (start, end-start)</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                start += <span class=\"number\">1</span></span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> result.<span class=\"number\">0</span> == -<span class=\"number\">1</span> ? <span class=\"string\">\"\"</span> : <span class=\"type\">String</span>(s[s.index(s.startIndex, offsetBy: result.<span class=\"number\">0</span>)..&lt;s.index(s.startIndex, offsetBy: result.<span class=\"number\">0</span>+result.<span class=\"number\">1</span>)])</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>From leetCode <a href=\"https://leetcode.com/problems/minimum-window-substring/\" target=\"_blank\" rel=\"noopener\">76. Minimum Window Substring</a></p>\n<h1>Longest Substring Without Repeating Characters</h1>\n<p>Given a string, find the length of the <strong>longest substring</strong> without repeating characters.</p>\n<p><strong>Example 1:</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Input: &quot;abcabcbb&quot;</span><br><span class=\"line\">Output: 3 </span><br><span class=\"line\">Explanation: The answer is &quot;abc&quot;, with the length of 3.</span><br></pre></td></tr></table></figure>\n<p><strong>Example 2:</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Input: &quot;bbbbb&quot;</span><br><span class=\"line\">Output: 1</span><br><span class=\"line\">Explanation: The answer is &quot;b&quot;, with the length of 1.</span><br></pre></td></tr></table></figure>\n<p><strong>Example 3:</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Input: &quot;pwwkew&quot;</span><br><span class=\"line\">Output: 3</span><br><span class=\"line\">Explanation: The answer is &quot;wke&quot;, with the length of 3. </span><br><span class=\"line\">Note: that the answer must be a substring, &quot;pwke&quot; is a subsequence and not a substring.</span><br></pre></td></tr></table></figure>\n<p><strong>Algorithm:</strong></p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Solution</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">lengthOfLongestSubstring</span><span class=\"params\">(<span class=\"number\">_</span> s: String)</span></span> -&gt; <span class=\"type\">Int</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">guard</span> !s.isEmpty <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"number\">0</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">let</span> sA = <span class=\"type\">Array</span>(s)</span><br><span class=\"line\">        <span class=\"keyword\">var</span> <span class=\"built_in\">map</span> = [<span class=\"type\">Character</span>: <span class=\"type\">Int</span>]()</span><br><span class=\"line\">        <span class=\"keyword\">var</span> start = <span class=\"number\">0</span>, end = <span class=\"number\">0</span>, counter = <span class=\"number\">0</span>, result = <span class=\"number\">0</span></span><br><span class=\"line\">        <span class=\"keyword\">while</span> end &lt; sA.<span class=\"built_in\">count</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">let</span> sE = sA[end]</span><br><span class=\"line\">            <span class=\"keyword\">if</span> <span class=\"keyword\">let</span> oldValue = <span class=\"built_in\">map</span>.updateValue(<span class=\"built_in\">map</span>[sE, <span class=\"keyword\">default</span>: <span class=\"number\">0</span>] + <span class=\"number\">1</span>, forKey: sE), oldValue &gt; <span class=\"number\">0</span> &#123;</span><br><span class=\"line\">                counter += <span class=\"number\">1</span></span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            end += <span class=\"number\">1</span></span><br><span class=\"line\">            <span class=\"keyword\">while</span> counter &gt; <span class=\"number\">0</span> &#123;</span><br><span class=\"line\">                <span class=\"keyword\">let</span> sS = sA[start]</span><br><span class=\"line\">                <span class=\"keyword\">if</span> <span class=\"keyword\">let</span> oldValue = <span class=\"built_in\">map</span>.updateValue(<span class=\"built_in\">map</span>[sS, <span class=\"keyword\">default</span>: <span class=\"number\">0</span>] - <span class=\"number\">1</span>, forKey: sS), oldValue &gt; <span class=\"number\">1</span> &#123;</span><br><span class=\"line\">                    counter -= <span class=\"number\">1</span></span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                start += <span class=\"number\">1</span></span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            result = <span class=\"built_in\">max</span>(result, end-start)</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> result</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>From leetCode <a href=\"https://leetcode.com/problems/longest-substring-without-repeating-characters/\" target=\"_blank\" rel=\"noopener\">3. Longest Substring Without Repeating Characters</a></p>\n<h1>Substring with Concatenation of All Words</h1>\n<p>You are given a string, <strong>s</strong>, and a list of words, <strong>words</strong>, that are all of the same length. Find all starting indices of substring(s) in <strong>s</strong> that is a concatenation of each words exactly once and without any intervening characters.</p>\n<p><strong>Example 1:</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Input:</span><br><span class=\"line\">  s = &quot;barfoothefoobarman&quot;,</span><br><span class=\"line\">  words = [&quot;foo&quot;,&quot;bar&quot;]</span><br><span class=\"line\">Output: [0,9]</span><br><span class=\"line\">Explanation: Substrings starting at index 0 and 9 are &quot;barfoor&quot; and &quot;foobar&quot; respectively.</span><br><span class=\"line\">The output order does not matter, returning [9,0] is fine too.</span><br></pre></td></tr></table></figure>\n<p><strong>Example 2:</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Input:</span><br><span class=\"line\">  s = &quot;wordgoodgoodgoodbestword&quot;,</span><br><span class=\"line\">  words = [&quot;word&quot;,&quot;good&quot;,&quot;best&quot;,&quot;word&quot;]</span><br><span class=\"line\">Output: []</span><br></pre></td></tr></table></figure>\n<p><strong>Algorithm:</strong></p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Solution</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">findSubstring</span><span class=\"params\">(<span class=\"number\">_</span> s: String, <span class=\"number\">_</span> words: [String])</span></span> -&gt; [<span class=\"type\">Int</span>] &#123;</span><br><span class=\"line\">        <span class=\"keyword\">guard</span> !s.isEmpty, !words.isEmpty, s.<span class=\"built_in\">count</span> &gt;= words.first!.<span class=\"built_in\">count</span> <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> []</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">var</span> <span class=\"built_in\">map</span> = [<span class=\"type\">String</span>: <span class=\"type\">Int</span>]()</span><br><span class=\"line\">        <span class=\"keyword\">for</span> word <span class=\"keyword\">in</span> words &#123;</span><br><span class=\"line\">            <span class=\"built_in\">map</span>.updateValue(<span class=\"built_in\">map</span>[word, <span class=\"keyword\">default</span>: <span class=\"number\">0</span>] + <span class=\"number\">1</span>, forKey: word)</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">let</span> sA = <span class=\"type\">Array</span>(s)</span><br><span class=\"line\">        <span class=\"keyword\">var</span> curMap = [<span class=\"type\">String</span>: <span class=\"type\">Int</span>]()</span><br><span class=\"line\">        <span class=\"keyword\">let</span> wl = words.first!.<span class=\"built_in\">count</span></span><br><span class=\"line\">        <span class=\"keyword\">var</span> result = [<span class=\"type\">Int</span>]()</span><br><span class=\"line\">        <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"number\">0</span>..&lt;wl &#123;</span><br><span class=\"line\">            <span class=\"keyword\">var</span> start = i</span><br><span class=\"line\">            <span class=\"keyword\">var</span> <span class=\"built_in\">count</span> = <span class=\"number\">0</span></span><br><span class=\"line\">            <span class=\"keyword\">for</span> j <span class=\"keyword\">in</span> <span class=\"built_in\">stride</span>(from: i, through: s.<span class=\"built_in\">count</span>-wl, by: wl) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">let</span> str = <span class=\"type\">String</span>(sA[j..&lt;j+wl])</span><br><span class=\"line\">                <span class=\"keyword\">if</span> <span class=\"keyword\">let</span> mapValue = <span class=\"built_in\">map</span>[str] &#123;</span><br><span class=\"line\">                    curMap.updateValue(curMap[str, <span class=\"keyword\">default</span>: <span class=\"number\">0</span>] + <span class=\"number\">1</span>, forKey: str)</span><br><span class=\"line\">                    <span class=\"keyword\">if</span> curMap[str]! &lt;= mapValue &#123;</span><br><span class=\"line\">                        <span class=\"built_in\">count</span> += <span class=\"number\">1</span></span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                    </span><br><span class=\"line\">                    <span class=\"keyword\">while</span> curMap[str]! &gt; <span class=\"built_in\">map</span>[str]! &#123;</span><br><span class=\"line\">                        <span class=\"keyword\">let</span> tmp = <span class=\"type\">String</span>(sA[start..&lt;start+wl])</span><br><span class=\"line\">                        curMap.updateValue(curMap[tmp, <span class=\"keyword\">default</span>: <span class=\"number\">0</span>] - <span class=\"number\">1</span>, forKey: tmp)</span><br><span class=\"line\">                        start += wl</span><br><span class=\"line\">                        <span class=\"keyword\">if</span> curMap[tmp]! &lt; <span class=\"built_in\">map</span>[tmp]! &#123;</span><br><span class=\"line\">                            <span class=\"built_in\">count</span> -= <span class=\"number\">1</span></span><br><span class=\"line\">                        &#125;</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                    <span class=\"keyword\">if</span> <span class=\"built_in\">count</span> == words.<span class=\"built_in\">count</span> &#123;</span><br><span class=\"line\">                        result.append(start)</span><br><span class=\"line\">                        <span class=\"keyword\">let</span> tmp = <span class=\"type\">String</span>(sA[start..&lt;start+wl])</span><br><span class=\"line\">                        curMap.updateValue(curMap[tmp, <span class=\"keyword\">default</span>: <span class=\"number\">0</span>] - <span class=\"number\">1</span>, forKey: tmp)</span><br><span class=\"line\">                        start += wl</span><br><span class=\"line\">                        <span class=\"built_in\">count</span> -= <span class=\"number\">1</span></span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                    start = j + wl</span><br><span class=\"line\">                    <span class=\"built_in\">count</span> = <span class=\"number\">0</span></span><br><span class=\"line\">                    curMap.removeAll()</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            curMap.removeAll()</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> result</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>From leetCode <a href=\"https://leetcode.com/problems/substring-with-concatenation-of-all-words/\" target=\"_blank\" rel=\"noopener\">30. Substring with Concatenation of All Words</a></p>\n"},{"title":"OpenGL ES","catalog":true,"toc_nav_num":true,"date":"2019-08-25T08:44:21.000Z","subtitle":"About OpenGL ES","header-img":"/img/article_header/article_header.png","busuanzi":true,"_content":"\n> OpenGL ESxyz-1.01.0\n> 5\n> - Local SpaceObject Space\n> - World Space\n> - View SpaceEye Space\n> - Clip Space\n> - Screen Space\n>\n> \n\n# \n\nModelViewProjectionLocal SpaceLocal CoordinateWorld CoordinateView CoordinateClip CoordinateScreen Coordinate\n\n![](/img/article/20190825/1.png)\n\n1. \n2. \n3. \n4. -1.01.0\n5. Viewport Transform-1.01.0`glViewport`\n\n\n\n# \n\n(0, 0, 0)(0, 0, 0)\n\n# \n\n(0, 0, 0)Model Matrix\ny\n\n# \n\nOpenGLCamera(Camera SpaceEye Space)/View Matrix\n\n## \n\n> OpenGLCamera\n\n### /\n\n/Camera/View Space\n\n![/](/img/article/20190825/6.png)\n\n1. \n\n\n\n``` objc\nvec3 cameraPos = vec3(0.0f, 0.0f, 3.0f);\n```\n\n2. \n\n(0, 0, 0)zzz\n\n``` objc\nvec3 cameraTarget = vec3(0.0f, 0.0f, 0.0f);\nvec3 cameraDirection = normalize(cameraPos - cameraTarget);     // normalize 1\n```\n\n> \n\n3. \n\nxxx\n\n``` objc\nvec3 up = vec3(0.0f, 1.0f, 0.0f);\nvec3 cameraRight = normalize(cross(up, cameraDirection));       // cross \n```\n\n4. \n\nxzy\n\n``` objc\nvec3 cameraUp = cross(cameraDirection, cameraRight);\n```\n\n/`LookAt`\n\n### Look At\n\n33`LookAt`3`LookAt`\n\n![LookAt](/img/article/20190825/7.png)\n\n`R``U``D``P``LookAt``LookAt`Look at\n\nGLMGLM`LookAt`\n\n``` objc\n// OpenGL ES 1.1\nGLKMatrix4 view = gluLookAt(0.0f, 0.0f, 3.0f, 0.0f, 0.0f, 0.0f, 0.0f, 1.0f, 0.0f);\n\n// GLKit\nGLKMatrix4 view = GLKMatrix4MakeLookAt(0.0f, 0.0f, 3.0f, 0.0f, 0.0f, 0.0f, 0.0f, 1.0f, 0.0f);\n``\n\n# \n\nOpenGLClippedClip Space\n-1.01.0Coordinate SetOpenGL\nProjection Matrix-10001000.(-1.0, 1.0)-1.01.0(1250, 500, 750)x1.0\n\n> OpenGL\n\nViewing Box****Frustum2D3D2D\n--Perspective Divisionxyzw4D3D\n`glViewport`\nOrthographic Projection MatrixPerspective Projection Matrix\n\n## \n\n\n\n![](/img/article/20190825/2.png)\n\nNearFarww1.0\n`GLKit`\n\n``` objc\nGLKMatrix4MakeOrtho(0.0, 800.0, 0.0, 600, 0.1, 100.0);\n```\n\nOpenGL ES 1.1\n\n``` objc\nglOrthof(0.0, 800.0, 0.0, 600.0, 0.1, 100.0);\n```\n\nxyz\n2DPerspective\n\n## \n\n\n\n![](/img/article/20190825/3.png)\n\nww-wwOpenGL-1.01.0\n\n![](/img/article/20190825/4.png)\n\nww\n\n`GLKit`\n\n``` objc\nGLKMatrix4MakePerspective(GLKMathRadiansToDegrees(45), width/height, 0.1, 100.0);\n```\n\n`GLKMatrix4MakePerspective`\n\n![](/img/article/20190825/5.png)\n\n`fov`Field of View45.0f0.1f100.0f\n\n> `near`10.0fOpenGL00f10.0f\n\n# \n\nV<sub>clip</sub> = M<sub>projection</sub>p * M<sub>view</sub> * M<sub>model</sub> * M<sub>local</sub>\n`gl_Position`OpenGL\n\n> \n> OpenGLOpenGL`glViewport`\n\n# \n\n\n\n``` objc\n- (void)update {\n    NSTimeInterval detalTime = self.timeSinceLastUpdate;\n    self.elapsedTime += detalTime;\n    \n    float varyingFactor = (sin(self.elapsedTime) + 1) / 2.0;\n    float aspect = self.view.frame.size.width / self.view.frame.size.height;\n\n    GLKMatrix4 perspectiveMatrix = GLKMatrix4MakePerspective(GLKMathDegreesToRadians(45), aspect, 0.1, 100.0);  // \n    GLKMatrix4 cameraMatrix = GLKMatrix4MakeLookAt(0, 0, 5 * (varyingFactor + 1), 0, 0, 0, 0, 1, 0);    // \n    GLKMatrix4 rotateMatrix = GLKMatrix4MakeRotation(varyingFactor * M_PI * 2, 1, 1, 1);    // \n    self.projectionMatrix = GLKMatrix4Multiply(cameraMatrix, rotateMatrix);\n    self.projectionMatrix = GLKMatrix4Multiply(perspectiveMatrix, self.projectionMatrix);\n}\n\n- (void)glkView:(GLKView *)view drawInRect:(CGRect)rect {\n    \n    glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);\n    glClearColor(0.0, 0.0, 0.0, 1.0);\n\n    glUniformMatrix4fv(mvpMatrixlocation, 1, 0, self.projectionMatrix.m);\n    \n    glBindVertexArray(vao);\n    glDrawElements(GL_TRIANGLES, 36, GL_UNSIGNED_SHORT, 0);\n}\n```\n\n# \n\n\n\n","source":"_posts/2019/opengl-es-coordinated-system-0825.md","raw":"---\ntitle: \"OpenGL ES\"\ncatalog: true\ntoc_nav_num: true\ndate: 2019-08-25 16:44:21\nsubtitle: \"About OpenGL ES\"\nheader-img: \"/img/article_header/article_header.png\"\nbusuanzi: true\ntags:\n- iOS\n\n---\n\n> OpenGL ESxyz-1.01.0\n> 5\n> - Local SpaceObject Space\n> - World Space\n> - View SpaceEye Space\n> - Clip Space\n> - Screen Space\n>\n> \n\n# \n\nModelViewProjectionLocal SpaceLocal CoordinateWorld CoordinateView CoordinateClip CoordinateScreen Coordinate\n\n![](/img/article/20190825/1.png)\n\n1. \n2. \n3. \n4. -1.01.0\n5. Viewport Transform-1.01.0`glViewport`\n\n\n\n# \n\n(0, 0, 0)(0, 0, 0)\n\n# \n\n(0, 0, 0)Model Matrix\ny\n\n# \n\nOpenGLCamera(Camera SpaceEye Space)/View Matrix\n\n## \n\n> OpenGLCamera\n\n### /\n\n/Camera/View Space\n\n![/](/img/article/20190825/6.png)\n\n1. \n\n\n\n``` objc\nvec3 cameraPos = vec3(0.0f, 0.0f, 3.0f);\n```\n\n2. \n\n(0, 0, 0)zzz\n\n``` objc\nvec3 cameraTarget = vec3(0.0f, 0.0f, 0.0f);\nvec3 cameraDirection = normalize(cameraPos - cameraTarget);     // normalize 1\n```\n\n> \n\n3. \n\nxxx\n\n``` objc\nvec3 up = vec3(0.0f, 1.0f, 0.0f);\nvec3 cameraRight = normalize(cross(up, cameraDirection));       // cross \n```\n\n4. \n\nxzy\n\n``` objc\nvec3 cameraUp = cross(cameraDirection, cameraRight);\n```\n\n/`LookAt`\n\n### Look At\n\n33`LookAt`3`LookAt`\n\n![LookAt](/img/article/20190825/7.png)\n\n`R``U``D``P``LookAt``LookAt`Look at\n\nGLMGLM`LookAt`\n\n``` objc\n// OpenGL ES 1.1\nGLKMatrix4 view = gluLookAt(0.0f, 0.0f, 3.0f, 0.0f, 0.0f, 0.0f, 0.0f, 1.0f, 0.0f);\n\n// GLKit\nGLKMatrix4 view = GLKMatrix4MakeLookAt(0.0f, 0.0f, 3.0f, 0.0f, 0.0f, 0.0f, 0.0f, 1.0f, 0.0f);\n``\n\n# \n\nOpenGLClippedClip Space\n-1.01.0Coordinate SetOpenGL\nProjection Matrix-10001000.(-1.0, 1.0)-1.01.0(1250, 500, 750)x1.0\n\n> OpenGL\n\nViewing Box****Frustum2D3D2D\n--Perspective Divisionxyzw4D3D\n`glViewport`\nOrthographic Projection MatrixPerspective Projection Matrix\n\n## \n\n\n\n![](/img/article/20190825/2.png)\n\nNearFarww1.0\n`GLKit`\n\n``` objc\nGLKMatrix4MakeOrtho(0.0, 800.0, 0.0, 600, 0.1, 100.0);\n```\n\nOpenGL ES 1.1\n\n``` objc\nglOrthof(0.0, 800.0, 0.0, 600.0, 0.1, 100.0);\n```\n\nxyz\n2DPerspective\n\n## \n\n\n\n![](/img/article/20190825/3.png)\n\nww-wwOpenGL-1.01.0\n\n![](/img/article/20190825/4.png)\n\nww\n\n`GLKit`\n\n``` objc\nGLKMatrix4MakePerspective(GLKMathRadiansToDegrees(45), width/height, 0.1, 100.0);\n```\n\n`GLKMatrix4MakePerspective`\n\n![](/img/article/20190825/5.png)\n\n`fov`Field of View45.0f0.1f100.0f\n\n> `near`10.0fOpenGL00f10.0f\n\n# \n\nV<sub>clip</sub> = M<sub>projection</sub>p * M<sub>view</sub> * M<sub>model</sub> * M<sub>local</sub>\n`gl_Position`OpenGL\n\n> \n> OpenGLOpenGL`glViewport`\n\n# \n\n\n\n``` objc\n- (void)update {\n    NSTimeInterval detalTime = self.timeSinceLastUpdate;\n    self.elapsedTime += detalTime;\n    \n    float varyingFactor = (sin(self.elapsedTime) + 1) / 2.0;\n    float aspect = self.view.frame.size.width / self.view.frame.size.height;\n\n    GLKMatrix4 perspectiveMatrix = GLKMatrix4MakePerspective(GLKMathDegreesToRadians(45), aspect, 0.1, 100.0);  // \n    GLKMatrix4 cameraMatrix = GLKMatrix4MakeLookAt(0, 0, 5 * (varyingFactor + 1), 0, 0, 0, 0, 1, 0);    // \n    GLKMatrix4 rotateMatrix = GLKMatrix4MakeRotation(varyingFactor * M_PI * 2, 1, 1, 1);    // \n    self.projectionMatrix = GLKMatrix4Multiply(cameraMatrix, rotateMatrix);\n    self.projectionMatrix = GLKMatrix4Multiply(perspectiveMatrix, self.projectionMatrix);\n}\n\n- (void)glkView:(GLKView *)view drawInRect:(CGRect)rect {\n    \n    glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);\n    glClearColor(0.0, 0.0, 0.0, 1.0);\n\n    glUniformMatrix4fv(mvpMatrixlocation, 1, 0, self.projectionMatrix.m);\n    \n    glBindVertexArray(vao);\n    glDrawElements(GL_TRIANGLES, 36, GL_UNSIGNED_SHORT, 0);\n}\n```\n\n# \n\n\n\n","slug":"2019/opengl-es-coordinated-system-0825","published":1,"updated":"2021-06-21T12:34:52.092Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckszp3nd6000hifnter210uu6","content":"<blockquote>\n<p>OpenGL ESxyz-1.01.0<br>\n5</p>\n<ul>\n<li>Local SpaceObject Space</li>\n<li>World Space</li>\n<li>View SpaceEye Space</li>\n<li>Clip Space</li>\n<li>Screen Space</li>\n</ul>\n<p></p>\n</blockquote>\n<h1 id=\"\"></h1>\n<p>ModelViewProjectionLocal SpaceLocal CoordinateWorld CoordinateView CoordinateClip CoordinateScreen Coordinate</p>\n<p><img src=\"/img/article/20190825/1.png\" alt=\"\"></p>\n<ol>\n<li></li>\n<li></li>\n<li></li>\n<li>-1.01.0</li>\n<li>Viewport Transform-1.01.0<code>glViewport</code></li>\n</ol>\n<p></p>\n<h1 id=\"\"></h1>\n<p>(0, 0, 0)(0, 0, 0)</p>\n<h1 id=\"\"></h1>\n<p>(0, 0, 0)Model Matrix<br>\ny</p>\n<h1 id=\"\"></h1>\n<p>OpenGLCamera(Camera SpaceEye Space)/View Matrix</p>\n<h2 id=\"\"></h2>\n<blockquote>\n<p>OpenGLCamera</p>\n</blockquote>\n<h3 id=\"\">/</h3>\n<p>/Camera/View Space</p>\n<p><img src=\"/img/article/20190825/6.png\" alt=\"/\"></p>\n<ol>\n<li></li>\n</ol>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vec3 cameraPos = vec3(<span class=\"number\">0.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">3.0</span>f);</span><br></pre></td></tr></table></figure>\n<ol start=\"2\">\n<li></li>\n</ol>\n<p>(0, 0, 0)zzz</p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vec3 cameraTarget = vec3(<span class=\"number\">0.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">0.0</span>f);</span><br><span class=\"line\">vec3 cameraDirection = normalize(cameraPos - cameraTarget);     <span class=\"comment\">// normalize 1</span></span><br></pre></td></tr></table></figure>\n<blockquote>\n<p></p>\n</blockquote>\n<ol start=\"3\">\n<li></li>\n</ol>\n<p>xxx</p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vec3 up = vec3(<span class=\"number\">0.0</span>f, <span class=\"number\">1.0</span>f, <span class=\"number\">0.0</span>f);</span><br><span class=\"line\">vec3 cameraRight = normalize(cross(up, cameraDirection));       <span class=\"comment\">// cross </span></span><br></pre></td></tr></table></figure>\n<ol start=\"4\">\n<li></li>\n</ol>\n<p>xzy</p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vec3 cameraUp = cross(cameraDirection, cameraRight);</span><br></pre></td></tr></table></figure>\n<p>/<code>LookAt</code></p>\n<h3 id=\"look-at\">Look At</h3>\n<p>33<code>LookAt</code>3<code>LookAt</code></p>\n<p><img src=\"/img/article/20190825/7.png\" alt=\"LookAt\"></p>\n<p><code>R</code><code>U</code><code>D</code><code>P</code><code>LookAt</code><code>LookAt</code>Look at</p>\n<p>GLMGLM<code>LookAt</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// OpenGL ES 1.1</span></span><br><span class=\"line\">GLKMatrix4 view = gluLookAt(<span class=\"number\">0.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">3.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">1.0</span>f, <span class=\"number\">0.0</span>f);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// GLKit</span></span><br><span class=\"line\">GLKMatrix4 view = GLKMatrix4MakeLookAt(<span class=\"number\">0.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">3.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">1.0</span>f, <span class=\"number\">0.0</span>f);</span><br><span class=\"line\">``</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\"># </span></span><br><span class=\"line\"></span><br><span class=\"line\">OpenGLClippedClip Space</span><br><span class=\"line\"><span class=\"number\">-1.0</span><span class=\"number\">1.0</span>Coordinate SetOpenGL</span><br><span class=\"line\">Projection Matrix<span class=\"number\">-1000</span><span class=\"number\">1000.</span>(<span class=\"number\">-1.0</span>, <span class=\"number\">1.0</span>)<span class=\"number\">-1.0</span><span class=\"number\">1.0</span>(<span class=\"number\">1250</span>, <span class=\"number\">500</span>, <span class=\"number\">750</span>)x<span class=\"number\">1.0</span></span><br><span class=\"line\"></span><br><span class=\"line\">&gt; OpenGL</span><br><span class=\"line\"></span><br><span class=\"line\">Viewing Box****Frustum<span class=\"number\">2</span>D<span class=\"number\">3</span>D<span class=\"number\">2</span>D</span><br><span class=\"line\">--Perspective Divisionxyzw<span class=\"number\">4</span>D<span class=\"number\">3</span>D</span><br><span class=\"line\">`glViewport`</span><br><span class=\"line\">Orthographic Projection MatrixPerspective Projection Matrix</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">## </span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">![](/img/article/<span class=\"number\">20190825</span>/<span class=\"number\">2.</span>png)</span><br><span class=\"line\"></span><br><span class=\"line\">NearFarww<span class=\"number\">1.0</span></span><br><span class=\"line\">`GLKit`</span><br><span class=\"line\"></span><br><span class=\"line\">``` objc</span><br><span class=\"line\">GLKMatrix4MakeOrtho(<span class=\"number\">0.0</span>, <span class=\"number\">800.0</span>, <span class=\"number\">0.0</span>, <span class=\"number\">600</span>, <span class=\"number\">0.1</span>, <span class=\"number\">100.0</span>);</span><br></pre></td></tr></table></figure>\n<p>OpenGL ES 1.1</p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">glOrthof(<span class=\"number\">0.0</span>, <span class=\"number\">800.0</span>, <span class=\"number\">0.0</span>, <span class=\"number\">600.0</span>, <span class=\"number\">0.1</span>, <span class=\"number\">100.0</span>);</span><br></pre></td></tr></table></figure>\n<p>xyz<br>\n2DPerspective</p>\n<h2 id=\"\"></h2>\n<p></p>\n<p><img src=\"/img/article/20190825/3.png\" alt=\"\"></p>\n<p>ww-wwOpenGL-1.01.0</p>\n<p><img src=\"/img/article/20190825/4.png\" alt=\"\"></p>\n<p>ww</p>\n<p><code>GLKit</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">GLKMatrix4MakePerspective(GLKMathRadiansToDegrees(<span class=\"number\">45</span>), width/height, <span class=\"number\">0.1</span>, <span class=\"number\">100.0</span>);</span><br></pre></td></tr></table></figure>\n<p><code>GLKMatrix4MakePerspective</code></p>\n<p><img src=\"/img/article/20190825/5.png\" alt=\"\"></p>\n<p><code>fov</code>Field of View45.0f0.1f100.0f</p>\n<blockquote>\n<p><code>near</code>10.0fOpenGL00f10.0f</p>\n</blockquote>\n<h1 id=\"\"></h1>\n<p>V<sub>clip</sub> = M<sub>projection</sub>p * M<sub>view</sub> * M<sub>model</sub> * M<sub>local</sub><br>\n<code>gl_Position</code>OpenGL</p>\n<blockquote>\n<p><br>\nOpenGLOpenGL<code>glViewport</code></p>\n</blockquote>\n<h1 id=\"\"></h1>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">- (<span class=\"keyword\">void</span>)update &#123;</span><br><span class=\"line\">    <span class=\"built_in\">NSTimeInterval</span> detalTime = <span class=\"keyword\">self</span>.timeSinceLastUpdate;</span><br><span class=\"line\">    <span class=\"keyword\">self</span>.elapsedTime += detalTime;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">float</span> varyingFactor = (sin(<span class=\"keyword\">self</span>.elapsedTime) + <span class=\"number\">1</span>) / <span class=\"number\">2.0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">float</span> aspect = <span class=\"keyword\">self</span>.view.frame.size.width / <span class=\"keyword\">self</span>.view.frame.size.height;</span><br><span class=\"line\"></span><br><span class=\"line\">    GLKMatrix4 perspectiveMatrix = GLKMatrix4MakePerspective(GLKMathDegreesToRadians(<span class=\"number\">45</span>), aspect, <span class=\"number\">0.1</span>, <span class=\"number\">100.0</span>);  <span class=\"comment\">// </span></span><br><span class=\"line\">    GLKMatrix4 cameraMatrix = GLKMatrix4MakeLookAt(<span class=\"number\">0</span>, <span class=\"number\">0</span>, <span class=\"number\">5</span> * (varyingFactor + <span class=\"number\">1</span>), <span class=\"number\">0</span>, <span class=\"number\">0</span>, <span class=\"number\">0</span>, <span class=\"number\">0</span>, <span class=\"number\">1</span>, <span class=\"number\">0</span>);    <span class=\"comment\">// </span></span><br><span class=\"line\">    GLKMatrix4 rotateMatrix = GLKMatrix4MakeRotation(varyingFactor * M_PI * <span class=\"number\">2</span>, <span class=\"number\">1</span>, <span class=\"number\">1</span>, <span class=\"number\">1</span>);    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">self</span>.projectionMatrix = GLKMatrix4Multiply(cameraMatrix, rotateMatrix);</span><br><span class=\"line\">    <span class=\"keyword\">self</span>.projectionMatrix = GLKMatrix4Multiply(perspectiveMatrix, <span class=\"keyword\">self</span>.projectionMatrix);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">- (<span class=\"keyword\">void</span>)glkView:(GLKView *)view drawInRect:(<span class=\"built_in\">CGRect</span>)rect &#123;</span><br><span class=\"line\">    </span><br><span class=\"line\">    glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);</span><br><span class=\"line\">    glClearColor(<span class=\"number\">0.0</span>, <span class=\"number\">0.0</span>, <span class=\"number\">0.0</span>, <span class=\"number\">1.0</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    glUniformMatrix4fv(mvpMatrixlocation, <span class=\"number\">1</span>, <span class=\"number\">0</span>, <span class=\"keyword\">self</span>.projectionMatrix.m);</span><br><span class=\"line\">    </span><br><span class=\"line\">    glBindVertexArray(vao);</span><br><span class=\"line\">    glDrawElements(GL_TRIANGLES, <span class=\"number\">36</span>, GL_UNSIGNED_SHORT, <span class=\"number\">0</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h1 id=\"\"></h1>\n<p></p>\n","site":{"data":{}},"excerpt":"","more":"<blockquote>\n<p>OpenGL ESxyz-1.01.0<br>\n5</p>\n<ul>\n<li>Local SpaceObject Space</li>\n<li>World Space</li>\n<li>View SpaceEye Space</li>\n<li>Clip Space</li>\n<li>Screen Space</li>\n</ul>\n<p></p>\n</blockquote>\n<h1></h1>\n<p>ModelViewProjectionLocal SpaceLocal CoordinateWorld CoordinateView CoordinateClip CoordinateScreen Coordinate</p>\n<p><img src=\"/img/article/20190825/1.png\" alt=\"\"></p>\n<ol>\n<li></li>\n<li></li>\n<li></li>\n<li>-1.01.0</li>\n<li>Viewport Transform-1.01.0<code>glViewport</code></li>\n</ol>\n<p></p>\n<h1></h1>\n<p>(0, 0, 0)(0, 0, 0)</p>\n<h1></h1>\n<p>(0, 0, 0)Model Matrix<br>\ny</p>\n<h1></h1>\n<p>OpenGLCamera(Camera SpaceEye Space)/View Matrix</p>\n<h2></h2>\n<blockquote>\n<p>OpenGLCamera</p>\n</blockquote>\n<h3>/</h3>\n<p>/Camera/View Space</p>\n<p><img src=\"/img/article/20190825/6.png\" alt=\"/\"></p>\n<ol>\n<li></li>\n</ol>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vec3 cameraPos = vec3(<span class=\"number\">0.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">3.0</span>f);</span><br></pre></td></tr></table></figure>\n<ol start=\"2\">\n<li></li>\n</ol>\n<p>(0, 0, 0)zzz</p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vec3 cameraTarget = vec3(<span class=\"number\">0.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">0.0</span>f);</span><br><span class=\"line\">vec3 cameraDirection = normalize(cameraPos - cameraTarget);     <span class=\"comment\">// normalize 1</span></span><br></pre></td></tr></table></figure>\n<blockquote>\n<p></p>\n</blockquote>\n<ol start=\"3\">\n<li></li>\n</ol>\n<p>xxx</p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vec3 up = vec3(<span class=\"number\">0.0</span>f, <span class=\"number\">1.0</span>f, <span class=\"number\">0.0</span>f);</span><br><span class=\"line\">vec3 cameraRight = normalize(cross(up, cameraDirection));       <span class=\"comment\">// cross </span></span><br></pre></td></tr></table></figure>\n<ol start=\"4\">\n<li></li>\n</ol>\n<p>xzy</p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vec3 cameraUp = cross(cameraDirection, cameraRight);</span><br></pre></td></tr></table></figure>\n<p>/<code>LookAt</code></p>\n<h3>Look At</h3>\n<p>33<code>LookAt</code>3<code>LookAt</code></p>\n<p><img src=\"/img/article/20190825/7.png\" alt=\"LookAt\"></p>\n<p><code>R</code><code>U</code><code>D</code><code>P</code><code>LookAt</code><code>LookAt</code>Look at</p>\n<p>GLMGLM<code>LookAt</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// OpenGL ES 1.1</span></span><br><span class=\"line\">GLKMatrix4 view = gluLookAt(<span class=\"number\">0.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">3.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">1.0</span>f, <span class=\"number\">0.0</span>f);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// GLKit</span></span><br><span class=\"line\">GLKMatrix4 view = GLKMatrix4MakeLookAt(<span class=\"number\">0.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">3.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">1.0</span>f, <span class=\"number\">0.0</span>f);</span><br><span class=\"line\">``</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\"># </span></span><br><span class=\"line\"></span><br><span class=\"line\">OpenGLClippedClip Space</span><br><span class=\"line\"><span class=\"number\">-1.0</span><span class=\"number\">1.0</span>Coordinate SetOpenGL</span><br><span class=\"line\">Projection Matrix<span class=\"number\">-1000</span><span class=\"number\">1000.</span>(<span class=\"number\">-1.0</span>, <span class=\"number\">1.0</span>)<span class=\"number\">-1.0</span><span class=\"number\">1.0</span>(<span class=\"number\">1250</span>, <span class=\"number\">500</span>, <span class=\"number\">750</span>)x<span class=\"number\">1.0</span></span><br><span class=\"line\"></span><br><span class=\"line\">&gt; OpenGL</span><br><span class=\"line\"></span><br><span class=\"line\">Viewing Box****Frustum<span class=\"number\">2</span>D<span class=\"number\">3</span>D<span class=\"number\">2</span>D</span><br><span class=\"line\">--Perspective Divisionxyzw<span class=\"number\">4</span>D<span class=\"number\">3</span>D</span><br><span class=\"line\">`glViewport`</span><br><span class=\"line\">Orthographic Projection MatrixPerspective Projection Matrix</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">## </span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">![](/img/article/<span class=\"number\">20190825</span>/<span class=\"number\">2.</span>png)</span><br><span class=\"line\"></span><br><span class=\"line\">NearFarww<span class=\"number\">1.0</span></span><br><span class=\"line\">`GLKit`</span><br><span class=\"line\"></span><br><span class=\"line\">``` objc</span><br><span class=\"line\">GLKMatrix4MakeOrtho(<span class=\"number\">0.0</span>, <span class=\"number\">800.0</span>, <span class=\"number\">0.0</span>, <span class=\"number\">600</span>, <span class=\"number\">0.1</span>, <span class=\"number\">100.0</span>);</span><br></pre></td></tr></table></figure>\n<p>OpenGL ES 1.1</p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">glOrthof(<span class=\"number\">0.0</span>, <span class=\"number\">800.0</span>, <span class=\"number\">0.0</span>, <span class=\"number\">600.0</span>, <span class=\"number\">0.1</span>, <span class=\"number\">100.0</span>);</span><br></pre></td></tr></table></figure>\n<p>xyz<br>\n2DPerspective</p>\n<h2></h2>\n<p></p>\n<p><img src=\"/img/article/20190825/3.png\" alt=\"\"></p>\n<p>ww-wwOpenGL-1.01.0</p>\n<p><img src=\"/img/article/20190825/4.png\" alt=\"\"></p>\n<p>ww</p>\n<p><code>GLKit</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">GLKMatrix4MakePerspective(GLKMathRadiansToDegrees(<span class=\"number\">45</span>), width/height, <span class=\"number\">0.1</span>, <span class=\"number\">100.0</span>);</span><br></pre></td></tr></table></figure>\n<p><code>GLKMatrix4MakePerspective</code></p>\n<p><img src=\"/img/article/20190825/5.png\" alt=\"\"></p>\n<p><code>fov</code>Field of View45.0f0.1f100.0f</p>\n<blockquote>\n<p><code>near</code>10.0fOpenGL00f10.0f</p>\n</blockquote>\n<h1></h1>\n<p>V<sub>clip</sub> = M<sub>projection</sub>p * M<sub>view</sub> * M<sub>model</sub> * M<sub>local</sub><br>\n<code>gl_Position</code>OpenGL</p>\n<blockquote>\n<p><br>\nOpenGLOpenGL<code>glViewport</code></p>\n</blockquote>\n<h1></h1>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">- (<span class=\"keyword\">void</span>)update &#123;</span><br><span class=\"line\">    <span class=\"built_in\">NSTimeInterval</span> detalTime = <span class=\"keyword\">self</span>.timeSinceLastUpdate;</span><br><span class=\"line\">    <span class=\"keyword\">self</span>.elapsedTime += detalTime;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">float</span> varyingFactor = (sin(<span class=\"keyword\">self</span>.elapsedTime) + <span class=\"number\">1</span>) / <span class=\"number\">2.0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">float</span> aspect = <span class=\"keyword\">self</span>.view.frame.size.width / <span class=\"keyword\">self</span>.view.frame.size.height;</span><br><span class=\"line\"></span><br><span class=\"line\">    GLKMatrix4 perspectiveMatrix = GLKMatrix4MakePerspective(GLKMathDegreesToRadians(<span class=\"number\">45</span>), aspect, <span class=\"number\">0.1</span>, <span class=\"number\">100.0</span>);  <span class=\"comment\">// </span></span><br><span class=\"line\">    GLKMatrix4 cameraMatrix = GLKMatrix4MakeLookAt(<span class=\"number\">0</span>, <span class=\"number\">0</span>, <span class=\"number\">5</span> * (varyingFactor + <span class=\"number\">1</span>), <span class=\"number\">0</span>, <span class=\"number\">0</span>, <span class=\"number\">0</span>, <span class=\"number\">0</span>, <span class=\"number\">1</span>, <span class=\"number\">0</span>);    <span class=\"comment\">// </span></span><br><span class=\"line\">    GLKMatrix4 rotateMatrix = GLKMatrix4MakeRotation(varyingFactor * M_PI * <span class=\"number\">2</span>, <span class=\"number\">1</span>, <span class=\"number\">1</span>, <span class=\"number\">1</span>);    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">self</span>.projectionMatrix = GLKMatrix4Multiply(cameraMatrix, rotateMatrix);</span><br><span class=\"line\">    <span class=\"keyword\">self</span>.projectionMatrix = GLKMatrix4Multiply(perspectiveMatrix, <span class=\"keyword\">self</span>.projectionMatrix);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">- (<span class=\"keyword\">void</span>)glkView:(GLKView *)view drawInRect:(<span class=\"built_in\">CGRect</span>)rect &#123;</span><br><span class=\"line\">    </span><br><span class=\"line\">    glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);</span><br><span class=\"line\">    glClearColor(<span class=\"number\">0.0</span>, <span class=\"number\">0.0</span>, <span class=\"number\">0.0</span>, <span class=\"number\">1.0</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    glUniformMatrix4fv(mvpMatrixlocation, <span class=\"number\">1</span>, <span class=\"number\">0</span>, <span class=\"keyword\">self</span>.projectionMatrix.m);</span><br><span class=\"line\">    </span><br><span class=\"line\">    glBindVertexArray(vao);</span><br><span class=\"line\">    glDrawElements(GL_TRIANGLES, <span class=\"number\">36</span>, GL_UNSIGNED_SHORT, <span class=\"number\">0</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h1></h1>\n<p></p>\n"},{"title":"OpenGL ES","catalog":true,"toc_nav_num":true,"date":"2019-06-06T11:23:02.000Z","subtitle":"About OpenGL ES","header-img":"/img/article_header/article_header.png","busuanzi":true,"_content":"\n# \n\nOpenGL ESOpenGL ESiOSMac OSOpenGL ESOpenGL ESOpenGL ES\n\n# \n\nOpenGL ES--GLSLGLSL[](https://github.com/wshxbqq/GLSL-Card)\n\n## \n\n`.vsh``.fsh`\n\n\n``` \n#version 300 es\nlayout(location = 0) in vec4 vPosition;\nvoid main() {\n    gl_Position = vPosition;\n}\n```\n\n1. V3.00\n2. `layout(location = 0)`0`in vec4 vPosition`\n3. main`gl_Position``gl_Position`\n\n\n```\n#version 300 es\nprecision mediump float;\nout vec4 fragColor;\nvoid main() {\n    fragColor = vec4(1.0, 0.0, 0.0, 1.0);\n}\n```\n\n1. V3.00\n2. \n3. `fragColor`\n4. man\n\n## \n\nOpenGL ES`loadShaderWithName:type:`\n\n``` objectivec\n- (GLuint)loadShaderWithName:(NSString *)name type:(GLenum)shaderType {\n    \n    // \n    NSString *shaderPath = [[NSBundle mainBundle] pathForResource:name ofType:shaderType == GL_VERTEX_SHADER ? @\"vsh\" : @\"fsh\"];\n    NSError *error;\n    NSString *shaderString = [NSString stringWithContentsOfFile:shaderPath encoding:NSUTF8StringEncoding error:&error];\n    if (!shaderString) {\n        NSAssert(NO, @\"Shader%@\", error.localizedDescription);\n        return 0;\n    }\n    \n    // shader\n    GLuint shader = glCreateShader(shaderType);\n    if (!shader) {\n        return 0;\n    }\n    \n    // shader\n    const GLchar *shaderStringUTF8 = [shaderString UTF8String];\n    glShaderSource(shader, 1, &shaderStringUTF8, NULL);\n    \n    // shader\n    glCompileShader(shader);\n    \n    // shader\n    GLint compiled;\n    glGetShaderiv(shader, GL_COMPILE_STATUS, &compiled);\n    if (!compiled) {\n        GLint infoLen;\n        glGetShaderiv(shader, GL_INFO_LOG_LENGTH, &infoLen);\n        if (infoLen > 1) {\n            GLchar *infoLog = malloc(sizeof(GLchar) * infoLen);\n            glGetShaderInfoLog(shader, infoLen, NULL, infoLog);\n            NSAssert(NO, @\"shader%s\", infoLog);\n            free(infoLog);\n        }\n        glDeleteShader(shader);\n        return 0;\n    }\n    return shader;\n}\n```\n\n## \n\n\n\n``` objectivec\n- (GLuint)createProgram:(NSString *)programName {\n\n    // \n    GLuint vertexShader = [self loadShaderWithName:programName type:GL_VERTEX_SHADER];\n    GLuint fragmentShader = [self loadShaderWithName:programName type:GL_FRAGMENT_SHADER];\n    \n    // program\n    GLuint program = glCreateProgram();\n    if (!program) {\n        return 0;\n    }\n    \n    // programshader\n    glAttachShader(program, vertexShader);\n    glAttachShader(program, fragmentShader);\n    \n    // program\n    glLinkProgram(program);\n    \n    // program\n    GLint linked;\n    glGetProgramiv(program, GL_LINK_STATUS, &linked);\n    if (!linked) {\n        GLint infoLen;\n        glGetProgramiv(program, GL_INFO_LOG_LENGTH, &infoLen);\n        if (infoLen > 1) {\n            GLchar *infoLog = malloc(sizeof(GLchar) * infoLen);\n            glGetProgramInfoLog(program, infoLen, NULL, infoLog);\n            NSAssert(NO, @\"program%s\", infoLog);\n            free(infoLog);\n        }\n        glDeleteProgram(program);\n        return 0;\n    }\n    return program;\n}\n```\n\n## \n\nOpenGL ES 3.0\n\n``` objectivec\nEAGLContext *context = [[EAGLContext alloc] initWithAPI:kEAGLRenderingAPIOpenGLES3];\n[EAGLContext setCurrentContext:context];\n```\n\n## CAEAGLLayer\n\niOS`CAEAGLLayer`\n\n```\n- (void)initialize {\n    // layerlayer\n    CAEAGLLayer *layer = [[CAEAGLLayer alloc] init];\n    layer.frame = self.view.bounds;\n    [self.view.layer addSublayer:layer];\n    \n    // layerOpenGL ES\n    [self bindRenderLayer:layer context:context];\n}\n\n- (void)bindRenderLayer:(CALayer <EAGLDrawable> *)layer context:(EAGLContext *)context {\n    GLuint renderbuffer;\n    GLuint framebuffer;\n    glGenRenderbuffers(1, &renderbuffer);\n    glBindRenderbuffer(GL_RENDERBUFFER, renderbuffer);\n    [context renderbufferStorage:GL_RENDERBUFFER fromDrawable:layer];\n    \n    glGenFramebuffers(1, &framebuffer);\n    glBindFramebuffer(GL_FRAMEBUFFER, framebuffer);\n    glFramebufferRenderbuffer(GL_FRAMEBUFFER, GL_COLOR_ATTACHMENT0, GL_RENDERBUFFER, renderbuffer);\n}\n```\n\n`bindRenderLayer`layerlayer\n\n## \n\n\n``` objectivec\nglViewport(0, 0, self.drawableWidth, self.drawableHeight);\n\n// \n- (GLint)drawableWidth {\n    GLint backingWidth;\n    glGetRenderbufferParameteriv(GL_RENDERBUFFER, GL_RENDERBUFFER_WIDTH, &backingWidth);\n    \n    return backingWidth;\n}\n\n// \n- (GLint)drawableHeight {\n    GLint backingHeight;\n    glGetRenderbufferParameteriv(GL_RENDERBUFFER, GL_RENDERBUFFER_HEIGHT, &backingHeight);\n    \n    return backingHeight;\n}\n```\n\n\n``` objectivec\nGLuint program = [self createProgram:@\"glsl\"];\nif (!program) {\n    return;\n}\nglUseProgram(program);\n```\n\n\n``` objectivec\nglClearColor(0.0, 0.0, 0.0, 1.0);\nglClear(GL_COLOR_BUFFER_BIT);\n```\n\n(x, y, z)3\n\n``` objectivec\nGLfloat vVertices[] = {\n    0.0f, 0.5f, 0.0f,\n    -0.5f, -0.5f, 0.0f,\n    0.5f, -0.5f, 0.0f\n};\n```\n\n\n``` objectivec\n// \nglEnableVertexAttribArray(GLKVertexAttribPosition);\nglVertexAttribPointer(GLKVertexAttribPosition, 3, GL_FLOAT, GL_FALSE, 0, vVertices);\n\n// \nglDrawArrays(GL_TRIANGLES, 0, 3);\n```\n\n\n``` objectivec\n[context presentRenderbuffer:GL_RENDERBUFFER];\n```\n\n\n\n![Triangle Picture](/img/article/20190606/1.png)\n\n# GLKit\n\nGLKitGLKit\n\nGLKit`GLKView``drawRect:``GLKView``GLKBaseEffect`\n\n## GLKView\n\n`GLKView``drawRect:``GLKBaseEffect`OpenGL ES\n\n``` objectivec\n@interface TriangleGLKView ()\n\n@property (nonatomic, strong) GLKBaseEffect *baseEffect;\n\n@end\n\n@implementation TriangleGLKView\n\n- (instancetype)initWithFrame:(CGRect)frame context:(nonnull EAGLContext *)context {\n    self = [super initWithFrame:frame context:context];\n    if (self) {\n        self.baseEffect = [[GLKBaseEffect alloc] init];\n        self.baseEffect.constantColor = GLKVector4Make(0.0, 1.0, 0.0, 1.0);\n    }\n    return self;\n}\n\n\n- (void)drawRect:(CGRect)rect {\n    \n    glClearColor(1.0, 0.0, 0.0, 1.0);\n    glClear(GL_COLOR_BUFFER_BIT);\n    \n    // \n    [self.baseEffect prepareToDraw];\n    \n    GLfloat vVertice[] = {\n        0.0, 0.5, 0.0,\n        -0.5, -0.5, 0.0,\n        0.5, -0.5, 0.0\n    };\n    \n    // \n    glEnableVertexAttribArray(GLKVertexAttribPosition);\n    glVertexAttribPointer(GLKVertexAttribPosition, 3, GL_FLOAT, GL_FALSE, 0, vVertice);\n\n    // \n    glDrawArrays(GL_TRIANGLES, 0, 3);\n}\n\n@end\n```\n\n## \n\n`GLKView``GLKBaseEffect`\n\n``` objectivec\n- (void)initialize {\n    EAGLContext *context = [[EAGLContext alloc] initWithAPI:kEAGLRenderingAPIOpenGLES3];\n    [EAGLContext setCurrentContext:context];\n\n    GLKView *glkView = [[GLKView alloc] initWithFrame:self.view.bounds context:context];\n    glkView.backgroundColor = [UIColor clearColor];\n    glkView.delegate = self;\n    [self.view addSubview:glkView];\n    \n    self.baseEffect = [[GLKBaseEffect alloc] init];\n    self.baseEffect.constantColor = GLKVector4Make(0.0, 1.0, 0.0, 1.0);\n    \n    [glkView display];\n}\n\n\n- (void)glkView:(GLKView *)view drawInRect:(CGRect)rect {\n    glClearColor(1.0, 0.0, 0.0, 1.0);\n    glClear(GL_COLOR_BUFFER_BIT);\n    \n    [self.baseEffect prepareToDraw];\n    \n    GLfloat vVertice[] = {\n        0.0, 0.5, 0.0,\n        -0.5, -0.5, 0.0,\n        0.5, -0.5, 0.0\n    };\n    \n    glEnableVertexAttribArray(GLKVertexAttribPosition);\n    glVertexAttribPointer(GLKVertexAttribPosition, 3, GL_FLOAT, GL_FALSE, 0, vVertice);\n    glDrawArrays(GL_TRIANGLES, 0, 3);\n}\n```\n\n# \n\nGLKitMetal[Demo](https://github.com/Quincy-QC/OpenGL-ES-Study)","source":"_posts/2019/opengl-es-draw-triangles-0606.md","raw":"---\ntitle: \"OpenGL ES\"\ncatalog: true\ntoc_nav_num: true\ndate: 2019-06-06 19:23:02\nsubtitle: \"About OpenGL ES\"\nheader-img: \"/img/article_header/article_header.png\"\nbusuanzi: true\ntags:\n- iOS\n\n---\n\n# \n\nOpenGL ESOpenGL ESiOSMac OSOpenGL ESOpenGL ESOpenGL ES\n\n# \n\nOpenGL ES--GLSLGLSL[](https://github.com/wshxbqq/GLSL-Card)\n\n## \n\n`.vsh``.fsh`\n\n\n``` \n#version 300 es\nlayout(location = 0) in vec4 vPosition;\nvoid main() {\n    gl_Position = vPosition;\n}\n```\n\n1. V3.00\n2. `layout(location = 0)`0`in vec4 vPosition`\n3. main`gl_Position``gl_Position`\n\n\n```\n#version 300 es\nprecision mediump float;\nout vec4 fragColor;\nvoid main() {\n    fragColor = vec4(1.0, 0.0, 0.0, 1.0);\n}\n```\n\n1. V3.00\n2. \n3. `fragColor`\n4. man\n\n## \n\nOpenGL ES`loadShaderWithName:type:`\n\n``` objectivec\n- (GLuint)loadShaderWithName:(NSString *)name type:(GLenum)shaderType {\n    \n    // \n    NSString *shaderPath = [[NSBundle mainBundle] pathForResource:name ofType:shaderType == GL_VERTEX_SHADER ? @\"vsh\" : @\"fsh\"];\n    NSError *error;\n    NSString *shaderString = [NSString stringWithContentsOfFile:shaderPath encoding:NSUTF8StringEncoding error:&error];\n    if (!shaderString) {\n        NSAssert(NO, @\"Shader%@\", error.localizedDescription);\n        return 0;\n    }\n    \n    // shader\n    GLuint shader = glCreateShader(shaderType);\n    if (!shader) {\n        return 0;\n    }\n    \n    // shader\n    const GLchar *shaderStringUTF8 = [shaderString UTF8String];\n    glShaderSource(shader, 1, &shaderStringUTF8, NULL);\n    \n    // shader\n    glCompileShader(shader);\n    \n    // shader\n    GLint compiled;\n    glGetShaderiv(shader, GL_COMPILE_STATUS, &compiled);\n    if (!compiled) {\n        GLint infoLen;\n        glGetShaderiv(shader, GL_INFO_LOG_LENGTH, &infoLen);\n        if (infoLen > 1) {\n            GLchar *infoLog = malloc(sizeof(GLchar) * infoLen);\n            glGetShaderInfoLog(shader, infoLen, NULL, infoLog);\n            NSAssert(NO, @\"shader%s\", infoLog);\n            free(infoLog);\n        }\n        glDeleteShader(shader);\n        return 0;\n    }\n    return shader;\n}\n```\n\n## \n\n\n\n``` objectivec\n- (GLuint)createProgram:(NSString *)programName {\n\n    // \n    GLuint vertexShader = [self loadShaderWithName:programName type:GL_VERTEX_SHADER];\n    GLuint fragmentShader = [self loadShaderWithName:programName type:GL_FRAGMENT_SHADER];\n    \n    // program\n    GLuint program = glCreateProgram();\n    if (!program) {\n        return 0;\n    }\n    \n    // programshader\n    glAttachShader(program, vertexShader);\n    glAttachShader(program, fragmentShader);\n    \n    // program\n    glLinkProgram(program);\n    \n    // program\n    GLint linked;\n    glGetProgramiv(program, GL_LINK_STATUS, &linked);\n    if (!linked) {\n        GLint infoLen;\n        glGetProgramiv(program, GL_INFO_LOG_LENGTH, &infoLen);\n        if (infoLen > 1) {\n            GLchar *infoLog = malloc(sizeof(GLchar) * infoLen);\n            glGetProgramInfoLog(program, infoLen, NULL, infoLog);\n            NSAssert(NO, @\"program%s\", infoLog);\n            free(infoLog);\n        }\n        glDeleteProgram(program);\n        return 0;\n    }\n    return program;\n}\n```\n\n## \n\nOpenGL ES 3.0\n\n``` objectivec\nEAGLContext *context = [[EAGLContext alloc] initWithAPI:kEAGLRenderingAPIOpenGLES3];\n[EAGLContext setCurrentContext:context];\n```\n\n## CAEAGLLayer\n\niOS`CAEAGLLayer`\n\n```\n- (void)initialize {\n    // layerlayer\n    CAEAGLLayer *layer = [[CAEAGLLayer alloc] init];\n    layer.frame = self.view.bounds;\n    [self.view.layer addSublayer:layer];\n    \n    // layerOpenGL ES\n    [self bindRenderLayer:layer context:context];\n}\n\n- (void)bindRenderLayer:(CALayer <EAGLDrawable> *)layer context:(EAGLContext *)context {\n    GLuint renderbuffer;\n    GLuint framebuffer;\n    glGenRenderbuffers(1, &renderbuffer);\n    glBindRenderbuffer(GL_RENDERBUFFER, renderbuffer);\n    [context renderbufferStorage:GL_RENDERBUFFER fromDrawable:layer];\n    \n    glGenFramebuffers(1, &framebuffer);\n    glBindFramebuffer(GL_FRAMEBUFFER, framebuffer);\n    glFramebufferRenderbuffer(GL_FRAMEBUFFER, GL_COLOR_ATTACHMENT0, GL_RENDERBUFFER, renderbuffer);\n}\n```\n\n`bindRenderLayer`layerlayer\n\n## \n\n\n``` objectivec\nglViewport(0, 0, self.drawableWidth, self.drawableHeight);\n\n// \n- (GLint)drawableWidth {\n    GLint backingWidth;\n    glGetRenderbufferParameteriv(GL_RENDERBUFFER, GL_RENDERBUFFER_WIDTH, &backingWidth);\n    \n    return backingWidth;\n}\n\n// \n- (GLint)drawableHeight {\n    GLint backingHeight;\n    glGetRenderbufferParameteriv(GL_RENDERBUFFER, GL_RENDERBUFFER_HEIGHT, &backingHeight);\n    \n    return backingHeight;\n}\n```\n\n\n``` objectivec\nGLuint program = [self createProgram:@\"glsl\"];\nif (!program) {\n    return;\n}\nglUseProgram(program);\n```\n\n\n``` objectivec\nglClearColor(0.0, 0.0, 0.0, 1.0);\nglClear(GL_COLOR_BUFFER_BIT);\n```\n\n(x, y, z)3\n\n``` objectivec\nGLfloat vVertices[] = {\n    0.0f, 0.5f, 0.0f,\n    -0.5f, -0.5f, 0.0f,\n    0.5f, -0.5f, 0.0f\n};\n```\n\n\n``` objectivec\n// \nglEnableVertexAttribArray(GLKVertexAttribPosition);\nglVertexAttribPointer(GLKVertexAttribPosition, 3, GL_FLOAT, GL_FALSE, 0, vVertices);\n\n// \nglDrawArrays(GL_TRIANGLES, 0, 3);\n```\n\n\n``` objectivec\n[context presentRenderbuffer:GL_RENDERBUFFER];\n```\n\n\n\n![Triangle Picture](/img/article/20190606/1.png)\n\n# GLKit\n\nGLKitGLKit\n\nGLKit`GLKView``drawRect:``GLKView``GLKBaseEffect`\n\n## GLKView\n\n`GLKView``drawRect:``GLKBaseEffect`OpenGL ES\n\n``` objectivec\n@interface TriangleGLKView ()\n\n@property (nonatomic, strong) GLKBaseEffect *baseEffect;\n\n@end\n\n@implementation TriangleGLKView\n\n- (instancetype)initWithFrame:(CGRect)frame context:(nonnull EAGLContext *)context {\n    self = [super initWithFrame:frame context:context];\n    if (self) {\n        self.baseEffect = [[GLKBaseEffect alloc] init];\n        self.baseEffect.constantColor = GLKVector4Make(0.0, 1.0, 0.0, 1.0);\n    }\n    return self;\n}\n\n\n- (void)drawRect:(CGRect)rect {\n    \n    glClearColor(1.0, 0.0, 0.0, 1.0);\n    glClear(GL_COLOR_BUFFER_BIT);\n    \n    // \n    [self.baseEffect prepareToDraw];\n    \n    GLfloat vVertice[] = {\n        0.0, 0.5, 0.0,\n        -0.5, -0.5, 0.0,\n        0.5, -0.5, 0.0\n    };\n    \n    // \n    glEnableVertexAttribArray(GLKVertexAttribPosition);\n    glVertexAttribPointer(GLKVertexAttribPosition, 3, GL_FLOAT, GL_FALSE, 0, vVertice);\n\n    // \n    glDrawArrays(GL_TRIANGLES, 0, 3);\n}\n\n@end\n```\n\n## \n\n`GLKView``GLKBaseEffect`\n\n``` objectivec\n- (void)initialize {\n    EAGLContext *context = [[EAGLContext alloc] initWithAPI:kEAGLRenderingAPIOpenGLES3];\n    [EAGLContext setCurrentContext:context];\n\n    GLKView *glkView = [[GLKView alloc] initWithFrame:self.view.bounds context:context];\n    glkView.backgroundColor = [UIColor clearColor];\n    glkView.delegate = self;\n    [self.view addSubview:glkView];\n    \n    self.baseEffect = [[GLKBaseEffect alloc] init];\n    self.baseEffect.constantColor = GLKVector4Make(0.0, 1.0, 0.0, 1.0);\n    \n    [glkView display];\n}\n\n\n- (void)glkView:(GLKView *)view drawInRect:(CGRect)rect {\n    glClearColor(1.0, 0.0, 0.0, 1.0);\n    glClear(GL_COLOR_BUFFER_BIT);\n    \n    [self.baseEffect prepareToDraw];\n    \n    GLfloat vVertice[] = {\n        0.0, 0.5, 0.0,\n        -0.5, -0.5, 0.0,\n        0.5, -0.5, 0.0\n    };\n    \n    glEnableVertexAttribArray(GLKVertexAttribPosition);\n    glVertexAttribPointer(GLKVertexAttribPosition, 3, GL_FLOAT, GL_FALSE, 0, vVertice);\n    glDrawArrays(GL_TRIANGLES, 0, 3);\n}\n```\n\n# \n\nGLKitMetal[Demo](https://github.com/Quincy-QC/OpenGL-ES-Study)","slug":"2019/opengl-es-draw-triangles-0606","published":1,"updated":"2021-06-21T12:34:52.093Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckszp3nd7000iifntomx14y1l","content":"<h1 id=\"\"></h1>\n<p>OpenGL ESOpenGL ESiOSMac OSOpenGL ESOpenGL ESOpenGL ES</p>\n<h1 id=\"\"></h1>\n<p>OpenGL ESGLSLGLSL<a href=\"https://github.com/wshxbqq/GLSL-Card\" target=\"_blank\" rel=\"noopener\"></a></p>\n<h2 id=\"\"></h2>\n<p><code>.vsh</code><code>.fsh</code></p>\n<p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#version 300 es</span><br><span class=\"line\">layout(location = 0) in vec4 vPosition;</span><br><span class=\"line\">void main() &#123;</span><br><span class=\"line\">    gl_Position = vPosition;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p></p>\n<ol>\n<li>V3.00</li>\n<li><code>layout(location = 0)</code>0<code>in vec4 vPosition</code></li>\n<li>main<code>gl_Position</code><code>gl_Position</code></li>\n</ol>\n<p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#version 300 es</span><br><span class=\"line\">precision mediump float;</span><br><span class=\"line\">out vec4 fragColor;</span><br><span class=\"line\">void main() &#123;</span><br><span class=\"line\">    fragColor = vec4(1.0, 0.0, 0.0, 1.0);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p></p>\n<ol>\n<li>V3.00</li>\n<li></li>\n<li><code>fragColor</code></li>\n<li>man</li>\n</ol>\n<h2 id=\"\"></h2>\n<p>OpenGL ES<code>loadShaderWithName:type:</code></p>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">- (GLuint)loadShaderWithName:(<span class=\"built_in\">NSString</span> *)name type:(GLenum)shaderType &#123;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"built_in\">NSString</span> *shaderPath = [[<span class=\"built_in\">NSBundle</span> mainBundle] pathForResource:name ofType:shaderType == GL_VERTEX_SHADER ? <span class=\"string\">@\"vsh\"</span> : <span class=\"string\">@\"fsh\"</span>];</span><br><span class=\"line\">    <span class=\"built_in\">NSError</span> *error;</span><br><span class=\"line\">    <span class=\"built_in\">NSString</span> *shaderString = [<span class=\"built_in\">NSString</span> stringWithContentsOfFile:shaderPath encoding:<span class=\"built_in\">NSUTF8StringEncoding</span> error:&amp;error];</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (!shaderString) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">NSAssert</span>(<span class=\"literal\">NO</span>, <span class=\"string\">@\"Shader%@\"</span>, error.localizedDescription);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">// shader</span></span><br><span class=\"line\">    GLuint shader = glCreateShader(shaderType);</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (!shader) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">// shader</span></span><br><span class=\"line\">    <span class=\"keyword\">const</span> GLchar *shaderStringUTF8 = [shaderString UTF8String];</span><br><span class=\"line\">    glShaderSource(shader, <span class=\"number\">1</span>, &amp;shaderStringUTF8, <span class=\"literal\">NULL</span>);</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">// shader</span></span><br><span class=\"line\">    glCompileShader(shader);</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">// shader</span></span><br><span class=\"line\">    GLint compiled;</span><br><span class=\"line\">    glGetShaderiv(shader, GL_COMPILE_STATUS, &amp;compiled);</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (!compiled) &#123;</span><br><span class=\"line\">        GLint infoLen;</span><br><span class=\"line\">        glGetShaderiv(shader, GL_INFO_LOG_LENGTH, &amp;infoLen);</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (infoLen &gt; <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">            GLchar *infoLog = malloc(<span class=\"keyword\">sizeof</span>(GLchar) * infoLen);</span><br><span class=\"line\">            glGetShaderInfoLog(shader, infoLen, <span class=\"literal\">NULL</span>, infoLog);</span><br><span class=\"line\">            <span class=\"built_in\">NSAssert</span>(<span class=\"literal\">NO</span>, <span class=\"string\">@\"shader%s\"</span>, infoLog);</span><br><span class=\"line\">            free(infoLog);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        glDeleteShader(shader);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> shader;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"\"></h2>\n<p></p>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">- (GLuint)createProgram:(<span class=\"built_in\">NSString</span> *)programName &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    GLuint vertexShader = [<span class=\"keyword\">self</span> loadShaderWithName:programName type:GL_VERTEX_SHADER];</span><br><span class=\"line\">    GLuint fragmentShader = [<span class=\"keyword\">self</span> loadShaderWithName:programName type:GL_FRAGMENT_SHADER];</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">// program</span></span><br><span class=\"line\">    GLuint program = glCreateProgram();</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (!program) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">// programshader</span></span><br><span class=\"line\">    glAttachShader(program, vertexShader);</span><br><span class=\"line\">    glAttachShader(program, fragmentShader);</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">// program</span></span><br><span class=\"line\">    glLinkProgram(program);</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">// program</span></span><br><span class=\"line\">    GLint linked;</span><br><span class=\"line\">    glGetProgramiv(program, GL_LINK_STATUS, &amp;linked);</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (!linked) &#123;</span><br><span class=\"line\">        GLint infoLen;</span><br><span class=\"line\">        glGetProgramiv(program, GL_INFO_LOG_LENGTH, &amp;infoLen);</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (infoLen &gt; <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">            GLchar *infoLog = malloc(<span class=\"keyword\">sizeof</span>(GLchar) * infoLen);</span><br><span class=\"line\">            glGetProgramInfoLog(program, infoLen, <span class=\"literal\">NULL</span>, infoLog);</span><br><span class=\"line\">            <span class=\"built_in\">NSAssert</span>(<span class=\"literal\">NO</span>, <span class=\"string\">@\"program%s\"</span>, infoLog);</span><br><span class=\"line\">            free(infoLog);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        glDeleteProgram(program);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> program;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"\"></h2>\n<p>OpenGL ES 3.0</p>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">EAGLContext *context = [[EAGLContext alloc] initWithAPI:kEAGLRenderingAPIOpenGLES3];</span><br><span class=\"line\">[EAGLContext setCurrentContext:context];</span><br></pre></td></tr></table></figure>\n<h2 id=\"caeagllayer\">CAEAGLLayer</h2>\n<p>iOS<code>CAEAGLLayer</code></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">- (void)initialize &#123;</span><br><span class=\"line\">    // layerlayer</span><br><span class=\"line\">    CAEAGLLayer *layer = [[CAEAGLLayer alloc] init];</span><br><span class=\"line\">    layer.frame = self.view.bounds;</span><br><span class=\"line\">    [self.view.layer addSublayer:layer];</span><br><span class=\"line\">    </span><br><span class=\"line\">    // layerOpenGL ES</span><br><span class=\"line\">    [self bindRenderLayer:layer context:context];</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">- (void)bindRenderLayer:(CALayer &lt;EAGLDrawable&gt; *)layer context:(EAGLContext *)context &#123;</span><br><span class=\"line\">    GLuint renderbuffer;</span><br><span class=\"line\">    GLuint framebuffer;</span><br><span class=\"line\">    glGenRenderbuffers(1, &amp;renderbuffer);</span><br><span class=\"line\">    glBindRenderbuffer(GL_RENDERBUFFER, renderbuffer);</span><br><span class=\"line\">    [context renderbufferStorage:GL_RENDERBUFFER fromDrawable:layer];</span><br><span class=\"line\">    </span><br><span class=\"line\">    glGenFramebuffers(1, &amp;framebuffer);</span><br><span class=\"line\">    glBindFramebuffer(GL_FRAMEBUFFER, framebuffer);</span><br><span class=\"line\">    glFramebufferRenderbuffer(GL_FRAMEBUFFER, GL_COLOR_ATTACHMENT0, GL_RENDERBUFFER, renderbuffer);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><code>bindRenderLayer</code>layerlayer</p>\n<h2 id=\"\"></h2>\n<p></p>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">glViewport(<span class=\"number\">0</span>, <span class=\"number\">0</span>, <span class=\"keyword\">self</span>.drawableWidth, <span class=\"keyword\">self</span>.drawableHeight);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\">- (GLint)drawableWidth &#123;</span><br><span class=\"line\">    GLint backingWidth;</span><br><span class=\"line\">    glGetRenderbufferParameteriv(GL_RENDERBUFFER, GL_RENDERBUFFER_WIDTH, &amp;backingWidth);</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">return</span> backingWidth;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\">- (GLint)drawableHeight &#123;</span><br><span class=\"line\">    GLint backingHeight;</span><br><span class=\"line\">    glGetRenderbufferParameteriv(GL_RENDERBUFFER, GL_RENDERBUFFER_HEIGHT, &amp;backingHeight);</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">return</span> backingHeight;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">GLuint program = [<span class=\"keyword\">self</span> createProgram:<span class=\"string\">@\"glsl\"</span>];</span><br><span class=\"line\"><span class=\"keyword\">if</span> (!program) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">glUseProgram(program);</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">glClearColor(<span class=\"number\">0.0</span>, <span class=\"number\">0.0</span>, <span class=\"number\">0.0</span>, <span class=\"number\">1.0</span>);</span><br><span class=\"line\">glClear(GL_COLOR_BUFFER_BIT);</span><br></pre></td></tr></table></figure>\n<p>(x, y, z)3</p>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">GLfloat vVertices[] = &#123;</span><br><span class=\"line\">    <span class=\"number\">0.0</span>f, <span class=\"number\">0.5</span>f, <span class=\"number\">0.0</span>f,</span><br><span class=\"line\">    <span class=\"number\">-0.5</span>f, <span class=\"number\">-0.5</span>f, <span class=\"number\">0.0</span>f,</span><br><span class=\"line\">    <span class=\"number\">0.5</span>f, <span class=\"number\">-0.5</span>f, <span class=\"number\">0.0</span>f</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\">glEnableVertexAttribArray(GLKVertexAttribPosition);</span><br><span class=\"line\">glVertexAttribPointer(GLKVertexAttribPosition, <span class=\"number\">3</span>, GL_FLOAT, GL_FALSE, <span class=\"number\">0</span>, vVertices);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\">glDrawArrays(GL_TRIANGLES, <span class=\"number\">0</span>, <span class=\"number\">3</span>);</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[context presentRenderbuffer:GL_RENDERBUFFER];</span><br></pre></td></tr></table></figure>\n<p></p>\n<p><img src=\"/img/article/20190606/1.png\" alt=\"Triangle Picture\"></p>\n<h1 id=\"glkit\">GLKit</h1>\n<p>GLKitGLKit</p>\n<p>GLKit<code>GLKView</code><code>drawRect:</code><code>GLKView</code><code>GLKBaseEffect</code></p>\n<h2 id=\"glkview\">GLKView</h2>\n<p><code>GLKView</code><code>drawRect:</code><code>GLKBaseEffect</code>OpenGL ES</p>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">@interface</span> <span class=\"title\">TriangleGLKView</span> ()</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">@property</span> (<span class=\"keyword\">nonatomic</span>, <span class=\"keyword\">strong</span>) GLKBaseEffect *baseEffect;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">@end</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">@implementation</span> <span class=\"title\">TriangleGLKView</span></span></span><br><span class=\"line\"></span><br><span class=\"line\">- (<span class=\"keyword\">instancetype</span>)initWithFrame:(<span class=\"built_in\">CGRect</span>)frame context:(<span class=\"keyword\">nonnull</span> EAGLContext *)context &#123;</span><br><span class=\"line\">    <span class=\"keyword\">self</span> = [<span class=\"keyword\">super</span> initWithFrame:frame context:context];</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"keyword\">self</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">self</span>.baseEffect = [[GLKBaseEffect alloc] init];</span><br><span class=\"line\">        <span class=\"keyword\">self</span>.baseEffect.constantColor = GLKVector4Make(<span class=\"number\">0.0</span>, <span class=\"number\">1.0</span>, <span class=\"number\">0.0</span>, <span class=\"number\">1.0</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">self</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">- (<span class=\"keyword\">void</span>)drawRect:(<span class=\"built_in\">CGRect</span>)rect &#123;</span><br><span class=\"line\">    </span><br><span class=\"line\">    glClearColor(<span class=\"number\">1.0</span>, <span class=\"number\">0.0</span>, <span class=\"number\">0.0</span>, <span class=\"number\">1.0</span>);</span><br><span class=\"line\">    glClear(GL_COLOR_BUFFER_BIT);</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    [<span class=\"keyword\">self</span>.baseEffect prepareToDraw];</span><br><span class=\"line\">    </span><br><span class=\"line\">    GLfloat vVertice[] = &#123;</span><br><span class=\"line\">        <span class=\"number\">0.0</span>, <span class=\"number\">0.5</span>, <span class=\"number\">0.0</span>,</span><br><span class=\"line\">        <span class=\"number\">-0.5</span>, <span class=\"number\">-0.5</span>, <span class=\"number\">0.0</span>,</span><br><span class=\"line\">        <span class=\"number\">0.5</span>, <span class=\"number\">-0.5</span>, <span class=\"number\">0.0</span></span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    glEnableVertexAttribArray(GLKVertexAttribPosition);</span><br><span class=\"line\">    glVertexAttribPointer(GLKVertexAttribPosition, <span class=\"number\">3</span>, GL_FLOAT, GL_FALSE, <span class=\"number\">0</span>, vVertice);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    glDrawArrays(GL_TRIANGLES, <span class=\"number\">0</span>, <span class=\"number\">3</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">@end</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"\"></h2>\n<p><code>GLKView</code><code>GLKBaseEffect</code></p>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">- (<span class=\"keyword\">void</span>)initialize &#123;</span><br><span class=\"line\">    EAGLContext *context = [[EAGLContext alloc] initWithAPI:kEAGLRenderingAPIOpenGLES3];</span><br><span class=\"line\">    [EAGLContext setCurrentContext:context];</span><br><span class=\"line\"></span><br><span class=\"line\">    GLKView *glkView = [[GLKView alloc] initWithFrame:<span class=\"keyword\">self</span>.view.bounds context:context];</span><br><span class=\"line\">    glkView.backgroundColor = [<span class=\"built_in\">UIColor</span> clearColor];</span><br><span class=\"line\">    glkView.delegate = <span class=\"keyword\">self</span>;</span><br><span class=\"line\">    [<span class=\"keyword\">self</span>.view addSubview:glkView];</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">self</span>.baseEffect = [[GLKBaseEffect alloc] init];</span><br><span class=\"line\">    <span class=\"keyword\">self</span>.baseEffect.constantColor = GLKVector4Make(<span class=\"number\">0.0</span>, <span class=\"number\">1.0</span>, <span class=\"number\">0.0</span>, <span class=\"number\">1.0</span>);</span><br><span class=\"line\">    </span><br><span class=\"line\">    [glkView display];</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">- (<span class=\"keyword\">void</span>)glkView:(GLKView *)view drawInRect:(<span class=\"built_in\">CGRect</span>)rect &#123;</span><br><span class=\"line\">    glClearColor(<span class=\"number\">1.0</span>, <span class=\"number\">0.0</span>, <span class=\"number\">0.0</span>, <span class=\"number\">1.0</span>);</span><br><span class=\"line\">    glClear(GL_COLOR_BUFFER_BIT);</span><br><span class=\"line\">    </span><br><span class=\"line\">    [<span class=\"keyword\">self</span>.baseEffect prepareToDraw];</span><br><span class=\"line\">    </span><br><span class=\"line\">    GLfloat vVertice[] = &#123;</span><br><span class=\"line\">        <span class=\"number\">0.0</span>, <span class=\"number\">0.5</span>, <span class=\"number\">0.0</span>,</span><br><span class=\"line\">        <span class=\"number\">-0.5</span>, <span class=\"number\">-0.5</span>, <span class=\"number\">0.0</span>,</span><br><span class=\"line\">        <span class=\"number\">0.5</span>, <span class=\"number\">-0.5</span>, <span class=\"number\">0.0</span></span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">    </span><br><span class=\"line\">    glEnableVertexAttribArray(GLKVertexAttribPosition);</span><br><span class=\"line\">    glVertexAttribPointer(GLKVertexAttribPosition, <span class=\"number\">3</span>, GL_FLOAT, GL_FALSE, <span class=\"number\">0</span>, vVertice);</span><br><span class=\"line\">    glDrawArrays(GL_TRIANGLES, <span class=\"number\">0</span>, <span class=\"number\">3</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h1 id=\"\"></h1>\n<p>GLKitMetal<a href=\"https://github.com/Quincy-QC/OpenGL-ES-Study\" target=\"_blank\" rel=\"noopener\">Demo</a></p>\n","site":{"data":{}},"excerpt":"","more":"<h1></h1>\n<p>OpenGL ESOpenGL ESiOSMac OSOpenGL ESOpenGL ESOpenGL ES</p>\n<h1></h1>\n<p>OpenGL ESGLSLGLSL<a href=\"https://github.com/wshxbqq/GLSL-Card\" target=\"_blank\" rel=\"noopener\"></a></p>\n<h2></h2>\n<p><code>.vsh</code><code>.fsh</code></p>\n<p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#version 300 es</span><br><span class=\"line\">layout(location = 0) in vec4 vPosition;</span><br><span class=\"line\">void main() &#123;</span><br><span class=\"line\">    gl_Position = vPosition;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p></p>\n<ol>\n<li>V3.00</li>\n<li><code>layout(location = 0)</code>0<code>in vec4 vPosition</code></li>\n<li>main<code>gl_Position</code><code>gl_Position</code></li>\n</ol>\n<p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#version 300 es</span><br><span class=\"line\">precision mediump float;</span><br><span class=\"line\">out vec4 fragColor;</span><br><span class=\"line\">void main() &#123;</span><br><span class=\"line\">    fragColor = vec4(1.0, 0.0, 0.0, 1.0);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p></p>\n<ol>\n<li>V3.00</li>\n<li></li>\n<li><code>fragColor</code></li>\n<li>man</li>\n</ol>\n<h2></h2>\n<p>OpenGL ES<code>loadShaderWithName:type:</code></p>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">- (GLuint)loadShaderWithName:(<span class=\"built_in\">NSString</span> *)name type:(GLenum)shaderType &#123;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"built_in\">NSString</span> *shaderPath = [[<span class=\"built_in\">NSBundle</span> mainBundle] pathForResource:name ofType:shaderType == GL_VERTEX_SHADER ? <span class=\"string\">@\"vsh\"</span> : <span class=\"string\">@\"fsh\"</span>];</span><br><span class=\"line\">    <span class=\"built_in\">NSError</span> *error;</span><br><span class=\"line\">    <span class=\"built_in\">NSString</span> *shaderString = [<span class=\"built_in\">NSString</span> stringWithContentsOfFile:shaderPath encoding:<span class=\"built_in\">NSUTF8StringEncoding</span> error:&amp;error];</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (!shaderString) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">NSAssert</span>(<span class=\"literal\">NO</span>, <span class=\"string\">@\"Shader%@\"</span>, error.localizedDescription);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">// shader</span></span><br><span class=\"line\">    GLuint shader = glCreateShader(shaderType);</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (!shader) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">// shader</span></span><br><span class=\"line\">    <span class=\"keyword\">const</span> GLchar *shaderStringUTF8 = [shaderString UTF8String];</span><br><span class=\"line\">    glShaderSource(shader, <span class=\"number\">1</span>, &amp;shaderStringUTF8, <span class=\"literal\">NULL</span>);</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">// shader</span></span><br><span class=\"line\">    glCompileShader(shader);</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">// shader</span></span><br><span class=\"line\">    GLint compiled;</span><br><span class=\"line\">    glGetShaderiv(shader, GL_COMPILE_STATUS, &amp;compiled);</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (!compiled) &#123;</span><br><span class=\"line\">        GLint infoLen;</span><br><span class=\"line\">        glGetShaderiv(shader, GL_INFO_LOG_LENGTH, &amp;infoLen);</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (infoLen &gt; <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">            GLchar *infoLog = malloc(<span class=\"keyword\">sizeof</span>(GLchar) * infoLen);</span><br><span class=\"line\">            glGetShaderInfoLog(shader, infoLen, <span class=\"literal\">NULL</span>, infoLog);</span><br><span class=\"line\">            <span class=\"built_in\">NSAssert</span>(<span class=\"literal\">NO</span>, <span class=\"string\">@\"shader%s\"</span>, infoLog);</span><br><span class=\"line\">            free(infoLog);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        glDeleteShader(shader);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> shader;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2></h2>\n<p></p>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">- (GLuint)createProgram:(<span class=\"built_in\">NSString</span> *)programName &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    GLuint vertexShader = [<span class=\"keyword\">self</span> loadShaderWithName:programName type:GL_VERTEX_SHADER];</span><br><span class=\"line\">    GLuint fragmentShader = [<span class=\"keyword\">self</span> loadShaderWithName:programName type:GL_FRAGMENT_SHADER];</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">// program</span></span><br><span class=\"line\">    GLuint program = glCreateProgram();</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (!program) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">// programshader</span></span><br><span class=\"line\">    glAttachShader(program, vertexShader);</span><br><span class=\"line\">    glAttachShader(program, fragmentShader);</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">// program</span></span><br><span class=\"line\">    glLinkProgram(program);</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">// program</span></span><br><span class=\"line\">    GLint linked;</span><br><span class=\"line\">    glGetProgramiv(program, GL_LINK_STATUS, &amp;linked);</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (!linked) &#123;</span><br><span class=\"line\">        GLint infoLen;</span><br><span class=\"line\">        glGetProgramiv(program, GL_INFO_LOG_LENGTH, &amp;infoLen);</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (infoLen &gt; <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">            GLchar *infoLog = malloc(<span class=\"keyword\">sizeof</span>(GLchar) * infoLen);</span><br><span class=\"line\">            glGetProgramInfoLog(program, infoLen, <span class=\"literal\">NULL</span>, infoLog);</span><br><span class=\"line\">            <span class=\"built_in\">NSAssert</span>(<span class=\"literal\">NO</span>, <span class=\"string\">@\"program%s\"</span>, infoLog);</span><br><span class=\"line\">            free(infoLog);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        glDeleteProgram(program);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> program;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2></h2>\n<p>OpenGL ES 3.0</p>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">EAGLContext *context = [[EAGLContext alloc] initWithAPI:kEAGLRenderingAPIOpenGLES3];</span><br><span class=\"line\">[EAGLContext setCurrentContext:context];</span><br></pre></td></tr></table></figure>\n<h2>CAEAGLLayer</h2>\n<p>iOS<code>CAEAGLLayer</code></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">- (void)initialize &#123;</span><br><span class=\"line\">    // layerlayer</span><br><span class=\"line\">    CAEAGLLayer *layer = [[CAEAGLLayer alloc] init];</span><br><span class=\"line\">    layer.frame = self.view.bounds;</span><br><span class=\"line\">    [self.view.layer addSublayer:layer];</span><br><span class=\"line\">    </span><br><span class=\"line\">    // layerOpenGL ES</span><br><span class=\"line\">    [self bindRenderLayer:layer context:context];</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">- (void)bindRenderLayer:(CALayer &lt;EAGLDrawable&gt; *)layer context:(EAGLContext *)context &#123;</span><br><span class=\"line\">    GLuint renderbuffer;</span><br><span class=\"line\">    GLuint framebuffer;</span><br><span class=\"line\">    glGenRenderbuffers(1, &amp;renderbuffer);</span><br><span class=\"line\">    glBindRenderbuffer(GL_RENDERBUFFER, renderbuffer);</span><br><span class=\"line\">    [context renderbufferStorage:GL_RENDERBUFFER fromDrawable:layer];</span><br><span class=\"line\">    </span><br><span class=\"line\">    glGenFramebuffers(1, &amp;framebuffer);</span><br><span class=\"line\">    glBindFramebuffer(GL_FRAMEBUFFER, framebuffer);</span><br><span class=\"line\">    glFramebufferRenderbuffer(GL_FRAMEBUFFER, GL_COLOR_ATTACHMENT0, GL_RENDERBUFFER, renderbuffer);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><code>bindRenderLayer</code>layerlayer</p>\n<h2></h2>\n<p></p>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">glViewport(<span class=\"number\">0</span>, <span class=\"number\">0</span>, <span class=\"keyword\">self</span>.drawableWidth, <span class=\"keyword\">self</span>.drawableHeight);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\">- (GLint)drawableWidth &#123;</span><br><span class=\"line\">    GLint backingWidth;</span><br><span class=\"line\">    glGetRenderbufferParameteriv(GL_RENDERBUFFER, GL_RENDERBUFFER_WIDTH, &amp;backingWidth);</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">return</span> backingWidth;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\">- (GLint)drawableHeight &#123;</span><br><span class=\"line\">    GLint backingHeight;</span><br><span class=\"line\">    glGetRenderbufferParameteriv(GL_RENDERBUFFER, GL_RENDERBUFFER_HEIGHT, &amp;backingHeight);</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">return</span> backingHeight;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">GLuint program = [<span class=\"keyword\">self</span> createProgram:<span class=\"string\">@\"glsl\"</span>];</span><br><span class=\"line\"><span class=\"keyword\">if</span> (!program) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">glUseProgram(program);</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">glClearColor(<span class=\"number\">0.0</span>, <span class=\"number\">0.0</span>, <span class=\"number\">0.0</span>, <span class=\"number\">1.0</span>);</span><br><span class=\"line\">glClear(GL_COLOR_BUFFER_BIT);</span><br></pre></td></tr></table></figure>\n<p>(x, y, z)3</p>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">GLfloat vVertices[] = &#123;</span><br><span class=\"line\">    <span class=\"number\">0.0</span>f, <span class=\"number\">0.5</span>f, <span class=\"number\">0.0</span>f,</span><br><span class=\"line\">    <span class=\"number\">-0.5</span>f, <span class=\"number\">-0.5</span>f, <span class=\"number\">0.0</span>f,</span><br><span class=\"line\">    <span class=\"number\">0.5</span>f, <span class=\"number\">-0.5</span>f, <span class=\"number\">0.0</span>f</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\">glEnableVertexAttribArray(GLKVertexAttribPosition);</span><br><span class=\"line\">glVertexAttribPointer(GLKVertexAttribPosition, <span class=\"number\">3</span>, GL_FLOAT, GL_FALSE, <span class=\"number\">0</span>, vVertices);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\">glDrawArrays(GL_TRIANGLES, <span class=\"number\">0</span>, <span class=\"number\">3</span>);</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[context presentRenderbuffer:GL_RENDERBUFFER];</span><br></pre></td></tr></table></figure>\n<p></p>\n<p><img src=\"/img/article/20190606/1.png\" alt=\"Triangle Picture\"></p>\n<h1>GLKit</h1>\n<p>GLKitGLKit</p>\n<p>GLKit<code>GLKView</code><code>drawRect:</code><code>GLKView</code><code>GLKBaseEffect</code></p>\n<h2>GLKView</h2>\n<p><code>GLKView</code><code>drawRect:</code><code>GLKBaseEffect</code>OpenGL ES</p>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">@interface</span> <span class=\"title\">TriangleGLKView</span> ()</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">@property</span> (<span class=\"keyword\">nonatomic</span>, <span class=\"keyword\">strong</span>) GLKBaseEffect *baseEffect;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">@end</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">@implementation</span> <span class=\"title\">TriangleGLKView</span></span></span><br><span class=\"line\"></span><br><span class=\"line\">- (<span class=\"keyword\">instancetype</span>)initWithFrame:(<span class=\"built_in\">CGRect</span>)frame context:(<span class=\"keyword\">nonnull</span> EAGLContext *)context &#123;</span><br><span class=\"line\">    <span class=\"keyword\">self</span> = [<span class=\"keyword\">super</span> initWithFrame:frame context:context];</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"keyword\">self</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">self</span>.baseEffect = [[GLKBaseEffect alloc] init];</span><br><span class=\"line\">        <span class=\"keyword\">self</span>.baseEffect.constantColor = GLKVector4Make(<span class=\"number\">0.0</span>, <span class=\"number\">1.0</span>, <span class=\"number\">0.0</span>, <span class=\"number\">1.0</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">self</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">- (<span class=\"keyword\">void</span>)drawRect:(<span class=\"built_in\">CGRect</span>)rect &#123;</span><br><span class=\"line\">    </span><br><span class=\"line\">    glClearColor(<span class=\"number\">1.0</span>, <span class=\"number\">0.0</span>, <span class=\"number\">0.0</span>, <span class=\"number\">1.0</span>);</span><br><span class=\"line\">    glClear(GL_COLOR_BUFFER_BIT);</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    [<span class=\"keyword\">self</span>.baseEffect prepareToDraw];</span><br><span class=\"line\">    </span><br><span class=\"line\">    GLfloat vVertice[] = &#123;</span><br><span class=\"line\">        <span class=\"number\">0.0</span>, <span class=\"number\">0.5</span>, <span class=\"number\">0.0</span>,</span><br><span class=\"line\">        <span class=\"number\">-0.5</span>, <span class=\"number\">-0.5</span>, <span class=\"number\">0.0</span>,</span><br><span class=\"line\">        <span class=\"number\">0.5</span>, <span class=\"number\">-0.5</span>, <span class=\"number\">0.0</span></span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    glEnableVertexAttribArray(GLKVertexAttribPosition);</span><br><span class=\"line\">    glVertexAttribPointer(GLKVertexAttribPosition, <span class=\"number\">3</span>, GL_FLOAT, GL_FALSE, <span class=\"number\">0</span>, vVertice);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    glDrawArrays(GL_TRIANGLES, <span class=\"number\">0</span>, <span class=\"number\">3</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">@end</span></span><br></pre></td></tr></table></figure>\n<h2></h2>\n<p><code>GLKView</code><code>GLKBaseEffect</code></p>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">- (<span class=\"keyword\">void</span>)initialize &#123;</span><br><span class=\"line\">    EAGLContext *context = [[EAGLContext alloc] initWithAPI:kEAGLRenderingAPIOpenGLES3];</span><br><span class=\"line\">    [EAGLContext setCurrentContext:context];</span><br><span class=\"line\"></span><br><span class=\"line\">    GLKView *glkView = [[GLKView alloc] initWithFrame:<span class=\"keyword\">self</span>.view.bounds context:context];</span><br><span class=\"line\">    glkView.backgroundColor = [<span class=\"built_in\">UIColor</span> clearColor];</span><br><span class=\"line\">    glkView.delegate = <span class=\"keyword\">self</span>;</span><br><span class=\"line\">    [<span class=\"keyword\">self</span>.view addSubview:glkView];</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">self</span>.baseEffect = [[GLKBaseEffect alloc] init];</span><br><span class=\"line\">    <span class=\"keyword\">self</span>.baseEffect.constantColor = GLKVector4Make(<span class=\"number\">0.0</span>, <span class=\"number\">1.0</span>, <span class=\"number\">0.0</span>, <span class=\"number\">1.0</span>);</span><br><span class=\"line\">    </span><br><span class=\"line\">    [glkView display];</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">- (<span class=\"keyword\">void</span>)glkView:(GLKView *)view drawInRect:(<span class=\"built_in\">CGRect</span>)rect &#123;</span><br><span class=\"line\">    glClearColor(<span class=\"number\">1.0</span>, <span class=\"number\">0.0</span>, <span class=\"number\">0.0</span>, <span class=\"number\">1.0</span>);</span><br><span class=\"line\">    glClear(GL_COLOR_BUFFER_BIT);</span><br><span class=\"line\">    </span><br><span class=\"line\">    [<span class=\"keyword\">self</span>.baseEffect prepareToDraw];</span><br><span class=\"line\">    </span><br><span class=\"line\">    GLfloat vVertice[] = &#123;</span><br><span class=\"line\">        <span class=\"number\">0.0</span>, <span class=\"number\">0.5</span>, <span class=\"number\">0.0</span>,</span><br><span class=\"line\">        <span class=\"number\">-0.5</span>, <span class=\"number\">-0.5</span>, <span class=\"number\">0.0</span>,</span><br><span class=\"line\">        <span class=\"number\">0.5</span>, <span class=\"number\">-0.5</span>, <span class=\"number\">0.0</span></span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">    </span><br><span class=\"line\">    glEnableVertexAttribArray(GLKVertexAttribPosition);</span><br><span class=\"line\">    glVertexAttribPointer(GLKVertexAttribPosition, <span class=\"number\">3</span>, GL_FLOAT, GL_FALSE, <span class=\"number\">0</span>, vVertice);</span><br><span class=\"line\">    glDrawArrays(GL_TRIANGLES, <span class=\"number\">0</span>, <span class=\"number\">3</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h1></h1>\n<p>GLKitMetal<a href=\"https://github.com/Quincy-QC/OpenGL-ES-Study\" target=\"_blank\" rel=\"noopener\">Demo</a></p>\n"},{"title":"OpenGL ES--","catalog":true,"toc_nav_num":true,"date":"2019-08-16T09:30:01.000Z","subtitle":"About OpenGL ES","header-img":"/img/article_header/article_header.png","busuanzi":true,"_content":"\n> OpenGL ES 3.0\n> - \n> - \n> - \n> - \n> - \n> - \n>\n> \n> ![](/img/article/20190816/1.png)\n\n# \n\nOpenGL ES3\n- \n- \n- \n\n3Alpha1616RGB56RGBA32\nLCD\nEGLEGL3168\n\n## \n\nOpenGL ES`glClear`\n\n``` objc\n/**\n \n\n @param mask#> OpenGL ESGL_COLOR_BUFFER_BIT GL_DEPTH_BUFFER_BITGL_STENCIL_BUFFER_BIT description#>\n @return void\n */\nglClear(GLbitfield mask);\n```\n\n`glClear`\n\n\n``` objc\n/**\n \n\n @param redgreenbluealpha#> glClearGL_COLOR_BUFFER_BIT[0, 1] description#>\n @return void\n */\nglClearColor(GLclampf red, GLclampf green, GLclampf blue, GLclampf alpha);\n\n/**\n \n\n @param depth#> glClearGL_DEPTH_BUFFER_BIT[0, 1] description#>\n @return void\n */\nglClearDepthf(GLclampf depth);\n\n/**\n \n\n @param s#> glClearGL_DEPTH_BUFFER_BIT[0, 2^n-1]n description#>\n @return void\n */\nglClearStencil(GLint s);\n```\n\n\n\n``` objc\n/**\n \n\n @param buffer#> GL_COLORGL_FRONTGL_BACKGL_FRONT_AND_BACKGL_LEFTGL_RIGHTGL_DEPTHglClearBufferfvGL_STENCILglClearBufferiv description#>\n @param drawbuffer#> 0.GL_MAX_DRAW_BUFFERS description#>\n @param value#>  description#>\n @return void\n */\nglClearBufferiv(GLenum buffer, GLint drawbuffer, const GLint *value);\nglClearBufferuiv(GLenum buffer, GLint drawbuffer, const GLuint *value);\nglClearBufferfv(GLenum buffer, GLint drawbuffer, const GLfloat *value);\n```\n\n`glClearBufferfi`\n\n``` objc\n/**\n \n\n @param buffer#> GL_DEPTH_STENCIL description#>\n @param drawbuffer#> 0 description#>\n @param depth#>  description#>\n @param stencil#>  description#>\n @return void\n */\nglClearBufferfi(GLenum buffer, GLint drawbuffer, GLfloat depth, GLint stencil);\n```\n\n## \n\n\n`glColorMask``GL_FALSE`\n\n``` objc\n/**\n \n\n @param redgreenbluealpha#>  description#>\n @return void\n */\nglColorMask(GLboolean red, GLboolean green, GLboolean blue, GLboolean alpha);\n```\n\n`GL_TRUE``GL_FALSE``glDepthMask`\n`GL_TRUE``glDepthMask``GL_FALSE`\n\n``` objc\n/**\n \n\n @param flag#>  description#>\n @return void\n */\nglDepthMask(GLboolean flag);\n```\n\n`glStencilMask``glColorMask``glDepthMask`\n\n``` objc\n/**\n \n\n @param mask#> [0, 2^n-1]n0x000xFF description#>\n @return void\n */\nglStencilMask(GLuint mask);\n```\n\n`glStencilMaskSeparate`\n\n``` objc\n/**\n \n\n @param face#> GL_FRONTGL_BACKGL_FRONT_AND_BACK description#>\n @param mask#> [0, 2^n-1]n description#>\n @return void\n */\nglStencilMaskSeparate(GLenum face, GLuint mask);\n```\n\n# \n\nOpenGL ES\n`glEnable`\n\nglEnable | \n- | -\nGL_DEPTH_TEST | \nGL_STENCIL_TEST | \nGL_BLEND | \nGL_DITHER | \nGL_SAMPLE_COVERAGE | \nGL_SAMPLE_ALPHA_TO_COVERAGE | Alpha\n\n## \n\n`glScissor`\n\n``` objc\n/**\n \n\n @param xy#>  description#>\n @param width#>  description#>\n @param height#>  description#>\n @return void\n */\nglScissor(GLint x, GLint y, GLsizei width, GLsizei height);\n```\n\n`glEnable(GL_SCISSOR_TEST)`\n\n\n## \n\n\n\nC`glStencilFunc``glStencilSeparate`\n\n``` objc\n/**\n \n\n @param func#> GL_EQUALGL_NOTEQUALGL_LESSGL_GREATERGL_LEQUEALGL_GEQUALGL_ALWAYSGL_NEVER description#>\n @param ref#>  description#>\n @param mask#>  description#>\n @return void\n */\nglStencilFunc(GLenum func, GLint ref, GLuint mask);\n\n/**\n \n\n @param face#> GL_FRONTGL_BACKGL_FRONT_AND_BACK description#>\n @param func#> GL_EQUALGL_NOTEQUALGL_LESSGL_GREATERGL_LEQUEALGL_GEQUALGL_ALWAYSGL_NEVER description#>\n @param ref#>  description#>\n @param mask#>  description#>\n @return void\n */\nglStencilFuncSeparate(GLenum face, GLenum func, GLint ref, GLuint mask);\n```\n\n2\n\n``` objc\nglStencilFunc(GL_EQUAL, 2, 0x7);\n```\n\n0x7111\n\nOpenGL ES 3.03\n1. \n2. \n3. \n\n`glStencilOp``glStencilOpSeparte`\n\n | \n- | -\nGL_ZERO | 0\nGL_REPLACE | `glStencilFunc``glStencilFuncSeparate`\nGL_INCE, GL_DECR | 02<sup>n</sup>n\nGL_INCE_WRAP, GL_DECR_WRAP | 00\nGL_KEEP | \nGL_INVERT | \n\n``` objc\n/**\n \n\n @param fail#>  description#>\n @param zfail#>  description#>\n @param zpass#>  description#>\n @return void\n */\nglStencilOp(GLenum fail, GLenum zfail, GLenum zpass);\n\n/**\n \n\n @param face#> GL_FRONTGL_BACKGL_FRONT_AND_BACK description#>\n @param fail#>  description#>\n @param zfail#>  description#>\n @param zpass#>  description#>\n @return void\n */\nglStencilOpSeparate(GLenum face, GLenum fail, GLenum zfail, GLenum zpass);\n```\n\n### \n\n--`GL_DEPTH_TEST``glEnable`\n`glDepthFunc`\n\n``` objc\n/**\n \n\n @param func#> GL_LESSGL_GREATERGL_LEQUALGL_GEQUALGL_EQUALGL_NOTEQUALGL_ALWAYSGL_NEVER description#>\n @return void\n */\nglDepthFunc(GLenum func);\n```\n\n## \n\nC<sub>final</sub>=f<sub>source</sub>C<sub>source</sub>opf<sub>destination</sub>C<sub>destination</sub>\nf<sub>source</sub>C<sub>source</sub>f<sub>destination</sub>C<sub>destination</sub>op\n`glBlendFunc``glBlendFuncSeparate`\n\n``` objc\n/**\n \n\n @param sfactor#>  description#>\n @param dfactor#>  description#>\n @return void\n */\nglBlendFunc(GLenum sfactor, GLenum dfactor);\n\n/**\n \n\n @param srcRGB#>  description#>\n @param dstRGB#>  description#>\n @param srcAlpha#> Alpha description#>\n @param dstAlpha#> Alpha description#>\n @return void\n */\nglBlendFuncSeparate(GLenum srcRGB, GLenum dstRGB, GLenum srcAlpha, GLenum dstAlpha);\n```\n\n\n\n![](/img/article/20190816/2.png)\n\nC<sub>constant</sub>`glBlendColor`\n\n``` objc\n/**\n \n\n @param redgreenbluealpha#>  description#>\n @return void\n */\nglBlendColor(GLfloat red, GLfloat green, GLfloat blue, GLfloat alpha);\n```\n\n`glBlendEquation``glBlendEquationSeparate``GL_FUNC_ADD``GL_FUNC_SUBTRACT``GL_FUNC_REVERSE_SUBTRACT`\n\n```\n/**\n \n\n @param mode#> GL_FUNC_ADDGL_FUNC_SUBTRACTGL_FUNC_REVERSE_SUBTRACTGL_MINGL_MAX description#>\n @return void\n */\nglBlendEquation(GLenum mode);\n\n/**\n \n\n @param modeRGB#>  description#>\n @param modeAlpha#> Alpha description#>\n @return void\n */\nglBlendEquationSeparate(GLenum modeRGB, GLenum modeAlpha);\n```\n\n# \n\nDitheringOpenGL ES 3.0\n`GL_DITHER``glEnable``glDisable`\n\n# \n\nAnti-aliasingOpenGL ES 3.0\nMultisamplingOpenGL\n/\n\n![](/img/article/20190816/3.png)\n\nSampler Point\n\n\n\n![](/img/article/20190816/4.png)\n\n\n\n4Subsampler\n\n![](/img/article/20190816/5.png)\n\n4\n\n> \n\n2MSAAMulti-Sampling Anti-Aliasing42\n\n\n\n![MSAA](/img/article/20190816/6.png)\n\n44\n\n\n\n![](/img/article/20190816/7.png)\n\n\n\n\n\n\n\n# \n\n`glReadPixels`\n\n``` objc\n/**\n \n\n @param xy#>  description#>\n @param widthheight#>  description#>\n @param format#> 3GL_RGBAGL_RGBA_INTEGERGL_IMPLEMENTATION_COLOR_READ_FORMAT description#>\n @param type#> 5GL_UNSIGNED_BYTEGL_UNSIGNED_INTGL_INTGL_FLOATGL_IMPLEMENTATION_COLOR_READ_TYPE description#>\n @param pixels#> glReadPixels description#>\n @return void\n */\nglReadPixels(GLint x, GLint y, GLsizei width, GLsizei height, GLenum format, GLenum type, GLvoid *pixels);\n```\n\n## \n\n`glBindBuffer``GL_PIXEL_PACK_BUFFER``glReadPixels`DMAPBO\nCPU`glReadPixels`CPUCPUDMAPBOCPUPBOPBO\n\n# \n\nMRTRGBAMRT\n\nMRT\n\n1. `glGenFramebuffers``glBindFramebuffer`FBO\n\n``` objc\nglGenFramebuffers(1, &fbo);\nglBindFramebuffer(GL_FRAMEBUFFER, fbo);\n```\n\n2. `glGenTextures``glBindTexture`\n\n``` objc\nglBindTexture(GL_TEXTURE_2D, textureId);\nglTexImage2D(GL_TEXTURE_2D, 0, GL_RGBA, textureWidth, textureHeight, 0, GL_RGBA, GL_UNSIGNED_BYTE, NULL);\n// Set the filtering mode\nglTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_NEAREST);\nglTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_NEAREST);\n```\n\n3. `glFramebufferTexture2D``glFramebufferTextureLayer`FBO\n\n``` objc\nglFramebufferTexture2D(GL_DRAW_FRAMEBUFFER, GL_COLOR_ATTACHMENT0, GL_TEXTURE_2D, textureId, 0);\n```\n\n4. `glDrawBuffers`\n\n``` objc\n/**\n \n\n @param n#> bufs description#>\n @param bufs#>  description#>\n @return void\n */\nglDrawBuffers(GLsizei n, const GLenum *bufs);\n\nconst GLenum attachments[4] = { GL_COLOR_ATTACHMENT0, GL_COLOR_ATTACHMENT1, GL_COLOR_ATTACHMENT2, GL_COLOR_ATTACHMENT3 };\nglDrawBuffers(4, attachments);\n```\n\n`GL_MAX_COLOR_ATTACHMENTS``glGetIntegerv`OpenGL 3.04.\n\n5. `fragData0 ~ fragData3`0 ~ 3\n\n``` objc\nlayout(location = 0) out vec4 fragData0;\nlayout(location = 1) out vec4 fragData1;\nlayout(location = 2) out vec4 fragData2;\nlayout(location = 3) out vec4 fragData3;\n```\n\n# \n\nOpenGL ES 3.0","source":"_posts/2019/opengl-es-fragment-operation-0816.md","raw":"---\ntitle: \"OpenGL ES--\"\ncatalog: true\ntoc_nav_num: true\ndate: 2019-08-16 17:30:01\nsubtitle: \"About OpenGL ES\"\nheader-img: \"/img/article_header/article_header.png\"\nbusuanzi: true\ntags:\n- iOS\n\n---\n\n> OpenGL ES 3.0\n> - \n> - \n> - \n> - \n> - \n> - \n>\n> \n> ![](/img/article/20190816/1.png)\n\n# \n\nOpenGL ES3\n- \n- \n- \n\n3Alpha1616RGB56RGBA32\nLCD\nEGLEGL3168\n\n## \n\nOpenGL ES`glClear`\n\n``` objc\n/**\n \n\n @param mask#> OpenGL ESGL_COLOR_BUFFER_BIT GL_DEPTH_BUFFER_BITGL_STENCIL_BUFFER_BIT description#>\n @return void\n */\nglClear(GLbitfield mask);\n```\n\n`glClear`\n\n\n``` objc\n/**\n \n\n @param redgreenbluealpha#> glClearGL_COLOR_BUFFER_BIT[0, 1] description#>\n @return void\n */\nglClearColor(GLclampf red, GLclampf green, GLclampf blue, GLclampf alpha);\n\n/**\n \n\n @param depth#> glClearGL_DEPTH_BUFFER_BIT[0, 1] description#>\n @return void\n */\nglClearDepthf(GLclampf depth);\n\n/**\n \n\n @param s#> glClearGL_DEPTH_BUFFER_BIT[0, 2^n-1]n description#>\n @return void\n */\nglClearStencil(GLint s);\n```\n\n\n\n``` objc\n/**\n \n\n @param buffer#> GL_COLORGL_FRONTGL_BACKGL_FRONT_AND_BACKGL_LEFTGL_RIGHTGL_DEPTHglClearBufferfvGL_STENCILglClearBufferiv description#>\n @param drawbuffer#> 0.GL_MAX_DRAW_BUFFERS description#>\n @param value#>  description#>\n @return void\n */\nglClearBufferiv(GLenum buffer, GLint drawbuffer, const GLint *value);\nglClearBufferuiv(GLenum buffer, GLint drawbuffer, const GLuint *value);\nglClearBufferfv(GLenum buffer, GLint drawbuffer, const GLfloat *value);\n```\n\n`glClearBufferfi`\n\n``` objc\n/**\n \n\n @param buffer#> GL_DEPTH_STENCIL description#>\n @param drawbuffer#> 0 description#>\n @param depth#>  description#>\n @param stencil#>  description#>\n @return void\n */\nglClearBufferfi(GLenum buffer, GLint drawbuffer, GLfloat depth, GLint stencil);\n```\n\n## \n\n\n`glColorMask``GL_FALSE`\n\n``` objc\n/**\n \n\n @param redgreenbluealpha#>  description#>\n @return void\n */\nglColorMask(GLboolean red, GLboolean green, GLboolean blue, GLboolean alpha);\n```\n\n`GL_TRUE``GL_FALSE``glDepthMask`\n`GL_TRUE``glDepthMask``GL_FALSE`\n\n``` objc\n/**\n \n\n @param flag#>  description#>\n @return void\n */\nglDepthMask(GLboolean flag);\n```\n\n`glStencilMask``glColorMask``glDepthMask`\n\n``` objc\n/**\n \n\n @param mask#> [0, 2^n-1]n0x000xFF description#>\n @return void\n */\nglStencilMask(GLuint mask);\n```\n\n`glStencilMaskSeparate`\n\n``` objc\n/**\n \n\n @param face#> GL_FRONTGL_BACKGL_FRONT_AND_BACK description#>\n @param mask#> [0, 2^n-1]n description#>\n @return void\n */\nglStencilMaskSeparate(GLenum face, GLuint mask);\n```\n\n# \n\nOpenGL ES\n`glEnable`\n\nglEnable | \n- | -\nGL_DEPTH_TEST | \nGL_STENCIL_TEST | \nGL_BLEND | \nGL_DITHER | \nGL_SAMPLE_COVERAGE | \nGL_SAMPLE_ALPHA_TO_COVERAGE | Alpha\n\n## \n\n`glScissor`\n\n``` objc\n/**\n \n\n @param xy#>  description#>\n @param width#>  description#>\n @param height#>  description#>\n @return void\n */\nglScissor(GLint x, GLint y, GLsizei width, GLsizei height);\n```\n\n`glEnable(GL_SCISSOR_TEST)`\n\n\n## \n\n\n\nC`glStencilFunc``glStencilSeparate`\n\n``` objc\n/**\n \n\n @param func#> GL_EQUALGL_NOTEQUALGL_LESSGL_GREATERGL_LEQUEALGL_GEQUALGL_ALWAYSGL_NEVER description#>\n @param ref#>  description#>\n @param mask#>  description#>\n @return void\n */\nglStencilFunc(GLenum func, GLint ref, GLuint mask);\n\n/**\n \n\n @param face#> GL_FRONTGL_BACKGL_FRONT_AND_BACK description#>\n @param func#> GL_EQUALGL_NOTEQUALGL_LESSGL_GREATERGL_LEQUEALGL_GEQUALGL_ALWAYSGL_NEVER description#>\n @param ref#>  description#>\n @param mask#>  description#>\n @return void\n */\nglStencilFuncSeparate(GLenum face, GLenum func, GLint ref, GLuint mask);\n```\n\n2\n\n``` objc\nglStencilFunc(GL_EQUAL, 2, 0x7);\n```\n\n0x7111\n\nOpenGL ES 3.03\n1. \n2. \n3. \n\n`glStencilOp``glStencilOpSeparte`\n\n | \n- | -\nGL_ZERO | 0\nGL_REPLACE | `glStencilFunc``glStencilFuncSeparate`\nGL_INCE, GL_DECR | 02<sup>n</sup>n\nGL_INCE_WRAP, GL_DECR_WRAP | 00\nGL_KEEP | \nGL_INVERT | \n\n``` objc\n/**\n \n\n @param fail#>  description#>\n @param zfail#>  description#>\n @param zpass#>  description#>\n @return void\n */\nglStencilOp(GLenum fail, GLenum zfail, GLenum zpass);\n\n/**\n \n\n @param face#> GL_FRONTGL_BACKGL_FRONT_AND_BACK description#>\n @param fail#>  description#>\n @param zfail#>  description#>\n @param zpass#>  description#>\n @return void\n */\nglStencilOpSeparate(GLenum face, GLenum fail, GLenum zfail, GLenum zpass);\n```\n\n### \n\n--`GL_DEPTH_TEST``glEnable`\n`glDepthFunc`\n\n``` objc\n/**\n \n\n @param func#> GL_LESSGL_GREATERGL_LEQUALGL_GEQUALGL_EQUALGL_NOTEQUALGL_ALWAYSGL_NEVER description#>\n @return void\n */\nglDepthFunc(GLenum func);\n```\n\n## \n\nC<sub>final</sub>=f<sub>source</sub>C<sub>source</sub>opf<sub>destination</sub>C<sub>destination</sub>\nf<sub>source</sub>C<sub>source</sub>f<sub>destination</sub>C<sub>destination</sub>op\n`glBlendFunc``glBlendFuncSeparate`\n\n``` objc\n/**\n \n\n @param sfactor#>  description#>\n @param dfactor#>  description#>\n @return void\n */\nglBlendFunc(GLenum sfactor, GLenum dfactor);\n\n/**\n \n\n @param srcRGB#>  description#>\n @param dstRGB#>  description#>\n @param srcAlpha#> Alpha description#>\n @param dstAlpha#> Alpha description#>\n @return void\n */\nglBlendFuncSeparate(GLenum srcRGB, GLenum dstRGB, GLenum srcAlpha, GLenum dstAlpha);\n```\n\n\n\n![](/img/article/20190816/2.png)\n\nC<sub>constant</sub>`glBlendColor`\n\n``` objc\n/**\n \n\n @param redgreenbluealpha#>  description#>\n @return void\n */\nglBlendColor(GLfloat red, GLfloat green, GLfloat blue, GLfloat alpha);\n```\n\n`glBlendEquation``glBlendEquationSeparate``GL_FUNC_ADD``GL_FUNC_SUBTRACT``GL_FUNC_REVERSE_SUBTRACT`\n\n```\n/**\n \n\n @param mode#> GL_FUNC_ADDGL_FUNC_SUBTRACTGL_FUNC_REVERSE_SUBTRACTGL_MINGL_MAX description#>\n @return void\n */\nglBlendEquation(GLenum mode);\n\n/**\n \n\n @param modeRGB#>  description#>\n @param modeAlpha#> Alpha description#>\n @return void\n */\nglBlendEquationSeparate(GLenum modeRGB, GLenum modeAlpha);\n```\n\n# \n\nDitheringOpenGL ES 3.0\n`GL_DITHER``glEnable``glDisable`\n\n# \n\nAnti-aliasingOpenGL ES 3.0\nMultisamplingOpenGL\n/\n\n![](/img/article/20190816/3.png)\n\nSampler Point\n\n\n\n![](/img/article/20190816/4.png)\n\n\n\n4Subsampler\n\n![](/img/article/20190816/5.png)\n\n4\n\n> \n\n2MSAAMulti-Sampling Anti-Aliasing42\n\n\n\n![MSAA](/img/article/20190816/6.png)\n\n44\n\n\n\n![](/img/article/20190816/7.png)\n\n\n\n\n\n\n\n# \n\n`glReadPixels`\n\n``` objc\n/**\n \n\n @param xy#>  description#>\n @param widthheight#>  description#>\n @param format#> 3GL_RGBAGL_RGBA_INTEGERGL_IMPLEMENTATION_COLOR_READ_FORMAT description#>\n @param type#> 5GL_UNSIGNED_BYTEGL_UNSIGNED_INTGL_INTGL_FLOATGL_IMPLEMENTATION_COLOR_READ_TYPE description#>\n @param pixels#> glReadPixels description#>\n @return void\n */\nglReadPixels(GLint x, GLint y, GLsizei width, GLsizei height, GLenum format, GLenum type, GLvoid *pixels);\n```\n\n## \n\n`glBindBuffer``GL_PIXEL_PACK_BUFFER``glReadPixels`DMAPBO\nCPU`glReadPixels`CPUCPUDMAPBOCPUPBOPBO\n\n# \n\nMRTRGBAMRT\n\nMRT\n\n1. `glGenFramebuffers``glBindFramebuffer`FBO\n\n``` objc\nglGenFramebuffers(1, &fbo);\nglBindFramebuffer(GL_FRAMEBUFFER, fbo);\n```\n\n2. `glGenTextures``glBindTexture`\n\n``` objc\nglBindTexture(GL_TEXTURE_2D, textureId);\nglTexImage2D(GL_TEXTURE_2D, 0, GL_RGBA, textureWidth, textureHeight, 0, GL_RGBA, GL_UNSIGNED_BYTE, NULL);\n// Set the filtering mode\nglTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_NEAREST);\nglTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_NEAREST);\n```\n\n3. `glFramebufferTexture2D``glFramebufferTextureLayer`FBO\n\n``` objc\nglFramebufferTexture2D(GL_DRAW_FRAMEBUFFER, GL_COLOR_ATTACHMENT0, GL_TEXTURE_2D, textureId, 0);\n```\n\n4. `glDrawBuffers`\n\n``` objc\n/**\n \n\n @param n#> bufs description#>\n @param bufs#>  description#>\n @return void\n */\nglDrawBuffers(GLsizei n, const GLenum *bufs);\n\nconst GLenum attachments[4] = { GL_COLOR_ATTACHMENT0, GL_COLOR_ATTACHMENT1, GL_COLOR_ATTACHMENT2, GL_COLOR_ATTACHMENT3 };\nglDrawBuffers(4, attachments);\n```\n\n`GL_MAX_COLOR_ATTACHMENTS``glGetIntegerv`OpenGL 3.04.\n\n5. `fragData0 ~ fragData3`0 ~ 3\n\n``` objc\nlayout(location = 0) out vec4 fragData0;\nlayout(location = 1) out vec4 fragData1;\nlayout(location = 2) out vec4 fragData2;\nlayout(location = 3) out vec4 fragData3;\n```\n\n# \n\nOpenGL ES 3.0","slug":"2019/opengl-es-fragment-operation-0816","published":1,"updated":"2021-06-21T12:34:52.093Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckszp3nd8000lifntgxke0csi","content":"<blockquote>\n<p>OpenGL ES 3.0</p>\n<ul>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n<p><br>\n<img src=\"/img/article/20190816/1.png\" alt=\"\"></p>\n</blockquote>\n<h1 id=\"\"></h1>\n<p>OpenGL ES3</p>\n<ul>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n<p>3Alpha1616RGB56RGBA32<br>\nLCD<br>\nEGLEGL3168</p>\n<h2 id=\"\"></h2>\n<p>OpenGL ES<code>glClear</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param mask#&gt; OpenGL ESGL_COLOR_BUFFER_BIT GL_DEPTH_BUFFER_BITGL_STENCIL_BUFFER_BIT description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glClear(GLbitfield mask);</span><br></pre></td></tr></table></figure>\n<p><code>glClear</code><br>\n</p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param redgreenbluealpha#&gt; glClearGL_COLOR_BUFFER_BIT[0, 1] description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glClearColor(GLclampf red, GLclampf green, GLclampf blue, GLclampf alpha);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param depth#&gt; glClearGL_DEPTH_BUFFER_BIT[0, 1] description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glClearDepthf(GLclampf depth);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param s#&gt; glClearGL_DEPTH_BUFFER_BIT[0, 2^n-1]n description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glClearStencil(GLint s);</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param buffer#&gt; GL_COLORGL_FRONTGL_BACKGL_FRONT_AND_BACKGL_LEFTGL_RIGHTGL_DEPTHglClearBufferfvGL_STENCILglClearBufferiv description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param drawbuffer#&gt; 0.GL_MAX_DRAW_BUFFERS description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param value#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glClearBufferiv(GLenum buffer, GLint drawbuffer, <span class=\"keyword\">const</span> GLint *value);</span><br><span class=\"line\">glClearBufferuiv(GLenum buffer, GLint drawbuffer, <span class=\"keyword\">const</span> GLuint *value);</span><br><span class=\"line\">glClearBufferfv(GLenum buffer, GLint drawbuffer, <span class=\"keyword\">const</span> GLfloat *value);</span><br></pre></td></tr></table></figure>\n<p><code>glClearBufferfi</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param buffer#&gt; GL_DEPTH_STENCIL description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param drawbuffer#&gt; 0 description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param depth#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param stencil#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glClearBufferfi(GLenum buffer, GLint drawbuffer, GLfloat depth, GLint stencil);</span><br></pre></td></tr></table></figure>\n<h2 id=\"\"></h2>\n<p><br>\n<code>glColorMask</code><code>GL_FALSE</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param redgreenbluealpha#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glColorMask(GLboolean red, GLboolean green, GLboolean blue, GLboolean alpha);</span><br></pre></td></tr></table></figure>\n<p><code>GL_TRUE</code><code>GL_FALSE</code><code>glDepthMask</code><br>\n<code>GL_TRUE</code><code>glDepthMask</code><code>GL_FALSE</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param flag#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glDepthMask(GLboolean flag);</span><br></pre></td></tr></table></figure>\n<p><code>glStencilMask</code><code>glColorMask</code><code>glDepthMask</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param mask#&gt; [0, 2^n-1]n0x000xFF description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glStencilMask(GLuint mask);</span><br></pre></td></tr></table></figure>\n<p><code>glStencilMaskSeparate</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param face#&gt; GL_FRONTGL_BACKGL_FRONT_AND_BACK description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param mask#&gt; [0, 2^n-1]n description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glStencilMaskSeparate(GLenum face, GLuint mask);</span><br></pre></td></tr></table></figure>\n<h1 id=\"\"></h1>\n<p>OpenGL ES<br>\n<code>glEnable</code></p>\n<table>\n<thead>\n<tr>\n<th>glEnable</th>\n<th></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>GL_DEPTH_TEST</td>\n<td></td>\n</tr>\n<tr>\n<td>GL_STENCIL_TEST</td>\n<td></td>\n</tr>\n<tr>\n<td>GL_BLEND</td>\n<td></td>\n</tr>\n<tr>\n<td>GL_DITHER</td>\n<td></td>\n</tr>\n<tr>\n<td>GL_SAMPLE_COVERAGE</td>\n<td></td>\n</tr>\n<tr>\n<td>GL_SAMPLE_ALPHA_TO_COVERAGE</td>\n<td>Alpha</td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"\"></h2>\n<p><code>glScissor</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param xy#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param width#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param height#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glScissor(GLint x, GLint y, GLsizei width, GLsizei height);</span><br></pre></td></tr></table></figure>\n<p><code>glEnable(GL_SCISSOR_TEST)</code><br>\n</p>\n<h2 id=\"\"></h2>\n<p><br>\n<br>\nC<code>glStencilFunc</code><code>glStencilSeparate</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param func#&gt; GL_EQUALGL_NOTEQUALGL_LESSGL_GREATERGL_LEQUEALGL_GEQUALGL_ALWAYSGL_NEVER description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param ref#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param mask#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glStencilFunc(GLenum func, GLint ref, GLuint mask);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param face#&gt; GL_FRONTGL_BACKGL_FRONT_AND_BACK description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param func#&gt; GL_EQUALGL_NOTEQUALGL_LESSGL_GREATERGL_LEQUEALGL_GEQUALGL_ALWAYSGL_NEVER description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param ref#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param mask#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glStencilFuncSeparate(GLenum face, GLenum func, GLint ref, GLuint mask);</span><br></pre></td></tr></table></figure>\n<p>2</p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">glStencilFunc(GL_EQUAL, <span class=\"number\">2</span>, <span class=\"number\">0x7</span>);</span><br></pre></td></tr></table></figure>\n<p>0x7111</p>\n<p>OpenGL ES 3.03</p>\n<ol>\n<li></li>\n<li></li>\n<li></li>\n</ol>\n<p><code>glStencilOp</code><code>glStencilOpSeparte</code></p>\n<table>\n<thead>\n<tr>\n<th></th>\n<th></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>GL_ZERO</td>\n<td>0</td>\n</tr>\n<tr>\n<td>GL_REPLACE</td>\n<td><code>glStencilFunc</code><code>glStencilFuncSeparate</code></td>\n</tr>\n<tr>\n<td>GL_INCE, GL_DECR</td>\n<td>02<sup>n</sup>n</td>\n</tr>\n<tr>\n<td>GL_INCE_WRAP, GL_DECR_WRAP</td>\n<td>00</td>\n</tr>\n<tr>\n<td>GL_KEEP</td>\n<td></td>\n</tr>\n<tr>\n<td>GL_INVERT</td>\n<td></td>\n</tr>\n</tbody>\n</table>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param fail#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param zfail#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param zpass#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glStencilOp(GLenum fail, GLenum zfail, GLenum zpass);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param face#&gt; GL_FRONTGL_BACKGL_FRONT_AND_BACK description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param fail#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param zfail#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param zpass#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glStencilOpSeparate(GLenum face, GLenum fail, GLenum zfail, GLenum zpass);</span><br></pre></td></tr></table></figure>\n<h3 id=\"\"></h3>\n<p><code>GL_DEPTH_TEST</code><code>glEnable</code><br>\n<code>glDepthFunc</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param func#&gt; GL_LESSGL_GREATERGL_LEQUALGL_GEQUALGL_EQUALGL_NOTEQUALGL_ALWAYSGL_NEVER description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glDepthFunc(GLenum func);</span><br></pre></td></tr></table></figure>\n<h2 id=\"\"></h2>\n<p>C<sub>final</sub>=f<sub>source</sub>C<sub>source</sub>opf<sub>destination</sub>C<sub>destination</sub><br>\nf<sub>source</sub>C<sub>source</sub>f<sub>destination</sub>C<sub>destination</sub>op<br>\n<code>glBlendFunc</code><code>glBlendFuncSeparate</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param sfactor#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param dfactor#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glBlendFunc(GLenum sfactor, GLenum dfactor);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param srcRGB#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param dstRGB#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param srcAlpha#&gt; Alpha description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param dstAlpha#&gt; Alpha description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glBlendFuncSeparate(GLenum srcRGB, GLenum dstRGB, GLenum srcAlpha, GLenum dstAlpha);</span><br></pre></td></tr></table></figure>\n<p></p>\n<p><img src=\"/img/article/20190816/2.png\" alt=\"\"></p>\n<p>C<sub>constant</sub><code>glBlendColor</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param redgreenbluealpha#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glBlendColor(GLfloat red, GLfloat green, GLfloat blue, GLfloat alpha);</span><br></pre></td></tr></table></figure>\n<p><code>glBlendEquation</code><code>glBlendEquationSeparate</code><code>GL_FUNC_ADD</code><code>GL_FUNC_SUBTRACT</code><code>GL_FUNC_REVERSE_SUBTRACT</code></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">/**</span><br><span class=\"line\"> </span><br><span class=\"line\"></span><br><span class=\"line\"> @param mode#&gt; GL_FUNC_ADDGL_FUNC_SUBTRACTGL_FUNC_REVERSE_SUBTRACTGL_MINGL_MAX description#&gt;</span><br><span class=\"line\"> @return void</span><br><span class=\"line\"> */</span><br><span class=\"line\">glBlendEquation(GLenum mode);</span><br><span class=\"line\"></span><br><span class=\"line\">/**</span><br><span class=\"line\"> </span><br><span class=\"line\"></span><br><span class=\"line\"> @param modeRGB#&gt;  description#&gt;</span><br><span class=\"line\"> @param modeAlpha#&gt; Alpha description#&gt;</span><br><span class=\"line\"> @return void</span><br><span class=\"line\"> */</span><br><span class=\"line\">glBlendEquationSeparate(GLenum modeRGB, GLenum modeAlpha);</span><br></pre></td></tr></table></figure>\n<h1 id=\"\"></h1>\n<p>DitheringOpenGL ES 3.0<br>\n<code>GL_DITHER</code><code>glEnable</code><code>glDisable</code></p>\n<h1 id=\"\"></h1>\n<p>Anti-aliasingOpenGL ES 3.0<br>\nMultisamplingOpenGL<br>\n/</p>\n<p><img src=\"/img/article/20190816/3.png\" alt=\"\"></p>\n<p>Sampler Point</p>\n<p></p>\n<p><img src=\"/img/article/20190816/4.png\" alt=\"\"></p>\n<p></p>\n<p>4Subsampler</p>\n<p><img src=\"/img/article/20190816/5.png\" alt=\"\"></p>\n<p>4</p>\n<blockquote>\n<p></p>\n</blockquote>\n<p>2MSAAMulti-Sampling Anti-Aliasing42</p>\n<p></p>\n<p><img src=\"/img/article/20190816/6.png\" alt=\"MSAA\"></p>\n<p>44</p>\n<p></p>\n<p><img src=\"/img/article/20190816/7.png\" alt=\"\"></p>\n<p></p>\n<p></p>\n<p></p>\n<h1 id=\"\"></h1>\n<p><code>glReadPixels</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param xy#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param widthheight#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param format#&gt; 3GL_RGBAGL_RGBA_INTEGERGL_IMPLEMENTATION_COLOR_READ_FORMAT description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param type#&gt; 5GL_UNSIGNED_BYTEGL_UNSIGNED_INTGL_INTGL_FLOATGL_IMPLEMENTATION_COLOR_READ_TYPE description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param pixels#&gt; glReadPixels description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glReadPixels(GLint x, GLint y, GLsizei width, GLsizei height, GLenum format, GLenum type, GLvoid *pixels);</span><br></pre></td></tr></table></figure>\n<h2 id=\"\"></h2>\n<p><code>glBindBuffer</code><code>GL_PIXEL_PACK_BUFFER</code><code>glReadPixels</code>DMAPBO<br>\nCPU<code>glReadPixels</code>CPUCPUDMAPBOCPUPBOPBO</p>\n<h1 id=\"\"></h1>\n<p>MRTRGBAMRT</p>\n<p>MRT</p>\n<ol>\n<li><code>glGenFramebuffers</code><code>glBindFramebuffer</code>FBO</li>\n</ol>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">glGenFramebuffers(<span class=\"number\">1</span>, &amp;fbo);</span><br><span class=\"line\">glBindFramebuffer(GL_FRAMEBUFFER, fbo);</span><br></pre></td></tr></table></figure>\n<ol start=\"2\">\n<li><code>glGenTextures</code><code>glBindTexture</code></li>\n</ol>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">glBindTexture(GL_TEXTURE_2D, textureId);</span><br><span class=\"line\">glTexImage2D(GL_TEXTURE_2D, <span class=\"number\">0</span>, GL_RGBA, textureWidth, textureHeight, <span class=\"number\">0</span>, GL_RGBA, GL_UNSIGNED_BYTE, <span class=\"literal\">NULL</span>);</span><br><span class=\"line\"><span class=\"comment\">// Set the filtering mode</span></span><br><span class=\"line\">glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_NEAREST);</span><br><span class=\"line\">glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_NEAREST);</span><br></pre></td></tr></table></figure>\n<ol start=\"3\">\n<li><code>glFramebufferTexture2D</code><code>glFramebufferTextureLayer</code>FBO</li>\n</ol>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">glFramebufferTexture2D(GL_DRAW_FRAMEBUFFER, GL_COLOR_ATTACHMENT0, GL_TEXTURE_2D, textureId, <span class=\"number\">0</span>);</span><br></pre></td></tr></table></figure>\n<ol start=\"4\">\n<li><code>glDrawBuffers</code></li>\n</ol>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param n#&gt; bufs description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param bufs#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glDrawBuffers(GLsizei n, <span class=\"keyword\">const</span> GLenum *bufs);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> GLenum attachments[<span class=\"number\">4</span>] = &#123; GL_COLOR_ATTACHMENT0, GL_COLOR_ATTACHMENT1, GL_COLOR_ATTACHMENT2, GL_COLOR_ATTACHMENT3 &#125;;</span><br><span class=\"line\">glDrawBuffers(<span class=\"number\">4</span>, attachments);</span><br></pre></td></tr></table></figure>\n<p><code>GL_MAX_COLOR_ATTACHMENTS</code><code>glGetIntegerv</code>OpenGL 3.04.</p>\n<ol start=\"5\">\n<li><code>fragData0 ~ fragData3</code>0 ~ 3</li>\n</ol>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">layout(location = <span class=\"number\">0</span>) <span class=\"keyword\">out</span> vec4 fragData0;</span><br><span class=\"line\">layout(location = <span class=\"number\">1</span>) <span class=\"keyword\">out</span> vec4 fragData1;</span><br><span class=\"line\">layout(location = <span class=\"number\">2</span>) <span class=\"keyword\">out</span> vec4 fragData2;</span><br><span class=\"line\">layout(location = <span class=\"number\">3</span>) <span class=\"keyword\">out</span> vec4 fragData3;</span><br></pre></td></tr></table></figure>\n<h1 id=\"\"></h1>\n<p>OpenGL ES 3.0</p>\n","site":{"data":{}},"excerpt":"","more":"<blockquote>\n<p>OpenGL ES 3.0</p>\n<ul>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n<p><br>\n<img src=\"/img/article/20190816/1.png\" alt=\"\"></p>\n</blockquote>\n<h1></h1>\n<p>OpenGL ES3</p>\n<ul>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n<p>3Alpha1616RGB56RGBA32<br>\nLCD<br>\nEGLEGL3168</p>\n<h2></h2>\n<p>OpenGL ES<code>glClear</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param mask#&gt; OpenGL ESGL_COLOR_BUFFER_BIT GL_DEPTH_BUFFER_BITGL_STENCIL_BUFFER_BIT description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glClear(GLbitfield mask);</span><br></pre></td></tr></table></figure>\n<p><code>glClear</code><br>\n</p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param redgreenbluealpha#&gt; glClearGL_COLOR_BUFFER_BIT[0, 1] description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glClearColor(GLclampf red, GLclampf green, GLclampf blue, GLclampf alpha);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param depth#&gt; glClearGL_DEPTH_BUFFER_BIT[0, 1] description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glClearDepthf(GLclampf depth);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param s#&gt; glClearGL_DEPTH_BUFFER_BIT[0, 2^n-1]n description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glClearStencil(GLint s);</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param buffer#&gt; GL_COLORGL_FRONTGL_BACKGL_FRONT_AND_BACKGL_LEFTGL_RIGHTGL_DEPTHglClearBufferfvGL_STENCILglClearBufferiv description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param drawbuffer#&gt; 0.GL_MAX_DRAW_BUFFERS description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param value#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glClearBufferiv(GLenum buffer, GLint drawbuffer, <span class=\"keyword\">const</span> GLint *value);</span><br><span class=\"line\">glClearBufferuiv(GLenum buffer, GLint drawbuffer, <span class=\"keyword\">const</span> GLuint *value);</span><br><span class=\"line\">glClearBufferfv(GLenum buffer, GLint drawbuffer, <span class=\"keyword\">const</span> GLfloat *value);</span><br></pre></td></tr></table></figure>\n<p><code>glClearBufferfi</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param buffer#&gt; GL_DEPTH_STENCIL description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param drawbuffer#&gt; 0 description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param depth#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param stencil#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glClearBufferfi(GLenum buffer, GLint drawbuffer, GLfloat depth, GLint stencil);</span><br></pre></td></tr></table></figure>\n<h2></h2>\n<p><br>\n<code>glColorMask</code><code>GL_FALSE</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param redgreenbluealpha#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glColorMask(GLboolean red, GLboolean green, GLboolean blue, GLboolean alpha);</span><br></pre></td></tr></table></figure>\n<p><code>GL_TRUE</code><code>GL_FALSE</code><code>glDepthMask</code><br>\n<code>GL_TRUE</code><code>glDepthMask</code><code>GL_FALSE</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param flag#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glDepthMask(GLboolean flag);</span><br></pre></td></tr></table></figure>\n<p><code>glStencilMask</code><code>glColorMask</code><code>glDepthMask</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param mask#&gt; [0, 2^n-1]n0x000xFF description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glStencilMask(GLuint mask);</span><br></pre></td></tr></table></figure>\n<p><code>glStencilMaskSeparate</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param face#&gt; GL_FRONTGL_BACKGL_FRONT_AND_BACK description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param mask#&gt; [0, 2^n-1]n description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glStencilMaskSeparate(GLenum face, GLuint mask);</span><br></pre></td></tr></table></figure>\n<h1></h1>\n<p>OpenGL ES<br>\n<code>glEnable</code></p>\n<table>\n<thead>\n<tr>\n<th>glEnable</th>\n<th></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>GL_DEPTH_TEST</td>\n<td></td>\n</tr>\n<tr>\n<td>GL_STENCIL_TEST</td>\n<td></td>\n</tr>\n<tr>\n<td>GL_BLEND</td>\n<td></td>\n</tr>\n<tr>\n<td>GL_DITHER</td>\n<td></td>\n</tr>\n<tr>\n<td>GL_SAMPLE_COVERAGE</td>\n<td></td>\n</tr>\n<tr>\n<td>GL_SAMPLE_ALPHA_TO_COVERAGE</td>\n<td>Alpha</td>\n</tr>\n</tbody>\n</table>\n<h2></h2>\n<p><code>glScissor</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param xy#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param width#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param height#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glScissor(GLint x, GLint y, GLsizei width, GLsizei height);</span><br></pre></td></tr></table></figure>\n<p><code>glEnable(GL_SCISSOR_TEST)</code><br>\n</p>\n<h2></h2>\n<p><br>\n<br>\nC<code>glStencilFunc</code><code>glStencilSeparate</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param func#&gt; GL_EQUALGL_NOTEQUALGL_LESSGL_GREATERGL_LEQUEALGL_GEQUALGL_ALWAYSGL_NEVER description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param ref#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param mask#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glStencilFunc(GLenum func, GLint ref, GLuint mask);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param face#&gt; GL_FRONTGL_BACKGL_FRONT_AND_BACK description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param func#&gt; GL_EQUALGL_NOTEQUALGL_LESSGL_GREATERGL_LEQUEALGL_GEQUALGL_ALWAYSGL_NEVER description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param ref#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param mask#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glStencilFuncSeparate(GLenum face, GLenum func, GLint ref, GLuint mask);</span><br></pre></td></tr></table></figure>\n<p>2</p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">glStencilFunc(GL_EQUAL, <span class=\"number\">2</span>, <span class=\"number\">0x7</span>);</span><br></pre></td></tr></table></figure>\n<p>0x7111</p>\n<p>OpenGL ES 3.03</p>\n<ol>\n<li></li>\n<li></li>\n<li></li>\n</ol>\n<p><code>glStencilOp</code><code>glStencilOpSeparte</code></p>\n<table>\n<thead>\n<tr>\n<th></th>\n<th></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>GL_ZERO</td>\n<td>0</td>\n</tr>\n<tr>\n<td>GL_REPLACE</td>\n<td><code>glStencilFunc</code><code>glStencilFuncSeparate</code></td>\n</tr>\n<tr>\n<td>GL_INCE, GL_DECR</td>\n<td>02<sup>n</sup>n</td>\n</tr>\n<tr>\n<td>GL_INCE_WRAP, GL_DECR_WRAP</td>\n<td>00</td>\n</tr>\n<tr>\n<td>GL_KEEP</td>\n<td></td>\n</tr>\n<tr>\n<td>GL_INVERT</td>\n<td></td>\n</tr>\n</tbody>\n</table>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param fail#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param zfail#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param zpass#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glStencilOp(GLenum fail, GLenum zfail, GLenum zpass);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param face#&gt; GL_FRONTGL_BACKGL_FRONT_AND_BACK description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param fail#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param zfail#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param zpass#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glStencilOpSeparate(GLenum face, GLenum fail, GLenum zfail, GLenum zpass);</span><br></pre></td></tr></table></figure>\n<h3></h3>\n<p><code>GL_DEPTH_TEST</code><code>glEnable</code><br>\n<code>glDepthFunc</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param func#&gt; GL_LESSGL_GREATERGL_LEQUALGL_GEQUALGL_EQUALGL_NOTEQUALGL_ALWAYSGL_NEVER description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glDepthFunc(GLenum func);</span><br></pre></td></tr></table></figure>\n<h2></h2>\n<p>C<sub>final</sub>=f<sub>source</sub>C<sub>source</sub>opf<sub>destination</sub>C<sub>destination</sub><br>\nf<sub>source</sub>C<sub>source</sub>f<sub>destination</sub>C<sub>destination</sub>op<br>\n<code>glBlendFunc</code><code>glBlendFuncSeparate</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param sfactor#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param dfactor#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glBlendFunc(GLenum sfactor, GLenum dfactor);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param srcRGB#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param dstRGB#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param srcAlpha#&gt; Alpha description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param dstAlpha#&gt; Alpha description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glBlendFuncSeparate(GLenum srcRGB, GLenum dstRGB, GLenum srcAlpha, GLenum dstAlpha);</span><br></pre></td></tr></table></figure>\n<p></p>\n<p><img src=\"/img/article/20190816/2.png\" alt=\"\"></p>\n<p>C<sub>constant</sub><code>glBlendColor</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param redgreenbluealpha#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glBlendColor(GLfloat red, GLfloat green, GLfloat blue, GLfloat alpha);</span><br></pre></td></tr></table></figure>\n<p><code>glBlendEquation</code><code>glBlendEquationSeparate</code><code>GL_FUNC_ADD</code><code>GL_FUNC_SUBTRACT</code><code>GL_FUNC_REVERSE_SUBTRACT</code></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">/**</span><br><span class=\"line\"> </span><br><span class=\"line\"></span><br><span class=\"line\"> @param mode#&gt; GL_FUNC_ADDGL_FUNC_SUBTRACTGL_FUNC_REVERSE_SUBTRACTGL_MINGL_MAX description#&gt;</span><br><span class=\"line\"> @return void</span><br><span class=\"line\"> */</span><br><span class=\"line\">glBlendEquation(GLenum mode);</span><br><span class=\"line\"></span><br><span class=\"line\">/**</span><br><span class=\"line\"> </span><br><span class=\"line\"></span><br><span class=\"line\"> @param modeRGB#&gt;  description#&gt;</span><br><span class=\"line\"> @param modeAlpha#&gt; Alpha description#&gt;</span><br><span class=\"line\"> @return void</span><br><span class=\"line\"> */</span><br><span class=\"line\">glBlendEquationSeparate(GLenum modeRGB, GLenum modeAlpha);</span><br></pre></td></tr></table></figure>\n<h1></h1>\n<p>DitheringOpenGL ES 3.0<br>\n<code>GL_DITHER</code><code>glEnable</code><code>glDisable</code></p>\n<h1></h1>\n<p>Anti-aliasingOpenGL ES 3.0<br>\nMultisamplingOpenGL<br>\n/</p>\n<p><img src=\"/img/article/20190816/3.png\" alt=\"\"></p>\n<p>Sampler Point</p>\n<p></p>\n<p><img src=\"/img/article/20190816/4.png\" alt=\"\"></p>\n<p></p>\n<p>4Subsampler</p>\n<p><img src=\"/img/article/20190816/5.png\" alt=\"\"></p>\n<p>4</p>\n<blockquote>\n<p></p>\n</blockquote>\n<p>2MSAAMulti-Sampling Anti-Aliasing42</p>\n<p></p>\n<p><img src=\"/img/article/20190816/6.png\" alt=\"MSAA\"></p>\n<p>44</p>\n<p></p>\n<p><img src=\"/img/article/20190816/7.png\" alt=\"\"></p>\n<p></p>\n<p></p>\n<p></p>\n<h1></h1>\n<p><code>glReadPixels</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param xy#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param widthheight#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param format#&gt; 3GL_RGBAGL_RGBA_INTEGERGL_IMPLEMENTATION_COLOR_READ_FORMAT description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param type#&gt; 5GL_UNSIGNED_BYTEGL_UNSIGNED_INTGL_INTGL_FLOATGL_IMPLEMENTATION_COLOR_READ_TYPE description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param pixels#&gt; glReadPixels description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glReadPixels(GLint x, GLint y, GLsizei width, GLsizei height, GLenum format, GLenum type, GLvoid *pixels);</span><br></pre></td></tr></table></figure>\n<h2></h2>\n<p><code>glBindBuffer</code><code>GL_PIXEL_PACK_BUFFER</code><code>glReadPixels</code>DMAPBO<br>\nCPU<code>glReadPixels</code>CPUCPUDMAPBOCPUPBOPBO</p>\n<h1></h1>\n<p>MRTRGBAMRT</p>\n<p>MRT</p>\n<ol>\n<li><code>glGenFramebuffers</code><code>glBindFramebuffer</code>FBO</li>\n</ol>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">glGenFramebuffers(<span class=\"number\">1</span>, &amp;fbo);</span><br><span class=\"line\">glBindFramebuffer(GL_FRAMEBUFFER, fbo);</span><br></pre></td></tr></table></figure>\n<ol start=\"2\">\n<li><code>glGenTextures</code><code>glBindTexture</code></li>\n</ol>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">glBindTexture(GL_TEXTURE_2D, textureId);</span><br><span class=\"line\">glTexImage2D(GL_TEXTURE_2D, <span class=\"number\">0</span>, GL_RGBA, textureWidth, textureHeight, <span class=\"number\">0</span>, GL_RGBA, GL_UNSIGNED_BYTE, <span class=\"literal\">NULL</span>);</span><br><span class=\"line\"><span class=\"comment\">// Set the filtering mode</span></span><br><span class=\"line\">glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_NEAREST);</span><br><span class=\"line\">glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_NEAREST);</span><br></pre></td></tr></table></figure>\n<ol start=\"3\">\n<li><code>glFramebufferTexture2D</code><code>glFramebufferTextureLayer</code>FBO</li>\n</ol>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">glFramebufferTexture2D(GL_DRAW_FRAMEBUFFER, GL_COLOR_ATTACHMENT0, GL_TEXTURE_2D, textureId, <span class=\"number\">0</span>);</span><br></pre></td></tr></table></figure>\n<ol start=\"4\">\n<li><code>glDrawBuffers</code></li>\n</ol>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param n#&gt; bufs description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param bufs#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glDrawBuffers(GLsizei n, <span class=\"keyword\">const</span> GLenum *bufs);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> GLenum attachments[<span class=\"number\">4</span>] = &#123; GL_COLOR_ATTACHMENT0, GL_COLOR_ATTACHMENT1, GL_COLOR_ATTACHMENT2, GL_COLOR_ATTACHMENT3 &#125;;</span><br><span class=\"line\">glDrawBuffers(<span class=\"number\">4</span>, attachments);</span><br></pre></td></tr></table></figure>\n<p><code>GL_MAX_COLOR_ATTACHMENTS</code><code>glGetIntegerv</code>OpenGL 3.04.</p>\n<ol start=\"5\">\n<li><code>fragData0 ~ fragData3</code>0 ~ 3</li>\n</ol>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">layout(location = <span class=\"number\">0</span>) <span class=\"keyword\">out</span> vec4 fragData0;</span><br><span class=\"line\">layout(location = <span class=\"number\">1</span>) <span class=\"keyword\">out</span> vec4 fragData1;</span><br><span class=\"line\">layout(location = <span class=\"number\">2</span>) <span class=\"keyword\">out</span> vec4 fragData2;</span><br><span class=\"line\">layout(location = <span class=\"number\">3</span>) <span class=\"keyword\">out</span> vec4 fragData3;</span><br></pre></td></tr></table></figure>\n<h1></h1>\n<p>OpenGL ES 3.0</p>\n"},{"title":"OpenGL ES--","catalog":true,"toc_nav_num":true,"date":"2019-08-19T12:03:12.000Z","subtitle":"About OpenGL ES","header-img":"/img/article_header/article_header.png","busuanzi":true,"_content":"\n> \n\n# \n\nOpenGL ESEGLAPIpbufferEGL\nOpenGL ES\n\n- `glCopyTexImage2D``glCopyTexSubImage2D`APIAPI\n- pbufferpbufferOpenGL ESCPUpbuffer\n\nAPIOpenGL ES API\nAPI\n- OpenGL ES\n- EGL--\n- \n- \n- \n- \n\n# \n\n2D--pbufferGL\nFBO2D2Dmip2D3D2Dmip2DFBO2DmipFBO2D\n\n\n![](/img/article/20190819/1.png)\n\n## \n\n\n\n- \n- OpenGL ESOpenGL ES\n\n## EGL\n\nFBO\n- (x<sub>w</sub>), y<sub>w</sub>)OpenGL ESOpenGL ES--OpenGL ES\n- \n- \n\n# \n\nOpenGL ES 3.0\n`glGenRenderbuffers`API\n\n``` objc\n/**\n \n\n @param n#>  description#>\n @param renderbuffers#> n description#>\n @return void\n */\nglGenRenderbuffers(GLsizei n, GLuint *renderbuffers);\n```\n\n`glGenRenderbuffers`n`renderbuffers``glGenRenderbuffers`0``0OpenGL ES0\n`glGenFramebuffers`API\n\n``` objc\n/**\n \n\n @param n#>  description#>\n @param framebuffers#> n description#>\n @return void\n */\nglGenFramebuffers(GLsizei n, GLuint *framebuffers);\n```\n\n`glGenFramebuffers`n`framebuffers``glGenFramebuffers`00OpenGL ES0\n\n# \n\n`glBindRenderbuffer`\n\n``` objc\n/**\n \n\n @param target#> GL_RENDERBUFFER description#>\n @param renderbuffer#>  description#>\n @return void\n */\nglBindRenderbuffer(GLenum target, GLuint renderbuffer);\n```\n\n`glGenRenderbuffers``glBindRenderbuffer``glGenRenderbuffers``glBindRenderbuffer`OpenGL ES`glGenRenderbuffers``glGenRenderbuffers`\n`glBindRenderbuffer`\n- --0\n- --\n- --0\n- --0\n- --0\n\n`glBindRenderbuffer`\n`glRenderbufferStorage`\n`glRenderbufferStorage``glTexImage2D``glRenderbufferStorageMultisample``glRenderbufferStorage`0`glRenderStorageMultisample`OpenGL ESOpenGL ES1\n\n``` objc\nGLint maxRenderbufferSize = 0;\nglGetIntegerv(GL_MAX_RENDERBUFFER_SIZE, &maxRenderbufferSize);\n```\n\n``` objc\n/**\n \n\n @param target#> GL_RENDERBUFFER description#>\n @param internalformat#>  description#>\n @param width#> GL_MAX_RENDERBUFFER_SIZE description#>\n @param height#> GL_MAX_RENDERBUFFER_SIZE description#>\n @return void\n */\nglRenderbufferStorage(GLenum target, GLenum internalformat, GLsizei width, GLsizei height);\n\n/**\n \n\n @param target#> GL_RENDERBUFFER description#>\n @param samples#> GL_MAX_SAMPLES description#>\n @param internalformat#>  description#>\n @param width#> GL_MAX_RENDERBUFFER_SIZE description#>\n @param height#> GL_MAX_RENDERBUFFER_SIZE description#>\n @return void\n */\nglRenderbufferStorageMultisample(GLenum target, GLsizei samples, GLenum internalformat, GLsizei width, GLsizei height);\n```\n\n\n\n## \n\n[](#)\n\n# \n\n`glBindFramebuffer`\n\n``` objc\n/**\n \n\n @param target#> GL_READ_FRAMEBUFFERGL_DRAW_FRAMEBUFFERGL_FRAMEBUFFER description#>\n @param framebuffer#>  description#>\n @return void\n */\nglBindFramebuffer(GLenum target, GLuint framebuffer);\n```\n\n`glBindFramebuffer``glGenFramebuffers``glBindFramebuffer`OpenGL ES`glGenFramebuffers``glGenFramebuffers`\nOpenGL ES 3.0`glBindFramebuffer`\n\n- --\n- --\n- --\n- --\n\n- --`GL_RENDERBUFFER``GL_TEXTURE``GL_NONE`\n- --0\n- --mip0\n- --6`GL_TEXTURE_CUBE_MAP_POSITIVE_X`\n- --3D2D0\n`glBindFramebuffer`\n2Dmip2D3D2Dmip2Dmip\n\n## \n\n`glFramebufferRenderbuffer`\n\n``` objc\n/**\n \n\n @param target#> GL_READ_FRAMEBUFFERGL_DRAW_FRAMEBUFFERGL_FRAMEBUFFER description#>\n @param attachment#> GL_COLOR_ATTACHMENTiGL_DEPTH_ATTACHMENTGL_STENCIL_ATTACHMENTGL_DEPTH_STENCIL_ATTACHMENT description#>\n @param renderbuffertarget#> GL_RENDERBUFFER description#>\n @param renderbuffer#> 0 description#>\n @return void\n */\nglFramebufferRenderbuffer(GLenum target, GLenum attachment, GLenum renderbuffertarget, GLuint renderbuffer);\n```\n\n`glFramebufferRenderbuffer``renderbuffer`0`attachment`\n\n-  = GL_RENDERBUFFER\n-  = renderbuffer\n-  = 0\n-  = GL_NONE\n\n\n`glFramebufferRenderbuffer``renderbuffer`0`attachment`0\n\n## 2D\n\n`glFramebufferTexture2D`2Dmip\n\n``` objc\n/**\n 2Dmip\n\n @param target#> GL_READ_FRAMEBUFFERGL_DRAW_FRAMEBUFFERGL_FRAMEBUFFER description#>\n @param attachment#> GL_COLOR_ATTACHMENTiGL_DEPTH_ATTACHMENTGL_STENCIL_ATTACHMENTGL_DEPTH_STENCIL_ATTACHMENT description#>\n @param textarget#> glTexImage2Dtarget description#>\n @param texture#>  description#>\n @param level#> mip description#>\n @return void\n */\nglFramebufferTexture2D(GLenum target, GLenum attachment, GLenum textarget, GLuint texture, GLint level);\n```\n\n`glFramebufferTexture2D``texture`0`texture``glFramebufferTexture2D`\n\n-  = GL_TEXTURE\n-  = texture\n-  = level\n-  GL_TEXTURE_CUBE_MAP_POSITIVE_(X | Y | Z)GL_TEXTURE_CUBE_MAP_NEGATIVE_(X | Y | Z)\n-  = 0\n`glFramebufferTexture2D`\n`glFramebufferTexture2D``texture`00\n\n## 3D\n\n`glFramebufferTextureLayer`3D2Dmip2D\n\n``` objc\n/**\n 3D2Dmip2D\n\n @param target#> GL_READ_FRAMEBUFFERGL_DRAW_FRAMEBUFFERGL_FRAMEBUFFER description#>\n @param attachment#> GL_COLOR_ATTACHMENTiGL_DEPTH_ATTACHMENTGL_STENCIL_ATTACHMENTGL_DEPTH_STENCIL_ATTACHMENT description#>\n @param texture#>  description#>\n @param level#> mip description#>\n @param layer#> textureGL_TEXTURE_CUBE_MAP_3Dlevel0GL_MAX3D_TEXTURE_SIZE2textureGL_TEXTURE_2D_ARRAYlevel0GL_MAX_TEXTURE_SIZE2 description#>\n @return void\n */\nglFramebufferTextureLayer(GLenum target, GLenum attachment, GLuint texture, GLint level, GLint layer);\n```\n\n`glFramebufferTextureLayer`\n\n-  = GL_TEXTURE\n-  = texture\n-  = level\n-  = GL_NONE\n-  = 0\n`glFramebufferTextureLayer``texture`00\n\n## \n\nOpenGL ES\n\n- \n- \n- \n- `GL_RENDERBUFFER_SAMPLES``GL_RENDERBUFFER_SAMPLES`0\n\n`glCheckFramebufferStatus`\n\n``` objc\n/**\n \n\n @param target#> GL_READ_FRAMEBUFFERGL_DRAW_FRMAEBUFFERGL_FRAMEBUFFER description#>\n @return void\n */\nglCheckFramebufferStatus(GLenum target);\n```\n\n`target``GL_FRAMEBUFFER``glCheckFramebufferStatus`0`target``GL_FRAMEBUFFER`\n- GL_FRAMEBUFFER_COMPLETE -- \n- GL_FRAMEBUFFER_UNDEFINED -- `target`\n- GL_FRAMEBUFFER_INCOMPLETE_ATTACHMENT -- 0\n- GL_FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT -- \n- GL_FRAMEBUFFER_UNSUPPORTED -- \n- GL_FRAMEBUFFER_INCOMPLETE_MULTISAMPLE -- GL_RENDERBUFFER_SAMPLESGL_RENDERBUFFER_SAMPLES0\n\n`glDrawArrays``glDrawElements``glReadPixels``glCopyTeximage2D``glCopyTexSubimage2D``glCopyTexSubimage3D``GL_INVALID_FRAMEBUFFER_OPERATION`\n\n# \n\nBlit\n\n\n``` objc\n/**\n \n\n @param srcX0srcY0srcX1srcY1#>  description#>\n @param dstX0dstY0dstX1dstY1#>  description#>\n @param mask#> GL_COLOR_BUFFER_BITGL_DEPTH_BUFFER_BITGL_STENCIL_BUFFER_BITGL_DEPTH_STENCIL_ATTACHMENT description#>\n @param filter#> GL_NEARESTGL_LINEAR description#>\n @return void\n */\nglBlitFramebuffer(GLint srcX0, GLint srcY0, GLint srcX1, GLint srcY1, GLint dstX0, GLint dstY0, GLint dstX1, GLint dstY1, GLbitfield mask, GLenum filter);\n```\n\n\n\n``` objc\n// set the default framebuffer for writing\nglBindFramebuffer(GL_DRAW_FRAMEBUFFER, defaultFramebuffer);\n// set the fbo with color attachments for reading\nglBindFramebuffer(GL_READ_FRAMEBUFFER, fbo);\n// copy the output buffer to target\nglReadBuffer(GL_COLOR_ATTACHMENT0);\nglBlitFramebuffer(0, 0, width, height, 0, 0, width/2, height, GL_COLOR_BUFFER_BIT, GL_LINEAR);\nglReadBuffer(GL_COLOR_ATTACHMENT1);\nglBlitFramebuffer(0, 0, width, height, width/2, 0, width/2, height, GL_COLOR_BUFFER_BIT, GL_LINEAR);\n```\n\n# \n\n1TBR2CPUGPU3\nTBR GPUGPUTBR GPUGPU--GPU\nGPUGPUGPU\n`glInvalidateFramebuffer``glInvalidateSubFramebuffer`\n\n``` objc\n/**\n \n\n @param target#> GL_READ_FRAMEBUFFERGL_DRAW_FRAMEBUFFERGL_FRAMEBUFFER description#>\n @param numAttachments#> attachments description#>\n @param attachments#> numAttachments description#>\n @return void\n */\nglInvalidateFramebuffer(GLenum target, GLsizei numAttachments, const GLenum *attachments);\n\n/**\n \n\n @param target#> GL_READ_FRAMEBUFFERGL_DRAW_FRAMEBUFFERGL_FRAMEBUFFER description#>\n @param numAttachments#> attachments description#>\n @param attachments#> numAttachments description#>\n @param xy#> 00 description#>\n @param width#>  description#>\n @param height#>  description#>\n @return void\n */\nglInvalidateSubFramebuffer(GLenum target, GLsizei numAttachments, const GLenum *attachments, GLint x, GLint y, GLsizei width, GLsizei height);\n```\n\n# \n\n\n`glDeleteRenderbuffers`API\n\n``` objc\n/**\n \n\n @param n#>  description#>\n @param renderbuffers#> nx description#>\n @return void\n */\nglDeleteRenderbuffers(GLsizei n, const GLuint *renderbuffers);\n```\n\n`glDeleteRenderbuffers``renderbuffers`0`renderbuffers`0\n`glDeleteFramebuffers`API\n\n``` objc\n/**\n \n\n @param n#>  description#>\n @param framebuffers#> n description#>\n @return void\n */\nglDeleteFramebuffers(GLsizei n, const GLuint *framebuffers);\n```\n\n`glDeleteFramebuffers``framebuffers`0`framebuffers`0\n\n# \n\n`glDeleteRenderbuffers`0`glDeleteRenderbuffers`0\n\n## \n\n`glReadPixels``glBindBuffer``GL_PIXEL_PACK_BUFFER``glReadPixels`DMA\n`glReadPixels``format``type``format``GL_RGBA``GL_RGBA_INTEGER``GL_IMPLEMENTATION_COLOR_READ_FORMAT``type``GL_UNSIGNED_BYTE``GL_UNSIGNED_INT``GL_INT``GL_FLOAT``GL_IMPLEMENTATION_COLOR_READ_TYPE``glReadPixels`\n\n# \n\n\n- OpenGL ES 3.0`eglSwapBuffers`\n- \n- `glTexImage2D``glTexSubImage2D``glCopyTexImage2D`\n- `glTexImage2D``glTexImage3D``pixel``NULL``glInvalidateFramebuffer`\n- \n\n# \n\n","source":"_posts/2019/opengl-es-framebuffer-0819.md","raw":"---\ntitle: \"OpenGL ES--\"\ncatalog: true\ntoc_nav_num: true\ndate: 2019-08-19 20:03:12\nsubtitle: \"About OpenGL ES\"\nheader-img: \"/img/article_header/article_header.png\"\nbusuanzi: true\ntags:\n- iOS\n\n---\n\n> \n\n# \n\nOpenGL ESEGLAPIpbufferEGL\nOpenGL ES\n\n- `glCopyTexImage2D``glCopyTexSubImage2D`APIAPI\n- pbufferpbufferOpenGL ESCPUpbuffer\n\nAPIOpenGL ES API\nAPI\n- OpenGL ES\n- EGL--\n- \n- \n- \n- \n\n# \n\n2D--pbufferGL\nFBO2D2Dmip2D3D2Dmip2DFBO2DmipFBO2D\n\n\n![](/img/article/20190819/1.png)\n\n## \n\n\n\n- \n- OpenGL ESOpenGL ES\n\n## EGL\n\nFBO\n- (x<sub>w</sub>), y<sub>w</sub>)OpenGL ESOpenGL ES--OpenGL ES\n- \n- \n\n# \n\nOpenGL ES 3.0\n`glGenRenderbuffers`API\n\n``` objc\n/**\n \n\n @param n#>  description#>\n @param renderbuffers#> n description#>\n @return void\n */\nglGenRenderbuffers(GLsizei n, GLuint *renderbuffers);\n```\n\n`glGenRenderbuffers`n`renderbuffers``glGenRenderbuffers`0``0OpenGL ES0\n`glGenFramebuffers`API\n\n``` objc\n/**\n \n\n @param n#>  description#>\n @param framebuffers#> n description#>\n @return void\n */\nglGenFramebuffers(GLsizei n, GLuint *framebuffers);\n```\n\n`glGenFramebuffers`n`framebuffers``glGenFramebuffers`00OpenGL ES0\n\n# \n\n`glBindRenderbuffer`\n\n``` objc\n/**\n \n\n @param target#> GL_RENDERBUFFER description#>\n @param renderbuffer#>  description#>\n @return void\n */\nglBindRenderbuffer(GLenum target, GLuint renderbuffer);\n```\n\n`glGenRenderbuffers``glBindRenderbuffer``glGenRenderbuffers``glBindRenderbuffer`OpenGL ES`glGenRenderbuffers``glGenRenderbuffers`\n`glBindRenderbuffer`\n- --0\n- --\n- --0\n- --0\n- --0\n\n`glBindRenderbuffer`\n`glRenderbufferStorage`\n`glRenderbufferStorage``glTexImage2D``glRenderbufferStorageMultisample``glRenderbufferStorage`0`glRenderStorageMultisample`OpenGL ESOpenGL ES1\n\n``` objc\nGLint maxRenderbufferSize = 0;\nglGetIntegerv(GL_MAX_RENDERBUFFER_SIZE, &maxRenderbufferSize);\n```\n\n``` objc\n/**\n \n\n @param target#> GL_RENDERBUFFER description#>\n @param internalformat#>  description#>\n @param width#> GL_MAX_RENDERBUFFER_SIZE description#>\n @param height#> GL_MAX_RENDERBUFFER_SIZE description#>\n @return void\n */\nglRenderbufferStorage(GLenum target, GLenum internalformat, GLsizei width, GLsizei height);\n\n/**\n \n\n @param target#> GL_RENDERBUFFER description#>\n @param samples#> GL_MAX_SAMPLES description#>\n @param internalformat#>  description#>\n @param width#> GL_MAX_RENDERBUFFER_SIZE description#>\n @param height#> GL_MAX_RENDERBUFFER_SIZE description#>\n @return void\n */\nglRenderbufferStorageMultisample(GLenum target, GLsizei samples, GLenum internalformat, GLsizei width, GLsizei height);\n```\n\n\n\n## \n\n[](#)\n\n# \n\n`glBindFramebuffer`\n\n``` objc\n/**\n \n\n @param target#> GL_READ_FRAMEBUFFERGL_DRAW_FRAMEBUFFERGL_FRAMEBUFFER description#>\n @param framebuffer#>  description#>\n @return void\n */\nglBindFramebuffer(GLenum target, GLuint framebuffer);\n```\n\n`glBindFramebuffer``glGenFramebuffers``glBindFramebuffer`OpenGL ES`glGenFramebuffers``glGenFramebuffers`\nOpenGL ES 3.0`glBindFramebuffer`\n\n- --\n- --\n- --\n- --\n\n- --`GL_RENDERBUFFER``GL_TEXTURE``GL_NONE`\n- --0\n- --mip0\n- --6`GL_TEXTURE_CUBE_MAP_POSITIVE_X`\n- --3D2D0\n`glBindFramebuffer`\n2Dmip2D3D2Dmip2Dmip\n\n## \n\n`glFramebufferRenderbuffer`\n\n``` objc\n/**\n \n\n @param target#> GL_READ_FRAMEBUFFERGL_DRAW_FRAMEBUFFERGL_FRAMEBUFFER description#>\n @param attachment#> GL_COLOR_ATTACHMENTiGL_DEPTH_ATTACHMENTGL_STENCIL_ATTACHMENTGL_DEPTH_STENCIL_ATTACHMENT description#>\n @param renderbuffertarget#> GL_RENDERBUFFER description#>\n @param renderbuffer#> 0 description#>\n @return void\n */\nglFramebufferRenderbuffer(GLenum target, GLenum attachment, GLenum renderbuffertarget, GLuint renderbuffer);\n```\n\n`glFramebufferRenderbuffer``renderbuffer`0`attachment`\n\n-  = GL_RENDERBUFFER\n-  = renderbuffer\n-  = 0\n-  = GL_NONE\n\n\n`glFramebufferRenderbuffer``renderbuffer`0`attachment`0\n\n## 2D\n\n`glFramebufferTexture2D`2Dmip\n\n``` objc\n/**\n 2Dmip\n\n @param target#> GL_READ_FRAMEBUFFERGL_DRAW_FRAMEBUFFERGL_FRAMEBUFFER description#>\n @param attachment#> GL_COLOR_ATTACHMENTiGL_DEPTH_ATTACHMENTGL_STENCIL_ATTACHMENTGL_DEPTH_STENCIL_ATTACHMENT description#>\n @param textarget#> glTexImage2Dtarget description#>\n @param texture#>  description#>\n @param level#> mip description#>\n @return void\n */\nglFramebufferTexture2D(GLenum target, GLenum attachment, GLenum textarget, GLuint texture, GLint level);\n```\n\n`glFramebufferTexture2D``texture`0`texture``glFramebufferTexture2D`\n\n-  = GL_TEXTURE\n-  = texture\n-  = level\n-  GL_TEXTURE_CUBE_MAP_POSITIVE_(X | Y | Z)GL_TEXTURE_CUBE_MAP_NEGATIVE_(X | Y | Z)\n-  = 0\n`glFramebufferTexture2D`\n`glFramebufferTexture2D``texture`00\n\n## 3D\n\n`glFramebufferTextureLayer`3D2Dmip2D\n\n``` objc\n/**\n 3D2Dmip2D\n\n @param target#> GL_READ_FRAMEBUFFERGL_DRAW_FRAMEBUFFERGL_FRAMEBUFFER description#>\n @param attachment#> GL_COLOR_ATTACHMENTiGL_DEPTH_ATTACHMENTGL_STENCIL_ATTACHMENTGL_DEPTH_STENCIL_ATTACHMENT description#>\n @param texture#>  description#>\n @param level#> mip description#>\n @param layer#> textureGL_TEXTURE_CUBE_MAP_3Dlevel0GL_MAX3D_TEXTURE_SIZE2textureGL_TEXTURE_2D_ARRAYlevel0GL_MAX_TEXTURE_SIZE2 description#>\n @return void\n */\nglFramebufferTextureLayer(GLenum target, GLenum attachment, GLuint texture, GLint level, GLint layer);\n```\n\n`glFramebufferTextureLayer`\n\n-  = GL_TEXTURE\n-  = texture\n-  = level\n-  = GL_NONE\n-  = 0\n`glFramebufferTextureLayer``texture`00\n\n## \n\nOpenGL ES\n\n- \n- \n- \n- `GL_RENDERBUFFER_SAMPLES``GL_RENDERBUFFER_SAMPLES`0\n\n`glCheckFramebufferStatus`\n\n``` objc\n/**\n \n\n @param target#> GL_READ_FRAMEBUFFERGL_DRAW_FRMAEBUFFERGL_FRAMEBUFFER description#>\n @return void\n */\nglCheckFramebufferStatus(GLenum target);\n```\n\n`target``GL_FRAMEBUFFER``glCheckFramebufferStatus`0`target``GL_FRAMEBUFFER`\n- GL_FRAMEBUFFER_COMPLETE -- \n- GL_FRAMEBUFFER_UNDEFINED -- `target`\n- GL_FRAMEBUFFER_INCOMPLETE_ATTACHMENT -- 0\n- GL_FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT -- \n- GL_FRAMEBUFFER_UNSUPPORTED -- \n- GL_FRAMEBUFFER_INCOMPLETE_MULTISAMPLE -- GL_RENDERBUFFER_SAMPLESGL_RENDERBUFFER_SAMPLES0\n\n`glDrawArrays``glDrawElements``glReadPixels``glCopyTeximage2D``glCopyTexSubimage2D``glCopyTexSubimage3D``GL_INVALID_FRAMEBUFFER_OPERATION`\n\n# \n\nBlit\n\n\n``` objc\n/**\n \n\n @param srcX0srcY0srcX1srcY1#>  description#>\n @param dstX0dstY0dstX1dstY1#>  description#>\n @param mask#> GL_COLOR_BUFFER_BITGL_DEPTH_BUFFER_BITGL_STENCIL_BUFFER_BITGL_DEPTH_STENCIL_ATTACHMENT description#>\n @param filter#> GL_NEARESTGL_LINEAR description#>\n @return void\n */\nglBlitFramebuffer(GLint srcX0, GLint srcY0, GLint srcX1, GLint srcY1, GLint dstX0, GLint dstY0, GLint dstX1, GLint dstY1, GLbitfield mask, GLenum filter);\n```\n\n\n\n``` objc\n// set the default framebuffer for writing\nglBindFramebuffer(GL_DRAW_FRAMEBUFFER, defaultFramebuffer);\n// set the fbo with color attachments for reading\nglBindFramebuffer(GL_READ_FRAMEBUFFER, fbo);\n// copy the output buffer to target\nglReadBuffer(GL_COLOR_ATTACHMENT0);\nglBlitFramebuffer(0, 0, width, height, 0, 0, width/2, height, GL_COLOR_BUFFER_BIT, GL_LINEAR);\nglReadBuffer(GL_COLOR_ATTACHMENT1);\nglBlitFramebuffer(0, 0, width, height, width/2, 0, width/2, height, GL_COLOR_BUFFER_BIT, GL_LINEAR);\n```\n\n# \n\n1TBR2CPUGPU3\nTBR GPUGPUTBR GPUGPU--GPU\nGPUGPUGPU\n`glInvalidateFramebuffer``glInvalidateSubFramebuffer`\n\n``` objc\n/**\n \n\n @param target#> GL_READ_FRAMEBUFFERGL_DRAW_FRAMEBUFFERGL_FRAMEBUFFER description#>\n @param numAttachments#> attachments description#>\n @param attachments#> numAttachments description#>\n @return void\n */\nglInvalidateFramebuffer(GLenum target, GLsizei numAttachments, const GLenum *attachments);\n\n/**\n \n\n @param target#> GL_READ_FRAMEBUFFERGL_DRAW_FRAMEBUFFERGL_FRAMEBUFFER description#>\n @param numAttachments#> attachments description#>\n @param attachments#> numAttachments description#>\n @param xy#> 00 description#>\n @param width#>  description#>\n @param height#>  description#>\n @return void\n */\nglInvalidateSubFramebuffer(GLenum target, GLsizei numAttachments, const GLenum *attachments, GLint x, GLint y, GLsizei width, GLsizei height);\n```\n\n# \n\n\n`glDeleteRenderbuffers`API\n\n``` objc\n/**\n \n\n @param n#>  description#>\n @param renderbuffers#> nx description#>\n @return void\n */\nglDeleteRenderbuffers(GLsizei n, const GLuint *renderbuffers);\n```\n\n`glDeleteRenderbuffers``renderbuffers`0`renderbuffers`0\n`glDeleteFramebuffers`API\n\n``` objc\n/**\n \n\n @param n#>  description#>\n @param framebuffers#> n description#>\n @return void\n */\nglDeleteFramebuffers(GLsizei n, const GLuint *framebuffers);\n```\n\n`glDeleteFramebuffers``framebuffers`0`framebuffers`0\n\n# \n\n`glDeleteRenderbuffers`0`glDeleteRenderbuffers`0\n\n## \n\n`glReadPixels``glBindBuffer``GL_PIXEL_PACK_BUFFER``glReadPixels`DMA\n`glReadPixels``format``type``format``GL_RGBA``GL_RGBA_INTEGER``GL_IMPLEMENTATION_COLOR_READ_FORMAT``type``GL_UNSIGNED_BYTE``GL_UNSIGNED_INT``GL_INT``GL_FLOAT``GL_IMPLEMENTATION_COLOR_READ_TYPE``glReadPixels`\n\n# \n\n\n- OpenGL ES 3.0`eglSwapBuffers`\n- \n- `glTexImage2D``glTexSubImage2D``glCopyTexImage2D`\n- `glTexImage2D``glTexImage3D``pixel``NULL``glInvalidateFramebuffer`\n- \n\n# \n\n","slug":"2019/opengl-es-framebuffer-0819","published":1,"updated":"2021-06-21T12:34:52.094Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckszp3nd9000nifntkwsuyej2","content":"<blockquote>\n<p></p>\n</blockquote>\n<h1 id=\"\"></h1>\n<p>OpenGL ESEGLAPIpbufferEGL<br>\nOpenGL ES<br>\n</p>\n<ul>\n<li><code>glCopyTexImage2D</code><code>glCopyTexSubImage2D</code>APIAPI</li>\n<li>pbufferpbufferOpenGL ESCPUpbuffer</li>\n</ul>\n<p>APIOpenGL ES API<br>\nAPI</p>\n<ul>\n<li>OpenGL ES</li>\n<li>EGL</li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n<h1 id=\"\"></h1>\n<p>2DpbufferGL<br>\nFBO2D2Dmip2D3D2Dmip2DFBO2DmipFBO2D<br>\n</p>\n<p><img src=\"/img/article/20190819/1.png\" alt=\"\"></p>\n<h2 id=\"\"></h2>\n<p><br>\n</p>\n<ul>\n<li></li>\n<li>OpenGL ESOpenGL ES</li>\n</ul>\n<h2 id=\"egl\">EGL</h2>\n<p>FBO</p>\n<ul>\n<li>(x<sub>w</sub>), y<sub>w</sub>)OpenGL ESOpenGL ESOpenGL ES</li>\n<li></li>\n<li></li>\n</ul>\n<h1 id=\"\"></h1>\n<p>OpenGL ES 3.0<br>\n<code>glGenRenderbuffers</code>API</p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param n#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param renderbuffers#&gt; n description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glGenRenderbuffers(GLsizei n, GLuint *renderbuffers);</span><br></pre></td></tr></table></figure>\n<p><code>glGenRenderbuffers</code>n<code>renderbuffers</code><code>glGenRenderbuffers</code>0<code></code>0OpenGL ES0<br>\n<code>glGenFramebuffers</code>API</p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param n#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param framebuffers#&gt; n description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glGenFramebuffers(GLsizei n, GLuint *framebuffers);</span><br></pre></td></tr></table></figure>\n<p><code>glGenFramebuffers</code>n<code>framebuffers</code><code>glGenFramebuffers</code>00OpenGL ES0</p>\n<h1 id=\"\"></h1>\n<p><code>glBindRenderbuffer</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param target#&gt; GL_RENDERBUFFER description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param renderbuffer#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glBindRenderbuffer(GLenum target, GLuint renderbuffer);</span><br></pre></td></tr></table></figure>\n<p><code>glGenRenderbuffers</code><code>glBindRenderbuffer</code><code>glGenRenderbuffers</code><code>glBindRenderbuffer</code>OpenGL ES<code>glGenRenderbuffers</code><code>glGenRenderbuffers</code><br>\n<code>glBindRenderbuffer</code></p>\n<ul>\n<li>0</li>\n<li></li>\n<li>0</li>\n<li>0</li>\n<li>0</li>\n</ul>\n<p><code>glBindRenderbuffer</code><br>\n<code>glRenderbufferStorage</code><br>\n<code>glRenderbufferStorage</code><code>glTexImage2D</code><code>glRenderbufferStorageMultisample</code><code>glRenderbufferStorage</code>0<code>glRenderStorageMultisample</code>OpenGL ESOpenGL ES1</p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">GLint maxRenderbufferSize = <span class=\"number\">0</span>;</span><br><span class=\"line\">glGetIntegerv(GL_MAX_RENDERBUFFER_SIZE, &amp;maxRenderbufferSize);</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param target#&gt; GL_RENDERBUFFER description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param internalformat#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param width#&gt; GL_MAX_RENDERBUFFER_SIZE description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param height#&gt; GL_MAX_RENDERBUFFER_SIZE description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glRenderbufferStorage(GLenum target, GLenum internalformat, GLsizei width, GLsizei height);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param target#&gt; GL_RENDERBUFFER description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param samples#&gt; GL_MAX_SAMPLES description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param internalformat#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param width#&gt; GL_MAX_RENDERBUFFER_SIZE description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param height#&gt; GL_MAX_RENDERBUFFER_SIZE description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glRenderbufferStorageMultisample(GLenum target, GLsizei samples, GLenum internalformat, GLsizei width, GLsizei height);</span><br></pre></td></tr></table></figure>\n<p></p>\n<h2 id=\"\"></h2>\n<p><a href=\"#%E5%B8%A7%E7%BC%93%E5%86%B2%E5%8C%BA%E4%BD%8D%E5%9D%97%E4%BC%A0%E9%80%81\"></a></p>\n<h1 id=\"\"></h1>\n<p><code>glBindFramebuffer</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param target#&gt; GL_READ_FRAMEBUFFERGL_DRAW_FRAMEBUFFERGL_FRAMEBUFFER description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param framebuffer#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glBindFramebuffer(GLenum target, GLuint framebuffer);</span><br></pre></td></tr></table></figure>\n<p><code>glBindFramebuffer</code><code>glGenFramebuffers</code><code>glBindFramebuffer</code>OpenGL ES<code>glGenFramebuffers</code><code>glGenFramebuffers</code><br>\nOpenGL ES 3.0<code>glBindFramebuffer</code><br>\n</p>\n<ul>\n<li></li>\n<li></li>\n<li></li>\n<li><br>\n</li>\n<li><code>GL_RENDERBUFFER</code><code>GL_TEXTURE</code><code>GL_NONE</code></li>\n<li>0</li>\n<li>mip0</li>\n<li>6<code>GL_TEXTURE_CUBE_MAP_POSITIVE_X</code></li>\n<li>3D2D0<br>\n<code>glBindFramebuffer</code><br>\n2Dmip2D3D2Dmip2Dmip</li>\n</ul>\n<h2 id=\"\"></h2>\n<p><code>glFramebufferRenderbuffer</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param target#&gt; GL_READ_FRAMEBUFFERGL_DRAW_FRAMEBUFFERGL_FRAMEBUFFER description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param attachment#&gt; GL_COLOR_ATTACHMENTiGL_DEPTH_ATTACHMENTGL_STENCIL_ATTACHMENTGL_DEPTH_STENCIL_ATTACHMENT description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param renderbuffertarget#&gt; GL_RENDERBUFFER description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param renderbuffer#&gt; 0 description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glFramebufferRenderbuffer(GLenum target, GLenum attachment, GLenum renderbuffertarget, GLuint renderbuffer);</span><br></pre></td></tr></table></figure>\n<p><code>glFramebufferRenderbuffer</code><code>renderbuffer</code>0<code>attachment</code><br>\n</p>\n<ul>\n<li> = GL_RENDERBUFFER</li>\n<li> = renderbuffer</li>\n<li> = 0</li>\n<li> = GL_NONE</li>\n</ul>\n<p><br>\n<code>glFramebufferRenderbuffer</code><code>renderbuffer</code>0<code>attachment</code>0</p>\n<h2 id=\"2d\">2D</h2>\n<p><code>glFramebufferTexture2D</code>2Dmip</p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> 2Dmip</span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param target#&gt; GL_READ_FRAMEBUFFERGL_DRAW_FRAMEBUFFERGL_FRAMEBUFFER description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param attachment#&gt; GL_COLOR_ATTACHMENTiGL_DEPTH_ATTACHMENTGL_STENCIL_ATTACHMENTGL_DEPTH_STENCIL_ATTACHMENT description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param textarget#&gt; glTexImage2Dtarget description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param texture#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param level#&gt; mip description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glFramebufferTexture2D(GLenum target, GLenum attachment, GLenum textarget, GLuint texture, GLint level);</span><br></pre></td></tr></table></figure>\n<p><code>glFramebufferTexture2D</code><code>texture</code>0<code>texture</code><code>glFramebufferTexture2D</code><br>\n</p>\n<ul>\n<li> = GL_TEXTURE</li>\n<li> = texture</li>\n<li> = level</li>\n<li> GL_TEXTURE_CUBE_MAP_POSITIVE_(X | Y | Z)GL_TEXTURE_CUBE_MAP_NEGATIVE_(X | Y | Z)</li>\n<li> = 0<br>\n<code>glFramebufferTexture2D</code><br>\n<code>glFramebufferTexture2D</code><code>texture</code>00</li>\n</ul>\n<h2 id=\"3d\">3D</h2>\n<p><code>glFramebufferTextureLayer</code>3D2Dmip2D</p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> 3D2Dmip2D</span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param target#&gt; GL_READ_FRAMEBUFFERGL_DRAW_FRAMEBUFFERGL_FRAMEBUFFER description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param attachment#&gt; GL_COLOR_ATTACHMENTiGL_DEPTH_ATTACHMENTGL_STENCIL_ATTACHMENTGL_DEPTH_STENCIL_ATTACHMENT description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param texture#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param level#&gt; mip description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param layer#&gt; textureGL_TEXTURE_CUBE_MAP_3Dlevel0GL_MAX3D_TEXTURE_SIZE2textureGL_TEXTURE_2D_ARRAYlevel0GL_MAX_TEXTURE_SIZE2 description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glFramebufferTextureLayer(GLenum target, GLenum attachment, GLuint texture, GLint level, GLint layer);</span><br></pre></td></tr></table></figure>\n<p><code>glFramebufferTextureLayer</code><br>\n</p>\n<ul>\n<li> = GL_TEXTURE</li>\n<li> = texture</li>\n<li> = level</li>\n<li> = GL_NONE</li>\n<li> = 0<br>\n<code>glFramebufferTextureLayer</code><code>texture</code>00</li>\n</ul>\n<h2 id=\"\"></h2>\n<p>OpenGL ES<br>\n</p>\n<ul>\n<li></li>\n<li></li>\n<li></li>\n<li><code>GL_RENDERBUFFER_SAMPLES</code><code>GL_RENDERBUFFER_SAMPLES</code>0</li>\n</ul>\n<p><code>glCheckFramebufferStatus</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param target#&gt; GL_READ_FRAMEBUFFERGL_DRAW_FRMAEBUFFERGL_FRAMEBUFFER description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glCheckFramebufferStatus(GLenum target);</span><br></pre></td></tr></table></figure>\n<p><code>target</code><code>GL_FRAMEBUFFER</code><code>glCheckFramebufferStatus</code>0<code>target</code><code>GL_FRAMEBUFFER</code></p>\n<ul>\n<li>GL_FRAMEBUFFER_COMPLETE  </li>\n<li>GL_FRAMEBUFFER_UNDEFINED  <code>target</code></li>\n<li>GL_FRAMEBUFFER_INCOMPLETE_ATTACHMENT  0</li>\n<li>GL_FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT  </li>\n<li>GL_FRAMEBUFFER_UNSUPPORTED  </li>\n<li>GL_FRAMEBUFFER_INCOMPLETE_MULTISAMPLE  GL_RENDERBUFFER_SAMPLESGL_RENDERBUFFER_SAMPLES0</li>\n</ul>\n<p><code>glDrawArrays</code><code>glDrawElements</code><code>glReadPixels</code><code>glCopyTeximage2D</code><code>glCopyTexSubimage2D</code><code>glCopyTexSubimage3D</code><code>GL_INVALID_FRAMEBUFFER_OPERATION</code></p>\n<h1 id=\"\"></h1>\n<p>Blit<br>\n</p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param srcX0srcY0srcX1srcY1#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param dstX0dstY0dstX1dstY1#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param mask#&gt; GL_COLOR_BUFFER_BITGL_DEPTH_BUFFER_BITGL_STENCIL_BUFFER_BITGL_DEPTH_STENCIL_ATTACHMENT description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param filter#&gt; GL_NEARESTGL_LINEAR description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glBlitFramebuffer(GLint srcX0, GLint srcY0, GLint srcX1, GLint srcY1, GLint dstX0, GLint dstY0, GLint dstX1, GLint dstY1, GLbitfield mask, GLenum filter);</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// set the default framebuffer for writing</span></span><br><span class=\"line\">glBindFramebuffer(GL_DRAW_FRAMEBUFFER, defaultFramebuffer);</span><br><span class=\"line\"><span class=\"comment\">// set the fbo with color attachments for reading</span></span><br><span class=\"line\">glBindFramebuffer(GL_READ_FRAMEBUFFER, fbo);</span><br><span class=\"line\"><span class=\"comment\">// copy the output buffer to target</span></span><br><span class=\"line\">glReadBuffer(GL_COLOR_ATTACHMENT0);</span><br><span class=\"line\">glBlitFramebuffer(<span class=\"number\">0</span>, <span class=\"number\">0</span>, width, height, <span class=\"number\">0</span>, <span class=\"number\">0</span>, width/<span class=\"number\">2</span>, height, GL_COLOR_BUFFER_BIT, GL_LINEAR);</span><br><span class=\"line\">glReadBuffer(GL_COLOR_ATTACHMENT1);</span><br><span class=\"line\">glBlitFramebuffer(<span class=\"number\">0</span>, <span class=\"number\">0</span>, width, height, width/<span class=\"number\">2</span>, <span class=\"number\">0</span>, width/<span class=\"number\">2</span>, height, GL_COLOR_BUFFER_BIT, GL_LINEAR);</span><br></pre></td></tr></table></figure>\n<h1 id=\"\"></h1>\n<p>1TBR2CPUGPU3<br>\nTBR GPUGPUTBR GPUGPUGPU<br>\nGPUGPUGPU<br>\n<code>glInvalidateFramebuffer</code><code>glInvalidateSubFramebuffer</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param target#&gt; GL_READ_FRAMEBUFFERGL_DRAW_FRAMEBUFFERGL_FRAMEBUFFER description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param numAttachments#&gt; attachments description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param attachments#&gt; numAttachments description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glInvalidateFramebuffer(GLenum target, GLsizei numAttachments, <span class=\"keyword\">const</span> GLenum *attachments);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param target#&gt; GL_READ_FRAMEBUFFERGL_DRAW_FRAMEBUFFERGL_FRAMEBUFFER description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param numAttachments#&gt; attachments description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param attachments#&gt; numAttachments description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param xy#&gt; 00 description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param width#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param height#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glInvalidateSubFramebuffer(GLenum target, GLsizei numAttachments, <span class=\"keyword\">const</span> GLenum *attachments, GLint x, GLint y, GLsizei width, GLsizei height);</span><br></pre></td></tr></table></figure>\n<h1 id=\"\"></h1>\n<p><br>\n<code>glDeleteRenderbuffers</code>API</p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param n#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param renderbuffers#&gt; nx description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glDeleteRenderbuffers(GLsizei n, <span class=\"keyword\">const</span> GLuint *renderbuffers);</span><br></pre></td></tr></table></figure>\n<p><code>glDeleteRenderbuffers</code><code>renderbuffers</code>0<code>renderbuffers</code>0<br>\n<code>glDeleteFramebuffers</code>API</p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param n#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param framebuffers#&gt; n description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glDeleteFramebuffers(GLsizei n, <span class=\"keyword\">const</span> GLuint *framebuffers);</span><br></pre></td></tr></table></figure>\n<p><code>glDeleteFramebuffers</code><code>framebuffers</code>0<code>framebuffers</code>0</p>\n<h1 id=\"\"></h1>\n<p><code>glDeleteRenderbuffers</code>0<code>glDeleteRenderbuffers</code>0</p>\n<h2 id=\"\"></h2>\n<p><code>glReadPixels</code><code>glBindBuffer</code><code>GL_PIXEL_PACK_BUFFER</code><code>glReadPixels</code>DMA<br>\n<code>glReadPixels</code><code>format</code><code>type</code><code>format</code><code>GL_RGBA</code><code>GL_RGBA_INTEGER</code><code>GL_IMPLEMENTATION_COLOR_READ_FORMAT</code><code>type</code><code>GL_UNSIGNED_BYTE</code><code>GL_UNSIGNED_INT</code><code>GL_INT</code><code>GL_FLOAT</code><code>GL_IMPLEMENTATION_COLOR_READ_TYPE</code><code>glReadPixels</code></p>\n<h1 id=\"\"></h1>\n<p></p>\n<ul>\n<li>OpenGL ES 3.0<code>eglSwapBuffers</code></li>\n<li></li>\n<li><code>glTexImage2D</code><code>glTexSubImage2D</code><code>glCopyTexImage2D</code></li>\n<li><code>glTexImage2D</code><code>glTexImage3D</code><code>pixel</code><code>NULL</code><code>glInvalidateFramebuffer</code></li>\n<li></li>\n</ul>\n<h1 id=\"\"></h1>\n<p></p>\n","site":{"data":{}},"excerpt":"","more":"<blockquote>\n<p></p>\n</blockquote>\n<h1></h1>\n<p>OpenGL ESEGLAPIpbufferEGL<br>\nOpenGL ES<br>\n</p>\n<ul>\n<li><code>glCopyTexImage2D</code><code>glCopyTexSubImage2D</code>APIAPI</li>\n<li>pbufferpbufferOpenGL ESCPUpbuffer</li>\n</ul>\n<p>APIOpenGL ES API<br>\nAPI</p>\n<ul>\n<li>OpenGL ES</li>\n<li>EGL</li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n<h1></h1>\n<p>2DpbufferGL<br>\nFBO2D2Dmip2D3D2Dmip2DFBO2DmipFBO2D<br>\n</p>\n<p><img src=\"/img/article/20190819/1.png\" alt=\"\"></p>\n<h2></h2>\n<p><br>\n</p>\n<ul>\n<li></li>\n<li>OpenGL ESOpenGL ES</li>\n</ul>\n<h2>EGL</h2>\n<p>FBO</p>\n<ul>\n<li>(x<sub>w</sub>), y<sub>w</sub>)OpenGL ESOpenGL ESOpenGL ES</li>\n<li></li>\n<li></li>\n</ul>\n<h1></h1>\n<p>OpenGL ES 3.0<br>\n<code>glGenRenderbuffers</code>API</p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param n#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param renderbuffers#&gt; n description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glGenRenderbuffers(GLsizei n, GLuint *renderbuffers);</span><br></pre></td></tr></table></figure>\n<p><code>glGenRenderbuffers</code>n<code>renderbuffers</code><code>glGenRenderbuffers</code>0<code></code>0OpenGL ES0<br>\n<code>glGenFramebuffers</code>API</p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param n#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param framebuffers#&gt; n description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glGenFramebuffers(GLsizei n, GLuint *framebuffers);</span><br></pre></td></tr></table></figure>\n<p><code>glGenFramebuffers</code>n<code>framebuffers</code><code>glGenFramebuffers</code>00OpenGL ES0</p>\n<h1></h1>\n<p><code>glBindRenderbuffer</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param target#&gt; GL_RENDERBUFFER description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param renderbuffer#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glBindRenderbuffer(GLenum target, GLuint renderbuffer);</span><br></pre></td></tr></table></figure>\n<p><code>glGenRenderbuffers</code><code>glBindRenderbuffer</code><code>glGenRenderbuffers</code><code>glBindRenderbuffer</code>OpenGL ES<code>glGenRenderbuffers</code><code>glGenRenderbuffers</code><br>\n<code>glBindRenderbuffer</code></p>\n<ul>\n<li>0</li>\n<li></li>\n<li>0</li>\n<li>0</li>\n<li>0</li>\n</ul>\n<p><code>glBindRenderbuffer</code><br>\n<code>glRenderbufferStorage</code><br>\n<code>glRenderbufferStorage</code><code>glTexImage2D</code><code>glRenderbufferStorageMultisample</code><code>glRenderbufferStorage</code>0<code>glRenderStorageMultisample</code>OpenGL ESOpenGL ES1</p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">GLint maxRenderbufferSize = <span class=\"number\">0</span>;</span><br><span class=\"line\">glGetIntegerv(GL_MAX_RENDERBUFFER_SIZE, &amp;maxRenderbufferSize);</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param target#&gt; GL_RENDERBUFFER description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param internalformat#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param width#&gt; GL_MAX_RENDERBUFFER_SIZE description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param height#&gt; GL_MAX_RENDERBUFFER_SIZE description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glRenderbufferStorage(GLenum target, GLenum internalformat, GLsizei width, GLsizei height);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param target#&gt; GL_RENDERBUFFER description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param samples#&gt; GL_MAX_SAMPLES description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param internalformat#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param width#&gt; GL_MAX_RENDERBUFFER_SIZE description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param height#&gt; GL_MAX_RENDERBUFFER_SIZE description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glRenderbufferStorageMultisample(GLenum target, GLsizei samples, GLenum internalformat, GLsizei width, GLsizei height);</span><br></pre></td></tr></table></figure>\n<p></p>\n<h2></h2>\n<p><a href=\"#%E5%B8%A7%E7%BC%93%E5%86%B2%E5%8C%BA%E4%BD%8D%E5%9D%97%E4%BC%A0%E9%80%81\"></a></p>\n<h1></h1>\n<p><code>glBindFramebuffer</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param target#&gt; GL_READ_FRAMEBUFFERGL_DRAW_FRAMEBUFFERGL_FRAMEBUFFER description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param framebuffer#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glBindFramebuffer(GLenum target, GLuint framebuffer);</span><br></pre></td></tr></table></figure>\n<p><code>glBindFramebuffer</code><code>glGenFramebuffers</code><code>glBindFramebuffer</code>OpenGL ES<code>glGenFramebuffers</code><code>glGenFramebuffers</code><br>\nOpenGL ES 3.0<code>glBindFramebuffer</code><br>\n</p>\n<ul>\n<li></li>\n<li></li>\n<li></li>\n<li><br>\n</li>\n<li><code>GL_RENDERBUFFER</code><code>GL_TEXTURE</code><code>GL_NONE</code></li>\n<li>0</li>\n<li>mip0</li>\n<li>6<code>GL_TEXTURE_CUBE_MAP_POSITIVE_X</code></li>\n<li>3D2D0<br>\n<code>glBindFramebuffer</code><br>\n2Dmip2D3D2Dmip2Dmip</li>\n</ul>\n<h2></h2>\n<p><code>glFramebufferRenderbuffer</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param target#&gt; GL_READ_FRAMEBUFFERGL_DRAW_FRAMEBUFFERGL_FRAMEBUFFER description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param attachment#&gt; GL_COLOR_ATTACHMENTiGL_DEPTH_ATTACHMENTGL_STENCIL_ATTACHMENTGL_DEPTH_STENCIL_ATTACHMENT description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param renderbuffertarget#&gt; GL_RENDERBUFFER description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param renderbuffer#&gt; 0 description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glFramebufferRenderbuffer(GLenum target, GLenum attachment, GLenum renderbuffertarget, GLuint renderbuffer);</span><br></pre></td></tr></table></figure>\n<p><code>glFramebufferRenderbuffer</code><code>renderbuffer</code>0<code>attachment</code><br>\n</p>\n<ul>\n<li> = GL_RENDERBUFFER</li>\n<li> = renderbuffer</li>\n<li> = 0</li>\n<li> = GL_NONE</li>\n</ul>\n<p><br>\n<code>glFramebufferRenderbuffer</code><code>renderbuffer</code>0<code>attachment</code>0</p>\n<h2>2D</h2>\n<p><code>glFramebufferTexture2D</code>2Dmip</p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> 2Dmip</span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param target#&gt; GL_READ_FRAMEBUFFERGL_DRAW_FRAMEBUFFERGL_FRAMEBUFFER description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param attachment#&gt; GL_COLOR_ATTACHMENTiGL_DEPTH_ATTACHMENTGL_STENCIL_ATTACHMENTGL_DEPTH_STENCIL_ATTACHMENT description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param textarget#&gt; glTexImage2Dtarget description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param texture#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param level#&gt; mip description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glFramebufferTexture2D(GLenum target, GLenum attachment, GLenum textarget, GLuint texture, GLint level);</span><br></pre></td></tr></table></figure>\n<p><code>glFramebufferTexture2D</code><code>texture</code>0<code>texture</code><code>glFramebufferTexture2D</code><br>\n</p>\n<ul>\n<li> = GL_TEXTURE</li>\n<li> = texture</li>\n<li> = level</li>\n<li> GL_TEXTURE_CUBE_MAP_POSITIVE_(X | Y | Z)GL_TEXTURE_CUBE_MAP_NEGATIVE_(X | Y | Z)</li>\n<li> = 0<br>\n<code>glFramebufferTexture2D</code><br>\n<code>glFramebufferTexture2D</code><code>texture</code>00</li>\n</ul>\n<h2>3D</h2>\n<p><code>glFramebufferTextureLayer</code>3D2Dmip2D</p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> 3D2Dmip2D</span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param target#&gt; GL_READ_FRAMEBUFFERGL_DRAW_FRAMEBUFFERGL_FRAMEBUFFER description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param attachment#&gt; GL_COLOR_ATTACHMENTiGL_DEPTH_ATTACHMENTGL_STENCIL_ATTACHMENTGL_DEPTH_STENCIL_ATTACHMENT description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param texture#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param level#&gt; mip description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param layer#&gt; textureGL_TEXTURE_CUBE_MAP_3Dlevel0GL_MAX3D_TEXTURE_SIZE2textureGL_TEXTURE_2D_ARRAYlevel0GL_MAX_TEXTURE_SIZE2 description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glFramebufferTextureLayer(GLenum target, GLenum attachment, GLuint texture, GLint level, GLint layer);</span><br></pre></td></tr></table></figure>\n<p><code>glFramebufferTextureLayer</code><br>\n</p>\n<ul>\n<li> = GL_TEXTURE</li>\n<li> = texture</li>\n<li> = level</li>\n<li> = GL_NONE</li>\n<li> = 0<br>\n<code>glFramebufferTextureLayer</code><code>texture</code>00</li>\n</ul>\n<h2></h2>\n<p>OpenGL ES<br>\n</p>\n<ul>\n<li></li>\n<li></li>\n<li></li>\n<li><code>GL_RENDERBUFFER_SAMPLES</code><code>GL_RENDERBUFFER_SAMPLES</code>0</li>\n</ul>\n<p><code>glCheckFramebufferStatus</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param target#&gt; GL_READ_FRAMEBUFFERGL_DRAW_FRMAEBUFFERGL_FRAMEBUFFER description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glCheckFramebufferStatus(GLenum target);</span><br></pre></td></tr></table></figure>\n<p><code>target</code><code>GL_FRAMEBUFFER</code><code>glCheckFramebufferStatus</code>0<code>target</code><code>GL_FRAMEBUFFER</code></p>\n<ul>\n<li>GL_FRAMEBUFFER_COMPLETE  </li>\n<li>GL_FRAMEBUFFER_UNDEFINED  <code>target</code></li>\n<li>GL_FRAMEBUFFER_INCOMPLETE_ATTACHMENT  0</li>\n<li>GL_FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT  </li>\n<li>GL_FRAMEBUFFER_UNSUPPORTED  </li>\n<li>GL_FRAMEBUFFER_INCOMPLETE_MULTISAMPLE  GL_RENDERBUFFER_SAMPLESGL_RENDERBUFFER_SAMPLES0</li>\n</ul>\n<p><code>glDrawArrays</code><code>glDrawElements</code><code>glReadPixels</code><code>glCopyTeximage2D</code><code>glCopyTexSubimage2D</code><code>glCopyTexSubimage3D</code><code>GL_INVALID_FRAMEBUFFER_OPERATION</code></p>\n<h1></h1>\n<p>Blit<br>\n</p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param srcX0srcY0srcX1srcY1#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param dstX0dstY0dstX1dstY1#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param mask#&gt; GL_COLOR_BUFFER_BITGL_DEPTH_BUFFER_BITGL_STENCIL_BUFFER_BITGL_DEPTH_STENCIL_ATTACHMENT description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param filter#&gt; GL_NEARESTGL_LINEAR description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glBlitFramebuffer(GLint srcX0, GLint srcY0, GLint srcX1, GLint srcY1, GLint dstX0, GLint dstY0, GLint dstX1, GLint dstY1, GLbitfield mask, GLenum filter);</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// set the default framebuffer for writing</span></span><br><span class=\"line\">glBindFramebuffer(GL_DRAW_FRAMEBUFFER, defaultFramebuffer);</span><br><span class=\"line\"><span class=\"comment\">// set the fbo with color attachments for reading</span></span><br><span class=\"line\">glBindFramebuffer(GL_READ_FRAMEBUFFER, fbo);</span><br><span class=\"line\"><span class=\"comment\">// copy the output buffer to target</span></span><br><span class=\"line\">glReadBuffer(GL_COLOR_ATTACHMENT0);</span><br><span class=\"line\">glBlitFramebuffer(<span class=\"number\">0</span>, <span class=\"number\">0</span>, width, height, <span class=\"number\">0</span>, <span class=\"number\">0</span>, width/<span class=\"number\">2</span>, height, GL_COLOR_BUFFER_BIT, GL_LINEAR);</span><br><span class=\"line\">glReadBuffer(GL_COLOR_ATTACHMENT1);</span><br><span class=\"line\">glBlitFramebuffer(<span class=\"number\">0</span>, <span class=\"number\">0</span>, width, height, width/<span class=\"number\">2</span>, <span class=\"number\">0</span>, width/<span class=\"number\">2</span>, height, GL_COLOR_BUFFER_BIT, GL_LINEAR);</span><br></pre></td></tr></table></figure>\n<h1></h1>\n<p>1TBR2CPUGPU3<br>\nTBR GPUGPUTBR GPUGPUGPU<br>\nGPUGPUGPU<br>\n<code>glInvalidateFramebuffer</code><code>glInvalidateSubFramebuffer</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param target#&gt; GL_READ_FRAMEBUFFERGL_DRAW_FRAMEBUFFERGL_FRAMEBUFFER description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param numAttachments#&gt; attachments description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param attachments#&gt; numAttachments description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glInvalidateFramebuffer(GLenum target, GLsizei numAttachments, <span class=\"keyword\">const</span> GLenum *attachments);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param target#&gt; GL_READ_FRAMEBUFFERGL_DRAW_FRAMEBUFFERGL_FRAMEBUFFER description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param numAttachments#&gt; attachments description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param attachments#&gt; numAttachments description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param xy#&gt; 00 description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param width#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param height#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glInvalidateSubFramebuffer(GLenum target, GLsizei numAttachments, <span class=\"keyword\">const</span> GLenum *attachments, GLint x, GLint y, GLsizei width, GLsizei height);</span><br></pre></td></tr></table></figure>\n<h1></h1>\n<p><br>\n<code>glDeleteRenderbuffers</code>API</p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param n#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param renderbuffers#&gt; nx description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glDeleteRenderbuffers(GLsizei n, <span class=\"keyword\">const</span> GLuint *renderbuffers);</span><br></pre></td></tr></table></figure>\n<p><code>glDeleteRenderbuffers</code><code>renderbuffers</code>0<code>renderbuffers</code>0<br>\n<code>glDeleteFramebuffers</code>API</p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param n#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param framebuffers#&gt; n description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glDeleteFramebuffers(GLsizei n, <span class=\"keyword\">const</span> GLuint *framebuffers);</span><br></pre></td></tr></table></figure>\n<p><code>glDeleteFramebuffers</code><code>framebuffers</code>0<code>framebuffers</code>0</p>\n<h1></h1>\n<p><code>glDeleteRenderbuffers</code>0<code>glDeleteRenderbuffers</code>0</p>\n<h2></h2>\n<p><code>glReadPixels</code><code>glBindBuffer</code><code>GL_PIXEL_PACK_BUFFER</code><code>glReadPixels</code>DMA<br>\n<code>glReadPixels</code><code>format</code><code>type</code><code>format</code><code>GL_RGBA</code><code>GL_RGBA_INTEGER</code><code>GL_IMPLEMENTATION_COLOR_READ_FORMAT</code><code>type</code><code>GL_UNSIGNED_BYTE</code><code>GL_UNSIGNED_INT</code><code>GL_INT</code><code>GL_FLOAT</code><code>GL_IMPLEMENTATION_COLOR_READ_TYPE</code><code>glReadPixels</code></p>\n<h1></h1>\n<p></p>\n<ul>\n<li>OpenGL ES 3.0<code>eglSwapBuffers</code></li>\n<li></li>\n<li><code>glTexImage2D</code><code>glTexSubImage2D</code><code>glCopyTexImage2D</code></li>\n<li><code>glTexImage2D</code><code>glTexImage3D</code><code>pixel</code><code>NULL</code><code>glInvalidateFramebuffer</code></li>\n<li></li>\n</ul>\n<h1></h1>\n<p></p>\n"},{"title":"OpenGL ES--","catalog":true,"toc_nav_num":true,"date":"2019-08-15T09:20:32.000Z","subtitle":"About OpenGL ES","header-img":"/img/article_header/article_header.png","busuanzi":true,"_content":"\n> \n\n# \n\n\nOpenGL ES 1.1OpenGL3\nOpenGL ES 1.1ABC\n\nRGB | \n- | -\nREPLACE | A\nMODULATE | AxB\nADD | A+B\nADD_SIGNED | A+B-0.5\nINTERPOLATE | AxC+Bx(1-C)\nSUBTRACT | A-B\nDOT3_RGB(and DOT3_RGBA) | 4x((A.r-0.5)x(B.r-0.5)+(A.g-0.5)x(B.g-0.5)+(A.b-0.5)x(B.b-0.5))\n\n\nOpenGL ESOpenGLMODULATEOpenGL ES 1.1\n\n``` objc\nglTexEnvi(GL_TEXTURE_ENV, GL_TEXTURE_ENV_MODE, GL_COMBINE);\nglTexEnvi(GL_TEXTURE_ENV, GL_COMBINE_RGB, GL_MODULATE);\nglTexEnvi(GL_TEXTURE_ENV, GL_SOURCE0_RGB, GL_PRIMARY_COLOR);\nglTexEnvi(GL_TEXTURE_ENV, GL_SOURCE1_RGB, GL_TEXTURE);\nglTexEnvi(GL_TEXTURE_ENV, GL_COMBINE_ALPHA, GL_MODULATE);\nglTexEnvi(GL_TEXTURE_ENV, GL_SOURCE0_ALPHA, GL_PRIMARY_COLOR);\nglTexEnvi(GL_TEXTURE_ENV, GL_SOURCE1_ALPHA, GL_TEXTURE);\n```\n\nAxBOpenGL ES 3.0\n\n``` objc\n#version 300 es\nprecision mediump float;\nuniform sampler2D s_tex0;\nin vec2 v_texCoord;\nin vec4 v_primaryColor;\nlayout(location = 0) out vec4 outColor;\nvoid main()\n{\n    outColor = texture(s_tex0, v_texCoord) * v_primaryColor;\n}\n```\n\n02D`v_primaryColor`\n\n\n# \n\n\n- --\n- --\n- --\n- --\n\n\n![OpenGL ES 3.0](/img/article/20190815/1.png)\n\n## \n\nOpenGL ES 3.0\n- `gl_FragCoord`--(x, y, z, 1/w)\n- `gl_FrontFacing`--truefalse\n- `gl_PointCoord`--[0, 1]\n- `gl_FragDepth`--GPUGPUEarly-ZEarly-Z`gl_FragDepth`GPU\n\n## \n\n\n\n``` objc\nconst mediump int gl_MaxFragmentInputVectors = 15;\nconst mediump int gl_MaxTextureImageUnits = 16;\nconst mediump int gl_MaxFragmentUniformVectors = 224;\nconst mediump int gl_MaxDrawBuffers = 4;\nconst mediump int gl_MinProgramTexelOffset = -8;\nconst mediump int gl_MaxProgramTexelOffset = 7;\n```\n\n\n- `gl_MaxFragmentInputVectors`--ES 3.015\n- `gl_MaxTextureImageUnits`--ES 3.015\n- `gl_MaxFragmentUniformVectors`--vec4ES 3.0224vec4\n- `gl_MaxDrawBuffers`--MRTES 3.04\n- `gl_MinProgramTexelOffset/gl_MaxProgramTexelOffset`--ESSLtexture*Offset()\nOpenGL ES 3.0API`gl_MaxTextureImageUnits``gl_MaxFragmentUniformVectors`\n\n``` objc\nGLint maxTextureImageUnits, maxFragmentUniformVectors;\nglGetIntegerv(GL_MAX_TEXTURE_IMAGE_UNITS, &maxTextureImageUnits);\nglGetIntegerv(GL_MAX_FRAGMENT_UNIFORM_VECTORS, &maxFragmentUniformVectors);\n```\n\n# \n\nOpenGL ES 1.xOpenGLAPIAlphaOpenGL ES 3.0\n\n## \n\nOpenGL ES\n\n\n\n``` objc\n#version 300 es\nprecision mediump float;\nin vec2 v_texCoord;\nlayout(location = 0) out vec4 outColor;\nuniform sampler2D s_baseMap;\nunifomr sampler2D s_lightMap;\nvoid main()\n{\n    vec4 baseColor;\n    vec4 lightColor;\n    baseColor = texture(s_baseMap, v_texCoord);\n    lightColor = texture(s_lightMap, v_texCoord);\n    // Add a 0.25 ambient light to the texture light color\n    outColor = baseColor * (lightColor + 0.25);\n}\n```\n\n\n\n``` objc\n// Bind the base map\nglActiveTexture(GL_TEXTURE0);\nglBindTexture(GL_TEXTURE_2D, baseMapTexId);\n// Set the base map sampler to texture unit 0\nglUniformli(baseMapLoc, 0);\n// Bind the light map\nglActiveTexture(GL_TEXTURE1);\nglBindTexture(GL_TEXTURE_2D, lightMapTexId);\n// Set the light map sampler to texture unit 1\nglUniform(lightMapLoc, 1);\n```\n\n01\n\n##  \n\n> \n\n## AlphaDiscard\n\n3DRGBARGBA\nAlphaAlphaAlphaAlphaOpenGL ES 3.0Alpha`discard`\n\n``` objc\n#version 300 es\nprecision mediump float;\nuniform sampler2D baseMap;\nin vec2 v_texCoord;\nlayout(location = 0) out vec4 outColor;\nvoid main()\n{\n    vec4 baseColor = texture(baseMap, v_texCoord);\n    // Discard all fragments with alpha value less than 0.25\n    if (baseColor.a < 0.25) {\n        discard;\n    } else {\n        outColor = baseColor;\n    }\n}\n```\n\nRGBAAlphaAlphaAlpha0.25`discard`\nAlphaAlpha\n\n## \n\n> \n\n# \n\nOpenGL ES 1.1","source":"_posts/2019/opengl-es-fragment-shader-0815.md","raw":"---\ntitle: \"OpenGL ES--\"\ncatalog: true\ntoc_nav_num: true\ndate: 2019-08-15 17:20:32\nsubtitle: \"About OpenGL ES\"\nheader-img: \"/img/article_header/article_header.png\"\nbusuanzi: true\ntags:\n- iOS\n\n---\n\n> \n\n# \n\n\nOpenGL ES 1.1OpenGL3\nOpenGL ES 1.1ABC\n\nRGB | \n- | -\nREPLACE | A\nMODULATE | AxB\nADD | A+B\nADD_SIGNED | A+B-0.5\nINTERPOLATE | AxC+Bx(1-C)\nSUBTRACT | A-B\nDOT3_RGB(and DOT3_RGBA) | 4x((A.r-0.5)x(B.r-0.5)+(A.g-0.5)x(B.g-0.5)+(A.b-0.5)x(B.b-0.5))\n\n\nOpenGL ESOpenGLMODULATEOpenGL ES 1.1\n\n``` objc\nglTexEnvi(GL_TEXTURE_ENV, GL_TEXTURE_ENV_MODE, GL_COMBINE);\nglTexEnvi(GL_TEXTURE_ENV, GL_COMBINE_RGB, GL_MODULATE);\nglTexEnvi(GL_TEXTURE_ENV, GL_SOURCE0_RGB, GL_PRIMARY_COLOR);\nglTexEnvi(GL_TEXTURE_ENV, GL_SOURCE1_RGB, GL_TEXTURE);\nglTexEnvi(GL_TEXTURE_ENV, GL_COMBINE_ALPHA, GL_MODULATE);\nglTexEnvi(GL_TEXTURE_ENV, GL_SOURCE0_ALPHA, GL_PRIMARY_COLOR);\nglTexEnvi(GL_TEXTURE_ENV, GL_SOURCE1_ALPHA, GL_TEXTURE);\n```\n\nAxBOpenGL ES 3.0\n\n``` objc\n#version 300 es\nprecision mediump float;\nuniform sampler2D s_tex0;\nin vec2 v_texCoord;\nin vec4 v_primaryColor;\nlayout(location = 0) out vec4 outColor;\nvoid main()\n{\n    outColor = texture(s_tex0, v_texCoord) * v_primaryColor;\n}\n```\n\n02D`v_primaryColor`\n\n\n# \n\n\n- --\n- --\n- --\n- --\n\n\n![OpenGL ES 3.0](/img/article/20190815/1.png)\n\n## \n\nOpenGL ES 3.0\n- `gl_FragCoord`--(x, y, z, 1/w)\n- `gl_FrontFacing`--truefalse\n- `gl_PointCoord`--[0, 1]\n- `gl_FragDepth`--GPUGPUEarly-ZEarly-Z`gl_FragDepth`GPU\n\n## \n\n\n\n``` objc\nconst mediump int gl_MaxFragmentInputVectors = 15;\nconst mediump int gl_MaxTextureImageUnits = 16;\nconst mediump int gl_MaxFragmentUniformVectors = 224;\nconst mediump int gl_MaxDrawBuffers = 4;\nconst mediump int gl_MinProgramTexelOffset = -8;\nconst mediump int gl_MaxProgramTexelOffset = 7;\n```\n\n\n- `gl_MaxFragmentInputVectors`--ES 3.015\n- `gl_MaxTextureImageUnits`--ES 3.015\n- `gl_MaxFragmentUniformVectors`--vec4ES 3.0224vec4\n- `gl_MaxDrawBuffers`--MRTES 3.04\n- `gl_MinProgramTexelOffset/gl_MaxProgramTexelOffset`--ESSLtexture*Offset()\nOpenGL ES 3.0API`gl_MaxTextureImageUnits``gl_MaxFragmentUniformVectors`\n\n``` objc\nGLint maxTextureImageUnits, maxFragmentUniformVectors;\nglGetIntegerv(GL_MAX_TEXTURE_IMAGE_UNITS, &maxTextureImageUnits);\nglGetIntegerv(GL_MAX_FRAGMENT_UNIFORM_VECTORS, &maxFragmentUniformVectors);\n```\n\n# \n\nOpenGL ES 1.xOpenGLAPIAlphaOpenGL ES 3.0\n\n## \n\nOpenGL ES\n\n\n\n``` objc\n#version 300 es\nprecision mediump float;\nin vec2 v_texCoord;\nlayout(location = 0) out vec4 outColor;\nuniform sampler2D s_baseMap;\nunifomr sampler2D s_lightMap;\nvoid main()\n{\n    vec4 baseColor;\n    vec4 lightColor;\n    baseColor = texture(s_baseMap, v_texCoord);\n    lightColor = texture(s_lightMap, v_texCoord);\n    // Add a 0.25 ambient light to the texture light color\n    outColor = baseColor * (lightColor + 0.25);\n}\n```\n\n\n\n``` objc\n// Bind the base map\nglActiveTexture(GL_TEXTURE0);\nglBindTexture(GL_TEXTURE_2D, baseMapTexId);\n// Set the base map sampler to texture unit 0\nglUniformli(baseMapLoc, 0);\n// Bind the light map\nglActiveTexture(GL_TEXTURE1);\nglBindTexture(GL_TEXTURE_2D, lightMapTexId);\n// Set the light map sampler to texture unit 1\nglUniform(lightMapLoc, 1);\n```\n\n01\n\n##  \n\n> \n\n## AlphaDiscard\n\n3DRGBARGBA\nAlphaAlphaAlphaAlphaOpenGL ES 3.0Alpha`discard`\n\n``` objc\n#version 300 es\nprecision mediump float;\nuniform sampler2D baseMap;\nin vec2 v_texCoord;\nlayout(location = 0) out vec4 outColor;\nvoid main()\n{\n    vec4 baseColor = texture(baseMap, v_texCoord);\n    // Discard all fragments with alpha value less than 0.25\n    if (baseColor.a < 0.25) {\n        discard;\n    } else {\n        outColor = baseColor;\n    }\n}\n```\n\nRGBAAlphaAlphaAlpha0.25`discard`\nAlphaAlpha\n\n## \n\n> \n\n# \n\nOpenGL ES 1.1","slug":"2019/opengl-es-fragment-shader-0815","published":1,"updated":"2021-06-21T12:34:52.093Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckszp3nda000qifntcgyuhydl","content":"<blockquote>\n<p></p>\n</blockquote>\n<h1 id=\"\"></h1>\n<p><br>\nOpenGL ES 1.1OpenGL3<br>\nOpenGL ES 1.1ABC</p>\n<table>\n<thead>\n<tr>\n<th>RGB</th>\n<th></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>REPLACE</td>\n<td>A</td>\n</tr>\n<tr>\n<td>MODULATE</td>\n<td>AxB</td>\n</tr>\n<tr>\n<td>ADD</td>\n<td>A+B</td>\n</tr>\n<tr>\n<td>ADD_SIGNED</td>\n<td>A+B-0.5</td>\n</tr>\n<tr>\n<td>INTERPOLATE</td>\n<td>AxC+Bx(1-C)</td>\n</tr>\n<tr>\n<td>SUBTRACT</td>\n<td>A-B</td>\n</tr>\n<tr>\n<td>DOT3_RGB(and DOT3_RGBA)</td>\n<td>4x((A.r-0.5)x(B.r-0.5)+(A.g-0.5)x(B.g-0.5)+(A.b-0.5)x(B.b-0.5))</td>\n</tr>\n</tbody>\n</table>\n<p><br>\nOpenGL ESOpenGLMODULATEOpenGL ES 1.1</p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">glTexEnvi(GL_TEXTURE_ENV, GL_TEXTURE_ENV_MODE, GL_COMBINE);</span><br><span class=\"line\">glTexEnvi(GL_TEXTURE_ENV, GL_COMBINE_RGB, GL_MODULATE);</span><br><span class=\"line\">glTexEnvi(GL_TEXTURE_ENV, GL_SOURCE0_RGB, GL_PRIMARY_COLOR);</span><br><span class=\"line\">glTexEnvi(GL_TEXTURE_ENV, GL_SOURCE1_RGB, GL_TEXTURE);</span><br><span class=\"line\">glTexEnvi(GL_TEXTURE_ENV, GL_COMBINE_ALPHA, GL_MODULATE);</span><br><span class=\"line\">glTexEnvi(GL_TEXTURE_ENV, GL_SOURCE0_ALPHA, GL_PRIMARY_COLOR);</span><br><span class=\"line\">glTexEnvi(GL_TEXTURE_ENV, GL_SOURCE1_ALPHA, GL_TEXTURE);</span><br></pre></td></tr></table></figure>\n<p>AxBOpenGL ES 3.0</p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#version 300 es</span></span><br><span class=\"line\">precision mediump <span class=\"keyword\">float</span>;</span><br><span class=\"line\">uniform sampler2D s_tex0;</span><br><span class=\"line\"><span class=\"keyword\">in</span> vec2 v_texCoord;</span><br><span class=\"line\"><span class=\"keyword\">in</span> vec4 v_primaryColor;</span><br><span class=\"line\">layout(location = <span class=\"number\">0</span>) <span class=\"keyword\">out</span> vec4 outColor;</span><br><span class=\"line\"><span class=\"keyword\">void</span> main()</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    outColor = texture(s_tex0, v_texCoord) * v_primaryColor;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>02D<code>v_primaryColor</code><br>\n</p>\n<h1 id=\"\"></h1>\n<p></p>\n<ul>\n<li></li>\n<li></li>\n<li></li>\n<li><br>\n</li>\n</ul>\n<p><img src=\"/img/article/20190815/1.png\" alt=\"OpenGL ES 3.0\"></p>\n<h2 id=\"\"></h2>\n<p>OpenGL ES 3.0</p>\n<ul>\n<li><code>gl_FragCoord</code>(x, y, z, 1/w)</li>\n<li><code>gl_FrontFacing</code>truefalse</li>\n<li><code>gl_PointCoord</code>[0, 1]</li>\n<li><code>gl_FragDepth</code>GPUGPUEarly-ZEarly-Z<code>gl_FragDepth</code>GPU</li>\n</ul>\n<h2 id=\"\"></h2>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> mediump <span class=\"keyword\">int</span> gl_MaxFragmentInputVectors = <span class=\"number\">15</span>;</span><br><span class=\"line\"><span class=\"keyword\">const</span> mediump <span class=\"keyword\">int</span> gl_MaxTextureImageUnits = <span class=\"number\">16</span>;</span><br><span class=\"line\"><span class=\"keyword\">const</span> mediump <span class=\"keyword\">int</span> gl_MaxFragmentUniformVectors = <span class=\"number\">224</span>;</span><br><span class=\"line\"><span class=\"keyword\">const</span> mediump <span class=\"keyword\">int</span> gl_MaxDrawBuffers = <span class=\"number\">4</span>;</span><br><span class=\"line\"><span class=\"keyword\">const</span> mediump <span class=\"keyword\">int</span> gl_MinProgramTexelOffset = <span class=\"number\">-8</span>;</span><br><span class=\"line\"><span class=\"keyword\">const</span> mediump <span class=\"keyword\">int</span> gl_MaxProgramTexelOffset = <span class=\"number\">7</span>;</span><br></pre></td></tr></table></figure>\n<p></p>\n<ul>\n<li><code>gl_MaxFragmentInputVectors</code>ES 3.015</li>\n<li><code>gl_MaxTextureImageUnits</code>ES 3.015</li>\n<li><code>gl_MaxFragmentUniformVectors</code>vec4ES 3.0224vec4</li>\n<li><code>gl_MaxDrawBuffers</code>MRTES 3.04</li>\n<li><code>gl_MinProgramTexelOffset/gl_MaxProgramTexelOffset</code>ESSLtexture*Offset()<br>\nOpenGL ES 3.0API<code>gl_MaxTextureImageUnits</code><code>gl_MaxFragmentUniformVectors</code></li>\n</ul>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">GLint maxTextureImageUnits, maxFragmentUniformVectors;</span><br><span class=\"line\">glGetIntegerv(GL_MAX_TEXTURE_IMAGE_UNITS, &amp;maxTextureImageUnits);</span><br><span class=\"line\">glGetIntegerv(GL_MAX_FRAGMENT_UNIFORM_VECTORS, &amp;maxFragmentUniformVectors);</span><br></pre></td></tr></table></figure>\n<h1 id=\"\"></h1>\n<p>OpenGL ES 1.xOpenGLAPIAlphaOpenGL ES 3.0</p>\n<h2 id=\"\"></h2>\n<p>OpenGL ES</p>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#version 300 es</span></span><br><span class=\"line\">precision mediump <span class=\"keyword\">float</span>;</span><br><span class=\"line\"><span class=\"keyword\">in</span> vec2 v_texCoord;</span><br><span class=\"line\">layout(location = <span class=\"number\">0</span>) <span class=\"keyword\">out</span> vec4 outColor;</span><br><span class=\"line\">uniform sampler2D s_baseMap;</span><br><span class=\"line\">unifomr sampler2D s_lightMap;</span><br><span class=\"line\"><span class=\"keyword\">void</span> main()</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    vec4 baseColor;</span><br><span class=\"line\">    vec4 lightColor;</span><br><span class=\"line\">    baseColor = texture(s_baseMap, v_texCoord);</span><br><span class=\"line\">    lightColor = texture(s_lightMap, v_texCoord);</span><br><span class=\"line\">    <span class=\"comment\">// Add a 0.25 ambient light to the texture light color</span></span><br><span class=\"line\">    outColor = baseColor * (lightColor + <span class=\"number\">0.25</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// Bind the base map</span></span><br><span class=\"line\">glActiveTexture(GL_TEXTURE0);</span><br><span class=\"line\">glBindTexture(GL_TEXTURE_2D, baseMapTexId);</span><br><span class=\"line\"><span class=\"comment\">// Set the base map sampler to texture unit 0</span></span><br><span class=\"line\">glUniformli(baseMapLoc, <span class=\"number\">0</span>);</span><br><span class=\"line\"><span class=\"comment\">// Bind the light map</span></span><br><span class=\"line\">glActiveTexture(GL_TEXTURE1);</span><br><span class=\"line\">glBindTexture(GL_TEXTURE_2D, lightMapTexId);</span><br><span class=\"line\"><span class=\"comment\">// Set the light map sampler to texture unit 1</span></span><br><span class=\"line\">glUniform(lightMapLoc, <span class=\"number\">1</span>);</span><br></pre></td></tr></table></figure>\n<p>01</p>\n<h2 id=\"\"></h2>\n<blockquote>\n<p></p>\n</blockquote>\n<h2 id=\"alphadiscard\">AlphaDiscard</h2>\n<p>3DRGBARGBA<br>\nAlphaAlphaAlphaAlphaOpenGL ES 3.0Alpha<code>discard</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#version 300 es</span></span><br><span class=\"line\">precision mediump <span class=\"keyword\">float</span>;</span><br><span class=\"line\">uniform sampler2D baseMap;</span><br><span class=\"line\"><span class=\"keyword\">in</span> vec2 v_texCoord;</span><br><span class=\"line\">layout(location = <span class=\"number\">0</span>) <span class=\"keyword\">out</span> vec4 outColor;</span><br><span class=\"line\"><span class=\"keyword\">void</span> main()</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    vec4 baseColor = texture(baseMap, v_texCoord);</span><br><span class=\"line\">    <span class=\"comment\">// Discard all fragments with alpha value less than 0.25</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (baseColor.a &lt; <span class=\"number\">0.25</span>) &#123;</span><br><span class=\"line\">        discard;</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        outColor = baseColor;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>RGBAAlphaAlphaAlpha0.25<code>discard</code><br>\nAlphaAlpha</p>\n<h2 id=\"\"></h2>\n<blockquote>\n<p></p>\n</blockquote>\n<h1 id=\"\"></h1>\n<p>OpenGL ES 1.1</p>\n","site":{"data":{}},"excerpt":"","more":"<blockquote>\n<p></p>\n</blockquote>\n<h1></h1>\n<p><br>\nOpenGL ES 1.1OpenGL3<br>\nOpenGL ES 1.1ABC</p>\n<table>\n<thead>\n<tr>\n<th>RGB</th>\n<th></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>REPLACE</td>\n<td>A</td>\n</tr>\n<tr>\n<td>MODULATE</td>\n<td>AxB</td>\n</tr>\n<tr>\n<td>ADD</td>\n<td>A+B</td>\n</tr>\n<tr>\n<td>ADD_SIGNED</td>\n<td>A+B-0.5</td>\n</tr>\n<tr>\n<td>INTERPOLATE</td>\n<td>AxC+Bx(1-C)</td>\n</tr>\n<tr>\n<td>SUBTRACT</td>\n<td>A-B</td>\n</tr>\n<tr>\n<td>DOT3_RGB(and DOT3_RGBA)</td>\n<td>4x((A.r-0.5)x(B.r-0.5)+(A.g-0.5)x(B.g-0.5)+(A.b-0.5)x(B.b-0.5))</td>\n</tr>\n</tbody>\n</table>\n<p><br>\nOpenGL ESOpenGLMODULATEOpenGL ES 1.1</p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">glTexEnvi(GL_TEXTURE_ENV, GL_TEXTURE_ENV_MODE, GL_COMBINE);</span><br><span class=\"line\">glTexEnvi(GL_TEXTURE_ENV, GL_COMBINE_RGB, GL_MODULATE);</span><br><span class=\"line\">glTexEnvi(GL_TEXTURE_ENV, GL_SOURCE0_RGB, GL_PRIMARY_COLOR);</span><br><span class=\"line\">glTexEnvi(GL_TEXTURE_ENV, GL_SOURCE1_RGB, GL_TEXTURE);</span><br><span class=\"line\">glTexEnvi(GL_TEXTURE_ENV, GL_COMBINE_ALPHA, GL_MODULATE);</span><br><span class=\"line\">glTexEnvi(GL_TEXTURE_ENV, GL_SOURCE0_ALPHA, GL_PRIMARY_COLOR);</span><br><span class=\"line\">glTexEnvi(GL_TEXTURE_ENV, GL_SOURCE1_ALPHA, GL_TEXTURE);</span><br></pre></td></tr></table></figure>\n<p>AxBOpenGL ES 3.0</p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#version 300 es</span></span><br><span class=\"line\">precision mediump <span class=\"keyword\">float</span>;</span><br><span class=\"line\">uniform sampler2D s_tex0;</span><br><span class=\"line\"><span class=\"keyword\">in</span> vec2 v_texCoord;</span><br><span class=\"line\"><span class=\"keyword\">in</span> vec4 v_primaryColor;</span><br><span class=\"line\">layout(location = <span class=\"number\">0</span>) <span class=\"keyword\">out</span> vec4 outColor;</span><br><span class=\"line\"><span class=\"keyword\">void</span> main()</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    outColor = texture(s_tex0, v_texCoord) * v_primaryColor;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>02D<code>v_primaryColor</code><br>\n</p>\n<h1></h1>\n<p></p>\n<ul>\n<li></li>\n<li></li>\n<li></li>\n<li><br>\n</li>\n</ul>\n<p><img src=\"/img/article/20190815/1.png\" alt=\"OpenGL ES 3.0\"></p>\n<h2></h2>\n<p>OpenGL ES 3.0</p>\n<ul>\n<li><code>gl_FragCoord</code>(x, y, z, 1/w)</li>\n<li><code>gl_FrontFacing</code>truefalse</li>\n<li><code>gl_PointCoord</code>[0, 1]</li>\n<li><code>gl_FragDepth</code>GPUGPUEarly-ZEarly-Z<code>gl_FragDepth</code>GPU</li>\n</ul>\n<h2></h2>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> mediump <span class=\"keyword\">int</span> gl_MaxFragmentInputVectors = <span class=\"number\">15</span>;</span><br><span class=\"line\"><span class=\"keyword\">const</span> mediump <span class=\"keyword\">int</span> gl_MaxTextureImageUnits = <span class=\"number\">16</span>;</span><br><span class=\"line\"><span class=\"keyword\">const</span> mediump <span class=\"keyword\">int</span> gl_MaxFragmentUniformVectors = <span class=\"number\">224</span>;</span><br><span class=\"line\"><span class=\"keyword\">const</span> mediump <span class=\"keyword\">int</span> gl_MaxDrawBuffers = <span class=\"number\">4</span>;</span><br><span class=\"line\"><span class=\"keyword\">const</span> mediump <span class=\"keyword\">int</span> gl_MinProgramTexelOffset = <span class=\"number\">-8</span>;</span><br><span class=\"line\"><span class=\"keyword\">const</span> mediump <span class=\"keyword\">int</span> gl_MaxProgramTexelOffset = <span class=\"number\">7</span>;</span><br></pre></td></tr></table></figure>\n<p></p>\n<ul>\n<li><code>gl_MaxFragmentInputVectors</code>ES 3.015</li>\n<li><code>gl_MaxTextureImageUnits</code>ES 3.015</li>\n<li><code>gl_MaxFragmentUniformVectors</code>vec4ES 3.0224vec4</li>\n<li><code>gl_MaxDrawBuffers</code>MRTES 3.04</li>\n<li><code>gl_MinProgramTexelOffset/gl_MaxProgramTexelOffset</code>ESSLtexture*Offset()<br>\nOpenGL ES 3.0API<code>gl_MaxTextureImageUnits</code><code>gl_MaxFragmentUniformVectors</code></li>\n</ul>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">GLint maxTextureImageUnits, maxFragmentUniformVectors;</span><br><span class=\"line\">glGetIntegerv(GL_MAX_TEXTURE_IMAGE_UNITS, &amp;maxTextureImageUnits);</span><br><span class=\"line\">glGetIntegerv(GL_MAX_FRAGMENT_UNIFORM_VECTORS, &amp;maxFragmentUniformVectors);</span><br></pre></td></tr></table></figure>\n<h1></h1>\n<p>OpenGL ES 1.xOpenGLAPIAlphaOpenGL ES 3.0</p>\n<h2></h2>\n<p>OpenGL ES</p>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#version 300 es</span></span><br><span class=\"line\">precision mediump <span class=\"keyword\">float</span>;</span><br><span class=\"line\"><span class=\"keyword\">in</span> vec2 v_texCoord;</span><br><span class=\"line\">layout(location = <span class=\"number\">0</span>) <span class=\"keyword\">out</span> vec4 outColor;</span><br><span class=\"line\">uniform sampler2D s_baseMap;</span><br><span class=\"line\">unifomr sampler2D s_lightMap;</span><br><span class=\"line\"><span class=\"keyword\">void</span> main()</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    vec4 baseColor;</span><br><span class=\"line\">    vec4 lightColor;</span><br><span class=\"line\">    baseColor = texture(s_baseMap, v_texCoord);</span><br><span class=\"line\">    lightColor = texture(s_lightMap, v_texCoord);</span><br><span class=\"line\">    <span class=\"comment\">// Add a 0.25 ambient light to the texture light color</span></span><br><span class=\"line\">    outColor = baseColor * (lightColor + <span class=\"number\">0.25</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// Bind the base map</span></span><br><span class=\"line\">glActiveTexture(GL_TEXTURE0);</span><br><span class=\"line\">glBindTexture(GL_TEXTURE_2D, baseMapTexId);</span><br><span class=\"line\"><span class=\"comment\">// Set the base map sampler to texture unit 0</span></span><br><span class=\"line\">glUniformli(baseMapLoc, <span class=\"number\">0</span>);</span><br><span class=\"line\"><span class=\"comment\">// Bind the light map</span></span><br><span class=\"line\">glActiveTexture(GL_TEXTURE1);</span><br><span class=\"line\">glBindTexture(GL_TEXTURE_2D, lightMapTexId);</span><br><span class=\"line\"><span class=\"comment\">// Set the light map sampler to texture unit 1</span></span><br><span class=\"line\">glUniform(lightMapLoc, <span class=\"number\">1</span>);</span><br></pre></td></tr></table></figure>\n<p>01</p>\n<h2></h2>\n<blockquote>\n<p></p>\n</blockquote>\n<h2>AlphaDiscard</h2>\n<p>3DRGBARGBA<br>\nAlphaAlphaAlphaAlphaOpenGL ES 3.0Alpha<code>discard</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#version 300 es</span></span><br><span class=\"line\">precision mediump <span class=\"keyword\">float</span>;</span><br><span class=\"line\">uniform sampler2D baseMap;</span><br><span class=\"line\"><span class=\"keyword\">in</span> vec2 v_texCoord;</span><br><span class=\"line\">layout(location = <span class=\"number\">0</span>) <span class=\"keyword\">out</span> vec4 outColor;</span><br><span class=\"line\"><span class=\"keyword\">void</span> main()</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    vec4 baseColor = texture(baseMap, v_texCoord);</span><br><span class=\"line\">    <span class=\"comment\">// Discard all fragments with alpha value less than 0.25</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (baseColor.a &lt; <span class=\"number\">0.25</span>) &#123;</span><br><span class=\"line\">        discard;</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        outColor = baseColor;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>RGBAAlphaAlphaAlpha0.25<code>discard</code><br>\nAlphaAlpha</p>\n<h2></h2>\n<blockquote>\n<p></p>\n</blockquote>\n<h1></h1>\n<p>OpenGL ES 1.1</p>\n"},{"title":"OpenGL ES--","catalog":true,"toc_nav_num":true,"date":"2019-07-15T11:09:32.000Z","subtitle":"About OpenGL ES","header-img":"/img/article_header/article_header.png","busuanzi":true,"_content":"\n> OpenGL ES 3.0 APIOpenGL ES 3.0-GLSL\n\n# \n\nOpenGL ES 3.0OpenGL ES3.0\n``` objc\n#version 300 es\n```\nOpenGL ES1.001.00OpenGL ES 2.0OpenGL ES 3.0API1.003.00\n\n# \n\nOpenGL ES\n\n |  | \n-|-|-\n | float, int, uint, bool | \n | float, vec2, vec3, vec4 | 1234\n | int, ivec2, ivec3, ivec4 | 1234\n | uint, uvec2, uvec3, uvec4 | 1234\n | bool, bvec2, bvec3, bvec4 | 1234\n | mat2, mat3, mat4, max2x3, max3x2 | 2x2, 3x3, 4x4, 2x3, 3x2\n\n\n\n# \n\nOpenGL ES \n\n``` objc\nfloat myFloat = 1.0;\nbool myBool = true; \n\nmyFloat = Float(myBool);    // bool -> float\nmyBool = bool(myFloat);     // float -> bool\n```\n\n\n``` objc\nvec4 myVec4 = vec4(1.0);        // myVec4 = {1.0, 1.0, 1.0, 1.0}\nvec3 myVec3 = vec3(1.0, 0.0, 0.5);\n\nvec3 temp = vec3(myVec3);\nvec2 myVec2 = vec2(myVec3);     // myVec2 = {myVec3.x, myVec3.y}\n\nmyVec4 = vec4(myVec2, temp);   myVec4 = {myVec2.v, myVec2.y, temp.x, temp.y}\n```\n\n\n``` objc\n// \nmat3 myMat3 = mat3(1.0, 2.0, 3.0,\n                   4.0, 5.0, 6.0,\n                   7.0, 8.0, 9.0)\n// \n[1.0 4.0 7.0\n 2.0 5.0 8.0\n 3.0 6.0 9.0]\n```\n\n# \n\n.{x, y, z, w}{r, g, b, a}{s, t, p, q}\n\n``` objc\nvec3 myVec3 = vec3(0.0, 1.0, 2.0)\nvec3 temp;\n\ntemp = myVec3.xyz;      // temp = {0.0, 1.0, 2.0}\ntemp = myVec3.xxx;      // temp = {0.0, 0.0, 0.0}\ntemp = myVec3.zyx;      // temp = {2.0, 1.0, 0.0   }\n```\n\n \".\"  [0]  x [1]  y OpenGL ES 2.0  OpenGL ES 2.0  uniform \n\nmat2vec2mat33vec3[]\n\n``` objc\nmat4 myMat4 = mat4(1.0);\nvec4 col0 = myMat4[0];      // \nfloat m1_1 = myMat4[1][1];  // [1][1]\n```\n\n# \n\nconst\n\n``` objc\nconst float zero = 0.0;\nconst vec4 red = vec4(1.0, 0.0, 0.0, 1.0);\n```\nconst\n\n# \n\n\n\n``` objc\nstruct fogStruct {\n    vec4 color;\n    float start;\n    float end;\n} fogVar;\n\nfogVar = fogStruct(vec4(0.0, 1.0, 0.0, 0.0),    // color\n                   0.5,                         // start\n                   2.0);                        // end\n\nvec4 color = fogVar.color;\nfloat start = fogVar.start;\nfloat end = fogVar.end;\n```\n\n# \n\n\n\n``` objc\nfloat floatArray[4];\nvec4 vecArray[2];\n\nfloat a[4] = float[](1.0, 2.0, 3.0, 4.0);\nfloat b[4] = float[4](1.0, 2.0, 3.0, 4.0);\nvec2 c[2] = vec[2](vec2(1.0), vec2(1.0));\n```\n\n# \n\nC\n\n# \n\nC\n\n | \n-|-\nin | \ninout | \nout | \n\nGPUGPU\n\n# \n\n\n``` objc\n// Vertex shader output\nsmooth out vec3 v_color;\n\n// Fragment shader input\nsmooth in vec3 v_color\n```\n\n--\n``` objc\n// Vertex shader output\nflat out vec3 v_color;\n\n// Fragment shader input\nflat in vec3 v_color;\n```\n\n`centroid`centroid sampling`centroid`\n``` objc\n// Vertex shader output\nsmooth centroid out vec3 v_color;\n\n// Fragment shader input\nsmooth centroid in vec3 v_color;\n```\n\n# \n\nOpenGL ES\n> OpenGL ESOpenGL ES\nlowpmediumphighp\n\n``` objc\nhighp vec4 position;\nvarying lowp vec4 color;\nmediump float specularExp;\n```\n\n\n\n``` objc\nprecision highp float;\nprecision mediump int;\n```\n\nintfloathighpfloatfloat\n\n# \n\nOpenGL ES`invariant`AlphaZ fightingZ\n```\n#version 300 es\nuniform mat4 u_viewProjMatrix;\nlayout(location = 0) in vec4 a_vertex;\ninvariant gl_Position;\nvoid main() {\n    // will be the same value in all shaders with the same viewProjMatrix and vertex\n    gl_Position = u_viewProMatrix * a_vertex;\n}\n```\n`#pragma STDGL invariant(all)`\n\n> `invariant``#pragma`GPUOpenGL ES\n\n# \n\nOpenGL ES","source":"_posts/2019/opengl-es-glsl-0715.md","raw":"---\ntitle: \"OpenGL ES--\"\ncatalog: true\ntoc_nav_num: true\ndate: 2019-07-15 19:09:32\nsubtitle: \"About OpenGL ES\"\nheader-img: \"/img/article_header/article_header.png\"\nbusuanzi: true\ntags:\n- iOS\n\n---\n\n> OpenGL ES 3.0 APIOpenGL ES 3.0-GLSL\n\n# \n\nOpenGL ES 3.0OpenGL ES3.0\n``` objc\n#version 300 es\n```\nOpenGL ES1.001.00OpenGL ES 2.0OpenGL ES 3.0API1.003.00\n\n# \n\nOpenGL ES\n\n |  | \n-|-|-\n | float, int, uint, bool | \n | float, vec2, vec3, vec4 | 1234\n | int, ivec2, ivec3, ivec4 | 1234\n | uint, uvec2, uvec3, uvec4 | 1234\n | bool, bvec2, bvec3, bvec4 | 1234\n | mat2, mat3, mat4, max2x3, max3x2 | 2x2, 3x3, 4x4, 2x3, 3x2\n\n\n\n# \n\nOpenGL ES \n\n``` objc\nfloat myFloat = 1.0;\nbool myBool = true; \n\nmyFloat = Float(myBool);    // bool -> float\nmyBool = bool(myFloat);     // float -> bool\n```\n\n\n``` objc\nvec4 myVec4 = vec4(1.0);        // myVec4 = {1.0, 1.0, 1.0, 1.0}\nvec3 myVec3 = vec3(1.0, 0.0, 0.5);\n\nvec3 temp = vec3(myVec3);\nvec2 myVec2 = vec2(myVec3);     // myVec2 = {myVec3.x, myVec3.y}\n\nmyVec4 = vec4(myVec2, temp);   myVec4 = {myVec2.v, myVec2.y, temp.x, temp.y}\n```\n\n\n``` objc\n// \nmat3 myMat3 = mat3(1.0, 2.0, 3.0,\n                   4.0, 5.0, 6.0,\n                   7.0, 8.0, 9.0)\n// \n[1.0 4.0 7.0\n 2.0 5.0 8.0\n 3.0 6.0 9.0]\n```\n\n# \n\n.{x, y, z, w}{r, g, b, a}{s, t, p, q}\n\n``` objc\nvec3 myVec3 = vec3(0.0, 1.0, 2.0)\nvec3 temp;\n\ntemp = myVec3.xyz;      // temp = {0.0, 1.0, 2.0}\ntemp = myVec3.xxx;      // temp = {0.0, 0.0, 0.0}\ntemp = myVec3.zyx;      // temp = {2.0, 1.0, 0.0   }\n```\n\n \".\"  [0]  x [1]  y OpenGL ES 2.0  OpenGL ES 2.0  uniform \n\nmat2vec2mat33vec3[]\n\n``` objc\nmat4 myMat4 = mat4(1.0);\nvec4 col0 = myMat4[0];      // \nfloat m1_1 = myMat4[1][1];  // [1][1]\n```\n\n# \n\nconst\n\n``` objc\nconst float zero = 0.0;\nconst vec4 red = vec4(1.0, 0.0, 0.0, 1.0);\n```\nconst\n\n# \n\n\n\n``` objc\nstruct fogStruct {\n    vec4 color;\n    float start;\n    float end;\n} fogVar;\n\nfogVar = fogStruct(vec4(0.0, 1.0, 0.0, 0.0),    // color\n                   0.5,                         // start\n                   2.0);                        // end\n\nvec4 color = fogVar.color;\nfloat start = fogVar.start;\nfloat end = fogVar.end;\n```\n\n# \n\n\n\n``` objc\nfloat floatArray[4];\nvec4 vecArray[2];\n\nfloat a[4] = float[](1.0, 2.0, 3.0, 4.0);\nfloat b[4] = float[4](1.0, 2.0, 3.0, 4.0);\nvec2 c[2] = vec[2](vec2(1.0), vec2(1.0));\n```\n\n# \n\nC\n\n# \n\nC\n\n | \n-|-\nin | \ninout | \nout | \n\nGPUGPU\n\n# \n\n\n``` objc\n// Vertex shader output\nsmooth out vec3 v_color;\n\n// Fragment shader input\nsmooth in vec3 v_color\n```\n\n--\n``` objc\n// Vertex shader output\nflat out vec3 v_color;\n\n// Fragment shader input\nflat in vec3 v_color;\n```\n\n`centroid`centroid sampling`centroid`\n``` objc\n// Vertex shader output\nsmooth centroid out vec3 v_color;\n\n// Fragment shader input\nsmooth centroid in vec3 v_color;\n```\n\n# \n\nOpenGL ES\n> OpenGL ESOpenGL ES\nlowpmediumphighp\n\n``` objc\nhighp vec4 position;\nvarying lowp vec4 color;\nmediump float specularExp;\n```\n\n\n\n``` objc\nprecision highp float;\nprecision mediump int;\n```\n\nintfloathighpfloatfloat\n\n# \n\nOpenGL ES`invariant`AlphaZ fightingZ\n```\n#version 300 es\nuniform mat4 u_viewProjMatrix;\nlayout(location = 0) in vec4 a_vertex;\ninvariant gl_Position;\nvoid main() {\n    // will be the same value in all shaders with the same viewProjMatrix and vertex\n    gl_Position = u_viewProMatrix * a_vertex;\n}\n```\n`#pragma STDGL invariant(all)`\n\n> `invariant``#pragma`GPUOpenGL ES\n\n# \n\nOpenGL ES","slug":"2019/opengl-es-glsl-0715","published":1,"updated":"2021-06-21T12:34:52.094Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckszp3ndb000sifnt5rbgqlb9","content":"<blockquote>\n<p>OpenGL ES 3.0 APIOpenGL ES 3.0-GLSL</p>\n</blockquote>\n<h1 id=\"\"></h1>\n<p>OpenGL ES 3.0OpenGL ES3.0</p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#version 300 es</span></span><br></pre></td></tr></table></figure>\n<p>OpenGL ES1.001.00OpenGL ES 2.0OpenGL ES 3.0API1.003.00</p>\n<h1 id=\"\"></h1>\n<p>OpenGL ES</p>\n<table>\n<thead>\n<tr>\n<th></th>\n<th></th>\n<th></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td></td>\n<td>float, int, uint, bool</td>\n<td></td>\n</tr>\n<tr>\n<td></td>\n<td>float, vec2, vec3, vec4</td>\n<td>1234</td>\n</tr>\n<tr>\n<td></td>\n<td>int, ivec2, ivec3, ivec4</td>\n<td>1234</td>\n</tr>\n<tr>\n<td></td>\n<td>uint, uvec2, uvec3, uvec4</td>\n<td>1234</td>\n</tr>\n<tr>\n<td></td>\n<td>bool, bvec2, bvec3, bvec4</td>\n<td>1234</td>\n</tr>\n<tr>\n<td></td>\n<td>mat2, mat3, mat4, max2x3, max3x2</td>\n<td>2x2, 3x3, 4x4, 2x3, 3x2</td>\n</tr>\n</tbody>\n</table>\n<p></p>\n<h1 id=\"\"></h1>\n<p>OpenGL ES <br>\n</p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">float</span> myFloat = <span class=\"number\">1.0</span>;</span><br><span class=\"line\"><span class=\"keyword\">bool</span> myBool = <span class=\"literal\">true</span>; </span><br><span class=\"line\"></span><br><span class=\"line\">myFloat = Float(myBool);    <span class=\"comment\">// bool -&gt; float</span></span><br><span class=\"line\">myBool = <span class=\"keyword\">bool</span>(myFloat);     <span class=\"comment\">// float -&gt; bool</span></span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vec4 myVec4 = vec4(<span class=\"number\">1.0</span>);        <span class=\"comment\">// myVec4 = &#123;1.0, 1.0, 1.0, 1.0&#125;</span></span><br><span class=\"line\">vec3 myVec3 = vec3(<span class=\"number\">1.0</span>, <span class=\"number\">0.0</span>, <span class=\"number\">0.5</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">vec3 temp = vec3(myVec3);</span><br><span class=\"line\">vec2 myVec2 = vec2(myVec3);     <span class=\"comment\">// myVec2 = &#123;myVec3.x, myVec3.y&#125;</span></span><br><span class=\"line\"></span><br><span class=\"line\">myVec4 = vec4(myVec2, temp);   myVec4 = &#123;myVec2.v, myVec2.y, temp.x, temp.y&#125;</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\">mat3 myMat3 = mat3(<span class=\"number\">1.0</span>, <span class=\"number\">2.0</span>, <span class=\"number\">3.0</span>,</span><br><span class=\"line\">                   <span class=\"number\">4.0</span>, <span class=\"number\">5.0</span>, <span class=\"number\">6.0</span>,</span><br><span class=\"line\">                   <span class=\"number\">7.0</span>, <span class=\"number\">8.0</span>, <span class=\"number\">9.0</span>)</span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\">[<span class=\"number\">1.0</span> <span class=\"number\">4.0</span> <span class=\"number\">7.0</span></span><br><span class=\"line\"> <span class=\"number\">2.0</span> <span class=\"number\">5.0</span> <span class=\"number\">8.0</span></span><br><span class=\"line\"> <span class=\"number\">3.0</span> <span class=\"number\">6.0</span> <span class=\"number\">9.0</span>]</span><br></pre></td></tr></table></figure>\n<h1 id=\"\"></h1>\n<p>.{x, y, z, w}{r, g, b, a}{s, t, p, q}</p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vec3 myVec3 = vec3(<span class=\"number\">0.0</span>, <span class=\"number\">1.0</span>, <span class=\"number\">2.0</span>)</span><br><span class=\"line\">vec3 temp;</span><br><span class=\"line\"></span><br><span class=\"line\">temp = myVec3.xyz;      <span class=\"comment\">// temp = &#123;0.0, 1.0, 2.0&#125;</span></span><br><span class=\"line\">temp = myVec3.xxx;      <span class=\"comment\">// temp = &#123;0.0, 0.0, 0.0&#125;</span></span><br><span class=\"line\">temp = myVec3.zyx;      <span class=\"comment\">// temp = &#123;2.0, 1.0, 0.0   &#125;</span></span><br></pre></td></tr></table></figure>\n<p> .  [0]  x [1]  y OpenGL ES 2.0  OpenGL ES 2.0  uniform </p>\n<p>mat2vec2mat33vec3[]</p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mat4 myMat4 = mat4(<span class=\"number\">1.0</span>);</span><br><span class=\"line\">vec4 col0 = myMat4[<span class=\"number\">0</span>];      <span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">float</span> m1_1 = myMat4[<span class=\"number\">1</span>][<span class=\"number\">1</span>];  <span class=\"comment\">// [1][1]</span></span><br></pre></td></tr></table></figure>\n<h1 id=\"\"></h1>\n<p>const</p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"keyword\">float</span> zero = <span class=\"number\">0.0</span>;</span><br><span class=\"line\"><span class=\"keyword\">const</span> vec4 red = vec4(<span class=\"number\">1.0</span>, <span class=\"number\">0.0</span>, <span class=\"number\">0.0</span>, <span class=\"number\">1.0</span>);</span><br></pre></td></tr></table></figure>\n<p>const</p>\n<h1 id=\"\"></h1>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">struct</span> fogStruct &#123;</span><br><span class=\"line\">    vec4 color;</span><br><span class=\"line\">    <span class=\"keyword\">float</span> start;</span><br><span class=\"line\">    <span class=\"keyword\">float</span> end;</span><br><span class=\"line\">&#125; fogVar;</span><br><span class=\"line\"></span><br><span class=\"line\">fogVar = fogStruct(vec4(<span class=\"number\">0.0</span>, <span class=\"number\">1.0</span>, <span class=\"number\">0.0</span>, <span class=\"number\">0.0</span>),    <span class=\"comment\">// color</span></span><br><span class=\"line\">                   <span class=\"number\">0.5</span>,                         <span class=\"comment\">// start</span></span><br><span class=\"line\">                   <span class=\"number\">2.0</span>);                        <span class=\"comment\">// end</span></span><br><span class=\"line\"></span><br><span class=\"line\">vec4 color = fogVar.color;</span><br><span class=\"line\"><span class=\"keyword\">float</span> start = fogVar.start;</span><br><span class=\"line\"><span class=\"keyword\">float</span> end = fogVar.end;</span><br></pre></td></tr></table></figure>\n<h1 id=\"\"></h1>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">float</span> floatArray[<span class=\"number\">4</span>];</span><br><span class=\"line\">vec4 vecArray[<span class=\"number\">2</span>];</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">float</span> a[<span class=\"number\">4</span>] = <span class=\"keyword\">float</span>[](<span class=\"number\">1.0</span>, <span class=\"number\">2.0</span>, <span class=\"number\">3.0</span>, <span class=\"number\">4.0</span>);</span><br><span class=\"line\"><span class=\"keyword\">float</span> b[<span class=\"number\">4</span>] = <span class=\"keyword\">float</span>[<span class=\"number\">4</span>](<span class=\"number\">1.0</span>, <span class=\"number\">2.0</span>, <span class=\"number\">3.0</span>, <span class=\"number\">4.0</span>);</span><br><span class=\"line\">vec2 c[<span class=\"number\">2</span>] = vec[<span class=\"number\">2</span>](vec2(<span class=\"number\">1.0</span>), vec2(<span class=\"number\">1.0</span>));</span><br></pre></td></tr></table></figure>\n<h1 id=\"\"></h1>\n<p>C</p>\n<h1 id=\"\"></h1>\n<p>C</p>\n<table>\n<thead>\n<tr>\n<th></th>\n<th></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>in</td>\n<td></td>\n</tr>\n<tr>\n<td>inout</td>\n<td></td>\n</tr>\n<tr>\n<td>out</td>\n<td></td>\n</tr>\n</tbody>\n</table>\n<p>GPUGPU</p>\n<h1 id=\"\"></h1>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// Vertex shader output</span></span><br><span class=\"line\">smooth <span class=\"keyword\">out</span> vec3 v_color;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// Fragment shader input</span></span><br><span class=\"line\">smooth <span class=\"keyword\">in</span> vec3 v_color</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// Vertex shader output</span></span><br><span class=\"line\">flat <span class=\"keyword\">out</span> vec3 v_color;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// Fragment shader input</span></span><br><span class=\"line\">flat <span class=\"keyword\">in</span> vec3 v_color;</span><br></pre></td></tr></table></figure>\n<p><code>centroid</code>centroid sampling<code>centroid</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// Vertex shader output</span></span><br><span class=\"line\">smooth centroid <span class=\"keyword\">out</span> vec3 v_color;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// Fragment shader input</span></span><br><span class=\"line\">smooth centroid <span class=\"keyword\">in</span> vec3 v_color;</span><br></pre></td></tr></table></figure>\n<h1 id=\"\"></h1>\n<p>OpenGL ES</p>\n<blockquote>\n<p>OpenGL ESOpenGL ES<br>\nlowpmediumphighp</p>\n</blockquote>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">highp vec4 position;</span><br><span class=\"line\">varying lowp vec4 color;</span><br><span class=\"line\">mediump <span class=\"keyword\">float</span> specularExp;</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">precision highp <span class=\"keyword\">float</span>;</span><br><span class=\"line\">precision mediump <span class=\"keyword\">int</span>;</span><br></pre></td></tr></table></figure>\n<p>intfloathighpfloatfloat</p>\n<h1 id=\"\"></h1>\n<p>OpenGL ES<code>invariant</code>AlphaZ fightingZ</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#version 300 es</span><br><span class=\"line\">uniform mat4 u_viewProjMatrix;</span><br><span class=\"line\">layout(location = 0) in vec4 a_vertex;</span><br><span class=\"line\">invariant gl_Position;</span><br><span class=\"line\">void main() &#123;</span><br><span class=\"line\">    // will be the same value in all shaders with the same viewProjMatrix and vertex</span><br><span class=\"line\">    gl_Position = u_viewProMatrix * a_vertex;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><code>#pragma STDGL invariant(all)</code></p>\n<blockquote>\n<p><code>invariant</code><code>#pragma</code>GPUOpenGL ES</p>\n</blockquote>\n<h1 id=\"\"></h1>\n<p>OpenGL ES</p>\n","site":{"data":{}},"excerpt":"","more":"<blockquote>\n<p>OpenGL ES 3.0 APIOpenGL ES 3.0-GLSL</p>\n</blockquote>\n<h1></h1>\n<p>OpenGL ES 3.0OpenGL ES3.0</p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#version 300 es</span></span><br></pre></td></tr></table></figure>\n<p>OpenGL ES1.001.00OpenGL ES 2.0OpenGL ES 3.0API1.003.00</p>\n<h1></h1>\n<p>OpenGL ES</p>\n<table>\n<thead>\n<tr>\n<th></th>\n<th></th>\n<th></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td></td>\n<td>float, int, uint, bool</td>\n<td></td>\n</tr>\n<tr>\n<td></td>\n<td>float, vec2, vec3, vec4</td>\n<td>1234</td>\n</tr>\n<tr>\n<td></td>\n<td>int, ivec2, ivec3, ivec4</td>\n<td>1234</td>\n</tr>\n<tr>\n<td></td>\n<td>uint, uvec2, uvec3, uvec4</td>\n<td>1234</td>\n</tr>\n<tr>\n<td></td>\n<td>bool, bvec2, bvec3, bvec4</td>\n<td>1234</td>\n</tr>\n<tr>\n<td></td>\n<td>mat2, mat3, mat4, max2x3, max3x2</td>\n<td>2x2, 3x3, 4x4, 2x3, 3x2</td>\n</tr>\n</tbody>\n</table>\n<p></p>\n<h1></h1>\n<p>OpenGL ES <br>\n</p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">float</span> myFloat = <span class=\"number\">1.0</span>;</span><br><span class=\"line\"><span class=\"keyword\">bool</span> myBool = <span class=\"literal\">true</span>; </span><br><span class=\"line\"></span><br><span class=\"line\">myFloat = Float(myBool);    <span class=\"comment\">// bool -&gt; float</span></span><br><span class=\"line\">myBool = <span class=\"keyword\">bool</span>(myFloat);     <span class=\"comment\">// float -&gt; bool</span></span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vec4 myVec4 = vec4(<span class=\"number\">1.0</span>);        <span class=\"comment\">// myVec4 = &#123;1.0, 1.0, 1.0, 1.0&#125;</span></span><br><span class=\"line\">vec3 myVec3 = vec3(<span class=\"number\">1.0</span>, <span class=\"number\">0.0</span>, <span class=\"number\">0.5</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">vec3 temp = vec3(myVec3);</span><br><span class=\"line\">vec2 myVec2 = vec2(myVec3);     <span class=\"comment\">// myVec2 = &#123;myVec3.x, myVec3.y&#125;</span></span><br><span class=\"line\"></span><br><span class=\"line\">myVec4 = vec4(myVec2, temp);   myVec4 = &#123;myVec2.v, myVec2.y, temp.x, temp.y&#125;</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\">mat3 myMat3 = mat3(<span class=\"number\">1.0</span>, <span class=\"number\">2.0</span>, <span class=\"number\">3.0</span>,</span><br><span class=\"line\">                   <span class=\"number\">4.0</span>, <span class=\"number\">5.0</span>, <span class=\"number\">6.0</span>,</span><br><span class=\"line\">                   <span class=\"number\">7.0</span>, <span class=\"number\">8.0</span>, <span class=\"number\">9.0</span>)</span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\">[<span class=\"number\">1.0</span> <span class=\"number\">4.0</span> <span class=\"number\">7.0</span></span><br><span class=\"line\"> <span class=\"number\">2.0</span> <span class=\"number\">5.0</span> <span class=\"number\">8.0</span></span><br><span class=\"line\"> <span class=\"number\">3.0</span> <span class=\"number\">6.0</span> <span class=\"number\">9.0</span>]</span><br></pre></td></tr></table></figure>\n<h1></h1>\n<p>.{x, y, z, w}{r, g, b, a}{s, t, p, q}</p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vec3 myVec3 = vec3(<span class=\"number\">0.0</span>, <span class=\"number\">1.0</span>, <span class=\"number\">2.0</span>)</span><br><span class=\"line\">vec3 temp;</span><br><span class=\"line\"></span><br><span class=\"line\">temp = myVec3.xyz;      <span class=\"comment\">// temp = &#123;0.0, 1.0, 2.0&#125;</span></span><br><span class=\"line\">temp = myVec3.xxx;      <span class=\"comment\">// temp = &#123;0.0, 0.0, 0.0&#125;</span></span><br><span class=\"line\">temp = myVec3.zyx;      <span class=\"comment\">// temp = &#123;2.0, 1.0, 0.0   &#125;</span></span><br></pre></td></tr></table></figure>\n<p> .  [0]  x [1]  y OpenGL ES 2.0  OpenGL ES 2.0  uniform </p>\n<p>mat2vec2mat33vec3[]</p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mat4 myMat4 = mat4(<span class=\"number\">1.0</span>);</span><br><span class=\"line\">vec4 col0 = myMat4[<span class=\"number\">0</span>];      <span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">float</span> m1_1 = myMat4[<span class=\"number\">1</span>][<span class=\"number\">1</span>];  <span class=\"comment\">// [1][1]</span></span><br></pre></td></tr></table></figure>\n<h1></h1>\n<p>const</p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"keyword\">float</span> zero = <span class=\"number\">0.0</span>;</span><br><span class=\"line\"><span class=\"keyword\">const</span> vec4 red = vec4(<span class=\"number\">1.0</span>, <span class=\"number\">0.0</span>, <span class=\"number\">0.0</span>, <span class=\"number\">1.0</span>);</span><br></pre></td></tr></table></figure>\n<p>const</p>\n<h1></h1>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">struct</span> fogStruct &#123;</span><br><span class=\"line\">    vec4 color;</span><br><span class=\"line\">    <span class=\"keyword\">float</span> start;</span><br><span class=\"line\">    <span class=\"keyword\">float</span> end;</span><br><span class=\"line\">&#125; fogVar;</span><br><span class=\"line\"></span><br><span class=\"line\">fogVar = fogStruct(vec4(<span class=\"number\">0.0</span>, <span class=\"number\">1.0</span>, <span class=\"number\">0.0</span>, <span class=\"number\">0.0</span>),    <span class=\"comment\">// color</span></span><br><span class=\"line\">                   <span class=\"number\">0.5</span>,                         <span class=\"comment\">// start</span></span><br><span class=\"line\">                   <span class=\"number\">2.0</span>);                        <span class=\"comment\">// end</span></span><br><span class=\"line\"></span><br><span class=\"line\">vec4 color = fogVar.color;</span><br><span class=\"line\"><span class=\"keyword\">float</span> start = fogVar.start;</span><br><span class=\"line\"><span class=\"keyword\">float</span> end = fogVar.end;</span><br></pre></td></tr></table></figure>\n<h1></h1>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">float</span> floatArray[<span class=\"number\">4</span>];</span><br><span class=\"line\">vec4 vecArray[<span class=\"number\">2</span>];</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">float</span> a[<span class=\"number\">4</span>] = <span class=\"keyword\">float</span>[](<span class=\"number\">1.0</span>, <span class=\"number\">2.0</span>, <span class=\"number\">3.0</span>, <span class=\"number\">4.0</span>);</span><br><span class=\"line\"><span class=\"keyword\">float</span> b[<span class=\"number\">4</span>] = <span class=\"keyword\">float</span>[<span class=\"number\">4</span>](<span class=\"number\">1.0</span>, <span class=\"number\">2.0</span>, <span class=\"number\">3.0</span>, <span class=\"number\">4.0</span>);</span><br><span class=\"line\">vec2 c[<span class=\"number\">2</span>] = vec[<span class=\"number\">2</span>](vec2(<span class=\"number\">1.0</span>), vec2(<span class=\"number\">1.0</span>));</span><br></pre></td></tr></table></figure>\n<h1></h1>\n<p>C</p>\n<h1></h1>\n<p>C</p>\n<table>\n<thead>\n<tr>\n<th></th>\n<th></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>in</td>\n<td></td>\n</tr>\n<tr>\n<td>inout</td>\n<td></td>\n</tr>\n<tr>\n<td>out</td>\n<td></td>\n</tr>\n</tbody>\n</table>\n<p>GPUGPU</p>\n<h1></h1>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// Vertex shader output</span></span><br><span class=\"line\">smooth <span class=\"keyword\">out</span> vec3 v_color;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// Fragment shader input</span></span><br><span class=\"line\">smooth <span class=\"keyword\">in</span> vec3 v_color</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// Vertex shader output</span></span><br><span class=\"line\">flat <span class=\"keyword\">out</span> vec3 v_color;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// Fragment shader input</span></span><br><span class=\"line\">flat <span class=\"keyword\">in</span> vec3 v_color;</span><br></pre></td></tr></table></figure>\n<p><code>centroid</code>centroid sampling<code>centroid</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// Vertex shader output</span></span><br><span class=\"line\">smooth centroid <span class=\"keyword\">out</span> vec3 v_color;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// Fragment shader input</span></span><br><span class=\"line\">smooth centroid <span class=\"keyword\">in</span> vec3 v_color;</span><br></pre></td></tr></table></figure>\n<h1></h1>\n<p>OpenGL ES</p>\n<blockquote>\n<p>OpenGL ESOpenGL ES<br>\nlowpmediumphighp</p>\n</blockquote>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">highp vec4 position;</span><br><span class=\"line\">varying lowp vec4 color;</span><br><span class=\"line\">mediump <span class=\"keyword\">float</span> specularExp;</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">precision highp <span class=\"keyword\">float</span>;</span><br><span class=\"line\">precision mediump <span class=\"keyword\">int</span>;</span><br></pre></td></tr></table></figure>\n<p>intfloathighpfloatfloat</p>\n<h1></h1>\n<p>OpenGL ES<code>invariant</code>AlphaZ fightingZ</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#version 300 es</span><br><span class=\"line\">uniform mat4 u_viewProjMatrix;</span><br><span class=\"line\">layout(location = 0) in vec4 a_vertex;</span><br><span class=\"line\">invariant gl_Position;</span><br><span class=\"line\">void main() &#123;</span><br><span class=\"line\">    // will be the same value in all shaders with the same viewProjMatrix and vertex</span><br><span class=\"line\">    gl_Position = u_viewProMatrix * a_vertex;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><code>#pragma STDGL invariant(all)</code></p>\n<blockquote>\n<p><code>invariant</code><code>#pragma</code>GPUOpenGL ES</p>\n</blockquote>\n<h1></h1>\n<p>OpenGL ES</p>\n"},{"title":"OpenGL ES--","catalog":true,"toc_nav_num":true,"date":"2019-09-02T09:30:54.000Z","subtitle":"About OpenGL ES","header-img":"/img/article_header/article_header.png","busuanzi":true,"_content":"\n# \n\nRedGreenBlueRGB\nReflectedAbsorb\nOpenGL\n\n``` objc\nvec3 lightColor = vec3(1.0f, 1.0f, 1.0f);\nvec3 toyColor = vec3(1.0f, 0.5f, 0.3f);\nvec3 result = lightColor * toyColor;    // = (1.0f, 0.5f, 0.3f)\n```\n\n\n\n``` objc\nvec3 lightColor = vec3(0.0f, 1.0f, 0.0f);\nvec3 toyColor = vec3(1.0f, 0.5f, 0.3f);\nvec3 result = lightColor * toyColor;    // = (0.0f, 0.5f, 0.0f)\n```\n\n\n\n# \n\n--3D\n\n\n\n``` objc\nNSString *objectVertexShaderString = @\" \\\n#version 300 es \\\nlayout(location = 0) in vec3 a_position; \\\nuniform mat4 modelMatrix; \\\nuniform mat4 viewMatrix; \\\nuniform mat4 projectionMatrix; \\\nvoid main() { \\\ngl_Position = projectionMatrix * viewMatrix * modelMatrix * vec4(a_position, 1.0); \\\n}\";\nNSString *objectFragmentShaderString = @\"\\\n#version 300 es \\\nprecision mediump float; \\\nuniform vec3 objectColor; \\\nout vec4 fragColor; \\\nvoid main() { \\\nfragColor = vec4(objectColor, 1.0); \\\n}\";\n\nNSString *lightVertexShaderString = @\" \\\n#version 300 es \\\nlayout(location = 0) in vec3 a_position; \\\nuniform mat4 modelMatrix; \\\nuniform mat4 viewMatrix; \\\nuniform mat4 projectionMatrix; \\\nvoid main() { \\\ngl_Position = projectionMatrix * viewMatrix * modelMatrix * vec4(a_position, 1.0); \\\n}\";\nNSString *lightFragmentShaderString = @\"\\\n#version 300 es \\\nprecision mediump float; \\\nout vec4 fragColor; \\\nvoid main() { \\\nfragColor = vec4(1.0); \\\n}\";\n```\n\n\n\n``` objc\n- (void)setupVertices {\n    ...\n    \n    ...\n    // \n    glGenVertexArrays(1, &vao);\n    glBindVertexArray(vao);\n    glEnableVertexAttribArray(0);\n    glVertexAttribPointer(0, 3, GL_FLOAT, GL_FALSE, sizeof(GLfloat)*6, 0);\n    glEnableVertexAttribArray(1);\n    glVertexAttribPointer(1, 3, GL_FLOAT, GL_FALSE, sizeof(GLfloat)*6, (GLvoid *)(sizeof(GLfloat)*3));\n    glBindVertexArray(0);\n\n    // \n    glGenVertexArrays(1, &lightvao);\n    glBindVertexArray(lightvao);\n    glEnableVertexAttribArray(0);\n    glVertexAttribPointer(0, 3, GL_FLOAT, GL_FALSE, sizeof(GLfloat)*6, 0);\n    glBindVertexArray(0);\n}\n\n- (void)glkView:(GLKView *)view drawInRect:(CGRect)rect {\n    glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);\n    glClearColor(0.0f, 0.0f, 0.0f, 1.0f);\n    \n    glUseProgram(program1);\n    \n    glBindVertexArray(vao);\n    glDrawArrays(GL_TRIANGLES, 0, 36);\n    \n    float aspect = self.view.frame.size.width / self.view.frame.size.height;\n    GLKMatrix4 modelMatrix = GLKMatrix4MakeTranslation(-0.3f, 0.2f, 1.0f);\n    GLKMatrix4 viewMatrix = GLKMatrix4MakeLookAt(-3.5f, 2.0f, 4.0f, 0.5f, 0.0f, 0.0f, 0.0f, 1.0f, 0.0f);\n    GLKMatrix4 projectionMatrx = GLKMatrix4MakePerspective(GLKMathDegreesToRadians(45), aspect, 0.1, 100.0);\n    glUniformMatrix4fv(modelLocation, 1, GL_FALSE, modelMatrix.m);\n    glUniformMatrix4fv(viewLocation, 1, GL_FALSE, viewMatrix.m);\n    glUniformMatrix4fv(projectionLocation, 1, GL_FALSE, projectionMatrx.m);\n    glUniform3f(objectLocation, 1.0f, 0.5f, 0.3f);  // objct color\n    \n    glUseProgram(program2);\n    glBindVertexArray(lightvao);\n    glDrawArrays(GL_TRIANGLES, 0, 36);\n    \n    GLKMatrix4 translateMatrix2 = GLKMatrix4MakeTranslation(3.0f, 6.6f, 2.5f);\n    GLKMatrix4 scaleMatrix2 = GLKMatrix4MakeScale(0.2f, 0.2f, 0.2f);\n    GLKMatrix4 modelMatrix2 = GLKMatrix4Multiply(scaleMatrix2, translateMatrix2);\n    glUniformMatrix4fv(modelLocation2, 1, GL_FALSE, modelMatrix2.m);\n    glUniformMatrix4fv(viewLocation2, 1, GL_FALSE, viewMatrix.m);\n    glUniformMatrix4fv(projectionLocation2, 1, GL_FALSE, projectionMatrx.m);\n}\n```\n\n\n\n![](/img/article/20190902/1.png)\n\n# \n\nOpenGLPhong Lighting Model3AmbientDiffuseSpecular\n\n![](/img/article/20190902/2.png)\n\n- Ambient Lighting\n- Diffuse LightingDirectional Impact\n- Specular Lighting\n\n# \n\nGlobal Illumination\n\n\n\n\n\n``` objc\nNSString *objectFragmentShaderString = @\"\\\n#version 300 es \\\nprecision mediump float; \\\nuniform vec3 objectColor; \\\nuniform vec3 lightColor; \\\nout vec4 fragColor; \\\nvoid main() { \\\nfloat ambientStrength = 0.1; \\\nvec3 ambient = ambientStrength * lightColor; \\\nvec3 result = ambient * objectColor; \\\nfragColor = vec4(result, 1.0); \\\n}\";\n```\n\n\n\n![](/img/article/20190902/3.png)\n\n# \n\n\n\n![](/img/article/20190902/4.png)\n\n\n\n1900\n\n> 1\n\n\n\n\n- \n- \n\n# \n\n3D\n\n``` objc\nglFloat vertices[] = {\n    -0.5f, -0.5f, -0.5f,  0.0f,  0.0f, -1.0f,\n    0.5f, -0.5f, -0.5f,  0.0f,  0.0f, -1.0f,\n    0.5f,  0.5f, -0.5f,  0.0f,  0.0f, -1.0f,\n    0.5f,  0.5f, -0.5f,  0.0f,  0.0f, -1.0f,\n    -0.5f,  0.5f, -0.5f,  0.0f,  0.0f, -1.0f,\n    -0.5f, -0.5f, -0.5f,  0.0f,  0.0f, -1.0f,\n    \n    -0.5f, -0.5f,  0.5f,  0.0f,  0.0f, 1.0f,\n    0.5f, -0.5f,  0.5f,  0.0f,  0.0f, 1.0f,\n    0.5f,  0.5f,  0.5f,  0.0f,  0.0f, 1.0f,\n    0.5f,  0.5f,  0.5f,  0.0f,  0.0f, 1.0f,\n    -0.5f,  0.5f,  0.5f,  0.0f,  0.0f, 1.0f,\n    -0.5f, -0.5f,  0.5f,  0.0f,  0.0f, 1.0f,\n    \n    -0.5f,  0.5f,  0.5f, -1.0f,  0.0f,  0.0f,\n    -0.5f,  0.5f, -0.5f, -1.0f,  0.0f,  0.0f,\n    -0.5f, -0.5f, -0.5f, -1.0f,  0.0f,  0.0f,\n    -0.5f, -0.5f, -0.5f, -1.0f,  0.0f,  0.0f,\n    -0.5f, -0.5f,  0.5f, -1.0f,  0.0f,  0.0f,\n    -0.5f,  0.5f,  0.5f, -1.0f,  0.0f,  0.0f,\n    \n    0.5f,  0.5f,  0.5f,  1.0f,  0.0f,  0.0f,\n    0.5f,  0.5f, -0.5f,  1.0f,  0.0f,  0.0f,\n    0.5f, -0.5f, -0.5f,  1.0f,  0.0f,  0.0f,\n    0.5f, -0.5f, -0.5f,  1.0f,  0.0f,  0.0f,\n    0.5f, -0.5f,  0.5f,  1.0f,  0.0f,  0.0f,\n    0.5f,  0.5f,  0.5f,  1.0f,  0.0f,  0.0f,\n    \n    -0.5f, -0.5f, -0.5f,  0.0f, -1.0f,  0.0f,\n    0.5f, -0.5f, -0.5f,  0.0f, -1.0f,  0.0f,\n    0.5f, -0.5f,  0.5f,  0.0f, -1.0f,  0.0f,\n    0.5f, -0.5f,  0.5f,  0.0f, -1.0f,  0.0f,\n    -0.5f, -0.5f,  0.5f,  0.0f, -1.0f,  0.0f,\n    -0.5f, -0.5f, -0.5f,  0.0f, -1.0f,  0.0f,\n    \n    -0.5f,  0.5f, -0.5f,  0.0f,  1.0f,  0.0f,\n    0.5f,  0.5f, -0.5f,  0.0f,  1.0f,  0.0f,\n    0.5f,  0.5f,  0.5f,  0.0f,  1.0f,  0.0f,\n    0.5f,  0.5f,  0.5f,  0.0f,  1.0f,  0.0f,\n    -0.5f,  0.5f,  0.5f,  0.0f,  1.0f,  0.0f,\n    -0.5f,  0.5f, -0.5f,  0.0f,  1.0f,  0.0f\n};\n```\n\n\n\n``` objc\nNSString *vertexShaderString = @\" \\\n#version 300 es \\\nlayout(location = 0) in vec3 a_position; \\\nlayout(location = 1) in vec3 a_normal; \\\nuniform mat4 modelMatrix; \\\nuniform mat4 viewMatrix; \\\nuniform mat4 projectionMatrix; \\\nout vec3 v_normal; \\\nvoid main() { \\\nv_normal = a_normal; \\\ngl_Position = projectionMatrix * viewMatrix * modelMatrix * vec4(a_position, 1.0); \\\n}\";\n```\n\n# \n\n`uniform`\n\n``` objc\nuniform vec3 lightPos;\n```\n\n\n\n``` objc\nNSString *vertexShaderString = @\" \\\n#version 300 es \\\nlayout(location = 0) in vec3 a_position; \\\nlayout(location = 1) in vec3 a_normal; \\\nuniform mat4 modelMatrix; \\\nuniform mat4 viewMatrix; \\\nuniform mat4 projectionMatrix; \\\nout vec3 v_normal; \\\nout vec3 FragPos; \\\nvoid main() { \\\nFragPos = vec3(modelMatrix * vec4(a_position, 1.0)); \\\nv_normal = a_normal; \\\ngl_Position = projectionMatrix * viewMatrix * modelMatrix * vec4(a_position, 1.0); \\\n}\";\n```\n\n`FragPos`\n\n\n\n``` objc\nvec3 norm = normalize(v_normal);\nvec3 lightDir = normalize(lightPos - FragPos);\n```\n\n> \n\n`norm``lightDir`\n\n``` objc\nfloat diff = max(dot(norm, lightDir), 0.0);\nvec3 diffuse = diff * lightColor;\n```\n\n90`max`\n\n\n\n``` objc\nvec3 result = (ambient + diffuse) * objectColor;\nFragColor = vec4(result, 1.0);\n```\n\n\n\n``` objc\nNSString *fragmentShaderString = @\"\\\n#version 300 es \\\nprecision mediump float; \\\nuniform vec3 objectColor; \\\nuniform vec3 lightColor; \\\nuniform vec3 lightPos; \\\nin vec3 FragPos; \\\nin vec3 v_normal; \\\nout vec4 fragColor; \\\nvoid main() { \\\nfloat ambientStrength = 0.1; \\\nvec3 ambient = ambientStrength * lightColor; \\\nvec3 norm = normalize(v_normal); \\\nvec3 lightDir = normalize(lightPos - FragPos); \\\nfloat diff = max(dot(norm, lightDir), 0.0); \\\nvec3 diffuse = diff * lightColor; \\\nvec3 result = (ambient + diffuse) * objectColor; \\\nfragColor = vec4(result, 1.0); \\\n}\";\n```\n\n\n\n![](/img/article/20190902/5.png)\n\n# ...\n\n\n\nw3x3w04x4\n\n\n\n![](/img/article/20190902/6.png)\n\n\n\n\n\n-\n\n`inverse``transpose`3x3`vec3`\n\n``` objc\nv_normal = mat3(transpose(inverse(model)))* a_normal;\n```\n\n\n\n> CPUuniform\n\n# \n\n\n\n\n\n![](/img/article/20190902/7.png)\n\n\n\n\n\n`uniform`\n\n``` objc\nuniform vec3 viewPos;\n```\n\n\n\n``` objc\nfloat specularStrength = 0.5;\n```\n\n1.0f\n\n``` objc\nvec3 viewDir = normalize(viewPos - FragPos);\nvec3 reflectDir = reflect(-lightDir, norm);\n```\n\n`lightDir``reflect``lightDir``reflect``lightDir``norm`\n\n\n\n``` objc\nfloat spec = pow(max(dot(viewDir, reflectDir), 0.0), 32.0);\nvec3 specular = specularStrength * spec * lightColor;\n```\n\n3232\n\n![](/img/article/20190902/8.png)\n\n\n\n``` objc\nvec3 result = (ambient + diffuse + specular) * objectColor;\nFragColor = vec4(result, 1.0);\n```\n\n\n\n``` objc\nNSString *fragmentShaderString = @\"\\\n#version 300 es \\\nprecision mediump float; \\\nuniform vec3 objectColor; \\\nuniform vec3 lightColor; \\\nuniform vec3 lightPos; \\\nuniform vec3 viewPos; \\\nin vec3 FragPos; \\\nin vec3 v_normal; \\\nout vec4 fragColor; \\\nvoid main() { \\\nfloat ambientStrength = 0.1; \\\nvec3 ambient = ambientStrength * lightColor; \\\nvec3 norm = normalize(v_normal); \\\nvec3 lightDir = normalize(lightPos - FragPos); \\\nfloat diff = max(dot(norm, lightDir), 0.0); \\\nvec3 diffuse = diff * lightColor; \\\nfloat specularStrength = 0.5; \\\nvec3 viewDir = normalize(viewPos - FragPos); \\\nvec3 reflectDir = reflect(-lightDir, norm); \\\nfloat spec = pow(max(dot(viewDir, reflectDir), 0.0), 32.0); \\\nvec3 specular = specularStrength * spec * lightColor; \\\nvec3 result = (ambient + diffuse + specular) * objectColor; \\\nfragColor = vec4(result, 1.0); \\\n}\";\n```\n\n\n\n![](/img/article/20190902/9.png)\n\n> \n\n# \n\n","source":"_posts/2019/opengl-es-illuminate-0902.md","raw":"---\ntitle: \"OpenGL ES--\"\ncatalog: true\ntoc_nav_num: true\ndate: 2019-09-02 17:30:54\nsubtitle: \"About OpenGL ES\"\nheader-img: \"/img/article_header/article_header.png\"\nbusuanzi: true\ntags:\n- iOS\n\n---\n\n# \n\nRedGreenBlueRGB\nReflectedAbsorb\nOpenGL\n\n``` objc\nvec3 lightColor = vec3(1.0f, 1.0f, 1.0f);\nvec3 toyColor = vec3(1.0f, 0.5f, 0.3f);\nvec3 result = lightColor * toyColor;    // = (1.0f, 0.5f, 0.3f)\n```\n\n\n\n``` objc\nvec3 lightColor = vec3(0.0f, 1.0f, 0.0f);\nvec3 toyColor = vec3(1.0f, 0.5f, 0.3f);\nvec3 result = lightColor * toyColor;    // = (0.0f, 0.5f, 0.0f)\n```\n\n\n\n# \n\n--3D\n\n\n\n``` objc\nNSString *objectVertexShaderString = @\" \\\n#version 300 es \\\nlayout(location = 0) in vec3 a_position; \\\nuniform mat4 modelMatrix; \\\nuniform mat4 viewMatrix; \\\nuniform mat4 projectionMatrix; \\\nvoid main() { \\\ngl_Position = projectionMatrix * viewMatrix * modelMatrix * vec4(a_position, 1.0); \\\n}\";\nNSString *objectFragmentShaderString = @\"\\\n#version 300 es \\\nprecision mediump float; \\\nuniform vec3 objectColor; \\\nout vec4 fragColor; \\\nvoid main() { \\\nfragColor = vec4(objectColor, 1.0); \\\n}\";\n\nNSString *lightVertexShaderString = @\" \\\n#version 300 es \\\nlayout(location = 0) in vec3 a_position; \\\nuniform mat4 modelMatrix; \\\nuniform mat4 viewMatrix; \\\nuniform mat4 projectionMatrix; \\\nvoid main() { \\\ngl_Position = projectionMatrix * viewMatrix * modelMatrix * vec4(a_position, 1.0); \\\n}\";\nNSString *lightFragmentShaderString = @\"\\\n#version 300 es \\\nprecision mediump float; \\\nout vec4 fragColor; \\\nvoid main() { \\\nfragColor = vec4(1.0); \\\n}\";\n```\n\n\n\n``` objc\n- (void)setupVertices {\n    ...\n    \n    ...\n    // \n    glGenVertexArrays(1, &vao);\n    glBindVertexArray(vao);\n    glEnableVertexAttribArray(0);\n    glVertexAttribPointer(0, 3, GL_FLOAT, GL_FALSE, sizeof(GLfloat)*6, 0);\n    glEnableVertexAttribArray(1);\n    glVertexAttribPointer(1, 3, GL_FLOAT, GL_FALSE, sizeof(GLfloat)*6, (GLvoid *)(sizeof(GLfloat)*3));\n    glBindVertexArray(0);\n\n    // \n    glGenVertexArrays(1, &lightvao);\n    glBindVertexArray(lightvao);\n    glEnableVertexAttribArray(0);\n    glVertexAttribPointer(0, 3, GL_FLOAT, GL_FALSE, sizeof(GLfloat)*6, 0);\n    glBindVertexArray(0);\n}\n\n- (void)glkView:(GLKView *)view drawInRect:(CGRect)rect {\n    glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);\n    glClearColor(0.0f, 0.0f, 0.0f, 1.0f);\n    \n    glUseProgram(program1);\n    \n    glBindVertexArray(vao);\n    glDrawArrays(GL_TRIANGLES, 0, 36);\n    \n    float aspect = self.view.frame.size.width / self.view.frame.size.height;\n    GLKMatrix4 modelMatrix = GLKMatrix4MakeTranslation(-0.3f, 0.2f, 1.0f);\n    GLKMatrix4 viewMatrix = GLKMatrix4MakeLookAt(-3.5f, 2.0f, 4.0f, 0.5f, 0.0f, 0.0f, 0.0f, 1.0f, 0.0f);\n    GLKMatrix4 projectionMatrx = GLKMatrix4MakePerspective(GLKMathDegreesToRadians(45), aspect, 0.1, 100.0);\n    glUniformMatrix4fv(modelLocation, 1, GL_FALSE, modelMatrix.m);\n    glUniformMatrix4fv(viewLocation, 1, GL_FALSE, viewMatrix.m);\n    glUniformMatrix4fv(projectionLocation, 1, GL_FALSE, projectionMatrx.m);\n    glUniform3f(objectLocation, 1.0f, 0.5f, 0.3f);  // objct color\n    \n    glUseProgram(program2);\n    glBindVertexArray(lightvao);\n    glDrawArrays(GL_TRIANGLES, 0, 36);\n    \n    GLKMatrix4 translateMatrix2 = GLKMatrix4MakeTranslation(3.0f, 6.6f, 2.5f);\n    GLKMatrix4 scaleMatrix2 = GLKMatrix4MakeScale(0.2f, 0.2f, 0.2f);\n    GLKMatrix4 modelMatrix2 = GLKMatrix4Multiply(scaleMatrix2, translateMatrix2);\n    glUniformMatrix4fv(modelLocation2, 1, GL_FALSE, modelMatrix2.m);\n    glUniformMatrix4fv(viewLocation2, 1, GL_FALSE, viewMatrix.m);\n    glUniformMatrix4fv(projectionLocation2, 1, GL_FALSE, projectionMatrx.m);\n}\n```\n\n\n\n![](/img/article/20190902/1.png)\n\n# \n\nOpenGLPhong Lighting Model3AmbientDiffuseSpecular\n\n![](/img/article/20190902/2.png)\n\n- Ambient Lighting\n- Diffuse LightingDirectional Impact\n- Specular Lighting\n\n# \n\nGlobal Illumination\n\n\n\n\n\n``` objc\nNSString *objectFragmentShaderString = @\"\\\n#version 300 es \\\nprecision mediump float; \\\nuniform vec3 objectColor; \\\nuniform vec3 lightColor; \\\nout vec4 fragColor; \\\nvoid main() { \\\nfloat ambientStrength = 0.1; \\\nvec3 ambient = ambientStrength * lightColor; \\\nvec3 result = ambient * objectColor; \\\nfragColor = vec4(result, 1.0); \\\n}\";\n```\n\n\n\n![](/img/article/20190902/3.png)\n\n# \n\n\n\n![](/img/article/20190902/4.png)\n\n\n\n1900\n\n> 1\n\n\n\n\n- \n- \n\n# \n\n3D\n\n``` objc\nglFloat vertices[] = {\n    -0.5f, -0.5f, -0.5f,  0.0f,  0.0f, -1.0f,\n    0.5f, -0.5f, -0.5f,  0.0f,  0.0f, -1.0f,\n    0.5f,  0.5f, -0.5f,  0.0f,  0.0f, -1.0f,\n    0.5f,  0.5f, -0.5f,  0.0f,  0.0f, -1.0f,\n    -0.5f,  0.5f, -0.5f,  0.0f,  0.0f, -1.0f,\n    -0.5f, -0.5f, -0.5f,  0.0f,  0.0f, -1.0f,\n    \n    -0.5f, -0.5f,  0.5f,  0.0f,  0.0f, 1.0f,\n    0.5f, -0.5f,  0.5f,  0.0f,  0.0f, 1.0f,\n    0.5f,  0.5f,  0.5f,  0.0f,  0.0f, 1.0f,\n    0.5f,  0.5f,  0.5f,  0.0f,  0.0f, 1.0f,\n    -0.5f,  0.5f,  0.5f,  0.0f,  0.0f, 1.0f,\n    -0.5f, -0.5f,  0.5f,  0.0f,  0.0f, 1.0f,\n    \n    -0.5f,  0.5f,  0.5f, -1.0f,  0.0f,  0.0f,\n    -0.5f,  0.5f, -0.5f, -1.0f,  0.0f,  0.0f,\n    -0.5f, -0.5f, -0.5f, -1.0f,  0.0f,  0.0f,\n    -0.5f, -0.5f, -0.5f, -1.0f,  0.0f,  0.0f,\n    -0.5f, -0.5f,  0.5f, -1.0f,  0.0f,  0.0f,\n    -0.5f,  0.5f,  0.5f, -1.0f,  0.0f,  0.0f,\n    \n    0.5f,  0.5f,  0.5f,  1.0f,  0.0f,  0.0f,\n    0.5f,  0.5f, -0.5f,  1.0f,  0.0f,  0.0f,\n    0.5f, -0.5f, -0.5f,  1.0f,  0.0f,  0.0f,\n    0.5f, -0.5f, -0.5f,  1.0f,  0.0f,  0.0f,\n    0.5f, -0.5f,  0.5f,  1.0f,  0.0f,  0.0f,\n    0.5f,  0.5f,  0.5f,  1.0f,  0.0f,  0.0f,\n    \n    -0.5f, -0.5f, -0.5f,  0.0f, -1.0f,  0.0f,\n    0.5f, -0.5f, -0.5f,  0.0f, -1.0f,  0.0f,\n    0.5f, -0.5f,  0.5f,  0.0f, -1.0f,  0.0f,\n    0.5f, -0.5f,  0.5f,  0.0f, -1.0f,  0.0f,\n    -0.5f, -0.5f,  0.5f,  0.0f, -1.0f,  0.0f,\n    -0.5f, -0.5f, -0.5f,  0.0f, -1.0f,  0.0f,\n    \n    -0.5f,  0.5f, -0.5f,  0.0f,  1.0f,  0.0f,\n    0.5f,  0.5f, -0.5f,  0.0f,  1.0f,  0.0f,\n    0.5f,  0.5f,  0.5f,  0.0f,  1.0f,  0.0f,\n    0.5f,  0.5f,  0.5f,  0.0f,  1.0f,  0.0f,\n    -0.5f,  0.5f,  0.5f,  0.0f,  1.0f,  0.0f,\n    -0.5f,  0.5f, -0.5f,  0.0f,  1.0f,  0.0f\n};\n```\n\n\n\n``` objc\nNSString *vertexShaderString = @\" \\\n#version 300 es \\\nlayout(location = 0) in vec3 a_position; \\\nlayout(location = 1) in vec3 a_normal; \\\nuniform mat4 modelMatrix; \\\nuniform mat4 viewMatrix; \\\nuniform mat4 projectionMatrix; \\\nout vec3 v_normal; \\\nvoid main() { \\\nv_normal = a_normal; \\\ngl_Position = projectionMatrix * viewMatrix * modelMatrix * vec4(a_position, 1.0); \\\n}\";\n```\n\n# \n\n`uniform`\n\n``` objc\nuniform vec3 lightPos;\n```\n\n\n\n``` objc\nNSString *vertexShaderString = @\" \\\n#version 300 es \\\nlayout(location = 0) in vec3 a_position; \\\nlayout(location = 1) in vec3 a_normal; \\\nuniform mat4 modelMatrix; \\\nuniform mat4 viewMatrix; \\\nuniform mat4 projectionMatrix; \\\nout vec3 v_normal; \\\nout vec3 FragPos; \\\nvoid main() { \\\nFragPos = vec3(modelMatrix * vec4(a_position, 1.0)); \\\nv_normal = a_normal; \\\ngl_Position = projectionMatrix * viewMatrix * modelMatrix * vec4(a_position, 1.0); \\\n}\";\n```\n\n`FragPos`\n\n\n\n``` objc\nvec3 norm = normalize(v_normal);\nvec3 lightDir = normalize(lightPos - FragPos);\n```\n\n> \n\n`norm``lightDir`\n\n``` objc\nfloat diff = max(dot(norm, lightDir), 0.0);\nvec3 diffuse = diff * lightColor;\n```\n\n90`max`\n\n\n\n``` objc\nvec3 result = (ambient + diffuse) * objectColor;\nFragColor = vec4(result, 1.0);\n```\n\n\n\n``` objc\nNSString *fragmentShaderString = @\"\\\n#version 300 es \\\nprecision mediump float; \\\nuniform vec3 objectColor; \\\nuniform vec3 lightColor; \\\nuniform vec3 lightPos; \\\nin vec3 FragPos; \\\nin vec3 v_normal; \\\nout vec4 fragColor; \\\nvoid main() { \\\nfloat ambientStrength = 0.1; \\\nvec3 ambient = ambientStrength * lightColor; \\\nvec3 norm = normalize(v_normal); \\\nvec3 lightDir = normalize(lightPos - FragPos); \\\nfloat diff = max(dot(norm, lightDir), 0.0); \\\nvec3 diffuse = diff * lightColor; \\\nvec3 result = (ambient + diffuse) * objectColor; \\\nfragColor = vec4(result, 1.0); \\\n}\";\n```\n\n\n\n![](/img/article/20190902/5.png)\n\n# ...\n\n\n\nw3x3w04x4\n\n\n\n![](/img/article/20190902/6.png)\n\n\n\n\n\n-\n\n`inverse``transpose`3x3`vec3`\n\n``` objc\nv_normal = mat3(transpose(inverse(model)))* a_normal;\n```\n\n\n\n> CPUuniform\n\n# \n\n\n\n\n\n![](/img/article/20190902/7.png)\n\n\n\n\n\n`uniform`\n\n``` objc\nuniform vec3 viewPos;\n```\n\n\n\n``` objc\nfloat specularStrength = 0.5;\n```\n\n1.0f\n\n``` objc\nvec3 viewDir = normalize(viewPos - FragPos);\nvec3 reflectDir = reflect(-lightDir, norm);\n```\n\n`lightDir``reflect``lightDir``reflect``lightDir``norm`\n\n\n\n``` objc\nfloat spec = pow(max(dot(viewDir, reflectDir), 0.0), 32.0);\nvec3 specular = specularStrength * spec * lightColor;\n```\n\n3232\n\n![](/img/article/20190902/8.png)\n\n\n\n``` objc\nvec3 result = (ambient + diffuse + specular) * objectColor;\nFragColor = vec4(result, 1.0);\n```\n\n\n\n``` objc\nNSString *fragmentShaderString = @\"\\\n#version 300 es \\\nprecision mediump float; \\\nuniform vec3 objectColor; \\\nuniform vec3 lightColor; \\\nuniform vec3 lightPos; \\\nuniform vec3 viewPos; \\\nin vec3 FragPos; \\\nin vec3 v_normal; \\\nout vec4 fragColor; \\\nvoid main() { \\\nfloat ambientStrength = 0.1; \\\nvec3 ambient = ambientStrength * lightColor; \\\nvec3 norm = normalize(v_normal); \\\nvec3 lightDir = normalize(lightPos - FragPos); \\\nfloat diff = max(dot(norm, lightDir), 0.0); \\\nvec3 diffuse = diff * lightColor; \\\nfloat specularStrength = 0.5; \\\nvec3 viewDir = normalize(viewPos - FragPos); \\\nvec3 reflectDir = reflect(-lightDir, norm); \\\nfloat spec = pow(max(dot(viewDir, reflectDir), 0.0), 32.0); \\\nvec3 specular = specularStrength * spec * lightColor; \\\nvec3 result = (ambient + diffuse + specular) * objectColor; \\\nfragColor = vec4(result, 1.0); \\\n}\";\n```\n\n\n\n![](/img/article/20190902/9.png)\n\n> \n\n# \n\n","slug":"2019/opengl-es-illuminate-0902","published":1,"updated":"2021-06-21T12:34:52.094Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckszp3ndd000vifntl9b334rm","content":"<h1 id=\"\"></h1>\n<p>RedGreenBlueRGB<br>\nReflectedAbsorb<br>\nOpenGL</p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vec3 lightColor = vec3(<span class=\"number\">1.0</span>f, <span class=\"number\">1.0</span>f, <span class=\"number\">1.0</span>f);</span><br><span class=\"line\">vec3 toyColor = vec3(<span class=\"number\">1.0</span>f, <span class=\"number\">0.5</span>f, <span class=\"number\">0.3</span>f);</span><br><span class=\"line\">vec3 result = lightColor * toyColor;    <span class=\"comment\">// = (1.0f, 0.5f, 0.3f)</span></span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vec3 lightColor = vec3(<span class=\"number\">0.0</span>f, <span class=\"number\">1.0</span>f, <span class=\"number\">0.0</span>f);</span><br><span class=\"line\">vec3 toyColor = vec3(<span class=\"number\">1.0</span>f, <span class=\"number\">0.5</span>f, <span class=\"number\">0.3</span>f);</span><br><span class=\"line\">vec3 result = lightColor * toyColor;    <span class=\"comment\">// = (0.0f, 0.5f, 0.0f)</span></span><br></pre></td></tr></table></figure>\n<p></p>\n<h1 id=\"\"></h1>\n<p>3D</p>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">NSString</span> *objectVertexShaderString = <span class=\"string\">@\" \\</span></span><br><span class=\"line\"><span class=\"string\">#version 300 es \\</span></span><br><span class=\"line\"><span class=\"string\">layout(location = 0) in vec3 a_position; \\</span></span><br><span class=\"line\"><span class=\"string\">uniform mat4 modelMatrix; \\</span></span><br><span class=\"line\"><span class=\"string\">uniform mat4 viewMatrix; \\</span></span><br><span class=\"line\"><span class=\"string\">uniform mat4 projectionMatrix; \\</span></span><br><span class=\"line\"><span class=\"string\">void main() &#123; \\</span></span><br><span class=\"line\"><span class=\"string\">gl_Position = projectionMatrix * viewMatrix * modelMatrix * vec4(a_position, 1.0); \\</span></span><br><span class=\"line\"><span class=\"string\">&#125;\"</span>;</span><br><span class=\"line\"><span class=\"built_in\">NSString</span> *objectFragmentShaderString = <span class=\"string\">@\"\\</span></span><br><span class=\"line\"><span class=\"string\">#version 300 es \\</span></span><br><span class=\"line\"><span class=\"string\">precision mediump float; \\</span></span><br><span class=\"line\"><span class=\"string\">uniform vec3 objectColor; \\</span></span><br><span class=\"line\"><span class=\"string\">out vec4 fragColor; \\</span></span><br><span class=\"line\"><span class=\"string\">void main() &#123; \\</span></span><br><span class=\"line\"><span class=\"string\">fragColor = vec4(objectColor, 1.0); \\</span></span><br><span class=\"line\"><span class=\"string\">&#125;\"</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">NSString</span> *lightVertexShaderString = <span class=\"string\">@\" \\</span></span><br><span class=\"line\"><span class=\"string\">#version 300 es \\</span></span><br><span class=\"line\"><span class=\"string\">layout(location = 0) in vec3 a_position; \\</span></span><br><span class=\"line\"><span class=\"string\">uniform mat4 modelMatrix; \\</span></span><br><span class=\"line\"><span class=\"string\">uniform mat4 viewMatrix; \\</span></span><br><span class=\"line\"><span class=\"string\">uniform mat4 projectionMatrix; \\</span></span><br><span class=\"line\"><span class=\"string\">void main() &#123; \\</span></span><br><span class=\"line\"><span class=\"string\">gl_Position = projectionMatrix * viewMatrix * modelMatrix * vec4(a_position, 1.0); \\</span></span><br><span class=\"line\"><span class=\"string\">&#125;\"</span>;</span><br><span class=\"line\"><span class=\"built_in\">NSString</span> *lightFragmentShaderString = <span class=\"string\">@\"\\</span></span><br><span class=\"line\"><span class=\"string\">#version 300 es \\</span></span><br><span class=\"line\"><span class=\"string\">precision mediump float; \\</span></span><br><span class=\"line\"><span class=\"string\">out vec4 fragColor; \\</span></span><br><span class=\"line\"><span class=\"string\">void main() &#123; \\</span></span><br><span class=\"line\"><span class=\"string\">fragColor = vec4(1.0); \\</span></span><br><span class=\"line\"><span class=\"string\">&#125;\"</span>;</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">- (<span class=\"keyword\">void</span>)setupVertices &#123;</span><br><span class=\"line\">    ...</span><br><span class=\"line\">    </span><br><span class=\"line\">    ...</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    glGenVertexArrays(<span class=\"number\">1</span>, &amp;vao);</span><br><span class=\"line\">    glBindVertexArray(vao);</span><br><span class=\"line\">    glEnableVertexAttribArray(<span class=\"number\">0</span>);</span><br><span class=\"line\">    glVertexAttribPointer(<span class=\"number\">0</span>, <span class=\"number\">3</span>, GL_FLOAT, GL_FALSE, <span class=\"keyword\">sizeof</span>(GLfloat)*<span class=\"number\">6</span>, <span class=\"number\">0</span>);</span><br><span class=\"line\">    glEnableVertexAttribArray(<span class=\"number\">1</span>);</span><br><span class=\"line\">    glVertexAttribPointer(<span class=\"number\">1</span>, <span class=\"number\">3</span>, GL_FLOAT, GL_FALSE, <span class=\"keyword\">sizeof</span>(GLfloat)*<span class=\"number\">6</span>, (GLvoid *)(<span class=\"keyword\">sizeof</span>(GLfloat)*<span class=\"number\">3</span>));</span><br><span class=\"line\">    glBindVertexArray(<span class=\"number\">0</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    glGenVertexArrays(<span class=\"number\">1</span>, &amp;lightvao);</span><br><span class=\"line\">    glBindVertexArray(lightvao);</span><br><span class=\"line\">    glEnableVertexAttribArray(<span class=\"number\">0</span>);</span><br><span class=\"line\">    glVertexAttribPointer(<span class=\"number\">0</span>, <span class=\"number\">3</span>, GL_FLOAT, GL_FALSE, <span class=\"keyword\">sizeof</span>(GLfloat)*<span class=\"number\">6</span>, <span class=\"number\">0</span>);</span><br><span class=\"line\">    glBindVertexArray(<span class=\"number\">0</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">- (<span class=\"keyword\">void</span>)glkView:(GLKView *)view drawInRect:(<span class=\"built_in\">CGRect</span>)rect &#123;</span><br><span class=\"line\">    glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);</span><br><span class=\"line\">    glClearColor(<span class=\"number\">0.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">1.0</span>f);</span><br><span class=\"line\">    </span><br><span class=\"line\">    glUseProgram(program1);</span><br><span class=\"line\">    </span><br><span class=\"line\">    glBindVertexArray(vao);</span><br><span class=\"line\">    glDrawArrays(GL_TRIANGLES, <span class=\"number\">0</span>, <span class=\"number\">36</span>);</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">float</span> aspect = <span class=\"keyword\">self</span>.view.frame.size.width / <span class=\"keyword\">self</span>.view.frame.size.height;</span><br><span class=\"line\">    GLKMatrix4 modelMatrix = GLKMatrix4MakeTranslation(<span class=\"number\">-0.3</span>f, <span class=\"number\">0.2</span>f, <span class=\"number\">1.0</span>f);</span><br><span class=\"line\">    GLKMatrix4 viewMatrix = GLKMatrix4MakeLookAt(<span class=\"number\">-3.5</span>f, <span class=\"number\">2.0</span>f, <span class=\"number\">4.0</span>f, <span class=\"number\">0.5</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">1.0</span>f, <span class=\"number\">0.0</span>f);</span><br><span class=\"line\">    GLKMatrix4 projectionMatrx = GLKMatrix4MakePerspective(GLKMathDegreesToRadians(<span class=\"number\">45</span>), aspect, <span class=\"number\">0.1</span>, <span class=\"number\">100.0</span>);</span><br><span class=\"line\">    glUniformMatrix4fv(modelLocation, <span class=\"number\">1</span>, GL_FALSE, modelMatrix.m);</span><br><span class=\"line\">    glUniformMatrix4fv(viewLocation, <span class=\"number\">1</span>, GL_FALSE, viewMatrix.m);</span><br><span class=\"line\">    glUniformMatrix4fv(projectionLocation, <span class=\"number\">1</span>, GL_FALSE, projectionMatrx.m);</span><br><span class=\"line\">    glUniform3f(objectLocation, <span class=\"number\">1.0</span>f, <span class=\"number\">0.5</span>f, <span class=\"number\">0.3</span>f);  <span class=\"comment\">// objct color</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    glUseProgram(program2);</span><br><span class=\"line\">    glBindVertexArray(lightvao);</span><br><span class=\"line\">    glDrawArrays(GL_TRIANGLES, <span class=\"number\">0</span>, <span class=\"number\">36</span>);</span><br><span class=\"line\">    </span><br><span class=\"line\">    GLKMatrix4 translateMatrix2 = GLKMatrix4MakeTranslation(<span class=\"number\">3.0</span>f, <span class=\"number\">6.6</span>f, <span class=\"number\">2.5</span>f);</span><br><span class=\"line\">    GLKMatrix4 scaleMatrix2 = GLKMatrix4MakeScale(<span class=\"number\">0.2</span>f, <span class=\"number\">0.2</span>f, <span class=\"number\">0.2</span>f);</span><br><span class=\"line\">    GLKMatrix4 modelMatrix2 = GLKMatrix4Multiply(scaleMatrix2, translateMatrix2);</span><br><span class=\"line\">    glUniformMatrix4fv(modelLocation2, <span class=\"number\">1</span>, GL_FALSE, modelMatrix2.m);</span><br><span class=\"line\">    glUniformMatrix4fv(viewLocation2, <span class=\"number\">1</span>, GL_FALSE, viewMatrix.m);</span><br><span class=\"line\">    glUniformMatrix4fv(projectionLocation2, <span class=\"number\">1</span>, GL_FALSE, projectionMatrx.m);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p></p>\n<p><img src=\"/img/article/20190902/1.png\" alt=\"\"></p>\n<h1 id=\"\"></h1>\n<p>OpenGLPhong Lighting Model3AmbientDiffuseSpecular</p>\n<p><img src=\"/img/article/20190902/2.png\" alt=\"\"></p>\n<ul>\n<li>Ambient Lighting</li>\n<li>Diffuse LightingDirectional Impact</li>\n<li>Specular Lighting</li>\n</ul>\n<h1 id=\"\"></h1>\n<p>Global Illumination</p>\n<p></p>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">NSString</span> *objectFragmentShaderString = <span class=\"string\">@\"\\</span></span><br><span class=\"line\"><span class=\"string\">#version 300 es \\</span></span><br><span class=\"line\"><span class=\"string\">precision mediump float; \\</span></span><br><span class=\"line\"><span class=\"string\">uniform vec3 objectColor; \\</span></span><br><span class=\"line\"><span class=\"string\">uniform vec3 lightColor; \\</span></span><br><span class=\"line\"><span class=\"string\">out vec4 fragColor; \\</span></span><br><span class=\"line\"><span class=\"string\">void main() &#123; \\</span></span><br><span class=\"line\"><span class=\"string\">float ambientStrength = 0.1; \\</span></span><br><span class=\"line\"><span class=\"string\">vec3 ambient = ambientStrength * lightColor; \\</span></span><br><span class=\"line\"><span class=\"string\">vec3 result = ambient * objectColor; \\</span></span><br><span class=\"line\"><span class=\"string\">fragColor = vec4(result, 1.0); \\</span></span><br><span class=\"line\"><span class=\"string\">&#125;\"</span>;</span><br></pre></td></tr></table></figure>\n<p></p>\n<p><img src=\"/img/article/20190902/3.png\" alt=\"\"></p>\n<h1 id=\"\"></h1>\n<p></p>\n<p><img src=\"/img/article/20190902/4.png\" alt=\"\"></p>\n<p></p>\n<p>1900</p>\n<blockquote>\n<p>1</p>\n</blockquote>\n<p></p>\n<p></p>\n<ul>\n<li></li>\n<li></li>\n</ul>\n<h1 id=\"\"></h1>\n<p>3D</p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">glFloat vertices[] = &#123;</span><br><span class=\"line\">    <span class=\"number\">-0.5</span>f, <span class=\"number\">-0.5</span>f, <span class=\"number\">-0.5</span>f,  <span class=\"number\">0.0</span>f,  <span class=\"number\">0.0</span>f, <span class=\"number\">-1.0</span>f,</span><br><span class=\"line\">    <span class=\"number\">0.5</span>f, <span class=\"number\">-0.5</span>f, <span class=\"number\">-0.5</span>f,  <span class=\"number\">0.0</span>f,  <span class=\"number\">0.0</span>f, <span class=\"number\">-1.0</span>f,</span><br><span class=\"line\">    <span class=\"number\">0.5</span>f,  <span class=\"number\">0.5</span>f, <span class=\"number\">-0.5</span>f,  <span class=\"number\">0.0</span>f,  <span class=\"number\">0.0</span>f, <span class=\"number\">-1.0</span>f,</span><br><span class=\"line\">    <span class=\"number\">0.5</span>f,  <span class=\"number\">0.5</span>f, <span class=\"number\">-0.5</span>f,  <span class=\"number\">0.0</span>f,  <span class=\"number\">0.0</span>f, <span class=\"number\">-1.0</span>f,</span><br><span class=\"line\">    <span class=\"number\">-0.5</span>f,  <span class=\"number\">0.5</span>f, <span class=\"number\">-0.5</span>f,  <span class=\"number\">0.0</span>f,  <span class=\"number\">0.0</span>f, <span class=\"number\">-1.0</span>f,</span><br><span class=\"line\">    <span class=\"number\">-0.5</span>f, <span class=\"number\">-0.5</span>f, <span class=\"number\">-0.5</span>f,  <span class=\"number\">0.0</span>f,  <span class=\"number\">0.0</span>f, <span class=\"number\">-1.0</span>f,</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"number\">-0.5</span>f, <span class=\"number\">-0.5</span>f,  <span class=\"number\">0.5</span>f,  <span class=\"number\">0.0</span>f,  <span class=\"number\">0.0</span>f, <span class=\"number\">1.0</span>f,</span><br><span class=\"line\">    <span class=\"number\">0.5</span>f, <span class=\"number\">-0.5</span>f,  <span class=\"number\">0.5</span>f,  <span class=\"number\">0.0</span>f,  <span class=\"number\">0.0</span>f, <span class=\"number\">1.0</span>f,</span><br><span class=\"line\">    <span class=\"number\">0.5</span>f,  <span class=\"number\">0.5</span>f,  <span class=\"number\">0.5</span>f,  <span class=\"number\">0.0</span>f,  <span class=\"number\">0.0</span>f, <span class=\"number\">1.0</span>f,</span><br><span class=\"line\">    <span class=\"number\">0.5</span>f,  <span class=\"number\">0.5</span>f,  <span class=\"number\">0.5</span>f,  <span class=\"number\">0.0</span>f,  <span class=\"number\">0.0</span>f, <span class=\"number\">1.0</span>f,</span><br><span class=\"line\">    <span class=\"number\">-0.5</span>f,  <span class=\"number\">0.5</span>f,  <span class=\"number\">0.5</span>f,  <span class=\"number\">0.0</span>f,  <span class=\"number\">0.0</span>f, <span class=\"number\">1.0</span>f,</span><br><span class=\"line\">    <span class=\"number\">-0.5</span>f, <span class=\"number\">-0.5</span>f,  <span class=\"number\">0.5</span>f,  <span class=\"number\">0.0</span>f,  <span class=\"number\">0.0</span>f, <span class=\"number\">1.0</span>f,</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"number\">-0.5</span>f,  <span class=\"number\">0.5</span>f,  <span class=\"number\">0.5</span>f, <span class=\"number\">-1.0</span>f,  <span class=\"number\">0.0</span>f,  <span class=\"number\">0.0</span>f,</span><br><span class=\"line\">    <span class=\"number\">-0.5</span>f,  <span class=\"number\">0.5</span>f, <span class=\"number\">-0.5</span>f, <span class=\"number\">-1.0</span>f,  <span class=\"number\">0.0</span>f,  <span class=\"number\">0.0</span>f,</span><br><span class=\"line\">    <span class=\"number\">-0.5</span>f, <span class=\"number\">-0.5</span>f, <span class=\"number\">-0.5</span>f, <span class=\"number\">-1.0</span>f,  <span class=\"number\">0.0</span>f,  <span class=\"number\">0.0</span>f,</span><br><span class=\"line\">    <span class=\"number\">-0.5</span>f, <span class=\"number\">-0.5</span>f, <span class=\"number\">-0.5</span>f, <span class=\"number\">-1.0</span>f,  <span class=\"number\">0.0</span>f,  <span class=\"number\">0.0</span>f,</span><br><span class=\"line\">    <span class=\"number\">-0.5</span>f, <span class=\"number\">-0.5</span>f,  <span class=\"number\">0.5</span>f, <span class=\"number\">-1.0</span>f,  <span class=\"number\">0.0</span>f,  <span class=\"number\">0.0</span>f,</span><br><span class=\"line\">    <span class=\"number\">-0.5</span>f,  <span class=\"number\">0.5</span>f,  <span class=\"number\">0.5</span>f, <span class=\"number\">-1.0</span>f,  <span class=\"number\">0.0</span>f,  <span class=\"number\">0.0</span>f,</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"number\">0.5</span>f,  <span class=\"number\">0.5</span>f,  <span class=\"number\">0.5</span>f,  <span class=\"number\">1.0</span>f,  <span class=\"number\">0.0</span>f,  <span class=\"number\">0.0</span>f,</span><br><span class=\"line\">    <span class=\"number\">0.5</span>f,  <span class=\"number\">0.5</span>f, <span class=\"number\">-0.5</span>f,  <span class=\"number\">1.0</span>f,  <span class=\"number\">0.0</span>f,  <span class=\"number\">0.0</span>f,</span><br><span class=\"line\">    <span class=\"number\">0.5</span>f, <span class=\"number\">-0.5</span>f, <span class=\"number\">-0.5</span>f,  <span class=\"number\">1.0</span>f,  <span class=\"number\">0.0</span>f,  <span class=\"number\">0.0</span>f,</span><br><span class=\"line\">    <span class=\"number\">0.5</span>f, <span class=\"number\">-0.5</span>f, <span class=\"number\">-0.5</span>f,  <span class=\"number\">1.0</span>f,  <span class=\"number\">0.0</span>f,  <span class=\"number\">0.0</span>f,</span><br><span class=\"line\">    <span class=\"number\">0.5</span>f, <span class=\"number\">-0.5</span>f,  <span class=\"number\">0.5</span>f,  <span class=\"number\">1.0</span>f,  <span class=\"number\">0.0</span>f,  <span class=\"number\">0.0</span>f,</span><br><span class=\"line\">    <span class=\"number\">0.5</span>f,  <span class=\"number\">0.5</span>f,  <span class=\"number\">0.5</span>f,  <span class=\"number\">1.0</span>f,  <span class=\"number\">0.0</span>f,  <span class=\"number\">0.0</span>f,</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"number\">-0.5</span>f, <span class=\"number\">-0.5</span>f, <span class=\"number\">-0.5</span>f,  <span class=\"number\">0.0</span>f, <span class=\"number\">-1.0</span>f,  <span class=\"number\">0.0</span>f,</span><br><span class=\"line\">    <span class=\"number\">0.5</span>f, <span class=\"number\">-0.5</span>f, <span class=\"number\">-0.5</span>f,  <span class=\"number\">0.0</span>f, <span class=\"number\">-1.0</span>f,  <span class=\"number\">0.0</span>f,</span><br><span class=\"line\">    <span class=\"number\">0.5</span>f, <span class=\"number\">-0.5</span>f,  <span class=\"number\">0.5</span>f,  <span class=\"number\">0.0</span>f, <span class=\"number\">-1.0</span>f,  <span class=\"number\">0.0</span>f,</span><br><span class=\"line\">    <span class=\"number\">0.5</span>f, <span class=\"number\">-0.5</span>f,  <span class=\"number\">0.5</span>f,  <span class=\"number\">0.0</span>f, <span class=\"number\">-1.0</span>f,  <span class=\"number\">0.0</span>f,</span><br><span class=\"line\">    <span class=\"number\">-0.5</span>f, <span class=\"number\">-0.5</span>f,  <span class=\"number\">0.5</span>f,  <span class=\"number\">0.0</span>f, <span class=\"number\">-1.0</span>f,  <span class=\"number\">0.0</span>f,</span><br><span class=\"line\">    <span class=\"number\">-0.5</span>f, <span class=\"number\">-0.5</span>f, <span class=\"number\">-0.5</span>f,  <span class=\"number\">0.0</span>f, <span class=\"number\">-1.0</span>f,  <span class=\"number\">0.0</span>f,</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"number\">-0.5</span>f,  <span class=\"number\">0.5</span>f, <span class=\"number\">-0.5</span>f,  <span class=\"number\">0.0</span>f,  <span class=\"number\">1.0</span>f,  <span class=\"number\">0.0</span>f,</span><br><span class=\"line\">    <span class=\"number\">0.5</span>f,  <span class=\"number\">0.5</span>f, <span class=\"number\">-0.5</span>f,  <span class=\"number\">0.0</span>f,  <span class=\"number\">1.0</span>f,  <span class=\"number\">0.0</span>f,</span><br><span class=\"line\">    <span class=\"number\">0.5</span>f,  <span class=\"number\">0.5</span>f,  <span class=\"number\">0.5</span>f,  <span class=\"number\">0.0</span>f,  <span class=\"number\">1.0</span>f,  <span class=\"number\">0.0</span>f,</span><br><span class=\"line\">    <span class=\"number\">0.5</span>f,  <span class=\"number\">0.5</span>f,  <span class=\"number\">0.5</span>f,  <span class=\"number\">0.0</span>f,  <span class=\"number\">1.0</span>f,  <span class=\"number\">0.0</span>f,</span><br><span class=\"line\">    <span class=\"number\">-0.5</span>f,  <span class=\"number\">0.5</span>f,  <span class=\"number\">0.5</span>f,  <span class=\"number\">0.0</span>f,  <span class=\"number\">1.0</span>f,  <span class=\"number\">0.0</span>f,</span><br><span class=\"line\">    <span class=\"number\">-0.5</span>f,  <span class=\"number\">0.5</span>f, <span class=\"number\">-0.5</span>f,  <span class=\"number\">0.0</span>f,  <span class=\"number\">1.0</span>f,  <span class=\"number\">0.0</span>f</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">NSString</span> *vertexShaderString = <span class=\"string\">@\" \\</span></span><br><span class=\"line\"><span class=\"string\">#version 300 es \\</span></span><br><span class=\"line\"><span class=\"string\">layout(location = 0) in vec3 a_position; \\</span></span><br><span class=\"line\"><span class=\"string\">layout(location = 1) in vec3 a_normal; \\</span></span><br><span class=\"line\"><span class=\"string\">uniform mat4 modelMatrix; \\</span></span><br><span class=\"line\"><span class=\"string\">uniform mat4 viewMatrix; \\</span></span><br><span class=\"line\"><span class=\"string\">uniform mat4 projectionMatrix; \\</span></span><br><span class=\"line\"><span class=\"string\">out vec3 v_normal; \\</span></span><br><span class=\"line\"><span class=\"string\">void main() &#123; \\</span></span><br><span class=\"line\"><span class=\"string\">v_normal = a_normal; \\</span></span><br><span class=\"line\"><span class=\"string\">gl_Position = projectionMatrix * viewMatrix * modelMatrix * vec4(a_position, 1.0); \\</span></span><br><span class=\"line\"><span class=\"string\">&#125;\"</span>;</span><br></pre></td></tr></table></figure>\n<h1 id=\"\"></h1>\n<p><code>uniform</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">uniform vec3 lightPos;</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">NSString</span> *vertexShaderString = <span class=\"string\">@\" \\</span></span><br><span class=\"line\"><span class=\"string\">#version 300 es \\</span></span><br><span class=\"line\"><span class=\"string\">layout(location = 0) in vec3 a_position; \\</span></span><br><span class=\"line\"><span class=\"string\">layout(location = 1) in vec3 a_normal; \\</span></span><br><span class=\"line\"><span class=\"string\">uniform mat4 modelMatrix; \\</span></span><br><span class=\"line\"><span class=\"string\">uniform mat4 viewMatrix; \\</span></span><br><span class=\"line\"><span class=\"string\">uniform mat4 projectionMatrix; \\</span></span><br><span class=\"line\"><span class=\"string\">out vec3 v_normal; \\</span></span><br><span class=\"line\"><span class=\"string\">out vec3 FragPos; \\</span></span><br><span class=\"line\"><span class=\"string\">void main() &#123; \\</span></span><br><span class=\"line\"><span class=\"string\">FragPos = vec3(modelMatrix * vec4(a_position, 1.0)); \\</span></span><br><span class=\"line\"><span class=\"string\">v_normal = a_normal; \\</span></span><br><span class=\"line\"><span class=\"string\">gl_Position = projectionMatrix * viewMatrix * modelMatrix * vec4(a_position, 1.0); \\</span></span><br><span class=\"line\"><span class=\"string\">&#125;\"</span>;</span><br></pre></td></tr></table></figure>\n<p><code>FragPos</code></p>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vec3 norm = normalize(v_normal);</span><br><span class=\"line\">vec3 lightDir = normalize(lightPos - FragPos);</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p></p>\n</blockquote>\n<p><code>norm</code><code>lightDir</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">float</span> diff = max(dot(norm, lightDir), <span class=\"number\">0.0</span>);</span><br><span class=\"line\">vec3 diffuse = diff * lightColor;</span><br></pre></td></tr></table></figure>\n<p>90<code>max</code></p>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vec3 result = (ambient + diffuse) * objectColor;</span><br><span class=\"line\">FragColor = vec4(result, <span class=\"number\">1.0</span>);</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">NSString</span> *fragmentShaderString = <span class=\"string\">@\"\\</span></span><br><span class=\"line\"><span class=\"string\">#version 300 es \\</span></span><br><span class=\"line\"><span class=\"string\">precision mediump float; \\</span></span><br><span class=\"line\"><span class=\"string\">uniform vec3 objectColor; \\</span></span><br><span class=\"line\"><span class=\"string\">uniform vec3 lightColor; \\</span></span><br><span class=\"line\"><span class=\"string\">uniform vec3 lightPos; \\</span></span><br><span class=\"line\"><span class=\"string\">in vec3 FragPos; \\</span></span><br><span class=\"line\"><span class=\"string\">in vec3 v_normal; \\</span></span><br><span class=\"line\"><span class=\"string\">out vec4 fragColor; \\</span></span><br><span class=\"line\"><span class=\"string\">void main() &#123; \\</span></span><br><span class=\"line\"><span class=\"string\">float ambientStrength = 0.1; \\</span></span><br><span class=\"line\"><span class=\"string\">vec3 ambient = ambientStrength * lightColor; \\</span></span><br><span class=\"line\"><span class=\"string\">vec3 norm = normalize(v_normal); \\</span></span><br><span class=\"line\"><span class=\"string\">vec3 lightDir = normalize(lightPos - FragPos); \\</span></span><br><span class=\"line\"><span class=\"string\">float diff = max(dot(norm, lightDir), 0.0); \\</span></span><br><span class=\"line\"><span class=\"string\">vec3 diffuse = diff * lightColor; \\</span></span><br><span class=\"line\"><span class=\"string\">vec3 result = (ambient + diffuse) * objectColor; \\</span></span><br><span class=\"line\"><span class=\"string\">fragColor = vec4(result, 1.0); \\</span></span><br><span class=\"line\"><span class=\"string\">&#125;\"</span>;</span><br></pre></td></tr></table></figure>\n<p></p>\n<p><img src=\"/img/article/20190902/5.png\" alt=\"\"></p>\n<h1 id=\"\"></h1>\n<p></p>\n<p>w3x3w04x4</p>\n<p></p>\n<p><img src=\"/img/article/20190902/6.png\" alt=\"\"></p>\n<p></p>\n<p></p>\n<p>-</p>\n<p><code>inverse</code><code>transpose</code>3x3<code>vec3</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">v_normal = mat3(transpose(inverse(model)))* a_normal;</span><br></pre></td></tr></table></figure>\n<p></p>\n<blockquote>\n<p>CPUuniform</p>\n</blockquote>\n<h1 id=\"\"></h1>\n<p></p>\n<p></p>\n<p><img src=\"/img/article/20190902/7.png\" alt=\"\"></p>\n<p></p>\n<p></p>\n<p><code>uniform</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">uniform vec3 viewPos;</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">float</span> specularStrength = <span class=\"number\">0.5</span>;</span><br></pre></td></tr></table></figure>\n<p>1.0f</p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vec3 viewDir = normalize(viewPos - FragPos);</span><br><span class=\"line\">vec3 reflectDir = reflect(-lightDir, norm);</span><br></pre></td></tr></table></figure>\n<p><code>lightDir</code><code>reflect</code><code>lightDir</code><code>reflect</code><code>lightDir</code><code>norm</code></p>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">float</span> spec = pow(max(dot(viewDir, reflectDir), <span class=\"number\">0.0</span>), <span class=\"number\">32.0</span>);</span><br><span class=\"line\">vec3 specular = specularStrength * spec * lightColor;</span><br></pre></td></tr></table></figure>\n<p>3232</p>\n<p><img src=\"/img/article/20190902/8.png\" alt=\"\"></p>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vec3 result = (ambient + diffuse + specular) * objectColor;</span><br><span class=\"line\">FragColor = vec4(result, <span class=\"number\">1.0</span>);</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">NSString</span> *fragmentShaderString = <span class=\"string\">@\"\\</span></span><br><span class=\"line\"><span class=\"string\">#version 300 es \\</span></span><br><span class=\"line\"><span class=\"string\">precision mediump float; \\</span></span><br><span class=\"line\"><span class=\"string\">uniform vec3 objectColor; \\</span></span><br><span class=\"line\"><span class=\"string\">uniform vec3 lightColor; \\</span></span><br><span class=\"line\"><span class=\"string\">uniform vec3 lightPos; \\</span></span><br><span class=\"line\"><span class=\"string\">uniform vec3 viewPos; \\</span></span><br><span class=\"line\"><span class=\"string\">in vec3 FragPos; \\</span></span><br><span class=\"line\"><span class=\"string\">in vec3 v_normal; \\</span></span><br><span class=\"line\"><span class=\"string\">out vec4 fragColor; \\</span></span><br><span class=\"line\"><span class=\"string\">void main() &#123; \\</span></span><br><span class=\"line\"><span class=\"string\">float ambientStrength = 0.1; \\</span></span><br><span class=\"line\"><span class=\"string\">vec3 ambient = ambientStrength * lightColor; \\</span></span><br><span class=\"line\"><span class=\"string\">vec3 norm = normalize(v_normal); \\</span></span><br><span class=\"line\"><span class=\"string\">vec3 lightDir = normalize(lightPos - FragPos); \\</span></span><br><span class=\"line\"><span class=\"string\">float diff = max(dot(norm, lightDir), 0.0); \\</span></span><br><span class=\"line\"><span class=\"string\">vec3 diffuse = diff * lightColor; \\</span></span><br><span class=\"line\"><span class=\"string\">float specularStrength = 0.5; \\</span></span><br><span class=\"line\"><span class=\"string\">vec3 viewDir = normalize(viewPos - FragPos); \\</span></span><br><span class=\"line\"><span class=\"string\">vec3 reflectDir = reflect(-lightDir, norm); \\</span></span><br><span class=\"line\"><span class=\"string\">float spec = pow(max(dot(viewDir, reflectDir), 0.0), 32.0); \\</span></span><br><span class=\"line\"><span class=\"string\">vec3 specular = specularStrength * spec * lightColor; \\</span></span><br><span class=\"line\"><span class=\"string\">vec3 result = (ambient + diffuse + specular) * objectColor; \\</span></span><br><span class=\"line\"><span class=\"string\">fragColor = vec4(result, 1.0); \\</span></span><br><span class=\"line\"><span class=\"string\">&#125;\"</span>;</span><br></pre></td></tr></table></figure>\n<p></p>\n<p><img src=\"/img/article/20190902/9.png\" alt=\"\"></p>\n<blockquote>\n<p></p>\n</blockquote>\n<h1 id=\"\"></h1>\n<p></p>\n","site":{"data":{}},"excerpt":"","more":"<h1></h1>\n<p>RedGreenBlueRGB<br>\nReflectedAbsorb<br>\nOpenGL</p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vec3 lightColor = vec3(<span class=\"number\">1.0</span>f, <span class=\"number\">1.0</span>f, <span class=\"number\">1.0</span>f);</span><br><span class=\"line\">vec3 toyColor = vec3(<span class=\"number\">1.0</span>f, <span class=\"number\">0.5</span>f, <span class=\"number\">0.3</span>f);</span><br><span class=\"line\">vec3 result = lightColor * toyColor;    <span class=\"comment\">// = (1.0f, 0.5f, 0.3f)</span></span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vec3 lightColor = vec3(<span class=\"number\">0.0</span>f, <span class=\"number\">1.0</span>f, <span class=\"number\">0.0</span>f);</span><br><span class=\"line\">vec3 toyColor = vec3(<span class=\"number\">1.0</span>f, <span class=\"number\">0.5</span>f, <span class=\"number\">0.3</span>f);</span><br><span class=\"line\">vec3 result = lightColor * toyColor;    <span class=\"comment\">// = (0.0f, 0.5f, 0.0f)</span></span><br></pre></td></tr></table></figure>\n<p></p>\n<h1></h1>\n<p>3D</p>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">NSString</span> *objectVertexShaderString = <span class=\"string\">@\" \\</span></span><br><span class=\"line\"><span class=\"string\">#version 300 es \\</span></span><br><span class=\"line\"><span class=\"string\">layout(location = 0) in vec3 a_position; \\</span></span><br><span class=\"line\"><span class=\"string\">uniform mat4 modelMatrix; \\</span></span><br><span class=\"line\"><span class=\"string\">uniform mat4 viewMatrix; \\</span></span><br><span class=\"line\"><span class=\"string\">uniform mat4 projectionMatrix; \\</span></span><br><span class=\"line\"><span class=\"string\">void main() &#123; \\</span></span><br><span class=\"line\"><span class=\"string\">gl_Position = projectionMatrix * viewMatrix * modelMatrix * vec4(a_position, 1.0); \\</span></span><br><span class=\"line\"><span class=\"string\">&#125;\"</span>;</span><br><span class=\"line\"><span class=\"built_in\">NSString</span> *objectFragmentShaderString = <span class=\"string\">@\"\\</span></span><br><span class=\"line\"><span class=\"string\">#version 300 es \\</span></span><br><span class=\"line\"><span class=\"string\">precision mediump float; \\</span></span><br><span class=\"line\"><span class=\"string\">uniform vec3 objectColor; \\</span></span><br><span class=\"line\"><span class=\"string\">out vec4 fragColor; \\</span></span><br><span class=\"line\"><span class=\"string\">void main() &#123; \\</span></span><br><span class=\"line\"><span class=\"string\">fragColor = vec4(objectColor, 1.0); \\</span></span><br><span class=\"line\"><span class=\"string\">&#125;\"</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">NSString</span> *lightVertexShaderString = <span class=\"string\">@\" \\</span></span><br><span class=\"line\"><span class=\"string\">#version 300 es \\</span></span><br><span class=\"line\"><span class=\"string\">layout(location = 0) in vec3 a_position; \\</span></span><br><span class=\"line\"><span class=\"string\">uniform mat4 modelMatrix; \\</span></span><br><span class=\"line\"><span class=\"string\">uniform mat4 viewMatrix; \\</span></span><br><span class=\"line\"><span class=\"string\">uniform mat4 projectionMatrix; \\</span></span><br><span class=\"line\"><span class=\"string\">void main() &#123; \\</span></span><br><span class=\"line\"><span class=\"string\">gl_Position = projectionMatrix * viewMatrix * modelMatrix * vec4(a_position, 1.0); \\</span></span><br><span class=\"line\"><span class=\"string\">&#125;\"</span>;</span><br><span class=\"line\"><span class=\"built_in\">NSString</span> *lightFragmentShaderString = <span class=\"string\">@\"\\</span></span><br><span class=\"line\"><span class=\"string\">#version 300 es \\</span></span><br><span class=\"line\"><span class=\"string\">precision mediump float; \\</span></span><br><span class=\"line\"><span class=\"string\">out vec4 fragColor; \\</span></span><br><span class=\"line\"><span class=\"string\">void main() &#123; \\</span></span><br><span class=\"line\"><span class=\"string\">fragColor = vec4(1.0); \\</span></span><br><span class=\"line\"><span class=\"string\">&#125;\"</span>;</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">- (<span class=\"keyword\">void</span>)setupVertices &#123;</span><br><span class=\"line\">    ...</span><br><span class=\"line\">    </span><br><span class=\"line\">    ...</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    glGenVertexArrays(<span class=\"number\">1</span>, &amp;vao);</span><br><span class=\"line\">    glBindVertexArray(vao);</span><br><span class=\"line\">    glEnableVertexAttribArray(<span class=\"number\">0</span>);</span><br><span class=\"line\">    glVertexAttribPointer(<span class=\"number\">0</span>, <span class=\"number\">3</span>, GL_FLOAT, GL_FALSE, <span class=\"keyword\">sizeof</span>(GLfloat)*<span class=\"number\">6</span>, <span class=\"number\">0</span>);</span><br><span class=\"line\">    glEnableVertexAttribArray(<span class=\"number\">1</span>);</span><br><span class=\"line\">    glVertexAttribPointer(<span class=\"number\">1</span>, <span class=\"number\">3</span>, GL_FLOAT, GL_FALSE, <span class=\"keyword\">sizeof</span>(GLfloat)*<span class=\"number\">6</span>, (GLvoid *)(<span class=\"keyword\">sizeof</span>(GLfloat)*<span class=\"number\">3</span>));</span><br><span class=\"line\">    glBindVertexArray(<span class=\"number\">0</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    glGenVertexArrays(<span class=\"number\">1</span>, &amp;lightvao);</span><br><span class=\"line\">    glBindVertexArray(lightvao);</span><br><span class=\"line\">    glEnableVertexAttribArray(<span class=\"number\">0</span>);</span><br><span class=\"line\">    glVertexAttribPointer(<span class=\"number\">0</span>, <span class=\"number\">3</span>, GL_FLOAT, GL_FALSE, <span class=\"keyword\">sizeof</span>(GLfloat)*<span class=\"number\">6</span>, <span class=\"number\">0</span>);</span><br><span class=\"line\">    glBindVertexArray(<span class=\"number\">0</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">- (<span class=\"keyword\">void</span>)glkView:(GLKView *)view drawInRect:(<span class=\"built_in\">CGRect</span>)rect &#123;</span><br><span class=\"line\">    glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);</span><br><span class=\"line\">    glClearColor(<span class=\"number\">0.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">1.0</span>f);</span><br><span class=\"line\">    </span><br><span class=\"line\">    glUseProgram(program1);</span><br><span class=\"line\">    </span><br><span class=\"line\">    glBindVertexArray(vao);</span><br><span class=\"line\">    glDrawArrays(GL_TRIANGLES, <span class=\"number\">0</span>, <span class=\"number\">36</span>);</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">float</span> aspect = <span class=\"keyword\">self</span>.view.frame.size.width / <span class=\"keyword\">self</span>.view.frame.size.height;</span><br><span class=\"line\">    GLKMatrix4 modelMatrix = GLKMatrix4MakeTranslation(<span class=\"number\">-0.3</span>f, <span class=\"number\">0.2</span>f, <span class=\"number\">1.0</span>f);</span><br><span class=\"line\">    GLKMatrix4 viewMatrix = GLKMatrix4MakeLookAt(<span class=\"number\">-3.5</span>f, <span class=\"number\">2.0</span>f, <span class=\"number\">4.0</span>f, <span class=\"number\">0.5</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">1.0</span>f, <span class=\"number\">0.0</span>f);</span><br><span class=\"line\">    GLKMatrix4 projectionMatrx = GLKMatrix4MakePerspective(GLKMathDegreesToRadians(<span class=\"number\">45</span>), aspect, <span class=\"number\">0.1</span>, <span class=\"number\">100.0</span>);</span><br><span class=\"line\">    glUniformMatrix4fv(modelLocation, <span class=\"number\">1</span>, GL_FALSE, modelMatrix.m);</span><br><span class=\"line\">    glUniformMatrix4fv(viewLocation, <span class=\"number\">1</span>, GL_FALSE, viewMatrix.m);</span><br><span class=\"line\">    glUniformMatrix4fv(projectionLocation, <span class=\"number\">1</span>, GL_FALSE, projectionMatrx.m);</span><br><span class=\"line\">    glUniform3f(objectLocation, <span class=\"number\">1.0</span>f, <span class=\"number\">0.5</span>f, <span class=\"number\">0.3</span>f);  <span class=\"comment\">// objct color</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    glUseProgram(program2);</span><br><span class=\"line\">    glBindVertexArray(lightvao);</span><br><span class=\"line\">    glDrawArrays(GL_TRIANGLES, <span class=\"number\">0</span>, <span class=\"number\">36</span>);</span><br><span class=\"line\">    </span><br><span class=\"line\">    GLKMatrix4 translateMatrix2 = GLKMatrix4MakeTranslation(<span class=\"number\">3.0</span>f, <span class=\"number\">6.6</span>f, <span class=\"number\">2.5</span>f);</span><br><span class=\"line\">    GLKMatrix4 scaleMatrix2 = GLKMatrix4MakeScale(<span class=\"number\">0.2</span>f, <span class=\"number\">0.2</span>f, <span class=\"number\">0.2</span>f);</span><br><span class=\"line\">    GLKMatrix4 modelMatrix2 = GLKMatrix4Multiply(scaleMatrix2, translateMatrix2);</span><br><span class=\"line\">    glUniformMatrix4fv(modelLocation2, <span class=\"number\">1</span>, GL_FALSE, modelMatrix2.m);</span><br><span class=\"line\">    glUniformMatrix4fv(viewLocation2, <span class=\"number\">1</span>, GL_FALSE, viewMatrix.m);</span><br><span class=\"line\">    glUniformMatrix4fv(projectionLocation2, <span class=\"number\">1</span>, GL_FALSE, projectionMatrx.m);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p></p>\n<p><img src=\"/img/article/20190902/1.png\" alt=\"\"></p>\n<h1></h1>\n<p>OpenGLPhong Lighting Model3AmbientDiffuseSpecular</p>\n<p><img src=\"/img/article/20190902/2.png\" alt=\"\"></p>\n<ul>\n<li>Ambient Lighting</li>\n<li>Diffuse LightingDirectional Impact</li>\n<li>Specular Lighting</li>\n</ul>\n<h1></h1>\n<p>Global Illumination</p>\n<p></p>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">NSString</span> *objectFragmentShaderString = <span class=\"string\">@\"\\</span></span><br><span class=\"line\"><span class=\"string\">#version 300 es \\</span></span><br><span class=\"line\"><span class=\"string\">precision mediump float; \\</span></span><br><span class=\"line\"><span class=\"string\">uniform vec3 objectColor; \\</span></span><br><span class=\"line\"><span class=\"string\">uniform vec3 lightColor; \\</span></span><br><span class=\"line\"><span class=\"string\">out vec4 fragColor; \\</span></span><br><span class=\"line\"><span class=\"string\">void main() &#123; \\</span></span><br><span class=\"line\"><span class=\"string\">float ambientStrength = 0.1; \\</span></span><br><span class=\"line\"><span class=\"string\">vec3 ambient = ambientStrength * lightColor; \\</span></span><br><span class=\"line\"><span class=\"string\">vec3 result = ambient * objectColor; \\</span></span><br><span class=\"line\"><span class=\"string\">fragColor = vec4(result, 1.0); \\</span></span><br><span class=\"line\"><span class=\"string\">&#125;\"</span>;</span><br></pre></td></tr></table></figure>\n<p></p>\n<p><img src=\"/img/article/20190902/3.png\" alt=\"\"></p>\n<h1></h1>\n<p></p>\n<p><img src=\"/img/article/20190902/4.png\" alt=\"\"></p>\n<p></p>\n<p>1900</p>\n<blockquote>\n<p>1</p>\n</blockquote>\n<p></p>\n<p></p>\n<ul>\n<li></li>\n<li></li>\n</ul>\n<h1></h1>\n<p>3D</p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">glFloat vertices[] = &#123;</span><br><span class=\"line\">    <span class=\"number\">-0.5</span>f, <span class=\"number\">-0.5</span>f, <span class=\"number\">-0.5</span>f,  <span class=\"number\">0.0</span>f,  <span class=\"number\">0.0</span>f, <span class=\"number\">-1.0</span>f,</span><br><span class=\"line\">    <span class=\"number\">0.5</span>f, <span class=\"number\">-0.5</span>f, <span class=\"number\">-0.5</span>f,  <span class=\"number\">0.0</span>f,  <span class=\"number\">0.0</span>f, <span class=\"number\">-1.0</span>f,</span><br><span class=\"line\">    <span class=\"number\">0.5</span>f,  <span class=\"number\">0.5</span>f, <span class=\"number\">-0.5</span>f,  <span class=\"number\">0.0</span>f,  <span class=\"number\">0.0</span>f, <span class=\"number\">-1.0</span>f,</span><br><span class=\"line\">    <span class=\"number\">0.5</span>f,  <span class=\"number\">0.5</span>f, <span class=\"number\">-0.5</span>f,  <span class=\"number\">0.0</span>f,  <span class=\"number\">0.0</span>f, <span class=\"number\">-1.0</span>f,</span><br><span class=\"line\">    <span class=\"number\">-0.5</span>f,  <span class=\"number\">0.5</span>f, <span class=\"number\">-0.5</span>f,  <span class=\"number\">0.0</span>f,  <span class=\"number\">0.0</span>f, <span class=\"number\">-1.0</span>f,</span><br><span class=\"line\">    <span class=\"number\">-0.5</span>f, <span class=\"number\">-0.5</span>f, <span class=\"number\">-0.5</span>f,  <span class=\"number\">0.0</span>f,  <span class=\"number\">0.0</span>f, <span class=\"number\">-1.0</span>f,</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"number\">-0.5</span>f, <span class=\"number\">-0.5</span>f,  <span class=\"number\">0.5</span>f,  <span class=\"number\">0.0</span>f,  <span class=\"number\">0.0</span>f, <span class=\"number\">1.0</span>f,</span><br><span class=\"line\">    <span class=\"number\">0.5</span>f, <span class=\"number\">-0.5</span>f,  <span class=\"number\">0.5</span>f,  <span class=\"number\">0.0</span>f,  <span class=\"number\">0.0</span>f, <span class=\"number\">1.0</span>f,</span><br><span class=\"line\">    <span class=\"number\">0.5</span>f,  <span class=\"number\">0.5</span>f,  <span class=\"number\">0.5</span>f,  <span class=\"number\">0.0</span>f,  <span class=\"number\">0.0</span>f, <span class=\"number\">1.0</span>f,</span><br><span class=\"line\">    <span class=\"number\">0.5</span>f,  <span class=\"number\">0.5</span>f,  <span class=\"number\">0.5</span>f,  <span class=\"number\">0.0</span>f,  <span class=\"number\">0.0</span>f, <span class=\"number\">1.0</span>f,</span><br><span class=\"line\">    <span class=\"number\">-0.5</span>f,  <span class=\"number\">0.5</span>f,  <span class=\"number\">0.5</span>f,  <span class=\"number\">0.0</span>f,  <span class=\"number\">0.0</span>f, <span class=\"number\">1.0</span>f,</span><br><span class=\"line\">    <span class=\"number\">-0.5</span>f, <span class=\"number\">-0.5</span>f,  <span class=\"number\">0.5</span>f,  <span class=\"number\">0.0</span>f,  <span class=\"number\">0.0</span>f, <span class=\"number\">1.0</span>f,</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"number\">-0.5</span>f,  <span class=\"number\">0.5</span>f,  <span class=\"number\">0.5</span>f, <span class=\"number\">-1.0</span>f,  <span class=\"number\">0.0</span>f,  <span class=\"number\">0.0</span>f,</span><br><span class=\"line\">    <span class=\"number\">-0.5</span>f,  <span class=\"number\">0.5</span>f, <span class=\"number\">-0.5</span>f, <span class=\"number\">-1.0</span>f,  <span class=\"number\">0.0</span>f,  <span class=\"number\">0.0</span>f,</span><br><span class=\"line\">    <span class=\"number\">-0.5</span>f, <span class=\"number\">-0.5</span>f, <span class=\"number\">-0.5</span>f, <span class=\"number\">-1.0</span>f,  <span class=\"number\">0.0</span>f,  <span class=\"number\">0.0</span>f,</span><br><span class=\"line\">    <span class=\"number\">-0.5</span>f, <span class=\"number\">-0.5</span>f, <span class=\"number\">-0.5</span>f, <span class=\"number\">-1.0</span>f,  <span class=\"number\">0.0</span>f,  <span class=\"number\">0.0</span>f,</span><br><span class=\"line\">    <span class=\"number\">-0.5</span>f, <span class=\"number\">-0.5</span>f,  <span class=\"number\">0.5</span>f, <span class=\"number\">-1.0</span>f,  <span class=\"number\">0.0</span>f,  <span class=\"number\">0.0</span>f,</span><br><span class=\"line\">    <span class=\"number\">-0.5</span>f,  <span class=\"number\">0.5</span>f,  <span class=\"number\">0.5</span>f, <span class=\"number\">-1.0</span>f,  <span class=\"number\">0.0</span>f,  <span class=\"number\">0.0</span>f,</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"number\">0.5</span>f,  <span class=\"number\">0.5</span>f,  <span class=\"number\">0.5</span>f,  <span class=\"number\">1.0</span>f,  <span class=\"number\">0.0</span>f,  <span class=\"number\">0.0</span>f,</span><br><span class=\"line\">    <span class=\"number\">0.5</span>f,  <span class=\"number\">0.5</span>f, <span class=\"number\">-0.5</span>f,  <span class=\"number\">1.0</span>f,  <span class=\"number\">0.0</span>f,  <span class=\"number\">0.0</span>f,</span><br><span class=\"line\">    <span class=\"number\">0.5</span>f, <span class=\"number\">-0.5</span>f, <span class=\"number\">-0.5</span>f,  <span class=\"number\">1.0</span>f,  <span class=\"number\">0.0</span>f,  <span class=\"number\">0.0</span>f,</span><br><span class=\"line\">    <span class=\"number\">0.5</span>f, <span class=\"number\">-0.5</span>f, <span class=\"number\">-0.5</span>f,  <span class=\"number\">1.0</span>f,  <span class=\"number\">0.0</span>f,  <span class=\"number\">0.0</span>f,</span><br><span class=\"line\">    <span class=\"number\">0.5</span>f, <span class=\"number\">-0.5</span>f,  <span class=\"number\">0.5</span>f,  <span class=\"number\">1.0</span>f,  <span class=\"number\">0.0</span>f,  <span class=\"number\">0.0</span>f,</span><br><span class=\"line\">    <span class=\"number\">0.5</span>f,  <span class=\"number\">0.5</span>f,  <span class=\"number\">0.5</span>f,  <span class=\"number\">1.0</span>f,  <span class=\"number\">0.0</span>f,  <span class=\"number\">0.0</span>f,</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"number\">-0.5</span>f, <span class=\"number\">-0.5</span>f, <span class=\"number\">-0.5</span>f,  <span class=\"number\">0.0</span>f, <span class=\"number\">-1.0</span>f,  <span class=\"number\">0.0</span>f,</span><br><span class=\"line\">    <span class=\"number\">0.5</span>f, <span class=\"number\">-0.5</span>f, <span class=\"number\">-0.5</span>f,  <span class=\"number\">0.0</span>f, <span class=\"number\">-1.0</span>f,  <span class=\"number\">0.0</span>f,</span><br><span class=\"line\">    <span class=\"number\">0.5</span>f, <span class=\"number\">-0.5</span>f,  <span class=\"number\">0.5</span>f,  <span class=\"number\">0.0</span>f, <span class=\"number\">-1.0</span>f,  <span class=\"number\">0.0</span>f,</span><br><span class=\"line\">    <span class=\"number\">0.5</span>f, <span class=\"number\">-0.5</span>f,  <span class=\"number\">0.5</span>f,  <span class=\"number\">0.0</span>f, <span class=\"number\">-1.0</span>f,  <span class=\"number\">0.0</span>f,</span><br><span class=\"line\">    <span class=\"number\">-0.5</span>f, <span class=\"number\">-0.5</span>f,  <span class=\"number\">0.5</span>f,  <span class=\"number\">0.0</span>f, <span class=\"number\">-1.0</span>f,  <span class=\"number\">0.0</span>f,</span><br><span class=\"line\">    <span class=\"number\">-0.5</span>f, <span class=\"number\">-0.5</span>f, <span class=\"number\">-0.5</span>f,  <span class=\"number\">0.0</span>f, <span class=\"number\">-1.0</span>f,  <span class=\"number\">0.0</span>f,</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"number\">-0.5</span>f,  <span class=\"number\">0.5</span>f, <span class=\"number\">-0.5</span>f,  <span class=\"number\">0.0</span>f,  <span class=\"number\">1.0</span>f,  <span class=\"number\">0.0</span>f,</span><br><span class=\"line\">    <span class=\"number\">0.5</span>f,  <span class=\"number\">0.5</span>f, <span class=\"number\">-0.5</span>f,  <span class=\"number\">0.0</span>f,  <span class=\"number\">1.0</span>f,  <span class=\"number\">0.0</span>f,</span><br><span class=\"line\">    <span class=\"number\">0.5</span>f,  <span class=\"number\">0.5</span>f,  <span class=\"number\">0.5</span>f,  <span class=\"number\">0.0</span>f,  <span class=\"number\">1.0</span>f,  <span class=\"number\">0.0</span>f,</span><br><span class=\"line\">    <span class=\"number\">0.5</span>f,  <span class=\"number\">0.5</span>f,  <span class=\"number\">0.5</span>f,  <span class=\"number\">0.0</span>f,  <span class=\"number\">1.0</span>f,  <span class=\"number\">0.0</span>f,</span><br><span class=\"line\">    <span class=\"number\">-0.5</span>f,  <span class=\"number\">0.5</span>f,  <span class=\"number\">0.5</span>f,  <span class=\"number\">0.0</span>f,  <span class=\"number\">1.0</span>f,  <span class=\"number\">0.0</span>f,</span><br><span class=\"line\">    <span class=\"number\">-0.5</span>f,  <span class=\"number\">0.5</span>f, <span class=\"number\">-0.5</span>f,  <span class=\"number\">0.0</span>f,  <span class=\"number\">1.0</span>f,  <span class=\"number\">0.0</span>f</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">NSString</span> *vertexShaderString = <span class=\"string\">@\" \\</span></span><br><span class=\"line\"><span class=\"string\">#version 300 es \\</span></span><br><span class=\"line\"><span class=\"string\">layout(location = 0) in vec3 a_position; \\</span></span><br><span class=\"line\"><span class=\"string\">layout(location = 1) in vec3 a_normal; \\</span></span><br><span class=\"line\"><span class=\"string\">uniform mat4 modelMatrix; \\</span></span><br><span class=\"line\"><span class=\"string\">uniform mat4 viewMatrix; \\</span></span><br><span class=\"line\"><span class=\"string\">uniform mat4 projectionMatrix; \\</span></span><br><span class=\"line\"><span class=\"string\">out vec3 v_normal; \\</span></span><br><span class=\"line\"><span class=\"string\">void main() &#123; \\</span></span><br><span class=\"line\"><span class=\"string\">v_normal = a_normal; \\</span></span><br><span class=\"line\"><span class=\"string\">gl_Position = projectionMatrix * viewMatrix * modelMatrix * vec4(a_position, 1.0); \\</span></span><br><span class=\"line\"><span class=\"string\">&#125;\"</span>;</span><br></pre></td></tr></table></figure>\n<h1></h1>\n<p><code>uniform</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">uniform vec3 lightPos;</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">NSString</span> *vertexShaderString = <span class=\"string\">@\" \\</span></span><br><span class=\"line\"><span class=\"string\">#version 300 es \\</span></span><br><span class=\"line\"><span class=\"string\">layout(location = 0) in vec3 a_position; \\</span></span><br><span class=\"line\"><span class=\"string\">layout(location = 1) in vec3 a_normal; \\</span></span><br><span class=\"line\"><span class=\"string\">uniform mat4 modelMatrix; \\</span></span><br><span class=\"line\"><span class=\"string\">uniform mat4 viewMatrix; \\</span></span><br><span class=\"line\"><span class=\"string\">uniform mat4 projectionMatrix; \\</span></span><br><span class=\"line\"><span class=\"string\">out vec3 v_normal; \\</span></span><br><span class=\"line\"><span class=\"string\">out vec3 FragPos; \\</span></span><br><span class=\"line\"><span class=\"string\">void main() &#123; \\</span></span><br><span class=\"line\"><span class=\"string\">FragPos = vec3(modelMatrix * vec4(a_position, 1.0)); \\</span></span><br><span class=\"line\"><span class=\"string\">v_normal = a_normal; \\</span></span><br><span class=\"line\"><span class=\"string\">gl_Position = projectionMatrix * viewMatrix * modelMatrix * vec4(a_position, 1.0); \\</span></span><br><span class=\"line\"><span class=\"string\">&#125;\"</span>;</span><br></pre></td></tr></table></figure>\n<p><code>FragPos</code></p>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vec3 norm = normalize(v_normal);</span><br><span class=\"line\">vec3 lightDir = normalize(lightPos - FragPos);</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p></p>\n</blockquote>\n<p><code>norm</code><code>lightDir</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">float</span> diff = max(dot(norm, lightDir), <span class=\"number\">0.0</span>);</span><br><span class=\"line\">vec3 diffuse = diff * lightColor;</span><br></pre></td></tr></table></figure>\n<p>90<code>max</code></p>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vec3 result = (ambient + diffuse) * objectColor;</span><br><span class=\"line\">FragColor = vec4(result, <span class=\"number\">1.0</span>);</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">NSString</span> *fragmentShaderString = <span class=\"string\">@\"\\</span></span><br><span class=\"line\"><span class=\"string\">#version 300 es \\</span></span><br><span class=\"line\"><span class=\"string\">precision mediump float; \\</span></span><br><span class=\"line\"><span class=\"string\">uniform vec3 objectColor; \\</span></span><br><span class=\"line\"><span class=\"string\">uniform vec3 lightColor; \\</span></span><br><span class=\"line\"><span class=\"string\">uniform vec3 lightPos; \\</span></span><br><span class=\"line\"><span class=\"string\">in vec3 FragPos; \\</span></span><br><span class=\"line\"><span class=\"string\">in vec3 v_normal; \\</span></span><br><span class=\"line\"><span class=\"string\">out vec4 fragColor; \\</span></span><br><span class=\"line\"><span class=\"string\">void main() &#123; \\</span></span><br><span class=\"line\"><span class=\"string\">float ambientStrength = 0.1; \\</span></span><br><span class=\"line\"><span class=\"string\">vec3 ambient = ambientStrength * lightColor; \\</span></span><br><span class=\"line\"><span class=\"string\">vec3 norm = normalize(v_normal); \\</span></span><br><span class=\"line\"><span class=\"string\">vec3 lightDir = normalize(lightPos - FragPos); \\</span></span><br><span class=\"line\"><span class=\"string\">float diff = max(dot(norm, lightDir), 0.0); \\</span></span><br><span class=\"line\"><span class=\"string\">vec3 diffuse = diff * lightColor; \\</span></span><br><span class=\"line\"><span class=\"string\">vec3 result = (ambient + diffuse) * objectColor; \\</span></span><br><span class=\"line\"><span class=\"string\">fragColor = vec4(result, 1.0); \\</span></span><br><span class=\"line\"><span class=\"string\">&#125;\"</span>;</span><br></pre></td></tr></table></figure>\n<p></p>\n<p><img src=\"/img/article/20190902/5.png\" alt=\"\"></p>\n<h1></h1>\n<p></p>\n<p>w3x3w04x4</p>\n<p></p>\n<p><img src=\"/img/article/20190902/6.png\" alt=\"\"></p>\n<p></p>\n<p></p>\n<p>-</p>\n<p><code>inverse</code><code>transpose</code>3x3<code>vec3</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">v_normal = mat3(transpose(inverse(model)))* a_normal;</span><br></pre></td></tr></table></figure>\n<p></p>\n<blockquote>\n<p>CPUuniform</p>\n</blockquote>\n<h1></h1>\n<p></p>\n<p></p>\n<p><img src=\"/img/article/20190902/7.png\" alt=\"\"></p>\n<p></p>\n<p></p>\n<p><code>uniform</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">uniform vec3 viewPos;</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">float</span> specularStrength = <span class=\"number\">0.5</span>;</span><br></pre></td></tr></table></figure>\n<p>1.0f</p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vec3 viewDir = normalize(viewPos - FragPos);</span><br><span class=\"line\">vec3 reflectDir = reflect(-lightDir, norm);</span><br></pre></td></tr></table></figure>\n<p><code>lightDir</code><code>reflect</code><code>lightDir</code><code>reflect</code><code>lightDir</code><code>norm</code></p>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">float</span> spec = pow(max(dot(viewDir, reflectDir), <span class=\"number\">0.0</span>), <span class=\"number\">32.0</span>);</span><br><span class=\"line\">vec3 specular = specularStrength * spec * lightColor;</span><br></pre></td></tr></table></figure>\n<p>3232</p>\n<p><img src=\"/img/article/20190902/8.png\" alt=\"\"></p>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vec3 result = (ambient + diffuse + specular) * objectColor;</span><br><span class=\"line\">FragColor = vec4(result, <span class=\"number\">1.0</span>);</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">NSString</span> *fragmentShaderString = <span class=\"string\">@\"\\</span></span><br><span class=\"line\"><span class=\"string\">#version 300 es \\</span></span><br><span class=\"line\"><span class=\"string\">precision mediump float; \\</span></span><br><span class=\"line\"><span class=\"string\">uniform vec3 objectColor; \\</span></span><br><span class=\"line\"><span class=\"string\">uniform vec3 lightColor; \\</span></span><br><span class=\"line\"><span class=\"string\">uniform vec3 lightPos; \\</span></span><br><span class=\"line\"><span class=\"string\">uniform vec3 viewPos; \\</span></span><br><span class=\"line\"><span class=\"string\">in vec3 FragPos; \\</span></span><br><span class=\"line\"><span class=\"string\">in vec3 v_normal; \\</span></span><br><span class=\"line\"><span class=\"string\">out vec4 fragColor; \\</span></span><br><span class=\"line\"><span class=\"string\">void main() &#123; \\</span></span><br><span class=\"line\"><span class=\"string\">float ambientStrength = 0.1; \\</span></span><br><span class=\"line\"><span class=\"string\">vec3 ambient = ambientStrength * lightColor; \\</span></span><br><span class=\"line\"><span class=\"string\">vec3 norm = normalize(v_normal); \\</span></span><br><span class=\"line\"><span class=\"string\">vec3 lightDir = normalize(lightPos - FragPos); \\</span></span><br><span class=\"line\"><span class=\"string\">float diff = max(dot(norm, lightDir), 0.0); \\</span></span><br><span class=\"line\"><span class=\"string\">vec3 diffuse = diff * lightColor; \\</span></span><br><span class=\"line\"><span class=\"string\">float specularStrength = 0.5; \\</span></span><br><span class=\"line\"><span class=\"string\">vec3 viewDir = normalize(viewPos - FragPos); \\</span></span><br><span class=\"line\"><span class=\"string\">vec3 reflectDir = reflect(-lightDir, norm); \\</span></span><br><span class=\"line\"><span class=\"string\">float spec = pow(max(dot(viewDir, reflectDir), 0.0), 32.0); \\</span></span><br><span class=\"line\"><span class=\"string\">vec3 specular = specularStrength * spec * lightColor; \\</span></span><br><span class=\"line\"><span class=\"string\">vec3 result = (ambient + diffuse + specular) * objectColor; \\</span></span><br><span class=\"line\"><span class=\"string\">fragColor = vec4(result, 1.0); \\</span></span><br><span class=\"line\"><span class=\"string\">&#125;\"</span>;</span><br></pre></td></tr></table></figure>\n<p></p>\n<p><img src=\"/img/article/20190902/9.png\" alt=\"\"></p>\n<blockquote>\n<p></p>\n</blockquote>\n<h1></h1>\n<p></p>\n"},{"title":"OpenGL ES--","catalog":true,"toc_nav_num":true,"date":"2019-08-01T11:09:32.000Z","subtitle":"About OpenGL ES","header-img":"/img/article_header/article_header.png","busuanzi":true,"_content":"\n> OpenGL ES\n\n# \n\nOpenGL ES`glDrawArrays``glDrawElements``glDrawRangeElements``glDrawArraysInstanced``glDrawElementsInstanced`\n\nOpenGL ES 3.0\n- \n- \n- \n\n## \n\n3DOpenGL ES`GL_TRIANGLES``GL_TRIANGLE_STRIP``GL_TRIANGLE_FAN`\n\n![](/img/article/20190801/1.png)\n\n`GL_TRIANGLES`(v<sup>0</sup>, v<sup>1</sup>, v<sup>2</sup>)(v<sup>3</sup>, v<sup>4</sup>, v<sup>5</sup>)n/3n`glDraw*``count`\n\n`GL_TRIANGLE_STRIP`4(v<sup>0</sup>, v<sup>1</sup>, v<sup>2</sup>)(v<sup>2</sup>, v<sup>1</sup>, v<sup>3</sup>)(v<sup>2</sup>, v<sup>3</sup>, v<sup>4</sup>)(v<sup>4</sup>, v<sup>3</sup>, v<sup>5</sup>)n-2n`glDraw*``count`\n\n`GL_TRIANGLE_FAN`3(v<sup>0</sup>, v<sup>1</sup>, v<sup>2</sup>)(v<sup>0</sup>, v<sup>2</sup>, v<sup>3</sup>)(v<sup>0</sup>, v<sup>3</sup>, v<sup>4</sup>)n-2n`glDraw*``count`\n\n## \n\nOpenGL ES`GL_LINES``GL_LINE_STRIP``GL_LINE_LOOP`\n\n![](/img/article/20190801/2.png)\n\n`GL_LINES`(v<sup>0</sup>, v<sup>1</sup>)(v<sup>2</sup>, v<sup>3</sup>)(v<sup>4</sup>, v<sup>5</sup>)n/2n`glDraw*``count`\n\n`GL_LINE_STRIP`3(v<sup>0</sup>, v<sup>1</sup>)(v<sup>1</sup>, v<sup>2</sup>)(v<sup>2</sup>, v<sup>3</sup>)n-1n`glDraw*``count`\n\nv<sup>n-1</sup>v<sup>0</sup>`GL_LINE_LOOP``GL_LINE_STRIP`(v<sup>0</sup>, v<sup>1</sup>)(v<sup>1</sup>, v<sup>2</sup>)(v<sup>2</sup>, v<sup>3</sup>)(v<sup>3</sup>, v<sup>4</sup>)(v<sup>4</sup>, v<sup>0</sup>)nn`glDraw*``count`\n\n`glLineWidth`API\n\n``` objc\n/**\n \n\n @param width#> 1.0 description#>\n @return void\n */\nglLineWidth(GLfloat width);\n```\n\n`glLineWidth`OpenGL ES 3.0OpenGL1\n\n\n``` objc\nGLfloat lineWidthRange[2];\nglGetFloatv(GL_ALIASED_LINE_WIDTH_RANGE, lineWidthRange);\n```\n\n## \n\nOpenGL ES`GL_POINTS`4\n\n`gl_PointSize``gl_PointSize``gl_PointSize`OpenGL ES 3.0\n``` objc\nGLfloat pointSizeRange[2];\nglGetFloatv(GL_ALIASED_POINT_SIZE_RANGE, pointSizeRange);\n```\n\nOpenGL ES 3.0(0, 0)(, )(, )\n\n`gl_PointCoord``mediump`vec2`gl_PointCoord`0~1\n\n# \n\nOpenGL ES5API`glDrawArrays``glDrawElements``glDrawRangeElements``glDrawArraysInstanced``glDrawElementsInstanced`\n\n``` objc\n/**\n \n\n @param mode#> GL_POINTS, GL_LINES, GL_LINES_STRIP, GL_LINES_LOOP, GL_TRIANGLES, GL_TRIANGLES_STRIP, GL_TRIANGLE_FAN description#>\n @param first#>  description#>\n @param count#>  description#>\n @return void\n */\nglDrawArrays(GLenum mode, GLint first, GLsizei count);\n\n/**\n \n\n @param mode#> GL_POINTS, GL_LINES, GL_LINES_STRIP, GL_LINES_LOOP, GL_TRIANGLES, GL_TRIANGLES_STRIP, GL_TRIANGLE_FAN description#>\n @param count#>  description#>\n @param type#> indicesGL_UNSIGNED_BYTE, GL_UNSIGNED_SHORT, GL_UNSIGNED_INT description#>\n @param indices#>  description#>\n @return void\n */\nglDrawElements(GLenum mode, GLsizei count, GLenum type, const GLvoid *indices)\n\n/**\n \n\n @param mode#> GL_POINTS, GL_LINES, GL_LINES_STRIP, GL_LINES_LOOP, GL_TRIANGLES, GL_TRIANGLES_STRIP, GL_TRIANGLE_FAN description#>\n @param start#> indices description#>\n @param end#> indices description#> \n @param count#>  description#>\n @param type#> indicesGL_UNSIGNED_BYTE, GL_UNSIGNED_SHORT, GL_UNSIGNED_INT description#>\n @param indices#>  description#>\n @return void\n */\nglDrawRangeElements(GLenum mode, GLuint start, GLuint end, GLsizei count, GLenum type, const GLvoid *indices)\n```\n\n`glDrawArrays`3D\n\n`glDrawArrays`\n\n``` objc\nGLfloat vertices[] = { .. };\nglEnableVertexAttribArray(0);\nglVertexAttribPointer(0, 3, GL_FLOAT, GL_FALSE, 0, vertices);\nglDrawArrays(GL_TRIANGLES, 0, 36);\n```\n\n`glDrawArrays``glDrawArrays`24`GL_TRIANGLE_FAN`36`GL_TRIANGLES`8\n\n`glDrawElements`\n\n``` objc\nGLfloat vertices[] = { .. };\nGLubyte indices[36] = {\n    0, 1, 2, 0, 2, 3,\n    0, 3, 4, 0, 4, 5,\n    7, 1, 6, 7, 2, 1,\n    7, 5, 4, 7, 6, 5,\n    7, 3, 2, 7, 4, 3\n}\nglEnableVertexAttribArray(0);\nglVertexAttribPointer(0, 3, GL_FLOAT, GL_FALSE, 0, vertices);\nglDrawElements(GL_TRIANGLES, 36, GL_USINGED_BYTE, indices);\n```\n\n`glDrawElements``glDrawArrays``glDrawElements`GPU`glDrawArrays``glDrawElements`\n\n## \n\nAPI\n\n`glDrawElements``glDrawElementsInstances``glDrawRangeElements``GL_UNSIGNED_BYTE``GL_UNSIGNED_SHORT`25565535\n\n(0, 1, 2, 3)(8, 9, 10, 11)`glDrawElements*``GL_UNSIGNED_BYTE`(0, 1, 2, 3, 255, 8, 9, 10, 11)\n\n\n``` objc\nglEnable(GL_PRIMITIVE_RESTART_FIXED_INDEX);\n// draw primitives\nglDisable(GL_PRIMITIVE_RESTART_FIXED_INDEX);\n```\n\n\n\n``` objc\n// \nGLfloat vertices[] = {\n    -0.75f, 0, 0,\n    -0.75f, 0.75f, 0,\n    -0.25f, 0, 0,\n    -0.25f, 0.75, 0,\n    \n    0.75f, 0, 0,\n    0.75f, 0.75f, 0,\n    0.25f, 0, 0,\n    0.25f, 0.75, 0\n};\nGLfloat colors[] = {\n    1.0f, 0.0f, 0.0f, 1.0f,\n    0.0f, 1.0f, 0.0f, 1.0f,\n    0.0f, 0.0f, 1.0f, 1.0f,\n    0.0f, 1.0f, 0.0f, 1.0f,\n    \n    1.0f, 0.0f, 0.0f, 1.0f,\n    0.0f, 1.0f, 0.0f, 1.0f,\n    0.0f, 0.0f, 1.0f, 1.0f,\n    0.0f, 1.0f, 0.0f, 1.0f\n};\nGLushort indices[] = {0, 1, 2, 3, 65535, 4, 5, 6, 7};\n\nGLuint vbos[3];\nglGenBuffers(3, vbos);\nglBindBuffer(GL_ARRAY_BUFFER, vbos[0]);\nglBufferData(GL_ARRAY_BUFFER, sizeof(vertices), vertices, GL_STATIC_DRAW);\n\nglBindBuffer(GL_ARRAY_BUFFER, vbos[1]);\nglBufferData(GL_ARRAY_BUFFER, sizeof(colors), colors, GL_STATIC_DRAW);\n\nglBindBuffer(GL_ELEMENT_ARRAY_BUFFER, vbos[2]);\nglBufferData(GL_ELEMENT_ARRAY_BUFFER, sizeof(indices), indices, GL_STATIC_DRAW);\n\nglGenVertexArrays(1, &vaos);\nglBindVertexArray(vaos);\n\nglBindBuffer(GL_ARRAY_BUFFER, vbos[0]);\nglEnableVertexAttribArray(0);\nglVertexAttribPointer(0, 3, GL_FLOAT, GL_FALSE, 3 * sizeof(GLfloat), 0);\nglBindBuffer(GL_ARRAY_BUFFER, vbos[1]);\nglEnableVertexAttribArray(1);\nglVertexAttribPointer(1, 4, GL_FLOAT, GL_FALSE, 4 * sizeof(GLfloat), 0);\nglBindBuffer(GL_ELEMENT_ARRAY_BUFFER, vbos[2]);\n\nglBindVertexArray(0);\n\n// \nglEnable(GL_PRIMITIVE_RESTART_FIXED_INDEX);\n\nglBindVertexArray(vaos);\nglDrawElements(GL_TRIANGLE_STRIP, 9, GL_UNSIGNED_SHORT, 0);\n\nglDisable(GL_PRIMITIVE_RESTART_FIXED_INDEX);\n```\n\n## \n\n[](/article/2019/opengl-es-glsl-0715/#)\n\ni | \n- | -\nGL_POINT | i\nGL_LINES | 2i\nGL_LINE_LOOP | i < ni + 1i = n1\nGL_LINE_STRIP | i + 1\nGL_TRIANGLES | 3i\nGL_TRIANGLE_STRIP | i + 2\nGL_TRIANGLE_FAN | i + 2\n\n> i1nn\n\n## \n\nAPIOpenGL ESAPICPU\n\n``` objc\n/**\n \n\n @param mode#> GL_POINTS, GL_LINES, GL_LINES_STRIP, GL_LINES_LOOP, GL_TRIANGLES, GL_TRIANGLES_STRIP, GL_TRIANGLE_FAN description#>\n @param first#>  description#>\n @param count#>  description#>\n @param instancecount#>  description#>\n @return void\n */\nglDrawArraysInstanced(GLenum mode, GLint first, GLsizei count, GLsizei instancecount);\n\n/**\n \n\n @param mode#> GL_POINTS, GL_LINES, GL_LINES_STRIP, GL_LINES_LOOP, GL_TRIANGLES, GL_TRIANGLES_STRIP, GL_TRIANGLE_FAN description#>\n @param count#>  description#>\n @param type#> indicesGL_UNSIGNED_BYTE, GL_UNSIGNED_SHORT, GL_UNSIGNED_INT description#>\n @param indices#>  description#>\n @param instancecount#>  description#>\n @return void\n */\nglDrawElementsInstanced(GLenum mode, GLsizei count, GLenum type, const GLvoid *indices, GLsizei instancecount);\n```\n\nOpenGL ES\n\n``` objc\n/**\n \n\n @param index#>  description#>\n @param divisor#> index description#>\n @return void\n */\nglVertexAttribDivisor(GLuint index, GLuint divisor);\n```\n\n`glVertexAttribDivisor``divisor``divisor`1[](https://github.com/danginsburg/opengles3-book/blob/master/Chapter_7/Instancing/Instancing.c)\n\n`glInstanceID`OpenGL ES 3.0API`gl_InstanceID``gl_InstanceID`0\n\n## \n\n`glDrawElements``glDrawElementsInstanced``GL_TRIANGLES``glDrawElements*`\n\nOpenGL ESGPUGPU\n\n\n\n``` objc\n// \nGLfloat vertices[] = {\n    -0.75f, 0, 0,\n    -0.75f, 0.75f, 0,\n    -0.25f, 0, 0,\n    -0.25f, 0.75, 0,\n    \n    0.75f, 0, 0,\n    0.75f, 0.75f, 0,\n    0.25f, 0, 0,\n    0.25f, 0.75, 0\n};\nGLfloat colors[] = {\n    1.0f, 0.0f, 0.0f, 1.0f,\n    0.0f, 1.0f, 0.0f, 1.0f,\n    0.0f, 0.0f, 1.0f, 1.0f,\n    0.0f, 1.0f, 0.0f, 1.0f,\n    \n    1.0f, 0.0f, 0.0f, 1.0f,\n    0.0f, 1.0f, 0.0f, 1.0f,\n    0.0f, 0.0f, 1.0f, 1.0f,\n    0.0f, 1.0f, 0.0f, 1.0f\n};\nGLushort indices[] = {0, 1, 2, 3, 3, 4, 4, 5, 6, 7};\n\nGLuint vbos[3];\nglGenBuffers(3, vbos);\nglBindBuffer(GL_ARRAY_BUFFER, vbos[0]);\nglBufferData(GL_ARRAY_BUFFER, sizeof(vertices), vertices, GL_STATIC_DRAW);\n\nglBindBuffer(GL_ARRAY_BUFFER, vbos[1]);\nglBufferData(GL_ARRAY_BUFFER, sizeof(colors), colors, GL_STATIC_DRAW);\n\nglBindBuffer(GL_ELEMENT_ARRAY_BUFFER, vbos[2]);\nglBufferData(GL_ELEMENT_ARRAY_BUFFER, sizeof(indices), indices, GL_STATIC_DRAW);\n\nglGenVertexArrays(1, &vaos);\nglBindVertexArray(vaos);\n\nglBindBuffer(GL_ARRAY_BUFFER, vbos[0]);\nglEnableVertexAttribArray(0);\nglVertexAttribPointer(0, 3, GL_FLOAT, GL_FALSE, 3 * sizeof(GLfloat), 0);\nglBindBuffer(GL_ARRAY_BUFFER, vbos[1]);\nglEnableVertexAttribArray(1);\nglVertexAttribPointer(1, 4, GL_FLOAT, GL_FALSE, 4 * sizeof(GLfloat), 0);\nglBindBuffer(GL_ELEMENT_ARRAY_BUFFER, vbos[2]);\n\nglBindVertexArray(0);\n\n// \nglBindVertexArray(vaos);\nglDrawElements(GL_TRIANGLE_STRIP, 10, GL_UNSIGNED_SHORT, 0);\n```\n\n# \n\n`glDraw***`(x, y, z, w)\n\n![OpenGL ES](/img/article/20190801/3.png)\n\n## \n\nOpenGL ES\n\n![](/img/article/20190801/4.png)\n\n### \n\n(x<sub>c</sub>, y<sub>c</sub>, z<sub>c</sub>, w<sub>c</sub>)(x<sub>c</sub>, y<sub>c</sub>, z<sub>c</sub>, w<sub>c</sub>)\n\n6-w<sub>c</sub> <= x<sub>c</sub> <= w<sub>c</sub>-w<sub>c</sub> <= y<sub>c</sub> <= w<sub>c</sub>-w<sub>c</sub> <= z<sub>c</sub> <= w<sub>c</sub>\n\n![](/img/article/20190801/5.png)\n\n`GL_TRIANGLES``GL_LINES`\n- --\n- --\n- --\n\n-1.01.0\n\n## \n\n(X<sub>c</sub>, Y<sub>c</sub>, Z<sub>c</sub>, W<sub>c</sub>)(X<sub>c</sub>, Y<sub>c</sub>, Z<sub>c</sub>)W<sub>c</sub>(X<sub>c</sub>/W<sub>c</sub>)(Y<sub>c</sub>/W<sub>c</sub>)(Z<sub>c</sub>/W<sub>c</sub>)(X<sub>d</sub>, Y<sub>d</sub>, Z<sub>d</sub>)[-1.0...1.0](X<sub>d</sub>, Y<sub>d</sub>)(Z<sub>d</sub>)`glDepthRangef``near``far`Z\n\n## \n\nOpenGL ESAPI\n\n``` objc\n/**\n \n\n @param x#> x description#>\n @param y#> y description#>\n @param width#> 0 description#>\n @param height#> 0 description#>\n @return void\n */\nglViewport(GLint x, GLint y, GLsizei width, GLsizei height);\n```\n\n(x<sub>d</sub>, y<sub>d</sub>, z<sub>d</sub>)(x<sub>w</sub>, y<sub>w</sub>, z<sub>w</sub>)\n\n![](/img/article/20190801/6.png)\n\no<sub>x</sub>=x+w/2o<sub>y</sub>=y+h/2nf\nnfAPI\n\n```objc\n/**\n \n\n @param zNear#> 0.0(0.0, 1.0) description#>\n @param zFar#> 1.0(0.0, 1.0) description#>\n @return void\n */\nglDepthRangef(GLclampf zNear, GLclampf zFar);\n```\n\n`glDepthRangef``glViewport`\n\n# \n\n(x, y)(x, y)\n\n![OpenGL ES](/img/article/20190801/7.png)\n\n## \n\nculling\n\n\n\n![](/img/article/20190801/8.png)\n\nCWCCWAPI\n\n```objc\n/**\n \n\n @param mode#> GL_CWGL_CCWGL_CCW description#>\n @return void\n */\nglFrontFace(GLenum mode);\n```\n\nAPI\n\n``` objc\n/**\n \n\n @param mode#> GL_FROUNTGL_BACKGL_FROUNT_AND_BACKGL_BACK description#>\n @return void\n */\nglCullFace(GLenum mode);\n```\n\n`GL_CULL_FACE`API\n\n``` objc\n/**\n \n\n @param cap#> GL_CULL_FACE description#>\n @return void\n */\nglEnable(GLenum cap);\n\n/**\n \n\n @param cap#> GL_CULL_FACE description#>\n @return void\n */\nglDisable(GLenum cap);\n```\n\nOpenGL ES`glEnable(GL_CULL_FACE)``glCullFace``glFrontFace`\n\n> GPUOpenGL ES\n\n## \n\n\n\n--+--\n\n\n\n``` objc\n/**\n \n\n @param factor#>  description#>\n @param units#>  description#>\n @return void\n */\nglPolygonOffset(GLfloat factor, GLfloat units);\n```\n\n = m *  + r * mOpenGL ESrOpenGL ES\n`glEnable(GL_POLYGON_OFFSET_FILL)``glDisable(GL_POLYGON_OFFSET_FILL)`\n\n\n``` objc\nconst float polygonOffsetFactor = -1.0f;\nconst float polygonOffsetUnits = -2.0f;\n\nglClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);\n\n// load vertex shader\n// set the appropriate transformation matrices\n// set the vertex attribute state\n\n// draw the SMALLER quad\nglDrawArrays(GL_TRIANGLE_FAN, 0, 4);\n\n// set the depth func to <= as polygons are coplanar\nglDrawFunc(GL_LEQUAL);\n\nglEnable(GL_POLYGON_OFFSET_FILL);\n\nglPolygonOffset(polygonOffsetFactor, polygonOffsetUnits);\n\n// set the vertex attribute state\n\n// draw the LARGER quad\nglDrawArrays(GL_TRIANGLE_FAN, 0, 4);\n```\n\n# \n\n\n\n\n\n``` objc\n/**\n \n\n @param target#> GL_ANY_SAMPLES_PASSEDGL_ANY_SAMPLES_PASSED_CONSERVATIVEGL_TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN description#>\n @param id#>  description#>\n @return void\n */\nglBeginQuery(GLenum target, GLuint id);\n    \n    \n/**\n \n\n @param target#> GL_ANY_SAMPLES_PASSEDGL_ANY_SAMPLES_PASSED_CONSERVATIVEGL_TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN description#>\n @return void\n */\nglEndQuery(GLenum target);\n```\n\n`GL_ANY_SAMPLES_PASSED``GL_ANY_SAMPLES_PASSED_CONSERVATIVE``GL_ANY_SAMPLES_PASSED_CONSERVATIVE``GL_TRUE`\n\n`id``glGenQueries``glDeleteQueries`\n\n``` objc\n/**\n id\n\n @param n#>  description#>\n @param ids#>  description#>\n @return void\n */\nglGenQueries(GLsizei n, GLuint *ids);\n    \n    \n/**\n id\n\n @param n#>  description#>\n @param ids#>  description#>\n @return void\n */ \nglDeleteQueries(GLsizei n, const GLuint *ids);\n```\n\n`glBeginQuery``glEndQuery``glGetQueryObjectuiv`\n\n``` objc\n/**\n \n\n @param id#>  description#>\n @param pname#> GL_QUERY_RESULTGL_QUERY_RESULT_AVAILABLE description#>\n @param params#>  description#>\n @return void\n */\nglGetQueryObjectuiv(GLuint id, GLenum pname, GLuint *params);\n```\n\n# \n\nOpenGL ES","source":"_posts/2019/opengl-es-primitive-0801.md","raw":"---\ntitle: \"OpenGL ES--\"\ncatalog: true\ntoc_nav_num: true\ndate: 2019-08-01 19:09:32\nsubtitle: \"About OpenGL ES\"\nheader-img: \"/img/article_header/article_header.png\"\nbusuanzi: true\ntags:\n- iOS\n\n---\n\n> OpenGL ES\n\n# \n\nOpenGL ES`glDrawArrays``glDrawElements``glDrawRangeElements``glDrawArraysInstanced``glDrawElementsInstanced`\n\nOpenGL ES 3.0\n- \n- \n- \n\n## \n\n3DOpenGL ES`GL_TRIANGLES``GL_TRIANGLE_STRIP``GL_TRIANGLE_FAN`\n\n![](/img/article/20190801/1.png)\n\n`GL_TRIANGLES`(v<sup>0</sup>, v<sup>1</sup>, v<sup>2</sup>)(v<sup>3</sup>, v<sup>4</sup>, v<sup>5</sup>)n/3n`glDraw*``count`\n\n`GL_TRIANGLE_STRIP`4(v<sup>0</sup>, v<sup>1</sup>, v<sup>2</sup>)(v<sup>2</sup>, v<sup>1</sup>, v<sup>3</sup>)(v<sup>2</sup>, v<sup>3</sup>, v<sup>4</sup>)(v<sup>4</sup>, v<sup>3</sup>, v<sup>5</sup>)n-2n`glDraw*``count`\n\n`GL_TRIANGLE_FAN`3(v<sup>0</sup>, v<sup>1</sup>, v<sup>2</sup>)(v<sup>0</sup>, v<sup>2</sup>, v<sup>3</sup>)(v<sup>0</sup>, v<sup>3</sup>, v<sup>4</sup>)n-2n`glDraw*``count`\n\n## \n\nOpenGL ES`GL_LINES``GL_LINE_STRIP``GL_LINE_LOOP`\n\n![](/img/article/20190801/2.png)\n\n`GL_LINES`(v<sup>0</sup>, v<sup>1</sup>)(v<sup>2</sup>, v<sup>3</sup>)(v<sup>4</sup>, v<sup>5</sup>)n/2n`glDraw*``count`\n\n`GL_LINE_STRIP`3(v<sup>0</sup>, v<sup>1</sup>)(v<sup>1</sup>, v<sup>2</sup>)(v<sup>2</sup>, v<sup>3</sup>)n-1n`glDraw*``count`\n\nv<sup>n-1</sup>v<sup>0</sup>`GL_LINE_LOOP``GL_LINE_STRIP`(v<sup>0</sup>, v<sup>1</sup>)(v<sup>1</sup>, v<sup>2</sup>)(v<sup>2</sup>, v<sup>3</sup>)(v<sup>3</sup>, v<sup>4</sup>)(v<sup>4</sup>, v<sup>0</sup>)nn`glDraw*``count`\n\n`glLineWidth`API\n\n``` objc\n/**\n \n\n @param width#> 1.0 description#>\n @return void\n */\nglLineWidth(GLfloat width);\n```\n\n`glLineWidth`OpenGL ES 3.0OpenGL1\n\n\n``` objc\nGLfloat lineWidthRange[2];\nglGetFloatv(GL_ALIASED_LINE_WIDTH_RANGE, lineWidthRange);\n```\n\n## \n\nOpenGL ES`GL_POINTS`4\n\n`gl_PointSize``gl_PointSize``gl_PointSize`OpenGL ES 3.0\n``` objc\nGLfloat pointSizeRange[2];\nglGetFloatv(GL_ALIASED_POINT_SIZE_RANGE, pointSizeRange);\n```\n\nOpenGL ES 3.0(0, 0)(, )(, )\n\n`gl_PointCoord``mediump`vec2`gl_PointCoord`0~1\n\n# \n\nOpenGL ES5API`glDrawArrays``glDrawElements``glDrawRangeElements``glDrawArraysInstanced``glDrawElementsInstanced`\n\n``` objc\n/**\n \n\n @param mode#> GL_POINTS, GL_LINES, GL_LINES_STRIP, GL_LINES_LOOP, GL_TRIANGLES, GL_TRIANGLES_STRIP, GL_TRIANGLE_FAN description#>\n @param first#>  description#>\n @param count#>  description#>\n @return void\n */\nglDrawArrays(GLenum mode, GLint first, GLsizei count);\n\n/**\n \n\n @param mode#> GL_POINTS, GL_LINES, GL_LINES_STRIP, GL_LINES_LOOP, GL_TRIANGLES, GL_TRIANGLES_STRIP, GL_TRIANGLE_FAN description#>\n @param count#>  description#>\n @param type#> indicesGL_UNSIGNED_BYTE, GL_UNSIGNED_SHORT, GL_UNSIGNED_INT description#>\n @param indices#>  description#>\n @return void\n */\nglDrawElements(GLenum mode, GLsizei count, GLenum type, const GLvoid *indices)\n\n/**\n \n\n @param mode#> GL_POINTS, GL_LINES, GL_LINES_STRIP, GL_LINES_LOOP, GL_TRIANGLES, GL_TRIANGLES_STRIP, GL_TRIANGLE_FAN description#>\n @param start#> indices description#>\n @param end#> indices description#> \n @param count#>  description#>\n @param type#> indicesGL_UNSIGNED_BYTE, GL_UNSIGNED_SHORT, GL_UNSIGNED_INT description#>\n @param indices#>  description#>\n @return void\n */\nglDrawRangeElements(GLenum mode, GLuint start, GLuint end, GLsizei count, GLenum type, const GLvoid *indices)\n```\n\n`glDrawArrays`3D\n\n`glDrawArrays`\n\n``` objc\nGLfloat vertices[] = { .. };\nglEnableVertexAttribArray(0);\nglVertexAttribPointer(0, 3, GL_FLOAT, GL_FALSE, 0, vertices);\nglDrawArrays(GL_TRIANGLES, 0, 36);\n```\n\n`glDrawArrays``glDrawArrays`24`GL_TRIANGLE_FAN`36`GL_TRIANGLES`8\n\n`glDrawElements`\n\n``` objc\nGLfloat vertices[] = { .. };\nGLubyte indices[36] = {\n    0, 1, 2, 0, 2, 3,\n    0, 3, 4, 0, 4, 5,\n    7, 1, 6, 7, 2, 1,\n    7, 5, 4, 7, 6, 5,\n    7, 3, 2, 7, 4, 3\n}\nglEnableVertexAttribArray(0);\nglVertexAttribPointer(0, 3, GL_FLOAT, GL_FALSE, 0, vertices);\nglDrawElements(GL_TRIANGLES, 36, GL_USINGED_BYTE, indices);\n```\n\n`glDrawElements``glDrawArrays``glDrawElements`GPU`glDrawArrays``glDrawElements`\n\n## \n\nAPI\n\n`glDrawElements``glDrawElementsInstances``glDrawRangeElements``GL_UNSIGNED_BYTE``GL_UNSIGNED_SHORT`25565535\n\n(0, 1, 2, 3)(8, 9, 10, 11)`glDrawElements*``GL_UNSIGNED_BYTE`(0, 1, 2, 3, 255, 8, 9, 10, 11)\n\n\n``` objc\nglEnable(GL_PRIMITIVE_RESTART_FIXED_INDEX);\n// draw primitives\nglDisable(GL_PRIMITIVE_RESTART_FIXED_INDEX);\n```\n\n\n\n``` objc\n// \nGLfloat vertices[] = {\n    -0.75f, 0, 0,\n    -0.75f, 0.75f, 0,\n    -0.25f, 0, 0,\n    -0.25f, 0.75, 0,\n    \n    0.75f, 0, 0,\n    0.75f, 0.75f, 0,\n    0.25f, 0, 0,\n    0.25f, 0.75, 0\n};\nGLfloat colors[] = {\n    1.0f, 0.0f, 0.0f, 1.0f,\n    0.0f, 1.0f, 0.0f, 1.0f,\n    0.0f, 0.0f, 1.0f, 1.0f,\n    0.0f, 1.0f, 0.0f, 1.0f,\n    \n    1.0f, 0.0f, 0.0f, 1.0f,\n    0.0f, 1.0f, 0.0f, 1.0f,\n    0.0f, 0.0f, 1.0f, 1.0f,\n    0.0f, 1.0f, 0.0f, 1.0f\n};\nGLushort indices[] = {0, 1, 2, 3, 65535, 4, 5, 6, 7};\n\nGLuint vbos[3];\nglGenBuffers(3, vbos);\nglBindBuffer(GL_ARRAY_BUFFER, vbos[0]);\nglBufferData(GL_ARRAY_BUFFER, sizeof(vertices), vertices, GL_STATIC_DRAW);\n\nglBindBuffer(GL_ARRAY_BUFFER, vbos[1]);\nglBufferData(GL_ARRAY_BUFFER, sizeof(colors), colors, GL_STATIC_DRAW);\n\nglBindBuffer(GL_ELEMENT_ARRAY_BUFFER, vbos[2]);\nglBufferData(GL_ELEMENT_ARRAY_BUFFER, sizeof(indices), indices, GL_STATIC_DRAW);\n\nglGenVertexArrays(1, &vaos);\nglBindVertexArray(vaos);\n\nglBindBuffer(GL_ARRAY_BUFFER, vbos[0]);\nglEnableVertexAttribArray(0);\nglVertexAttribPointer(0, 3, GL_FLOAT, GL_FALSE, 3 * sizeof(GLfloat), 0);\nglBindBuffer(GL_ARRAY_BUFFER, vbos[1]);\nglEnableVertexAttribArray(1);\nglVertexAttribPointer(1, 4, GL_FLOAT, GL_FALSE, 4 * sizeof(GLfloat), 0);\nglBindBuffer(GL_ELEMENT_ARRAY_BUFFER, vbos[2]);\n\nglBindVertexArray(0);\n\n// \nglEnable(GL_PRIMITIVE_RESTART_FIXED_INDEX);\n\nglBindVertexArray(vaos);\nglDrawElements(GL_TRIANGLE_STRIP, 9, GL_UNSIGNED_SHORT, 0);\n\nglDisable(GL_PRIMITIVE_RESTART_FIXED_INDEX);\n```\n\n## \n\n[](/article/2019/opengl-es-glsl-0715/#)\n\ni | \n- | -\nGL_POINT | i\nGL_LINES | 2i\nGL_LINE_LOOP | i < ni + 1i = n1\nGL_LINE_STRIP | i + 1\nGL_TRIANGLES | 3i\nGL_TRIANGLE_STRIP | i + 2\nGL_TRIANGLE_FAN | i + 2\n\n> i1nn\n\n## \n\nAPIOpenGL ESAPICPU\n\n``` objc\n/**\n \n\n @param mode#> GL_POINTS, GL_LINES, GL_LINES_STRIP, GL_LINES_LOOP, GL_TRIANGLES, GL_TRIANGLES_STRIP, GL_TRIANGLE_FAN description#>\n @param first#>  description#>\n @param count#>  description#>\n @param instancecount#>  description#>\n @return void\n */\nglDrawArraysInstanced(GLenum mode, GLint first, GLsizei count, GLsizei instancecount);\n\n/**\n \n\n @param mode#> GL_POINTS, GL_LINES, GL_LINES_STRIP, GL_LINES_LOOP, GL_TRIANGLES, GL_TRIANGLES_STRIP, GL_TRIANGLE_FAN description#>\n @param count#>  description#>\n @param type#> indicesGL_UNSIGNED_BYTE, GL_UNSIGNED_SHORT, GL_UNSIGNED_INT description#>\n @param indices#>  description#>\n @param instancecount#>  description#>\n @return void\n */\nglDrawElementsInstanced(GLenum mode, GLsizei count, GLenum type, const GLvoid *indices, GLsizei instancecount);\n```\n\nOpenGL ES\n\n``` objc\n/**\n \n\n @param index#>  description#>\n @param divisor#> index description#>\n @return void\n */\nglVertexAttribDivisor(GLuint index, GLuint divisor);\n```\n\n`glVertexAttribDivisor``divisor``divisor`1[](https://github.com/danginsburg/opengles3-book/blob/master/Chapter_7/Instancing/Instancing.c)\n\n`glInstanceID`OpenGL ES 3.0API`gl_InstanceID``gl_InstanceID`0\n\n## \n\n`glDrawElements``glDrawElementsInstanced``GL_TRIANGLES``glDrawElements*`\n\nOpenGL ESGPUGPU\n\n\n\n``` objc\n// \nGLfloat vertices[] = {\n    -0.75f, 0, 0,\n    -0.75f, 0.75f, 0,\n    -0.25f, 0, 0,\n    -0.25f, 0.75, 0,\n    \n    0.75f, 0, 0,\n    0.75f, 0.75f, 0,\n    0.25f, 0, 0,\n    0.25f, 0.75, 0\n};\nGLfloat colors[] = {\n    1.0f, 0.0f, 0.0f, 1.0f,\n    0.0f, 1.0f, 0.0f, 1.0f,\n    0.0f, 0.0f, 1.0f, 1.0f,\n    0.0f, 1.0f, 0.0f, 1.0f,\n    \n    1.0f, 0.0f, 0.0f, 1.0f,\n    0.0f, 1.0f, 0.0f, 1.0f,\n    0.0f, 0.0f, 1.0f, 1.0f,\n    0.0f, 1.0f, 0.0f, 1.0f\n};\nGLushort indices[] = {0, 1, 2, 3, 3, 4, 4, 5, 6, 7};\n\nGLuint vbos[3];\nglGenBuffers(3, vbos);\nglBindBuffer(GL_ARRAY_BUFFER, vbos[0]);\nglBufferData(GL_ARRAY_BUFFER, sizeof(vertices), vertices, GL_STATIC_DRAW);\n\nglBindBuffer(GL_ARRAY_BUFFER, vbos[1]);\nglBufferData(GL_ARRAY_BUFFER, sizeof(colors), colors, GL_STATIC_DRAW);\n\nglBindBuffer(GL_ELEMENT_ARRAY_BUFFER, vbos[2]);\nglBufferData(GL_ELEMENT_ARRAY_BUFFER, sizeof(indices), indices, GL_STATIC_DRAW);\n\nglGenVertexArrays(1, &vaos);\nglBindVertexArray(vaos);\n\nglBindBuffer(GL_ARRAY_BUFFER, vbos[0]);\nglEnableVertexAttribArray(0);\nglVertexAttribPointer(0, 3, GL_FLOAT, GL_FALSE, 3 * sizeof(GLfloat), 0);\nglBindBuffer(GL_ARRAY_BUFFER, vbos[1]);\nglEnableVertexAttribArray(1);\nglVertexAttribPointer(1, 4, GL_FLOAT, GL_FALSE, 4 * sizeof(GLfloat), 0);\nglBindBuffer(GL_ELEMENT_ARRAY_BUFFER, vbos[2]);\n\nglBindVertexArray(0);\n\n// \nglBindVertexArray(vaos);\nglDrawElements(GL_TRIANGLE_STRIP, 10, GL_UNSIGNED_SHORT, 0);\n```\n\n# \n\n`glDraw***`(x, y, z, w)\n\n![OpenGL ES](/img/article/20190801/3.png)\n\n## \n\nOpenGL ES\n\n![](/img/article/20190801/4.png)\n\n### \n\n(x<sub>c</sub>, y<sub>c</sub>, z<sub>c</sub>, w<sub>c</sub>)(x<sub>c</sub>, y<sub>c</sub>, z<sub>c</sub>, w<sub>c</sub>)\n\n6-w<sub>c</sub> <= x<sub>c</sub> <= w<sub>c</sub>-w<sub>c</sub> <= y<sub>c</sub> <= w<sub>c</sub>-w<sub>c</sub> <= z<sub>c</sub> <= w<sub>c</sub>\n\n![](/img/article/20190801/5.png)\n\n`GL_TRIANGLES``GL_LINES`\n- --\n- --\n- --\n\n-1.01.0\n\n## \n\n(X<sub>c</sub>, Y<sub>c</sub>, Z<sub>c</sub>, W<sub>c</sub>)(X<sub>c</sub>, Y<sub>c</sub>, Z<sub>c</sub>)W<sub>c</sub>(X<sub>c</sub>/W<sub>c</sub>)(Y<sub>c</sub>/W<sub>c</sub>)(Z<sub>c</sub>/W<sub>c</sub>)(X<sub>d</sub>, Y<sub>d</sub>, Z<sub>d</sub>)[-1.0...1.0](X<sub>d</sub>, Y<sub>d</sub>)(Z<sub>d</sub>)`glDepthRangef``near``far`Z\n\n## \n\nOpenGL ESAPI\n\n``` objc\n/**\n \n\n @param x#> x description#>\n @param y#> y description#>\n @param width#> 0 description#>\n @param height#> 0 description#>\n @return void\n */\nglViewport(GLint x, GLint y, GLsizei width, GLsizei height);\n```\n\n(x<sub>d</sub>, y<sub>d</sub>, z<sub>d</sub>)(x<sub>w</sub>, y<sub>w</sub>, z<sub>w</sub>)\n\n![](/img/article/20190801/6.png)\n\no<sub>x</sub>=x+w/2o<sub>y</sub>=y+h/2nf\nnfAPI\n\n```objc\n/**\n \n\n @param zNear#> 0.0(0.0, 1.0) description#>\n @param zFar#> 1.0(0.0, 1.0) description#>\n @return void\n */\nglDepthRangef(GLclampf zNear, GLclampf zFar);\n```\n\n`glDepthRangef``glViewport`\n\n# \n\n(x, y)(x, y)\n\n![OpenGL ES](/img/article/20190801/7.png)\n\n## \n\nculling\n\n\n\n![](/img/article/20190801/8.png)\n\nCWCCWAPI\n\n```objc\n/**\n \n\n @param mode#> GL_CWGL_CCWGL_CCW description#>\n @return void\n */\nglFrontFace(GLenum mode);\n```\n\nAPI\n\n``` objc\n/**\n \n\n @param mode#> GL_FROUNTGL_BACKGL_FROUNT_AND_BACKGL_BACK description#>\n @return void\n */\nglCullFace(GLenum mode);\n```\n\n`GL_CULL_FACE`API\n\n``` objc\n/**\n \n\n @param cap#> GL_CULL_FACE description#>\n @return void\n */\nglEnable(GLenum cap);\n\n/**\n \n\n @param cap#> GL_CULL_FACE description#>\n @return void\n */\nglDisable(GLenum cap);\n```\n\nOpenGL ES`glEnable(GL_CULL_FACE)``glCullFace``glFrontFace`\n\n> GPUOpenGL ES\n\n## \n\n\n\n--+--\n\n\n\n``` objc\n/**\n \n\n @param factor#>  description#>\n @param units#>  description#>\n @return void\n */\nglPolygonOffset(GLfloat factor, GLfloat units);\n```\n\n = m *  + r * mOpenGL ESrOpenGL ES\n`glEnable(GL_POLYGON_OFFSET_FILL)``glDisable(GL_POLYGON_OFFSET_FILL)`\n\n\n``` objc\nconst float polygonOffsetFactor = -1.0f;\nconst float polygonOffsetUnits = -2.0f;\n\nglClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);\n\n// load vertex shader\n// set the appropriate transformation matrices\n// set the vertex attribute state\n\n// draw the SMALLER quad\nglDrawArrays(GL_TRIANGLE_FAN, 0, 4);\n\n// set the depth func to <= as polygons are coplanar\nglDrawFunc(GL_LEQUAL);\n\nglEnable(GL_POLYGON_OFFSET_FILL);\n\nglPolygonOffset(polygonOffsetFactor, polygonOffsetUnits);\n\n// set the vertex attribute state\n\n// draw the LARGER quad\nglDrawArrays(GL_TRIANGLE_FAN, 0, 4);\n```\n\n# \n\n\n\n\n\n``` objc\n/**\n \n\n @param target#> GL_ANY_SAMPLES_PASSEDGL_ANY_SAMPLES_PASSED_CONSERVATIVEGL_TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN description#>\n @param id#>  description#>\n @return void\n */\nglBeginQuery(GLenum target, GLuint id);\n    \n    \n/**\n \n\n @param target#> GL_ANY_SAMPLES_PASSEDGL_ANY_SAMPLES_PASSED_CONSERVATIVEGL_TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN description#>\n @return void\n */\nglEndQuery(GLenum target);\n```\n\n`GL_ANY_SAMPLES_PASSED``GL_ANY_SAMPLES_PASSED_CONSERVATIVE``GL_ANY_SAMPLES_PASSED_CONSERVATIVE``GL_TRUE`\n\n`id``glGenQueries``glDeleteQueries`\n\n``` objc\n/**\n id\n\n @param n#>  description#>\n @param ids#>  description#>\n @return void\n */\nglGenQueries(GLsizei n, GLuint *ids);\n    \n    \n/**\n id\n\n @param n#>  description#>\n @param ids#>  description#>\n @return void\n */ \nglDeleteQueries(GLsizei n, const GLuint *ids);\n```\n\n`glBeginQuery``glEndQuery``glGetQueryObjectuiv`\n\n``` objc\n/**\n \n\n @param id#>  description#>\n @param pname#> GL_QUERY_RESULTGL_QUERY_RESULT_AVAILABLE description#>\n @param params#>  description#>\n @return void\n */\nglGetQueryObjectuiv(GLuint id, GLenum pname, GLuint *params);\n```\n\n# \n\nOpenGL ES","slug":"2019/opengl-es-primitive-0801","published":1,"updated":"2021-06-21T12:34:52.095Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckszp3nde000xifnt6emdmy4g","content":"<blockquote>\n<p>OpenGL ES</p>\n</blockquote>\n<h1 id=\"\"></h1>\n<p>OpenGL ES<code>glDrawArrays</code><code>glDrawElements</code><code>glDrawRangeElements</code><code>glDrawArraysInstanced</code><code>glDrawElementsInstanced</code></p>\n<p>OpenGL ES 3.0</p>\n<ul>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n<h2 id=\"\"></h2>\n<p>3DOpenGL ES<code>GL_TRIANGLES</code><code>GL_TRIANGLE_STRIP</code><code>GL_TRIANGLE_FAN</code></p>\n<p><img src=\"/img/article/20190801/1.png\" alt=\"\"></p>\n<p><code>GL_TRIANGLES</code>(v<sup>0</sup>, v<sup>1</sup>, v<sup>2</sup>)(v<sup>3</sup>, v<sup>4</sup>, v<sup>5</sup>)n/3n<code>glDraw*</code><code>count</code></p>\n<p><code>GL_TRIANGLE_STRIP</code>4(v<sup>0</sup>, v<sup>1</sup>, v<sup>2</sup>)(v<sup>2</sup>, v<sup>1</sup>, v<sup>3</sup>)(v<sup>2</sup>, v<sup>3</sup>, v<sup>4</sup>)(v<sup>4</sup>, v<sup>3</sup>, v<sup>5</sup>)n-2n<code>glDraw*</code><code>count</code></p>\n<p><code>GL_TRIANGLE_FAN</code>3(v<sup>0</sup>, v<sup>1</sup>, v<sup>2</sup>)(v<sup>0</sup>, v<sup>2</sup>, v<sup>3</sup>)(v<sup>0</sup>, v<sup>3</sup>, v<sup>4</sup>)n-2n<code>glDraw*</code><code>count</code></p>\n<h2 id=\"\"></h2>\n<p>OpenGL ES<code>GL_LINES</code><code>GL_LINE_STRIP</code><code>GL_LINE_LOOP</code></p>\n<p><img src=\"/img/article/20190801/2.png\" alt=\"\"></p>\n<p><code>GL_LINES</code>(v<sup>0</sup>, v<sup>1</sup>)(v<sup>2</sup>, v<sup>3</sup>)(v<sup>4</sup>, v<sup>5</sup>)n/2n<code>glDraw*</code><code>count</code></p>\n<p><code>GL_LINE_STRIP</code>3(v<sup>0</sup>, v<sup>1</sup>)(v<sup>1</sup>, v<sup>2</sup>)(v<sup>2</sup>, v<sup>3</sup>)n-1n<code>glDraw*</code><code>count</code></p>\n<p>v<sup>n-1</sup>v<sup>0</sup><code>GL_LINE_LOOP</code><code>GL_LINE_STRIP</code>(v<sup>0</sup>, v<sup>1</sup>)(v<sup>1</sup>, v<sup>2</sup>)(v<sup>2</sup>, v<sup>3</sup>)(v<sup>3</sup>, v<sup>4</sup>)(v<sup>4</sup>, v<sup>0</sup>)nn<code>glDraw*</code><code>count</code></p>\n<p><code>glLineWidth</code>API</p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param width#&gt; 1.0 description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glLineWidth(GLfloat width);</span><br></pre></td></tr></table></figure>\n<p><code>glLineWidth</code>OpenGL ES 3.0OpenGL1<br>\n</p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">GLfloat lineWidthRange[<span class=\"number\">2</span>];</span><br><span class=\"line\">glGetFloatv(GL_ALIASED_LINE_WIDTH_RANGE, lineWidthRange);</span><br></pre></td></tr></table></figure>\n<h2 id=\"\"></h2>\n<p>OpenGL ES<code>GL_POINTS</code>4</p>\n<p><code>gl_PointSize</code><code>gl_PointSize</code><code>gl_PointSize</code>OpenGL ES 3.0</p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">GLfloat pointSizeRange[<span class=\"number\">2</span>];</span><br><span class=\"line\">glGetFloatv(GL_ALIASED_POINT_SIZE_RANGE, pointSizeRange);</span><br></pre></td></tr></table></figure>\n<p>OpenGL ES 3.0(0, 0)(, )(, )</p>\n<p><code>gl_PointCoord</code><code>mediump</code>vec2<code>gl_PointCoord</code>0~1</p>\n<h1 id=\"\"></h1>\n<p>OpenGL ES5API<code>glDrawArrays</code><code>glDrawElements</code><code>glDrawRangeElements</code><code>glDrawArraysInstanced</code><code>glDrawElementsInstanced</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param mode#&gt; GL_POINTS, GL_LINES, GL_LINES_STRIP, GL_LINES_LOOP, GL_TRIANGLES, GL_TRIANGLES_STRIP, GL_TRIANGLE_FAN description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param first#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param count#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glDrawArrays(GLenum mode, GLint first, GLsizei count);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param mode#&gt; GL_POINTS, GL_LINES, GL_LINES_STRIP, GL_LINES_LOOP, GL_TRIANGLES, GL_TRIANGLES_STRIP, GL_TRIANGLE_FAN description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param count#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param type#&gt; indicesGL_UNSIGNED_BYTE, GL_UNSIGNED_SHORT, GL_UNSIGNED_INT description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param indices#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glDrawElements(GLenum mode, GLsizei count, GLenum type, <span class=\"keyword\">const</span> GLvoid *indices)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param mode#&gt; GL_POINTS, GL_LINES, GL_LINES_STRIP, GL_LINES_LOOP, GL_TRIANGLES, GL_TRIANGLES_STRIP, GL_TRIANGLE_FAN description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param start#&gt; indices description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param end#&gt; indices description#&gt; </span></span><br><span class=\"line\"><span class=\"comment\"> @param count#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param type#&gt; indicesGL_UNSIGNED_BYTE, GL_UNSIGNED_SHORT, GL_UNSIGNED_INT description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param indices#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glDrawRangeElements(GLenum mode, GLuint start, GLuint end, GLsizei count, GLenum type, <span class=\"keyword\">const</span> GLvoid *indices)</span><br></pre></td></tr></table></figure>\n<p><code>glDrawArrays</code>3D</p>\n<p><code>glDrawArrays</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">GLfloat vertices[] = &#123; .. &#125;;</span><br><span class=\"line\">glEnableVertexAttribArray(<span class=\"number\">0</span>);</span><br><span class=\"line\">glVertexAttribPointer(<span class=\"number\">0</span>, <span class=\"number\">3</span>, GL_FLOAT, GL_FALSE, <span class=\"number\">0</span>, vertices);</span><br><span class=\"line\">glDrawArrays(GL_TRIANGLES, <span class=\"number\">0</span>, <span class=\"number\">36</span>);</span><br></pre></td></tr></table></figure>\n<p><code>glDrawArrays</code><code>glDrawArrays</code>24<code>GL_TRIANGLE_FAN</code>36<code>GL_TRIANGLES</code>8</p>\n<p><code>glDrawElements</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">GLfloat vertices[] = &#123; .. &#125;;</span><br><span class=\"line\">GLubyte indices[<span class=\"number\">36</span>] = &#123;</span><br><span class=\"line\">    <span class=\"number\">0</span>, <span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">0</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>,</span><br><span class=\"line\">    <span class=\"number\">0</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">0</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>,</span><br><span class=\"line\">    <span class=\"number\">7</span>, <span class=\"number\">1</span>, <span class=\"number\">6</span>, <span class=\"number\">7</span>, <span class=\"number\">2</span>, <span class=\"number\">1</span>,</span><br><span class=\"line\">    <span class=\"number\">7</span>, <span class=\"number\">5</span>, <span class=\"number\">4</span>, <span class=\"number\">7</span>, <span class=\"number\">6</span>, <span class=\"number\">5</span>,</span><br><span class=\"line\">    <span class=\"number\">7</span>, <span class=\"number\">3</span>, <span class=\"number\">2</span>, <span class=\"number\">7</span>, <span class=\"number\">4</span>, <span class=\"number\">3</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\">glEnableVertexAttribArray(<span class=\"number\">0</span>);</span><br><span class=\"line\">glVertexAttribPointer(<span class=\"number\">0</span>, <span class=\"number\">3</span>, GL_FLOAT, GL_FALSE, <span class=\"number\">0</span>, vertices);</span><br><span class=\"line\">glDrawElements(GL_TRIANGLES, <span class=\"number\">36</span>, GL_USINGED_BYTE, indices);</span><br></pre></td></tr></table></figure>\n<p><code>glDrawElements</code><code>glDrawArrays</code><code>glDrawElements</code>GPU<code>glDrawArrays</code><code>glDrawElements</code></p>\n<h2 id=\"\"></h2>\n<p>API</p>\n<p><code>glDrawElements</code><code>glDrawElementsInstances</code><code>glDrawRangeElements</code><code>GL_UNSIGNED_BYTE</code><code>GL_UNSIGNED_SHORT</code>25565535</p>\n<p>(0, 1, 2, 3)(8, 9, 10, 11)<code>glDrawElements*</code><code>GL_UNSIGNED_BYTE</code>(0, 1, 2, 3, 255, 8, 9, 10, 11)</p>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">glEnable(GL_PRIMITIVE_RESTART_FIXED_INDEX);</span><br><span class=\"line\"><span class=\"comment\">// draw primitives</span></span><br><span class=\"line\">glDisable(GL_PRIMITIVE_RESTART_FIXED_INDEX);</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\">GLfloat vertices[] = &#123;</span><br><span class=\"line\">    <span class=\"number\">-0.75</span>f, <span class=\"number\">0</span>, <span class=\"number\">0</span>,</span><br><span class=\"line\">    <span class=\"number\">-0.75</span>f, <span class=\"number\">0.75</span>f, <span class=\"number\">0</span>,</span><br><span class=\"line\">    <span class=\"number\">-0.25</span>f, <span class=\"number\">0</span>, <span class=\"number\">0</span>,</span><br><span class=\"line\">    <span class=\"number\">-0.25</span>f, <span class=\"number\">0.75</span>, <span class=\"number\">0</span>,</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"number\">0.75</span>f, <span class=\"number\">0</span>, <span class=\"number\">0</span>,</span><br><span class=\"line\">    <span class=\"number\">0.75</span>f, <span class=\"number\">0.75</span>f, <span class=\"number\">0</span>,</span><br><span class=\"line\">    <span class=\"number\">0.25</span>f, <span class=\"number\">0</span>, <span class=\"number\">0</span>,</span><br><span class=\"line\">    <span class=\"number\">0.25</span>f, <span class=\"number\">0.75</span>, <span class=\"number\">0</span></span><br><span class=\"line\">&#125;;</span><br><span class=\"line\">GLfloat colors[] = &#123;</span><br><span class=\"line\">    <span class=\"number\">1.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">1.0</span>f,</span><br><span class=\"line\">    <span class=\"number\">0.0</span>f, <span class=\"number\">1.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">1.0</span>f,</span><br><span class=\"line\">    <span class=\"number\">0.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">1.0</span>f, <span class=\"number\">1.0</span>f,</span><br><span class=\"line\">    <span class=\"number\">0.0</span>f, <span class=\"number\">1.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">1.0</span>f,</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"number\">1.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">1.0</span>f,</span><br><span class=\"line\">    <span class=\"number\">0.0</span>f, <span class=\"number\">1.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">1.0</span>f,</span><br><span class=\"line\">    <span class=\"number\">0.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">1.0</span>f, <span class=\"number\">1.0</span>f,</span><br><span class=\"line\">    <span class=\"number\">0.0</span>f, <span class=\"number\">1.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">1.0</span>f</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\">GLushort indices[] = &#123;<span class=\"number\">0</span>, <span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">65535</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>, <span class=\"number\">7</span>&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">GLuint vbos[<span class=\"number\">3</span>];</span><br><span class=\"line\">glGenBuffers(<span class=\"number\">3</span>, vbos);</span><br><span class=\"line\">glBindBuffer(GL_ARRAY_BUFFER, vbos[<span class=\"number\">0</span>]);</span><br><span class=\"line\">glBufferData(GL_ARRAY_BUFFER, <span class=\"keyword\">sizeof</span>(vertices), vertices, GL_STATIC_DRAW);</span><br><span class=\"line\"></span><br><span class=\"line\">glBindBuffer(GL_ARRAY_BUFFER, vbos[<span class=\"number\">1</span>]);</span><br><span class=\"line\">glBufferData(GL_ARRAY_BUFFER, <span class=\"keyword\">sizeof</span>(colors), colors, GL_STATIC_DRAW);</span><br><span class=\"line\"></span><br><span class=\"line\">glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, vbos[<span class=\"number\">2</span>]);</span><br><span class=\"line\">glBufferData(GL_ELEMENT_ARRAY_BUFFER, <span class=\"keyword\">sizeof</span>(indices), indices, GL_STATIC_DRAW);</span><br><span class=\"line\"></span><br><span class=\"line\">glGenVertexArrays(<span class=\"number\">1</span>, &amp;vaos);</span><br><span class=\"line\">glBindVertexArray(vaos);</span><br><span class=\"line\"></span><br><span class=\"line\">glBindBuffer(GL_ARRAY_BUFFER, vbos[<span class=\"number\">0</span>]);</span><br><span class=\"line\">glEnableVertexAttribArray(<span class=\"number\">0</span>);</span><br><span class=\"line\">glVertexAttribPointer(<span class=\"number\">0</span>, <span class=\"number\">3</span>, GL_FLOAT, GL_FALSE, <span class=\"number\">3</span> * <span class=\"keyword\">sizeof</span>(GLfloat), <span class=\"number\">0</span>);</span><br><span class=\"line\">glBindBuffer(GL_ARRAY_BUFFER, vbos[<span class=\"number\">1</span>]);</span><br><span class=\"line\">glEnableVertexAttribArray(<span class=\"number\">1</span>);</span><br><span class=\"line\">glVertexAttribPointer(<span class=\"number\">1</span>, <span class=\"number\">4</span>, GL_FLOAT, GL_FALSE, <span class=\"number\">4</span> * <span class=\"keyword\">sizeof</span>(GLfloat), <span class=\"number\">0</span>);</span><br><span class=\"line\">glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, vbos[<span class=\"number\">2</span>]);</span><br><span class=\"line\"></span><br><span class=\"line\">glBindVertexArray(<span class=\"number\">0</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\">glEnable(GL_PRIMITIVE_RESTART_FIXED_INDEX);</span><br><span class=\"line\"></span><br><span class=\"line\">glBindVertexArray(vaos);</span><br><span class=\"line\">glDrawElements(GL_TRIANGLE_STRIP, <span class=\"number\">9</span>, GL_UNSIGNED_SHORT, <span class=\"number\">0</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">glDisable(GL_PRIMITIVE_RESTART_FIXED_INDEX);</span><br></pre></td></tr></table></figure>\n<h2 id=\"\"></h2>\n<p><a href=\"/article/2019/opengl-es-glsl-0715/#%E6%8F%92%E5%80%BC%E9%99%90%E5%AE%9A%E7%AC%A6\"></a></p>\n<table>\n<thead>\n<tr>\n<th>i</th>\n<th></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>GL_POINT</td>\n<td>i</td>\n</tr>\n<tr>\n<td>GL_LINES</td>\n<td>2i</td>\n</tr>\n<tr>\n<td>GL_LINE_LOOP</td>\n<td>i &lt; ni + 1i = n1</td>\n</tr>\n<tr>\n<td>GL_LINE_STRIP</td>\n<td>i + 1</td>\n</tr>\n<tr>\n<td>GL_TRIANGLES</td>\n<td>3i</td>\n</tr>\n<tr>\n<td>GL_TRIANGLE_STRIP</td>\n<td>i + 2</td>\n</tr>\n<tr>\n<td>GL_TRIANGLE_FAN</td>\n<td>i + 2</td>\n</tr>\n</tbody>\n</table>\n<blockquote>\n<p>i1nn</p>\n</blockquote>\n<h2 id=\"\"></h2>\n<p>APIOpenGL ESAPICPU</p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param mode#&gt; GL_POINTS, GL_LINES, GL_LINES_STRIP, GL_LINES_LOOP, GL_TRIANGLES, GL_TRIANGLES_STRIP, GL_TRIANGLE_FAN description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param first#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param count#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param instancecount#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glDrawArraysInstanced(GLenum mode, GLint first, GLsizei count, GLsizei instancecount);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param mode#&gt; GL_POINTS, GL_LINES, GL_LINES_STRIP, GL_LINES_LOOP, GL_TRIANGLES, GL_TRIANGLES_STRIP, GL_TRIANGLE_FAN description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param count#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param type#&gt; indicesGL_UNSIGNED_BYTE, GL_UNSIGNED_SHORT, GL_UNSIGNED_INT description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param indices#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param instancecount#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glDrawElementsInstanced(GLenum mode, GLsizei count, GLenum type, <span class=\"keyword\">const</span> GLvoid *indices, GLsizei instancecount);</span><br></pre></td></tr></table></figure>\n<p>OpenGL ES</p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param index#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param divisor#&gt; index description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glVertexAttribDivisor(GLuint index, GLuint divisor);</span><br></pre></td></tr></table></figure>\n<p><code>glVertexAttribDivisor</code><code>divisor</code><code>divisor</code>1<a href=\"https://github.com/danginsburg/opengles3-book/blob/master/Chapter_7/Instancing/Instancing.c\" target=\"_blank\" rel=\"noopener\"></a></p>\n<p><code>glInstanceID</code>OpenGL ES 3.0API<code>gl_InstanceID</code><code>gl_InstanceID</code>0</p>\n<h2 id=\"\"></h2>\n<p><code>glDrawElements</code><code>glDrawElementsInstanced</code><code>GL_TRIANGLES</code><code>glDrawElements*</code></p>\n<p>OpenGL ESGPUGPU</p>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\">GLfloat vertices[] = &#123;</span><br><span class=\"line\">    <span class=\"number\">-0.75</span>f, <span class=\"number\">0</span>, <span class=\"number\">0</span>,</span><br><span class=\"line\">    <span class=\"number\">-0.75</span>f, <span class=\"number\">0.75</span>f, <span class=\"number\">0</span>,</span><br><span class=\"line\">    <span class=\"number\">-0.25</span>f, <span class=\"number\">0</span>, <span class=\"number\">0</span>,</span><br><span class=\"line\">    <span class=\"number\">-0.25</span>f, <span class=\"number\">0.75</span>, <span class=\"number\">0</span>,</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"number\">0.75</span>f, <span class=\"number\">0</span>, <span class=\"number\">0</span>,</span><br><span class=\"line\">    <span class=\"number\">0.75</span>f, <span class=\"number\">0.75</span>f, <span class=\"number\">0</span>,</span><br><span class=\"line\">    <span class=\"number\">0.25</span>f, <span class=\"number\">0</span>, <span class=\"number\">0</span>,</span><br><span class=\"line\">    <span class=\"number\">0.25</span>f, <span class=\"number\">0.75</span>, <span class=\"number\">0</span></span><br><span class=\"line\">&#125;;</span><br><span class=\"line\">GLfloat colors[] = &#123;</span><br><span class=\"line\">    <span class=\"number\">1.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">1.0</span>f,</span><br><span class=\"line\">    <span class=\"number\">0.0</span>f, <span class=\"number\">1.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">1.0</span>f,</span><br><span class=\"line\">    <span class=\"number\">0.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">1.0</span>f, <span class=\"number\">1.0</span>f,</span><br><span class=\"line\">    <span class=\"number\">0.0</span>f, <span class=\"number\">1.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">1.0</span>f,</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"number\">1.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">1.0</span>f,</span><br><span class=\"line\">    <span class=\"number\">0.0</span>f, <span class=\"number\">1.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">1.0</span>f,</span><br><span class=\"line\">    <span class=\"number\">0.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">1.0</span>f, <span class=\"number\">1.0</span>f,</span><br><span class=\"line\">    <span class=\"number\">0.0</span>f, <span class=\"number\">1.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">1.0</span>f</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\">GLushort indices[] = &#123;<span class=\"number\">0</span>, <span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>, <span class=\"number\">7</span>&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">GLuint vbos[<span class=\"number\">3</span>];</span><br><span class=\"line\">glGenBuffers(<span class=\"number\">3</span>, vbos);</span><br><span class=\"line\">glBindBuffer(GL_ARRAY_BUFFER, vbos[<span class=\"number\">0</span>]);</span><br><span class=\"line\">glBufferData(GL_ARRAY_BUFFER, <span class=\"keyword\">sizeof</span>(vertices), vertices, GL_STATIC_DRAW);</span><br><span class=\"line\"></span><br><span class=\"line\">glBindBuffer(GL_ARRAY_BUFFER, vbos[<span class=\"number\">1</span>]);</span><br><span class=\"line\">glBufferData(GL_ARRAY_BUFFER, <span class=\"keyword\">sizeof</span>(colors), colors, GL_STATIC_DRAW);</span><br><span class=\"line\"></span><br><span class=\"line\">glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, vbos[<span class=\"number\">2</span>]);</span><br><span class=\"line\">glBufferData(GL_ELEMENT_ARRAY_BUFFER, <span class=\"keyword\">sizeof</span>(indices), indices, GL_STATIC_DRAW);</span><br><span class=\"line\"></span><br><span class=\"line\">glGenVertexArrays(<span class=\"number\">1</span>, &amp;vaos);</span><br><span class=\"line\">glBindVertexArray(vaos);</span><br><span class=\"line\"></span><br><span class=\"line\">glBindBuffer(GL_ARRAY_BUFFER, vbos[<span class=\"number\">0</span>]);</span><br><span class=\"line\">glEnableVertexAttribArray(<span class=\"number\">0</span>);</span><br><span class=\"line\">glVertexAttribPointer(<span class=\"number\">0</span>, <span class=\"number\">3</span>, GL_FLOAT, GL_FALSE, <span class=\"number\">3</span> * <span class=\"keyword\">sizeof</span>(GLfloat), <span class=\"number\">0</span>);</span><br><span class=\"line\">glBindBuffer(GL_ARRAY_BUFFER, vbos[<span class=\"number\">1</span>]);</span><br><span class=\"line\">glEnableVertexAttribArray(<span class=\"number\">1</span>);</span><br><span class=\"line\">glVertexAttribPointer(<span class=\"number\">1</span>, <span class=\"number\">4</span>, GL_FLOAT, GL_FALSE, <span class=\"number\">4</span> * <span class=\"keyword\">sizeof</span>(GLfloat), <span class=\"number\">0</span>);</span><br><span class=\"line\">glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, vbos[<span class=\"number\">2</span>]);</span><br><span class=\"line\"></span><br><span class=\"line\">glBindVertexArray(<span class=\"number\">0</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\">glBindVertexArray(vaos);</span><br><span class=\"line\">glDrawElements(GL_TRIANGLE_STRIP, <span class=\"number\">10</span>, GL_UNSIGNED_SHORT, <span class=\"number\">0</span>);</span><br></pre></td></tr></table></figure>\n<h1 id=\"\"></h1>\n<p><code>glDraw***</code>(x, y, z, w)</p>\n<p><img src=\"/img/article/20190801/3.png\" alt=\"OpenGL ES\"></p>\n<h2 id=\"\"></h2>\n<p>OpenGL ES</p>\n<p><img src=\"/img/article/20190801/4.png\" alt=\"\"></p>\n<h3 id=\"\"></h3>\n<p>(x<sub>c</sub>, y<sub>c</sub>, z<sub>c</sub>, w<sub>c</sub>)(x<sub>c</sub>, y<sub>c</sub>, z<sub>c</sub>, w<sub>c</sub>)</p>\n<p>6-w<sub>c</sub> &lt;= x<sub>c</sub> &lt;= w<sub>c</sub>-w<sub>c</sub> &lt;= y<sub>c</sub> &lt;= w<sub>c</sub>-w<sub>c</sub> &lt;= z<sub>c</sub> &lt;= w<sub>c</sub></p>\n<p><img src=\"/img/article/20190801/5.png\" alt=\"\"></p>\n<p><code>GL_TRIANGLES</code><code>GL_LINES</code></p>\n<ul>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n<p>-1.01.0</p>\n<h2 id=\"\"></h2>\n<p>(X<sub>c</sub>, Y<sub>c</sub>, Z<sub>c</sub>, W<sub>c</sub>)(X<sub>c</sub>, Y<sub>c</sub>, Z<sub>c</sub>)W<sub>c</sub>(X<sub>c</sub>/W<sub>c</sub>)(Y<sub>c</sub>/W<sub>c</sub>)(Z<sub>c</sub>/W<sub>c</sub>)(X<sub>d</sub>, Y<sub>d</sub>, Z<sub>d</sub>)[-1.01.0](X<sub>d</sub>, Y<sub>d</sub>)(Z<sub>d</sub>)<code>glDepthRangef</code><code>near</code><code>far</code>Z</p>\n<h2 id=\"\"></h2>\n<p>OpenGL ESAPI</p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param x#&gt; x description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param y#&gt; y description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param width#&gt; 0 description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param height#&gt; 0 description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glViewport(GLint x, GLint y, GLsizei width, GLsizei height);</span><br></pre></td></tr></table></figure>\n<p>(x<sub>d</sub>, y<sub>d</sub>, z<sub>d</sub>)(x<sub>w</sub>, y<sub>w</sub>, z<sub>w</sub>)</p>\n<p><img src=\"/img/article/20190801/6.png\" alt=\"\"></p>\n<p>o<sub>x</sub>=x+w/2o<sub>y</sub>=y+h/2nf<br>\nnfAPI</p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param zNear#&gt; 0.0(0.0, 1.0) description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param zFar#&gt; 1.0(0.0, 1.0) description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glDepthRangef(GLclampf zNear, GLclampf zFar);</span><br></pre></td></tr></table></figure>\n<p><code>glDepthRangef</code><code>glViewport</code></p>\n<h1 id=\"\"></h1>\n<p>(x, y)(x, y)</p>\n<p><img src=\"/img/article/20190801/7.png\" alt=\"OpenGL ES\"></p>\n<h2 id=\"\"></h2>\n<p>culling</p>\n<p></p>\n<p><img src=\"/img/article/20190801/8.png\" alt=\"\"></p>\n<p>CWCCWAPI</p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param mode#&gt; GL_CWGL_CCWGL_CCW description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glFrontFace(GLenum mode);</span><br></pre></td></tr></table></figure>\n<p>API</p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param mode#&gt; GL_FROUNTGL_BACKGL_FROUNT_AND_BACKGL_BACK description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glCullFace(GLenum mode);</span><br></pre></td></tr></table></figure>\n<p><code>GL_CULL_FACE</code>API</p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param cap#&gt; GL_CULL_FACE description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glEnable(GLenum cap);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param cap#&gt; GL_CULL_FACE description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glDisable(GLenum cap);</span><br></pre></td></tr></table></figure>\n<p>OpenGL ES<code>glEnable(GL_CULL_FACE)</code><code>glCullFace</code><code>glFrontFace</code></p>\n<blockquote>\n<p>GPUOpenGL ES</p>\n</blockquote>\n<h2 id=\"\"></h2>\n<p></p>\n<p>+</p>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param factor#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param units#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glPolygonOffset(GLfloat factor, GLfloat units);</span><br></pre></td></tr></table></figure>\n<p> = m *  + r * mOpenGL ESrOpenGL ES<br>\n<code>glEnable(GL_POLYGON_OFFSET_FILL)</code><code>glDisable(GL_POLYGON_OFFSET_FILL)</code></p>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"keyword\">float</span> polygonOffsetFactor = <span class=\"number\">-1.0</span>f;</span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"keyword\">float</span> polygonOffsetUnits = <span class=\"number\">-2.0</span>f;</span><br><span class=\"line\"></span><br><span class=\"line\">glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// load vertex shader</span></span><br><span class=\"line\"><span class=\"comment\">// set the appropriate transformation matrices</span></span><br><span class=\"line\"><span class=\"comment\">// set the vertex attribute state</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// draw the SMALLER quad</span></span><br><span class=\"line\">glDrawArrays(GL_TRIANGLE_FAN, <span class=\"number\">0</span>, <span class=\"number\">4</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// set the depth func to &lt;= as polygons are coplanar</span></span><br><span class=\"line\">glDrawFunc(GL_LEQUAL);</span><br><span class=\"line\"></span><br><span class=\"line\">glEnable(GL_POLYGON_OFFSET_FILL);</span><br><span class=\"line\"></span><br><span class=\"line\">glPolygonOffset(polygonOffsetFactor, polygonOffsetUnits);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// set the vertex attribute state</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// draw the LARGER quad</span></span><br><span class=\"line\">glDrawArrays(GL_TRIANGLE_FAN, <span class=\"number\">0</span>, <span class=\"number\">4</span>);</span><br></pre></td></tr></table></figure>\n<h1 id=\"\"></h1>\n<p></p>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param target#&gt; GL_ANY_SAMPLES_PASSEDGL_ANY_SAMPLES_PASSED_CONSERVATIVEGL_TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param id#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glBeginQuery(GLenum target, GLuint <span class=\"keyword\">id</span>);</span><br><span class=\"line\">    </span><br><span class=\"line\">    </span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param target#&gt; GL_ANY_SAMPLES_PASSEDGL_ANY_SAMPLES_PASSED_CONSERVATIVEGL_TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glEndQuery(GLenum target);</span><br></pre></td></tr></table></figure>\n<p><code>GL_ANY_SAMPLES_PASSED</code><code>GL_ANY_SAMPLES_PASSED_CONSERVATIVE</code><code>GL_ANY_SAMPLES_PASSED_CONSERVATIVE</code><code>GL_TRUE</code></p>\n<p><code>id</code><code>glGenQueries</code><code>glDeleteQueries</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> id</span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param n#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param ids#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glGenQueries(GLsizei n, GLuint *ids);</span><br><span class=\"line\">    </span><br><span class=\"line\">    </span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> id</span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param n#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param ids#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span> </span><br><span class=\"line\">glDeleteQueries(GLsizei n, <span class=\"keyword\">const</span> GLuint *ids);</span><br></pre></td></tr></table></figure>\n<p><code>glBeginQuery</code><code>glEndQuery</code><code>glGetQueryObjectuiv</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param id#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param pname#&gt; GL_QUERY_RESULTGL_QUERY_RESULT_AVAILABLE description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param params#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glGetQueryObjectuiv(GLuint <span class=\"keyword\">id</span>, GLenum pname, GLuint *params);</span><br></pre></td></tr></table></figure>\n<h1 id=\"\"></h1>\n<p>OpenGL ES</p>\n","site":{"data":{}},"excerpt":"","more":"<blockquote>\n<p>OpenGL ES</p>\n</blockquote>\n<h1></h1>\n<p>OpenGL ES<code>glDrawArrays</code><code>glDrawElements</code><code>glDrawRangeElements</code><code>glDrawArraysInstanced</code><code>glDrawElementsInstanced</code></p>\n<p>OpenGL ES 3.0</p>\n<ul>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n<h2></h2>\n<p>3DOpenGL ES<code>GL_TRIANGLES</code><code>GL_TRIANGLE_STRIP</code><code>GL_TRIANGLE_FAN</code></p>\n<p><img src=\"/img/article/20190801/1.png\" alt=\"\"></p>\n<p><code>GL_TRIANGLES</code>(v<sup>0</sup>, v<sup>1</sup>, v<sup>2</sup>)(v<sup>3</sup>, v<sup>4</sup>, v<sup>5</sup>)n/3n<code>glDraw*</code><code>count</code></p>\n<p><code>GL_TRIANGLE_STRIP</code>4(v<sup>0</sup>, v<sup>1</sup>, v<sup>2</sup>)(v<sup>2</sup>, v<sup>1</sup>, v<sup>3</sup>)(v<sup>2</sup>, v<sup>3</sup>, v<sup>4</sup>)(v<sup>4</sup>, v<sup>3</sup>, v<sup>5</sup>)n-2n<code>glDraw*</code><code>count</code></p>\n<p><code>GL_TRIANGLE_FAN</code>3(v<sup>0</sup>, v<sup>1</sup>, v<sup>2</sup>)(v<sup>0</sup>, v<sup>2</sup>, v<sup>3</sup>)(v<sup>0</sup>, v<sup>3</sup>, v<sup>4</sup>)n-2n<code>glDraw*</code><code>count</code></p>\n<h2></h2>\n<p>OpenGL ES<code>GL_LINES</code><code>GL_LINE_STRIP</code><code>GL_LINE_LOOP</code></p>\n<p><img src=\"/img/article/20190801/2.png\" alt=\"\"></p>\n<p><code>GL_LINES</code>(v<sup>0</sup>, v<sup>1</sup>)(v<sup>2</sup>, v<sup>3</sup>)(v<sup>4</sup>, v<sup>5</sup>)n/2n<code>glDraw*</code><code>count</code></p>\n<p><code>GL_LINE_STRIP</code>3(v<sup>0</sup>, v<sup>1</sup>)(v<sup>1</sup>, v<sup>2</sup>)(v<sup>2</sup>, v<sup>3</sup>)n-1n<code>glDraw*</code><code>count</code></p>\n<p>v<sup>n-1</sup>v<sup>0</sup><code>GL_LINE_LOOP</code><code>GL_LINE_STRIP</code>(v<sup>0</sup>, v<sup>1</sup>)(v<sup>1</sup>, v<sup>2</sup>)(v<sup>2</sup>, v<sup>3</sup>)(v<sup>3</sup>, v<sup>4</sup>)(v<sup>4</sup>, v<sup>0</sup>)nn<code>glDraw*</code><code>count</code></p>\n<p><code>glLineWidth</code>API</p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param width#&gt; 1.0 description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glLineWidth(GLfloat width);</span><br></pre></td></tr></table></figure>\n<p><code>glLineWidth</code>OpenGL ES 3.0OpenGL1<br>\n</p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">GLfloat lineWidthRange[<span class=\"number\">2</span>];</span><br><span class=\"line\">glGetFloatv(GL_ALIASED_LINE_WIDTH_RANGE, lineWidthRange);</span><br></pre></td></tr></table></figure>\n<h2></h2>\n<p>OpenGL ES<code>GL_POINTS</code>4</p>\n<p><code>gl_PointSize</code><code>gl_PointSize</code><code>gl_PointSize</code>OpenGL ES 3.0</p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">GLfloat pointSizeRange[<span class=\"number\">2</span>];</span><br><span class=\"line\">glGetFloatv(GL_ALIASED_POINT_SIZE_RANGE, pointSizeRange);</span><br></pre></td></tr></table></figure>\n<p>OpenGL ES 3.0(0, 0)(, )(, )</p>\n<p><code>gl_PointCoord</code><code>mediump</code>vec2<code>gl_PointCoord</code>0~1</p>\n<h1></h1>\n<p>OpenGL ES5API<code>glDrawArrays</code><code>glDrawElements</code><code>glDrawRangeElements</code><code>glDrawArraysInstanced</code><code>glDrawElementsInstanced</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param mode#&gt; GL_POINTS, GL_LINES, GL_LINES_STRIP, GL_LINES_LOOP, GL_TRIANGLES, GL_TRIANGLES_STRIP, GL_TRIANGLE_FAN description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param first#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param count#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glDrawArrays(GLenum mode, GLint first, GLsizei count);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param mode#&gt; GL_POINTS, GL_LINES, GL_LINES_STRIP, GL_LINES_LOOP, GL_TRIANGLES, GL_TRIANGLES_STRIP, GL_TRIANGLE_FAN description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param count#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param type#&gt; indicesGL_UNSIGNED_BYTE, GL_UNSIGNED_SHORT, GL_UNSIGNED_INT description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param indices#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glDrawElements(GLenum mode, GLsizei count, GLenum type, <span class=\"keyword\">const</span> GLvoid *indices)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param mode#&gt; GL_POINTS, GL_LINES, GL_LINES_STRIP, GL_LINES_LOOP, GL_TRIANGLES, GL_TRIANGLES_STRIP, GL_TRIANGLE_FAN description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param start#&gt; indices description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param end#&gt; indices description#&gt; </span></span><br><span class=\"line\"><span class=\"comment\"> @param count#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param type#&gt; indicesGL_UNSIGNED_BYTE, GL_UNSIGNED_SHORT, GL_UNSIGNED_INT description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param indices#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glDrawRangeElements(GLenum mode, GLuint start, GLuint end, GLsizei count, GLenum type, <span class=\"keyword\">const</span> GLvoid *indices)</span><br></pre></td></tr></table></figure>\n<p><code>glDrawArrays</code>3D</p>\n<p><code>glDrawArrays</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">GLfloat vertices[] = &#123; .. &#125;;</span><br><span class=\"line\">glEnableVertexAttribArray(<span class=\"number\">0</span>);</span><br><span class=\"line\">glVertexAttribPointer(<span class=\"number\">0</span>, <span class=\"number\">3</span>, GL_FLOAT, GL_FALSE, <span class=\"number\">0</span>, vertices);</span><br><span class=\"line\">glDrawArrays(GL_TRIANGLES, <span class=\"number\">0</span>, <span class=\"number\">36</span>);</span><br></pre></td></tr></table></figure>\n<p><code>glDrawArrays</code><code>glDrawArrays</code>24<code>GL_TRIANGLE_FAN</code>36<code>GL_TRIANGLES</code>8</p>\n<p><code>glDrawElements</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">GLfloat vertices[] = &#123; .. &#125;;</span><br><span class=\"line\">GLubyte indices[<span class=\"number\">36</span>] = &#123;</span><br><span class=\"line\">    <span class=\"number\">0</span>, <span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">0</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>,</span><br><span class=\"line\">    <span class=\"number\">0</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">0</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>,</span><br><span class=\"line\">    <span class=\"number\">7</span>, <span class=\"number\">1</span>, <span class=\"number\">6</span>, <span class=\"number\">7</span>, <span class=\"number\">2</span>, <span class=\"number\">1</span>,</span><br><span class=\"line\">    <span class=\"number\">7</span>, <span class=\"number\">5</span>, <span class=\"number\">4</span>, <span class=\"number\">7</span>, <span class=\"number\">6</span>, <span class=\"number\">5</span>,</span><br><span class=\"line\">    <span class=\"number\">7</span>, <span class=\"number\">3</span>, <span class=\"number\">2</span>, <span class=\"number\">7</span>, <span class=\"number\">4</span>, <span class=\"number\">3</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\">glEnableVertexAttribArray(<span class=\"number\">0</span>);</span><br><span class=\"line\">glVertexAttribPointer(<span class=\"number\">0</span>, <span class=\"number\">3</span>, GL_FLOAT, GL_FALSE, <span class=\"number\">0</span>, vertices);</span><br><span class=\"line\">glDrawElements(GL_TRIANGLES, <span class=\"number\">36</span>, GL_USINGED_BYTE, indices);</span><br></pre></td></tr></table></figure>\n<p><code>glDrawElements</code><code>glDrawArrays</code><code>glDrawElements</code>GPU<code>glDrawArrays</code><code>glDrawElements</code></p>\n<h2></h2>\n<p>API</p>\n<p><code>glDrawElements</code><code>glDrawElementsInstances</code><code>glDrawRangeElements</code><code>GL_UNSIGNED_BYTE</code><code>GL_UNSIGNED_SHORT</code>25565535</p>\n<p>(0, 1, 2, 3)(8, 9, 10, 11)<code>glDrawElements*</code><code>GL_UNSIGNED_BYTE</code>(0, 1, 2, 3, 255, 8, 9, 10, 11)</p>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">glEnable(GL_PRIMITIVE_RESTART_FIXED_INDEX);</span><br><span class=\"line\"><span class=\"comment\">// draw primitives</span></span><br><span class=\"line\">glDisable(GL_PRIMITIVE_RESTART_FIXED_INDEX);</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\">GLfloat vertices[] = &#123;</span><br><span class=\"line\">    <span class=\"number\">-0.75</span>f, <span class=\"number\">0</span>, <span class=\"number\">0</span>,</span><br><span class=\"line\">    <span class=\"number\">-0.75</span>f, <span class=\"number\">0.75</span>f, <span class=\"number\">0</span>,</span><br><span class=\"line\">    <span class=\"number\">-0.25</span>f, <span class=\"number\">0</span>, <span class=\"number\">0</span>,</span><br><span class=\"line\">    <span class=\"number\">-0.25</span>f, <span class=\"number\">0.75</span>, <span class=\"number\">0</span>,</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"number\">0.75</span>f, <span class=\"number\">0</span>, <span class=\"number\">0</span>,</span><br><span class=\"line\">    <span class=\"number\">0.75</span>f, <span class=\"number\">0.75</span>f, <span class=\"number\">0</span>,</span><br><span class=\"line\">    <span class=\"number\">0.25</span>f, <span class=\"number\">0</span>, <span class=\"number\">0</span>,</span><br><span class=\"line\">    <span class=\"number\">0.25</span>f, <span class=\"number\">0.75</span>, <span class=\"number\">0</span></span><br><span class=\"line\">&#125;;</span><br><span class=\"line\">GLfloat colors[] = &#123;</span><br><span class=\"line\">    <span class=\"number\">1.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">1.0</span>f,</span><br><span class=\"line\">    <span class=\"number\">0.0</span>f, <span class=\"number\">1.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">1.0</span>f,</span><br><span class=\"line\">    <span class=\"number\">0.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">1.0</span>f, <span class=\"number\">1.0</span>f,</span><br><span class=\"line\">    <span class=\"number\">0.0</span>f, <span class=\"number\">1.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">1.0</span>f,</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"number\">1.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">1.0</span>f,</span><br><span class=\"line\">    <span class=\"number\">0.0</span>f, <span class=\"number\">1.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">1.0</span>f,</span><br><span class=\"line\">    <span class=\"number\">0.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">1.0</span>f, <span class=\"number\">1.0</span>f,</span><br><span class=\"line\">    <span class=\"number\">0.0</span>f, <span class=\"number\">1.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">1.0</span>f</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\">GLushort indices[] = &#123;<span class=\"number\">0</span>, <span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">65535</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>, <span class=\"number\">7</span>&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">GLuint vbos[<span class=\"number\">3</span>];</span><br><span class=\"line\">glGenBuffers(<span class=\"number\">3</span>, vbos);</span><br><span class=\"line\">glBindBuffer(GL_ARRAY_BUFFER, vbos[<span class=\"number\">0</span>]);</span><br><span class=\"line\">glBufferData(GL_ARRAY_BUFFER, <span class=\"keyword\">sizeof</span>(vertices), vertices, GL_STATIC_DRAW);</span><br><span class=\"line\"></span><br><span class=\"line\">glBindBuffer(GL_ARRAY_BUFFER, vbos[<span class=\"number\">1</span>]);</span><br><span class=\"line\">glBufferData(GL_ARRAY_BUFFER, <span class=\"keyword\">sizeof</span>(colors), colors, GL_STATIC_DRAW);</span><br><span class=\"line\"></span><br><span class=\"line\">glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, vbos[<span class=\"number\">2</span>]);</span><br><span class=\"line\">glBufferData(GL_ELEMENT_ARRAY_BUFFER, <span class=\"keyword\">sizeof</span>(indices), indices, GL_STATIC_DRAW);</span><br><span class=\"line\"></span><br><span class=\"line\">glGenVertexArrays(<span class=\"number\">1</span>, &amp;vaos);</span><br><span class=\"line\">glBindVertexArray(vaos);</span><br><span class=\"line\"></span><br><span class=\"line\">glBindBuffer(GL_ARRAY_BUFFER, vbos[<span class=\"number\">0</span>]);</span><br><span class=\"line\">glEnableVertexAttribArray(<span class=\"number\">0</span>);</span><br><span class=\"line\">glVertexAttribPointer(<span class=\"number\">0</span>, <span class=\"number\">3</span>, GL_FLOAT, GL_FALSE, <span class=\"number\">3</span> * <span class=\"keyword\">sizeof</span>(GLfloat), <span class=\"number\">0</span>);</span><br><span class=\"line\">glBindBuffer(GL_ARRAY_BUFFER, vbos[<span class=\"number\">1</span>]);</span><br><span class=\"line\">glEnableVertexAttribArray(<span class=\"number\">1</span>);</span><br><span class=\"line\">glVertexAttribPointer(<span class=\"number\">1</span>, <span class=\"number\">4</span>, GL_FLOAT, GL_FALSE, <span class=\"number\">4</span> * <span class=\"keyword\">sizeof</span>(GLfloat), <span class=\"number\">0</span>);</span><br><span class=\"line\">glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, vbos[<span class=\"number\">2</span>]);</span><br><span class=\"line\"></span><br><span class=\"line\">glBindVertexArray(<span class=\"number\">0</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\">glEnable(GL_PRIMITIVE_RESTART_FIXED_INDEX);</span><br><span class=\"line\"></span><br><span class=\"line\">glBindVertexArray(vaos);</span><br><span class=\"line\">glDrawElements(GL_TRIANGLE_STRIP, <span class=\"number\">9</span>, GL_UNSIGNED_SHORT, <span class=\"number\">0</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">glDisable(GL_PRIMITIVE_RESTART_FIXED_INDEX);</span><br></pre></td></tr></table></figure>\n<h2></h2>\n<p><a href=\"/article/2019/opengl-es-glsl-0715/#%E6%8F%92%E5%80%BC%E9%99%90%E5%AE%9A%E7%AC%A6\"></a></p>\n<table>\n<thead>\n<tr>\n<th>i</th>\n<th></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>GL_POINT</td>\n<td>i</td>\n</tr>\n<tr>\n<td>GL_LINES</td>\n<td>2i</td>\n</tr>\n<tr>\n<td>GL_LINE_LOOP</td>\n<td>i &lt; ni + 1i = n1</td>\n</tr>\n<tr>\n<td>GL_LINE_STRIP</td>\n<td>i + 1</td>\n</tr>\n<tr>\n<td>GL_TRIANGLES</td>\n<td>3i</td>\n</tr>\n<tr>\n<td>GL_TRIANGLE_STRIP</td>\n<td>i + 2</td>\n</tr>\n<tr>\n<td>GL_TRIANGLE_FAN</td>\n<td>i + 2</td>\n</tr>\n</tbody>\n</table>\n<blockquote>\n<p>i1nn</p>\n</blockquote>\n<h2></h2>\n<p>APIOpenGL ESAPICPU</p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param mode#&gt; GL_POINTS, GL_LINES, GL_LINES_STRIP, GL_LINES_LOOP, GL_TRIANGLES, GL_TRIANGLES_STRIP, GL_TRIANGLE_FAN description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param first#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param count#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param instancecount#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glDrawArraysInstanced(GLenum mode, GLint first, GLsizei count, GLsizei instancecount);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param mode#&gt; GL_POINTS, GL_LINES, GL_LINES_STRIP, GL_LINES_LOOP, GL_TRIANGLES, GL_TRIANGLES_STRIP, GL_TRIANGLE_FAN description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param count#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param type#&gt; indicesGL_UNSIGNED_BYTE, GL_UNSIGNED_SHORT, GL_UNSIGNED_INT description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param indices#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param instancecount#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glDrawElementsInstanced(GLenum mode, GLsizei count, GLenum type, <span class=\"keyword\">const</span> GLvoid *indices, GLsizei instancecount);</span><br></pre></td></tr></table></figure>\n<p>OpenGL ES</p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param index#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param divisor#&gt; index description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glVertexAttribDivisor(GLuint index, GLuint divisor);</span><br></pre></td></tr></table></figure>\n<p><code>glVertexAttribDivisor</code><code>divisor</code><code>divisor</code>1<a href=\"https://github.com/danginsburg/opengles3-book/blob/master/Chapter_7/Instancing/Instancing.c\" target=\"_blank\" rel=\"noopener\"></a></p>\n<p><code>glInstanceID</code>OpenGL ES 3.0API<code>gl_InstanceID</code><code>gl_InstanceID</code>0</p>\n<h2></h2>\n<p><code>glDrawElements</code><code>glDrawElementsInstanced</code><code>GL_TRIANGLES</code><code>glDrawElements*</code></p>\n<p>OpenGL ESGPUGPU</p>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\">GLfloat vertices[] = &#123;</span><br><span class=\"line\">    <span class=\"number\">-0.75</span>f, <span class=\"number\">0</span>, <span class=\"number\">0</span>,</span><br><span class=\"line\">    <span class=\"number\">-0.75</span>f, <span class=\"number\">0.75</span>f, <span class=\"number\">0</span>,</span><br><span class=\"line\">    <span class=\"number\">-0.25</span>f, <span class=\"number\">0</span>, <span class=\"number\">0</span>,</span><br><span class=\"line\">    <span class=\"number\">-0.25</span>f, <span class=\"number\">0.75</span>, <span class=\"number\">0</span>,</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"number\">0.75</span>f, <span class=\"number\">0</span>, <span class=\"number\">0</span>,</span><br><span class=\"line\">    <span class=\"number\">0.75</span>f, <span class=\"number\">0.75</span>f, <span class=\"number\">0</span>,</span><br><span class=\"line\">    <span class=\"number\">0.25</span>f, <span class=\"number\">0</span>, <span class=\"number\">0</span>,</span><br><span class=\"line\">    <span class=\"number\">0.25</span>f, <span class=\"number\">0.75</span>, <span class=\"number\">0</span></span><br><span class=\"line\">&#125;;</span><br><span class=\"line\">GLfloat colors[] = &#123;</span><br><span class=\"line\">    <span class=\"number\">1.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">1.0</span>f,</span><br><span class=\"line\">    <span class=\"number\">0.0</span>f, <span class=\"number\">1.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">1.0</span>f,</span><br><span class=\"line\">    <span class=\"number\">0.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">1.0</span>f, <span class=\"number\">1.0</span>f,</span><br><span class=\"line\">    <span class=\"number\">0.0</span>f, <span class=\"number\">1.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">1.0</span>f,</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"number\">1.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">1.0</span>f,</span><br><span class=\"line\">    <span class=\"number\">0.0</span>f, <span class=\"number\">1.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">1.0</span>f,</span><br><span class=\"line\">    <span class=\"number\">0.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">1.0</span>f, <span class=\"number\">1.0</span>f,</span><br><span class=\"line\">    <span class=\"number\">0.0</span>f, <span class=\"number\">1.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">1.0</span>f</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\">GLushort indices[] = &#123;<span class=\"number\">0</span>, <span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>, <span class=\"number\">6</span>, <span class=\"number\">7</span>&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">GLuint vbos[<span class=\"number\">3</span>];</span><br><span class=\"line\">glGenBuffers(<span class=\"number\">3</span>, vbos);</span><br><span class=\"line\">glBindBuffer(GL_ARRAY_BUFFER, vbos[<span class=\"number\">0</span>]);</span><br><span class=\"line\">glBufferData(GL_ARRAY_BUFFER, <span class=\"keyword\">sizeof</span>(vertices), vertices, GL_STATIC_DRAW);</span><br><span class=\"line\"></span><br><span class=\"line\">glBindBuffer(GL_ARRAY_BUFFER, vbos[<span class=\"number\">1</span>]);</span><br><span class=\"line\">glBufferData(GL_ARRAY_BUFFER, <span class=\"keyword\">sizeof</span>(colors), colors, GL_STATIC_DRAW);</span><br><span class=\"line\"></span><br><span class=\"line\">glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, vbos[<span class=\"number\">2</span>]);</span><br><span class=\"line\">glBufferData(GL_ELEMENT_ARRAY_BUFFER, <span class=\"keyword\">sizeof</span>(indices), indices, GL_STATIC_DRAW);</span><br><span class=\"line\"></span><br><span class=\"line\">glGenVertexArrays(<span class=\"number\">1</span>, &amp;vaos);</span><br><span class=\"line\">glBindVertexArray(vaos);</span><br><span class=\"line\"></span><br><span class=\"line\">glBindBuffer(GL_ARRAY_BUFFER, vbos[<span class=\"number\">0</span>]);</span><br><span class=\"line\">glEnableVertexAttribArray(<span class=\"number\">0</span>);</span><br><span class=\"line\">glVertexAttribPointer(<span class=\"number\">0</span>, <span class=\"number\">3</span>, GL_FLOAT, GL_FALSE, <span class=\"number\">3</span> * <span class=\"keyword\">sizeof</span>(GLfloat), <span class=\"number\">0</span>);</span><br><span class=\"line\">glBindBuffer(GL_ARRAY_BUFFER, vbos[<span class=\"number\">1</span>]);</span><br><span class=\"line\">glEnableVertexAttribArray(<span class=\"number\">1</span>);</span><br><span class=\"line\">glVertexAttribPointer(<span class=\"number\">1</span>, <span class=\"number\">4</span>, GL_FLOAT, GL_FALSE, <span class=\"number\">4</span> * <span class=\"keyword\">sizeof</span>(GLfloat), <span class=\"number\">0</span>);</span><br><span class=\"line\">glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, vbos[<span class=\"number\">2</span>]);</span><br><span class=\"line\"></span><br><span class=\"line\">glBindVertexArray(<span class=\"number\">0</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\">glBindVertexArray(vaos);</span><br><span class=\"line\">glDrawElements(GL_TRIANGLE_STRIP, <span class=\"number\">10</span>, GL_UNSIGNED_SHORT, <span class=\"number\">0</span>);</span><br></pre></td></tr></table></figure>\n<h1></h1>\n<p><code>glDraw***</code>(x, y, z, w)</p>\n<p><img src=\"/img/article/20190801/3.png\" alt=\"OpenGL ES\"></p>\n<h2></h2>\n<p>OpenGL ES</p>\n<p><img src=\"/img/article/20190801/4.png\" alt=\"\"></p>\n<h3></h3>\n<p>(x<sub>c</sub>, y<sub>c</sub>, z<sub>c</sub>, w<sub>c</sub>)(x<sub>c</sub>, y<sub>c</sub>, z<sub>c</sub>, w<sub>c</sub>)</p>\n<p>6-w<sub>c</sub> &lt;= x<sub>c</sub> &lt;= w<sub>c</sub>-w<sub>c</sub> &lt;= y<sub>c</sub> &lt;= w<sub>c</sub>-w<sub>c</sub> &lt;= z<sub>c</sub> &lt;= w<sub>c</sub></p>\n<p><img src=\"/img/article/20190801/5.png\" alt=\"\"></p>\n<p><code>GL_TRIANGLES</code><code>GL_LINES</code></p>\n<ul>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n<p>-1.01.0</p>\n<h2></h2>\n<p>(X<sub>c</sub>, Y<sub>c</sub>, Z<sub>c</sub>, W<sub>c</sub>)(X<sub>c</sub>, Y<sub>c</sub>, Z<sub>c</sub>)W<sub>c</sub>(X<sub>c</sub>/W<sub>c</sub>)(Y<sub>c</sub>/W<sub>c</sub>)(Z<sub>c</sub>/W<sub>c</sub>)(X<sub>d</sub>, Y<sub>d</sub>, Z<sub>d</sub>)[-1.01.0](X<sub>d</sub>, Y<sub>d</sub>)(Z<sub>d</sub>)<code>glDepthRangef</code><code>near</code><code>far</code>Z</p>\n<h2></h2>\n<p>OpenGL ESAPI</p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param x#&gt; x description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param y#&gt; y description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param width#&gt; 0 description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param height#&gt; 0 description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glViewport(GLint x, GLint y, GLsizei width, GLsizei height);</span><br></pre></td></tr></table></figure>\n<p>(x<sub>d</sub>, y<sub>d</sub>, z<sub>d</sub>)(x<sub>w</sub>, y<sub>w</sub>, z<sub>w</sub>)</p>\n<p><img src=\"/img/article/20190801/6.png\" alt=\"\"></p>\n<p>o<sub>x</sub>=x+w/2o<sub>y</sub>=y+h/2nf<br>\nnfAPI</p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param zNear#&gt; 0.0(0.0, 1.0) description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param zFar#&gt; 1.0(0.0, 1.0) description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glDepthRangef(GLclampf zNear, GLclampf zFar);</span><br></pre></td></tr></table></figure>\n<p><code>glDepthRangef</code><code>glViewport</code></p>\n<h1></h1>\n<p>(x, y)(x, y)</p>\n<p><img src=\"/img/article/20190801/7.png\" alt=\"OpenGL ES\"></p>\n<h2></h2>\n<p>culling</p>\n<p></p>\n<p><img src=\"/img/article/20190801/8.png\" alt=\"\"></p>\n<p>CWCCWAPI</p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param mode#&gt; GL_CWGL_CCWGL_CCW description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glFrontFace(GLenum mode);</span><br></pre></td></tr></table></figure>\n<p>API</p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param mode#&gt; GL_FROUNTGL_BACKGL_FROUNT_AND_BACKGL_BACK description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glCullFace(GLenum mode);</span><br></pre></td></tr></table></figure>\n<p><code>GL_CULL_FACE</code>API</p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param cap#&gt; GL_CULL_FACE description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glEnable(GLenum cap);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param cap#&gt; GL_CULL_FACE description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glDisable(GLenum cap);</span><br></pre></td></tr></table></figure>\n<p>OpenGL ES<code>glEnable(GL_CULL_FACE)</code><code>glCullFace</code><code>glFrontFace</code></p>\n<blockquote>\n<p>GPUOpenGL ES</p>\n</blockquote>\n<h2></h2>\n<p></p>\n<p>+</p>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param factor#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param units#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glPolygonOffset(GLfloat factor, GLfloat units);</span><br></pre></td></tr></table></figure>\n<p> = m *  + r * mOpenGL ESrOpenGL ES<br>\n<code>glEnable(GL_POLYGON_OFFSET_FILL)</code><code>glDisable(GL_POLYGON_OFFSET_FILL)</code></p>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"keyword\">float</span> polygonOffsetFactor = <span class=\"number\">-1.0</span>f;</span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"keyword\">float</span> polygonOffsetUnits = <span class=\"number\">-2.0</span>f;</span><br><span class=\"line\"></span><br><span class=\"line\">glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// load vertex shader</span></span><br><span class=\"line\"><span class=\"comment\">// set the appropriate transformation matrices</span></span><br><span class=\"line\"><span class=\"comment\">// set the vertex attribute state</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// draw the SMALLER quad</span></span><br><span class=\"line\">glDrawArrays(GL_TRIANGLE_FAN, <span class=\"number\">0</span>, <span class=\"number\">4</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// set the depth func to &lt;= as polygons are coplanar</span></span><br><span class=\"line\">glDrawFunc(GL_LEQUAL);</span><br><span class=\"line\"></span><br><span class=\"line\">glEnable(GL_POLYGON_OFFSET_FILL);</span><br><span class=\"line\"></span><br><span class=\"line\">glPolygonOffset(polygonOffsetFactor, polygonOffsetUnits);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// set the vertex attribute state</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// draw the LARGER quad</span></span><br><span class=\"line\">glDrawArrays(GL_TRIANGLE_FAN, <span class=\"number\">0</span>, <span class=\"number\">4</span>);</span><br></pre></td></tr></table></figure>\n<h1></h1>\n<p></p>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param target#&gt; GL_ANY_SAMPLES_PASSEDGL_ANY_SAMPLES_PASSED_CONSERVATIVEGL_TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param id#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glBeginQuery(GLenum target, GLuint <span class=\"keyword\">id</span>);</span><br><span class=\"line\">    </span><br><span class=\"line\">    </span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param target#&gt; GL_ANY_SAMPLES_PASSEDGL_ANY_SAMPLES_PASSED_CONSERVATIVEGL_TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glEndQuery(GLenum target);</span><br></pre></td></tr></table></figure>\n<p><code>GL_ANY_SAMPLES_PASSED</code><code>GL_ANY_SAMPLES_PASSED_CONSERVATIVE</code><code>GL_ANY_SAMPLES_PASSED_CONSERVATIVE</code><code>GL_TRUE</code></p>\n<p><code>id</code><code>glGenQueries</code><code>glDeleteQueries</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> id</span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param n#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param ids#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glGenQueries(GLsizei n, GLuint *ids);</span><br><span class=\"line\">    </span><br><span class=\"line\">    </span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> id</span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param n#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param ids#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span> </span><br><span class=\"line\">glDeleteQueries(GLsizei n, <span class=\"keyword\">const</span> GLuint *ids);</span><br></pre></td></tr></table></figure>\n<p><code>glBeginQuery</code><code>glEndQuery</code><code>glGetQueryObjectuiv</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param id#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param pname#&gt; GL_QUERY_RESULTGL_QUERY_RESULT_AVAILABLE description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param params#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glGetQueryObjectuiv(GLuint <span class=\"keyword\">id</span>, GLenum pname, GLuint *params);</span><br></pre></td></tr></table></figure>\n<h1></h1>\n<p>OpenGL ES</p>\n"},{"title":"OpenGL ES--","catalog":true,"toc_nav_num":true,"date":"2019-07-06T09:30:55.000Z","subtitle":"About OpenGL ES","header-img":"/img/article_header/article_header.png","busuanzi":true,"_content":"\n> \n\n# \n\nOpenGL ES\n6\n1. \n2. \n3. \n4. \n5. \n6. \n\n## \n\n\n``` objc\n/**\n \n\n @param type#>  GL_VERTEX_SHADER  GL_FRAGMENT_SHADER description#>\n @return \n */\nglCreateShader(GLenum type);\n\n/**\n \n\n @param shader#>  description#>\n @return void\n */\nglDeleteShader(GLuint shader)\n```\n\n\n\n``` objc\n/**\n \n\n @param shader#>  description#>\n @param count#>  description#>\n @param string#> count description#>\n @param length#>  description#>\n @return void\n */\nglShaderSource(GLuint shader, GLsizei count, const GLchar *const *string, const GLint *length)\n```\n\n\n``` objc\n/**\n \n\n @param shader#>  description#>\n @return void\n */\nglCompileShader(GLuint shader)\n```\n\n`glGetShderiv`\n``` objc\n/**\n \n\n @param shader#>  description#>\n @param pname#> GL_COMPILE_STATUSGL_DELETE_STATUSGL_INFO_LOG_LENGTHGL_SHADER_SOURCE_LENGTHGL_SHADER_TYPE description#>\n @param params#>  description#>\n @return void\n */\nglGetShaderiv(GLuint shader, GLenum pname, GLint *params)\n```\n\n`glGetShaderiv``GL_INFO_LOG_LENGTH``glGetShaderInfoLog`\n``` objc\n/**\n \n\n @param shader#>  description#>\n @param bufsize#>  description#>\n @param length#> NULL description#>\n @param infolog#>  description#>\n @return void\n */\nglGetShaderInfoLog(GLuint shader, GLsizei bufsize, GLsizei *length, GLchar *infolog)\n```\n\n\n\n## \n\n\n\n``` objc\n/**\n \n\n @param void void\n @return \n */\nglCreateProgram()\n```\n\n\n``` objc\n/**\n \n\n @param program#>  description#>\n @return void\n */\nglDeleteProgram(GLuint program)\n```\n\n\n``` objc\n/**\n \n\n @param program#>  description#>\n @param shader#>  description#>\n @return void\n */\nglAttachShader(GLuint program, GLuint shader)\n```\n> --\n\n\n``` objc\n/**\n \n\n @param program#>  description#>\n @param shader#>  description#>\n @return void\n */\nglDetachShader(GLuint program, GLuint shader)\n```\n\n\n``` objc\n/**\n \n\n @param program#>  description#>\n @return void\n */\nglLinkProgram(GLuint program)\n```\n\n\n\n\n``` objc\n/**\n \n\n @param program#>  description#>\n @param pname#> GL_ACTIVE_(ATTRIBUTES, ATTRIBUTE_MAX_LENGTH, UNIFORM_BLOCK, UNIFORM_BLOCK_MAX_LENGTH, UNIFORMS, UNFORM_MAX_LENGTH), GL_ATTACHED_SHADERS, GL_DELETE_STATUS, GL_INFO_LOG_LENGTH, GL_LINK_STATUS, GL_PROGRAM_BINARY_RETRIEVABLE_HINT, GL_TRANSFORM_FEEDBACK_(BUFFER_MODE, VARYINGS, VARYING_MAX_LENGTH), GL_VALIDATE_STATUS description#>\n @param params#>  description#>\n @return void\n */\nglGetProgramiv(GLuint program, GLenum pname, GLint *params)\n```\n\n`glGetProgramiv``GL_INFO_LOG_LENGTH`\n``` objc\n/**\n \n\n @param program#>  description#>\n @param bufsize#>  description#>\n @param length#> NULL description#>\n @param infolog#>  description#>\n @return void\n */\nglGetProgramInfoLog(GLuint program, GLsizei bufsize, GLsizei *length, GLchar *infolog)\n```\n\n\n``` objc\n/**\n \n\n @param program#>  description#>\n @return void\n */\nglValidateProgram(GLuint program)\n```\n`glValidProgram``glGetProgramiv``GL_VALIDATE_STATUS`\n\n\n``` objc\n/**\n \n\n @param program#>  description#>\n @return void\n */\nglUseProgram(GLuint program)\n```\n\n# \n\nuniform\n\n\n``` objc\nuniform TransformBlock {\n    mat4 matViewProj;\n    mat3 matNormal;\n    mat3 matTexGen\n}\n```\n\n\n```\nuniform mat4 matViewProj;\nuniform mat3 matNormal;\nuniform mat3 matTexGen;\n```\n\n\n\n## \n\n`glGetProgramiv``GL_ACTIVE_UNIFORMS``GL_ACTIVE_UNIFORM_MAX_LENGTH``glGetActiveUniform``glGetActiveUniformsiv`\n``` objc\nGLint uniformsCount;\nGLint maxUniformLength;\nglGetProgramiv(program, GL_ACTIVE_UNIFORMS, &uniformsCount);\nglGetProgramiv(program, GL_ACTIVE_UNIFORM_MAX_LENGTH, &maxUniformLength);\nfor (int i = 0; i < uniformsCount; i++) {\n    GLsizei length;\n    GLint size;\n    GLenum type;\n    GLchar *name = malloc(sizeof(GLchar) * maxUniformLength);\n    glGetActiveUniform(program, i, maxUniformLength, &length, &size, &type, name);\n    NSLog(@\"length: %d, size: %d, type: %u, name: %s\", length, size, type, name);\n}\n```\n\n`glGetActiveUniform`\n``` objc\n/**\n \n\n @param program#>  description#>\n @param name#>  description#>\n @return \n */\nglGetUniformLocation(GLuint program, const GLchar *name)\n```\n\n\n```\nvoid glUniformlf(GLint location, GLfloat x);\nvoid glUniformfv(GLint location, GLsizei count, const GLfloat* value);\n...\n```\n\n>  `glUniform*``glUniform*``glUseProgram`\n\n## \n\n UBOUniform Buffer ObjectAPI\n`glBufferData``glBufferSubData``glMapBufferRange``glUnmapBuffer``glUniform*`\n\nUBOUniform BlockBufferbufferbufferpoint`GL_MAX_UNIFORM_BUFFER_BINDINGS``glGet`pointpoint\n\n![UBO](/img/article/20190706/1.png)\n\n\n``` objc\n/**\n \n\n @param program#>  description#>\n @param uniformBlockName#>  description#>\n @return \n */\nglGetUniformBlockIndex(GLuint program, const GLchar *uniformBlockName)\n```\n\n`glGetActiveUniformBlockName`\n``` objc\n/**\n \n\n @param program#>  description#>\n @param uniformBlockIndex#>  description#>\n @param bufSize#>  description#>\n @param length#> NULL description#>\n @param uniformBlockName#>  description#>\n @return \n */\nglGetActiveUniformBlockName(GLuint program, GLuint uniformBlockIndex, GLsizei bufSize, GLsizei *length, GLchar *uniformBlockName)\n```\n\n`glGetActiveUniformBlockiv`\n``` objc\n/**\n \n\n @param program#>  description#>\n @param uniformBlockIndex#>  description#>\n @param pname#> GL_UNIFORM_BLOCK_(BINDING, DATA_SIZE, NAME_LENGTH, ACTIVE_UNIFORMS, ACTIVE_UNIFORM_INDICES, REFERENCED_BY_VERTEX_SHADER, REFERENCED_BY_FRAGMENT_SHADER) description#>\n @param params#> pname description#>\n @return void\n */\nglGetActiveUniformBlockiv(GLuint program, GLuint uniformBlockIndex, GLenum pname, GLint *params)\n```\n\n\n``` objc\n/**\n \n\n @param program#>  description#>\n @param uniformBlockIndex#>  description#>\n @param uniformBlockBinding#>  description#>\n @return void\n */\nglUniformBlockBinding(GLuint program, GLuint uniformBlockIndex, GLuint uniformBlockBinding)\n```\n\n`GL_UNIFORM_BUFFER`\n``` objc\n/**\n \n\n @param target#> GL_UNIFORM_BUFFERGL_TRANSFORM_FEEDBACK_BUFFER description#>\n @param index#>  description#>\n @param buffer#>  description#>\n @return void\n */\nglBindBufferBase(GLenum target, GLuint index, GLuint buffer)\n\n/**\n \n\n @param target#> GL_UNIFORM_BUFFERGL_TRANSFORM_FEEDBACK_BUFFER description#>\n @param index#>  description#>\n @param buffer#> b description#>\n @param offset#>  description#>\n @param size#>  description#>\n @return void\n */\nglBindBufferRange(GLenum target, GLuint index, GLuint buffer, GLintptr offset, GLsizeiptr size)\n```\n\n\nstd140std140OpengGL ES 3.0std140OpengGL ES 3.0\n\n | \n-|-\nshared | row_major/column_majorstd140packed\npacked | /std140shared\nstd140 | OpenGL ES 3.0sharedpacked\nrow_major | \ncolumn_major | \n\n\n``` objc\nlayout (std140) uniform LightBlock {\n    vec3 lightDirection;\n    vec4 lightPosition;\n}\n```\n\nUBO\n``` objc\nGLuint blockId, bufferId;\nGLint blockSize;\nGLuint bindingPoint = 1;\nGLfloat lightData[] = {\n    1.0f, 0.0f, 0.0f, 0.0f,\n    0.0f, 0.0f, 0.0f, 1.0f\n};\n\nblockId = glGetUniformBlockIndex(program, \"LightBlock\");\n\nglUniformBlockBinding(program, blockId, bindingPoint);\n\nglGetActiveUniformBlockiv(program, blockId, GL_UNIFORM_BLOCK_DATA_SIZE, &blockSize);\n\nglGenBuffers(1, &bufferId);\nglBindBuffer(GL_UNIFORM_BUFFER, bufferId);\nglBufferData(GL_UNIFORM_BUFFER, blockSize, lightData, GL_DYNAMIC_DRAW);\n\nglBindBufferBase(GL_UNIFORM_BUFFER, bindingPoint, bufferId);\n```\n\nUBO\n``` objc\nGLfloat updateData[] = {\n    1.0f, 0.0f, 0.0f, 0.0f\n};\n\nglBindBuffer(GL_UNIFORM_BUFFER, bufferId);\n\nconst GLchar *names[] = {\"lightDirection\"};\nGLuint indices;\nGLint offset;\nGLint size;\nglGetUniformIndices(program, 1, names, &indices);\nglGetActiveUniformsiv(program, 1, &indices, GL_UNIFORM_OFFSET, &offset);\nglGetActiveUniformsiv(program, 1, &indices, GL_UNIFORM_SIZE, &size);\nglBufferSubData(GL_UNIFORM_BUFFER, offset, size, updateData);\n```\n\n# \n\n\n\n``` objc\n/**\n \n \n @param program#>  description#>\n @param bufSize#> binary description#>\n @param length#>  description#>\n @param binaryFormat#>  description#>\n @param binary#>  description#>\n @return void\n */\nglGetProgramBinary(GLuint program, GLsizei bufSize, GLsizei *length, GLenum *binaryFormat, GLvoid *binary)\n```\n\nOpenGL ES\n``` objc\n/**\n OpenGL ES\n\n @param program#>  description#>\n @param binaryFormat#>  description#>\n @param binary#>  description#>\n @param length#>  description#>\n @return void\n */\nglProgramBinary(GLuint program, GLenum binaryFormat, const GLvoid *binary, GLsizei length)\n```\n\n`glProgramBinary``glProgramiv``GL_LINK_STATUS`\n\n# \n\nOpenGL ES 3.0","source":"_posts/2019/opengl-es-shader-and-program-0706.md","raw":"---\ntitle: \"OpenGL ES--\"\ncatalog: true\ntoc_nav_num: true\ndate: 2019-07-06 17:30:55\nsubtitle: \"About OpenGL ES\"\nheader-img: \"/img/article_header/article_header.png\"\nbusuanzi: true\ntags:\n- iOS\n\n---\n\n> \n\n# \n\nOpenGL ES\n6\n1. \n2. \n3. \n4. \n5. \n6. \n\n## \n\n\n``` objc\n/**\n \n\n @param type#>  GL_VERTEX_SHADER  GL_FRAGMENT_SHADER description#>\n @return \n */\nglCreateShader(GLenum type);\n\n/**\n \n\n @param shader#>  description#>\n @return void\n */\nglDeleteShader(GLuint shader)\n```\n\n\n\n``` objc\n/**\n \n\n @param shader#>  description#>\n @param count#>  description#>\n @param string#> count description#>\n @param length#>  description#>\n @return void\n */\nglShaderSource(GLuint shader, GLsizei count, const GLchar *const *string, const GLint *length)\n```\n\n\n``` objc\n/**\n \n\n @param shader#>  description#>\n @return void\n */\nglCompileShader(GLuint shader)\n```\n\n`glGetShderiv`\n``` objc\n/**\n \n\n @param shader#>  description#>\n @param pname#> GL_COMPILE_STATUSGL_DELETE_STATUSGL_INFO_LOG_LENGTHGL_SHADER_SOURCE_LENGTHGL_SHADER_TYPE description#>\n @param params#>  description#>\n @return void\n */\nglGetShaderiv(GLuint shader, GLenum pname, GLint *params)\n```\n\n`glGetShaderiv``GL_INFO_LOG_LENGTH``glGetShaderInfoLog`\n``` objc\n/**\n \n\n @param shader#>  description#>\n @param bufsize#>  description#>\n @param length#> NULL description#>\n @param infolog#>  description#>\n @return void\n */\nglGetShaderInfoLog(GLuint shader, GLsizei bufsize, GLsizei *length, GLchar *infolog)\n```\n\n\n\n## \n\n\n\n``` objc\n/**\n \n\n @param void void\n @return \n */\nglCreateProgram()\n```\n\n\n``` objc\n/**\n \n\n @param program#>  description#>\n @return void\n */\nglDeleteProgram(GLuint program)\n```\n\n\n``` objc\n/**\n \n\n @param program#>  description#>\n @param shader#>  description#>\n @return void\n */\nglAttachShader(GLuint program, GLuint shader)\n```\n> --\n\n\n``` objc\n/**\n \n\n @param program#>  description#>\n @param shader#>  description#>\n @return void\n */\nglDetachShader(GLuint program, GLuint shader)\n```\n\n\n``` objc\n/**\n \n\n @param program#>  description#>\n @return void\n */\nglLinkProgram(GLuint program)\n```\n\n\n\n\n``` objc\n/**\n \n\n @param program#>  description#>\n @param pname#> GL_ACTIVE_(ATTRIBUTES, ATTRIBUTE_MAX_LENGTH, UNIFORM_BLOCK, UNIFORM_BLOCK_MAX_LENGTH, UNIFORMS, UNFORM_MAX_LENGTH), GL_ATTACHED_SHADERS, GL_DELETE_STATUS, GL_INFO_LOG_LENGTH, GL_LINK_STATUS, GL_PROGRAM_BINARY_RETRIEVABLE_HINT, GL_TRANSFORM_FEEDBACK_(BUFFER_MODE, VARYINGS, VARYING_MAX_LENGTH), GL_VALIDATE_STATUS description#>\n @param params#>  description#>\n @return void\n */\nglGetProgramiv(GLuint program, GLenum pname, GLint *params)\n```\n\n`glGetProgramiv``GL_INFO_LOG_LENGTH`\n``` objc\n/**\n \n\n @param program#>  description#>\n @param bufsize#>  description#>\n @param length#> NULL description#>\n @param infolog#>  description#>\n @return void\n */\nglGetProgramInfoLog(GLuint program, GLsizei bufsize, GLsizei *length, GLchar *infolog)\n```\n\n\n``` objc\n/**\n \n\n @param program#>  description#>\n @return void\n */\nglValidateProgram(GLuint program)\n```\n`glValidProgram``glGetProgramiv``GL_VALIDATE_STATUS`\n\n\n``` objc\n/**\n \n\n @param program#>  description#>\n @return void\n */\nglUseProgram(GLuint program)\n```\n\n# \n\nuniform\n\n\n``` objc\nuniform TransformBlock {\n    mat4 matViewProj;\n    mat3 matNormal;\n    mat3 matTexGen\n}\n```\n\n\n```\nuniform mat4 matViewProj;\nuniform mat3 matNormal;\nuniform mat3 matTexGen;\n```\n\n\n\n## \n\n`glGetProgramiv``GL_ACTIVE_UNIFORMS``GL_ACTIVE_UNIFORM_MAX_LENGTH``glGetActiveUniform``glGetActiveUniformsiv`\n``` objc\nGLint uniformsCount;\nGLint maxUniformLength;\nglGetProgramiv(program, GL_ACTIVE_UNIFORMS, &uniformsCount);\nglGetProgramiv(program, GL_ACTIVE_UNIFORM_MAX_LENGTH, &maxUniformLength);\nfor (int i = 0; i < uniformsCount; i++) {\n    GLsizei length;\n    GLint size;\n    GLenum type;\n    GLchar *name = malloc(sizeof(GLchar) * maxUniformLength);\n    glGetActiveUniform(program, i, maxUniformLength, &length, &size, &type, name);\n    NSLog(@\"length: %d, size: %d, type: %u, name: %s\", length, size, type, name);\n}\n```\n\n`glGetActiveUniform`\n``` objc\n/**\n \n\n @param program#>  description#>\n @param name#>  description#>\n @return \n */\nglGetUniformLocation(GLuint program, const GLchar *name)\n```\n\n\n```\nvoid glUniformlf(GLint location, GLfloat x);\nvoid glUniformfv(GLint location, GLsizei count, const GLfloat* value);\n...\n```\n\n>  `glUniform*``glUniform*``glUseProgram`\n\n## \n\n UBOUniform Buffer ObjectAPI\n`glBufferData``glBufferSubData``glMapBufferRange``glUnmapBuffer``glUniform*`\n\nUBOUniform BlockBufferbufferbufferpoint`GL_MAX_UNIFORM_BUFFER_BINDINGS``glGet`pointpoint\n\n![UBO](/img/article/20190706/1.png)\n\n\n``` objc\n/**\n \n\n @param program#>  description#>\n @param uniformBlockName#>  description#>\n @return \n */\nglGetUniformBlockIndex(GLuint program, const GLchar *uniformBlockName)\n```\n\n`glGetActiveUniformBlockName`\n``` objc\n/**\n \n\n @param program#>  description#>\n @param uniformBlockIndex#>  description#>\n @param bufSize#>  description#>\n @param length#> NULL description#>\n @param uniformBlockName#>  description#>\n @return \n */\nglGetActiveUniformBlockName(GLuint program, GLuint uniformBlockIndex, GLsizei bufSize, GLsizei *length, GLchar *uniformBlockName)\n```\n\n`glGetActiveUniformBlockiv`\n``` objc\n/**\n \n\n @param program#>  description#>\n @param uniformBlockIndex#>  description#>\n @param pname#> GL_UNIFORM_BLOCK_(BINDING, DATA_SIZE, NAME_LENGTH, ACTIVE_UNIFORMS, ACTIVE_UNIFORM_INDICES, REFERENCED_BY_VERTEX_SHADER, REFERENCED_BY_FRAGMENT_SHADER) description#>\n @param params#> pname description#>\n @return void\n */\nglGetActiveUniformBlockiv(GLuint program, GLuint uniformBlockIndex, GLenum pname, GLint *params)\n```\n\n\n``` objc\n/**\n \n\n @param program#>  description#>\n @param uniformBlockIndex#>  description#>\n @param uniformBlockBinding#>  description#>\n @return void\n */\nglUniformBlockBinding(GLuint program, GLuint uniformBlockIndex, GLuint uniformBlockBinding)\n```\n\n`GL_UNIFORM_BUFFER`\n``` objc\n/**\n \n\n @param target#> GL_UNIFORM_BUFFERGL_TRANSFORM_FEEDBACK_BUFFER description#>\n @param index#>  description#>\n @param buffer#>  description#>\n @return void\n */\nglBindBufferBase(GLenum target, GLuint index, GLuint buffer)\n\n/**\n \n\n @param target#> GL_UNIFORM_BUFFERGL_TRANSFORM_FEEDBACK_BUFFER description#>\n @param index#>  description#>\n @param buffer#> b description#>\n @param offset#>  description#>\n @param size#>  description#>\n @return void\n */\nglBindBufferRange(GLenum target, GLuint index, GLuint buffer, GLintptr offset, GLsizeiptr size)\n```\n\n\nstd140std140OpengGL ES 3.0std140OpengGL ES 3.0\n\n | \n-|-\nshared | row_major/column_majorstd140packed\npacked | /std140shared\nstd140 | OpenGL ES 3.0sharedpacked\nrow_major | \ncolumn_major | \n\n\n``` objc\nlayout (std140) uniform LightBlock {\n    vec3 lightDirection;\n    vec4 lightPosition;\n}\n```\n\nUBO\n``` objc\nGLuint blockId, bufferId;\nGLint blockSize;\nGLuint bindingPoint = 1;\nGLfloat lightData[] = {\n    1.0f, 0.0f, 0.0f, 0.0f,\n    0.0f, 0.0f, 0.0f, 1.0f\n};\n\nblockId = glGetUniformBlockIndex(program, \"LightBlock\");\n\nglUniformBlockBinding(program, blockId, bindingPoint);\n\nglGetActiveUniformBlockiv(program, blockId, GL_UNIFORM_BLOCK_DATA_SIZE, &blockSize);\n\nglGenBuffers(1, &bufferId);\nglBindBuffer(GL_UNIFORM_BUFFER, bufferId);\nglBufferData(GL_UNIFORM_BUFFER, blockSize, lightData, GL_DYNAMIC_DRAW);\n\nglBindBufferBase(GL_UNIFORM_BUFFER, bindingPoint, bufferId);\n```\n\nUBO\n``` objc\nGLfloat updateData[] = {\n    1.0f, 0.0f, 0.0f, 0.0f\n};\n\nglBindBuffer(GL_UNIFORM_BUFFER, bufferId);\n\nconst GLchar *names[] = {\"lightDirection\"};\nGLuint indices;\nGLint offset;\nGLint size;\nglGetUniformIndices(program, 1, names, &indices);\nglGetActiveUniformsiv(program, 1, &indices, GL_UNIFORM_OFFSET, &offset);\nglGetActiveUniformsiv(program, 1, &indices, GL_UNIFORM_SIZE, &size);\nglBufferSubData(GL_UNIFORM_BUFFER, offset, size, updateData);\n```\n\n# \n\n\n\n``` objc\n/**\n \n \n @param program#>  description#>\n @param bufSize#> binary description#>\n @param length#>  description#>\n @param binaryFormat#>  description#>\n @param binary#>  description#>\n @return void\n */\nglGetProgramBinary(GLuint program, GLsizei bufSize, GLsizei *length, GLenum *binaryFormat, GLvoid *binary)\n```\n\nOpenGL ES\n``` objc\n/**\n OpenGL ES\n\n @param program#>  description#>\n @param binaryFormat#>  description#>\n @param binary#>  description#>\n @param length#>  description#>\n @return void\n */\nglProgramBinary(GLuint program, GLenum binaryFormat, const GLvoid *binary, GLsizei length)\n```\n\n`glProgramBinary``glProgramiv``GL_LINK_STATUS`\n\n# \n\nOpenGL ES 3.0","slug":"2019/opengl-es-shader-and-program-0706","published":1,"updated":"2021-06-21T12:34:52.095Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckszp3ndf000zifnt5qn9ga66","content":"<blockquote>\n<p></p>\n</blockquote>\n<h1 id=\"\"></h1>\n<p>OpenGL ES<br>\n6</p>\n<ol>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n</ol>\n<h2 id=\"\"></h2>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param type#&gt;  GL_VERTEX_SHADER  GL_FRAGMENT_SHADER description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return </span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glCreateShader(GLenum type);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param shader#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glDeleteShader(GLuint shader)</span><br></pre></td></tr></table></figure>\n<p></p>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param shader#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param count#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param string#&gt; count description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param length#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glShaderSource(GLuint shader, GLsizei count, <span class=\"keyword\">const</span> GLchar *<span class=\"keyword\">const</span> *string, <span class=\"keyword\">const</span> GLint *length)</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param shader#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glCompileShader(GLuint shader)</span><br></pre></td></tr></table></figure>\n<p><code>glGetShderiv</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param shader#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param pname#&gt; GL_COMPILE_STATUSGL_DELETE_STATUSGL_INFO_LOG_LENGTHGL_SHADER_SOURCE_LENGTHGL_SHADER_TYPE description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param params#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glGetShaderiv(GLuint shader, GLenum pname, GLint *params)</span><br></pre></td></tr></table></figure>\n<p><code>glGetShaderiv</code><code>GL_INFO_LOG_LENGTH</code><code>glGetShaderInfoLog</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param shader#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param bufsize#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param length#&gt; NULL description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param infolog#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glGetShaderInfoLog(GLuint shader, GLsizei bufsize, GLsizei *length, GLchar *infolog)</span><br></pre></td></tr></table></figure>\n<p></p>\n<h2 id=\"\"></h2>\n<p><br>\n</p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param void void</span></span><br><span class=\"line\"><span class=\"comment\"> @return </span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glCreateProgram()</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param program#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glDeleteProgram(GLuint program)</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param program#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param shader#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glAttachShader(GLuint program, GLuint shader)</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p></p>\n</blockquote>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param program#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param shader#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glDetachShader(GLuint program, GLuint shader)</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param program#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glLinkProgram(GLuint program)</span><br></pre></td></tr></table></figure>\n<p></p>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param program#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param pname#&gt; GL_ACTIVE_(ATTRIBUTES, ATTRIBUTE_MAX_LENGTH, UNIFORM_BLOCK, UNIFORM_BLOCK_MAX_LENGTH, UNIFORMS, UNFORM_MAX_LENGTH), GL_ATTACHED_SHADERS, GL_DELETE_STATUS, GL_INFO_LOG_LENGTH, GL_LINK_STATUS, GL_PROGRAM_BINARY_RETRIEVABLE_HINT, GL_TRANSFORM_FEEDBACK_(BUFFER_MODE, VARYINGS, VARYING_MAX_LENGTH), GL_VALIDATE_STATUS description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param params#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glGetProgramiv(GLuint program, GLenum pname, GLint *params)</span><br></pre></td></tr></table></figure>\n<p><code>glGetProgramiv</code><code>GL_INFO_LOG_LENGTH</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param program#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param bufsize#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param length#&gt; NULL description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param infolog#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glGetProgramInfoLog(GLuint program, GLsizei bufsize, GLsizei *length, GLchar *infolog)</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param program#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glValidateProgram(GLuint program)</span><br></pre></td></tr></table></figure>\n<p><code>glValidProgram</code><code>glGetProgramiv</code><code>GL_VALIDATE_STATUS</code></p>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param program#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glUseProgram(GLuint program)</span><br></pre></td></tr></table></figure>\n<h1 id=\"\"></h1>\n<p>uniform</p>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">uniform TransformBlock &#123;</span><br><span class=\"line\">    mat4 matViewProj;</span><br><span class=\"line\">    mat3 matNormal;</span><br><span class=\"line\">    mat3 matTexGen</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">uniform mat4 matViewProj;</span><br><span class=\"line\">uniform mat3 matNormal;</span><br><span class=\"line\">uniform mat3 matTexGen;</span><br></pre></td></tr></table></figure>\n<p></p>\n<h2 id=\"\"></h2>\n<p><code>glGetProgramiv</code><code>GL_ACTIVE_UNIFORMS</code><code>GL_ACTIVE_UNIFORM_MAX_LENGTH</code><code>glGetActiveUniform</code><code>glGetActiveUniformsiv</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">GLint uniformsCount;</span><br><span class=\"line\">GLint maxUniformLength;</span><br><span class=\"line\">glGetProgramiv(program, GL_ACTIVE_UNIFORMS, &amp;uniformsCount);</span><br><span class=\"line\">glGetProgramiv(program, GL_ACTIVE_UNIFORM_MAX_LENGTH, &amp;maxUniformLength);</span><br><span class=\"line\"><span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; uniformsCount; i++) &#123;</span><br><span class=\"line\">    GLsizei length;</span><br><span class=\"line\">    GLint size;</span><br><span class=\"line\">    GLenum type;</span><br><span class=\"line\">    GLchar *name = malloc(<span class=\"keyword\">sizeof</span>(GLchar) * maxUniformLength);</span><br><span class=\"line\">    glGetActiveUniform(program, i, maxUniformLength, &amp;length, &amp;size, &amp;type, name);</span><br><span class=\"line\">    <span class=\"built_in\">NSLog</span>(<span class=\"string\">@\"length: %d, size: %d, type: %u, name: %s\"</span>, length, size, type, name);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><code>glGetActiveUniform</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param program#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param name#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return </span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glGetUniformLocation(GLuint program, <span class=\"keyword\">const</span> GLchar *name)</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">void glUniformlf(GLint location, GLfloat x);</span><br><span class=\"line\">void glUniformfv(GLint location, GLsizei count, const GLfloat* value);</span><br><span class=\"line\">...</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p><code>glUniform*</code><code>glUniform*</code><code>glUseProgram</code></p>\n</blockquote>\n<h2 id=\"\"></h2>\n<p> UBOUniform Buffer ObjectAPI<br>\n<code>glBufferData</code><code>glBufferSubData</code><code>glMapBufferRange</code><code>glUnmapBuffer</code><code>glUniform*</code></p>\n<p>UBOUniform BlockBufferbufferbufferpoint<code>GL_MAX_UNIFORM_BUFFER_BINDINGS</code><code>glGet</code>pointpoint</p>\n<p><img src=\"/img/article/20190706/1.png\" alt=\"UBO\"></p>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param program#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param uniformBlockName#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return </span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glGetUniformBlockIndex(GLuint program, <span class=\"keyword\">const</span> GLchar *uniformBlockName)</span><br></pre></td></tr></table></figure>\n<p><code>glGetActiveUniformBlockName</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param program#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param uniformBlockIndex#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param bufSize#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param length#&gt; NULL description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param uniformBlockName#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return </span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glGetActiveUniformBlockName(GLuint program, GLuint uniformBlockIndex, GLsizei bufSize, GLsizei *length, GLchar *uniformBlockName)</span><br></pre></td></tr></table></figure>\n<p><code>glGetActiveUniformBlockiv</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param program#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param uniformBlockIndex#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param pname#&gt; GL_UNIFORM_BLOCK_(BINDING, DATA_SIZE, NAME_LENGTH, ACTIVE_UNIFORMS, ACTIVE_UNIFORM_INDICES, REFERENCED_BY_VERTEX_SHADER, REFERENCED_BY_FRAGMENT_SHADER) description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param params#&gt; pname description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glGetActiveUniformBlockiv(GLuint program, GLuint uniformBlockIndex, GLenum pname, GLint *params)</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param program#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param uniformBlockIndex#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param uniformBlockBinding#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glUniformBlockBinding(GLuint program, GLuint uniformBlockIndex, GLuint uniformBlockBinding)</span><br></pre></td></tr></table></figure>\n<p><code>GL_UNIFORM_BUFFER</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param target#&gt; GL_UNIFORM_BUFFERGL_TRANSFORM_FEEDBACK_BUFFER description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param index#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param buffer#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glBindBufferBase(GLenum target, GLuint index, GLuint buffer)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param target#&gt; GL_UNIFORM_BUFFERGL_TRANSFORM_FEEDBACK_BUFFER description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param index#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param buffer#&gt; b description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param offset#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param size#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glBindBufferRange(GLenum target, GLuint index, GLuint buffer, GLintptr offset, GLsizeiptr size)</span><br></pre></td></tr></table></figure>\n<p><br>\nstd140std140OpengGL ES 3.0std140OpengGL ES 3.0<br>\n</p>\n<table>\n<thead>\n<tr>\n<th></th>\n<th></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>shared</td>\n<td>row_major/column_majorstd140packed</td>\n</tr>\n<tr>\n<td>packed</td>\n<td>/std140shared</td>\n</tr>\n<tr>\n<td>std140</td>\n<td>OpenGL ES 3.0sharedpacked</td>\n</tr>\n<tr>\n<td>row_major</td>\n<td></td>\n</tr>\n<tr>\n<td>column_major</td>\n<td></td>\n</tr>\n</tbody>\n</table>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">layout (std140) uniform LightBlock &#123;</span><br><span class=\"line\">    vec3 lightDirection;</span><br><span class=\"line\">    vec4 lightPosition;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>UBO</p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">GLuint blockId, bufferId;</span><br><span class=\"line\">GLint blockSize;</span><br><span class=\"line\">GLuint bindingPoint = <span class=\"number\">1</span>;</span><br><span class=\"line\">GLfloat lightData[] = &#123;</span><br><span class=\"line\">    <span class=\"number\">1.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">0.0</span>f,</span><br><span class=\"line\">    <span class=\"number\">0.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">1.0</span>f</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">blockId = glGetUniformBlockIndex(program, <span class=\"string\">\"LightBlock\"</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">glUniformBlockBinding(program, blockId, bindingPoint);</span><br><span class=\"line\"></span><br><span class=\"line\">glGetActiveUniformBlockiv(program, blockId, GL_UNIFORM_BLOCK_DATA_SIZE, &amp;blockSize);</span><br><span class=\"line\"></span><br><span class=\"line\">glGenBuffers(<span class=\"number\">1</span>, &amp;bufferId);</span><br><span class=\"line\">glBindBuffer(GL_UNIFORM_BUFFER, bufferId);</span><br><span class=\"line\">glBufferData(GL_UNIFORM_BUFFER, blockSize, lightData, GL_DYNAMIC_DRAW);</span><br><span class=\"line\"></span><br><span class=\"line\">glBindBufferBase(GL_UNIFORM_BUFFER, bindingPoint, bufferId);</span><br></pre></td></tr></table></figure>\n<p>UBO</p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">GLfloat updateData[] = &#123;</span><br><span class=\"line\">    <span class=\"number\">1.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">0.0</span>f</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">glBindBuffer(GL_UNIFORM_BUFFER, bufferId);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> GLchar *names[] = &#123;<span class=\"string\">\"lightDirection\"</span>&#125;;</span><br><span class=\"line\">GLuint indices;</span><br><span class=\"line\">GLint offset;</span><br><span class=\"line\">GLint size;</span><br><span class=\"line\">glGetUniformIndices(program, <span class=\"number\">1</span>, names, &amp;indices);</span><br><span class=\"line\">glGetActiveUniformsiv(program, <span class=\"number\">1</span>, &amp;indices, GL_UNIFORM_OFFSET, &amp;offset);</span><br><span class=\"line\">glGetActiveUniformsiv(program, <span class=\"number\">1</span>, &amp;indices, GL_UNIFORM_SIZE, &amp;size);</span><br><span class=\"line\">glBufferSubData(GL_UNIFORM_BUFFER, offset, size, updateData);</span><br></pre></td></tr></table></figure>\n<h1 id=\"\"></h1>\n<p><br>\n</p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"> @param program#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param bufSize#&gt; binary description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param length#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param binaryFormat#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param binary#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glGetProgramBinary(GLuint program, GLsizei bufSize, GLsizei *length, GLenum *binaryFormat, GLvoid *binary)</span><br></pre></td></tr></table></figure>\n<p>OpenGL ES</p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> OpenGL ES</span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param program#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param binaryFormat#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param binary#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param length#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glProgramBinary(GLuint program, GLenum binaryFormat, <span class=\"keyword\">const</span> GLvoid *binary, GLsizei length)</span><br></pre></td></tr></table></figure>\n<p><code>glProgramBinary</code><code>glProgramiv</code><code>GL_LINK_STATUS</code></p>\n<h1 id=\"\"></h1>\n<p>OpenGL ES 3.0</p>\n","site":{"data":{}},"excerpt":"","more":"<blockquote>\n<p></p>\n</blockquote>\n<h1></h1>\n<p>OpenGL ES<br>\n6</p>\n<ol>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n</ol>\n<h2></h2>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param type#&gt;  GL_VERTEX_SHADER  GL_FRAGMENT_SHADER description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return </span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glCreateShader(GLenum type);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param shader#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glDeleteShader(GLuint shader)</span><br></pre></td></tr></table></figure>\n<p></p>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param shader#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param count#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param string#&gt; count description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param length#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glShaderSource(GLuint shader, GLsizei count, <span class=\"keyword\">const</span> GLchar *<span class=\"keyword\">const</span> *string, <span class=\"keyword\">const</span> GLint *length)</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param shader#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glCompileShader(GLuint shader)</span><br></pre></td></tr></table></figure>\n<p><code>glGetShderiv</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param shader#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param pname#&gt; GL_COMPILE_STATUSGL_DELETE_STATUSGL_INFO_LOG_LENGTHGL_SHADER_SOURCE_LENGTHGL_SHADER_TYPE description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param params#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glGetShaderiv(GLuint shader, GLenum pname, GLint *params)</span><br></pre></td></tr></table></figure>\n<p><code>glGetShaderiv</code><code>GL_INFO_LOG_LENGTH</code><code>glGetShaderInfoLog</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param shader#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param bufsize#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param length#&gt; NULL description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param infolog#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glGetShaderInfoLog(GLuint shader, GLsizei bufsize, GLsizei *length, GLchar *infolog)</span><br></pre></td></tr></table></figure>\n<p></p>\n<h2></h2>\n<p><br>\n</p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param void void</span></span><br><span class=\"line\"><span class=\"comment\"> @return </span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glCreateProgram()</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param program#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glDeleteProgram(GLuint program)</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param program#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param shader#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glAttachShader(GLuint program, GLuint shader)</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p></p>\n</blockquote>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param program#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param shader#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glDetachShader(GLuint program, GLuint shader)</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param program#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glLinkProgram(GLuint program)</span><br></pre></td></tr></table></figure>\n<p></p>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param program#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param pname#&gt; GL_ACTIVE_(ATTRIBUTES, ATTRIBUTE_MAX_LENGTH, UNIFORM_BLOCK, UNIFORM_BLOCK_MAX_LENGTH, UNIFORMS, UNFORM_MAX_LENGTH), GL_ATTACHED_SHADERS, GL_DELETE_STATUS, GL_INFO_LOG_LENGTH, GL_LINK_STATUS, GL_PROGRAM_BINARY_RETRIEVABLE_HINT, GL_TRANSFORM_FEEDBACK_(BUFFER_MODE, VARYINGS, VARYING_MAX_LENGTH), GL_VALIDATE_STATUS description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param params#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glGetProgramiv(GLuint program, GLenum pname, GLint *params)</span><br></pre></td></tr></table></figure>\n<p><code>glGetProgramiv</code><code>GL_INFO_LOG_LENGTH</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param program#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param bufsize#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param length#&gt; NULL description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param infolog#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glGetProgramInfoLog(GLuint program, GLsizei bufsize, GLsizei *length, GLchar *infolog)</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param program#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glValidateProgram(GLuint program)</span><br></pre></td></tr></table></figure>\n<p><code>glValidProgram</code><code>glGetProgramiv</code><code>GL_VALIDATE_STATUS</code></p>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param program#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glUseProgram(GLuint program)</span><br></pre></td></tr></table></figure>\n<h1></h1>\n<p>uniform</p>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">uniform TransformBlock &#123;</span><br><span class=\"line\">    mat4 matViewProj;</span><br><span class=\"line\">    mat3 matNormal;</span><br><span class=\"line\">    mat3 matTexGen</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">uniform mat4 matViewProj;</span><br><span class=\"line\">uniform mat3 matNormal;</span><br><span class=\"line\">uniform mat3 matTexGen;</span><br></pre></td></tr></table></figure>\n<p></p>\n<h2></h2>\n<p><code>glGetProgramiv</code><code>GL_ACTIVE_UNIFORMS</code><code>GL_ACTIVE_UNIFORM_MAX_LENGTH</code><code>glGetActiveUniform</code><code>glGetActiveUniformsiv</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">GLint uniformsCount;</span><br><span class=\"line\">GLint maxUniformLength;</span><br><span class=\"line\">glGetProgramiv(program, GL_ACTIVE_UNIFORMS, &amp;uniformsCount);</span><br><span class=\"line\">glGetProgramiv(program, GL_ACTIVE_UNIFORM_MAX_LENGTH, &amp;maxUniformLength);</span><br><span class=\"line\"><span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; uniformsCount; i++) &#123;</span><br><span class=\"line\">    GLsizei length;</span><br><span class=\"line\">    GLint size;</span><br><span class=\"line\">    GLenum type;</span><br><span class=\"line\">    GLchar *name = malloc(<span class=\"keyword\">sizeof</span>(GLchar) * maxUniformLength);</span><br><span class=\"line\">    glGetActiveUniform(program, i, maxUniformLength, &amp;length, &amp;size, &amp;type, name);</span><br><span class=\"line\">    <span class=\"built_in\">NSLog</span>(<span class=\"string\">@\"length: %d, size: %d, type: %u, name: %s\"</span>, length, size, type, name);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><code>glGetActiveUniform</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param program#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param name#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return </span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glGetUniformLocation(GLuint program, <span class=\"keyword\">const</span> GLchar *name)</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">void glUniformlf(GLint location, GLfloat x);</span><br><span class=\"line\">void glUniformfv(GLint location, GLsizei count, const GLfloat* value);</span><br><span class=\"line\">...</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p><code>glUniform*</code><code>glUniform*</code><code>glUseProgram</code></p>\n</blockquote>\n<h2></h2>\n<p> UBOUniform Buffer ObjectAPI<br>\n<code>glBufferData</code><code>glBufferSubData</code><code>glMapBufferRange</code><code>glUnmapBuffer</code><code>glUniform*</code></p>\n<p>UBOUniform BlockBufferbufferbufferpoint<code>GL_MAX_UNIFORM_BUFFER_BINDINGS</code><code>glGet</code>pointpoint</p>\n<p><img src=\"/img/article/20190706/1.png\" alt=\"UBO\"></p>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param program#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param uniformBlockName#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return </span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glGetUniformBlockIndex(GLuint program, <span class=\"keyword\">const</span> GLchar *uniformBlockName)</span><br></pre></td></tr></table></figure>\n<p><code>glGetActiveUniformBlockName</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param program#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param uniformBlockIndex#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param bufSize#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param length#&gt; NULL description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param uniformBlockName#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return </span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glGetActiveUniformBlockName(GLuint program, GLuint uniformBlockIndex, GLsizei bufSize, GLsizei *length, GLchar *uniformBlockName)</span><br></pre></td></tr></table></figure>\n<p><code>glGetActiveUniformBlockiv</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param program#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param uniformBlockIndex#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param pname#&gt; GL_UNIFORM_BLOCK_(BINDING, DATA_SIZE, NAME_LENGTH, ACTIVE_UNIFORMS, ACTIVE_UNIFORM_INDICES, REFERENCED_BY_VERTEX_SHADER, REFERENCED_BY_FRAGMENT_SHADER) description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param params#&gt; pname description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glGetActiveUniformBlockiv(GLuint program, GLuint uniformBlockIndex, GLenum pname, GLint *params)</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param program#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param uniformBlockIndex#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param uniformBlockBinding#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glUniformBlockBinding(GLuint program, GLuint uniformBlockIndex, GLuint uniformBlockBinding)</span><br></pre></td></tr></table></figure>\n<p><code>GL_UNIFORM_BUFFER</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param target#&gt; GL_UNIFORM_BUFFERGL_TRANSFORM_FEEDBACK_BUFFER description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param index#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param buffer#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glBindBufferBase(GLenum target, GLuint index, GLuint buffer)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param target#&gt; GL_UNIFORM_BUFFERGL_TRANSFORM_FEEDBACK_BUFFER description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param index#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param buffer#&gt; b description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param offset#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param size#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glBindBufferRange(GLenum target, GLuint index, GLuint buffer, GLintptr offset, GLsizeiptr size)</span><br></pre></td></tr></table></figure>\n<p><br>\nstd140std140OpengGL ES 3.0std140OpengGL ES 3.0<br>\n</p>\n<table>\n<thead>\n<tr>\n<th></th>\n<th></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>shared</td>\n<td>row_major/column_majorstd140packed</td>\n</tr>\n<tr>\n<td>packed</td>\n<td>/std140shared</td>\n</tr>\n<tr>\n<td>std140</td>\n<td>OpenGL ES 3.0sharedpacked</td>\n</tr>\n<tr>\n<td>row_major</td>\n<td></td>\n</tr>\n<tr>\n<td>column_major</td>\n<td></td>\n</tr>\n</tbody>\n</table>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">layout (std140) uniform LightBlock &#123;</span><br><span class=\"line\">    vec3 lightDirection;</span><br><span class=\"line\">    vec4 lightPosition;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>UBO</p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">GLuint blockId, bufferId;</span><br><span class=\"line\">GLint blockSize;</span><br><span class=\"line\">GLuint bindingPoint = <span class=\"number\">1</span>;</span><br><span class=\"line\">GLfloat lightData[] = &#123;</span><br><span class=\"line\">    <span class=\"number\">1.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">0.0</span>f,</span><br><span class=\"line\">    <span class=\"number\">0.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">1.0</span>f</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">blockId = glGetUniformBlockIndex(program, <span class=\"string\">\"LightBlock\"</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">glUniformBlockBinding(program, blockId, bindingPoint);</span><br><span class=\"line\"></span><br><span class=\"line\">glGetActiveUniformBlockiv(program, blockId, GL_UNIFORM_BLOCK_DATA_SIZE, &amp;blockSize);</span><br><span class=\"line\"></span><br><span class=\"line\">glGenBuffers(<span class=\"number\">1</span>, &amp;bufferId);</span><br><span class=\"line\">glBindBuffer(GL_UNIFORM_BUFFER, bufferId);</span><br><span class=\"line\">glBufferData(GL_UNIFORM_BUFFER, blockSize, lightData, GL_DYNAMIC_DRAW);</span><br><span class=\"line\"></span><br><span class=\"line\">glBindBufferBase(GL_UNIFORM_BUFFER, bindingPoint, bufferId);</span><br></pre></td></tr></table></figure>\n<p>UBO</p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">GLfloat updateData[] = &#123;</span><br><span class=\"line\">    <span class=\"number\">1.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">0.0</span>f</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">glBindBuffer(GL_UNIFORM_BUFFER, bufferId);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> GLchar *names[] = &#123;<span class=\"string\">\"lightDirection\"</span>&#125;;</span><br><span class=\"line\">GLuint indices;</span><br><span class=\"line\">GLint offset;</span><br><span class=\"line\">GLint size;</span><br><span class=\"line\">glGetUniformIndices(program, <span class=\"number\">1</span>, names, &amp;indices);</span><br><span class=\"line\">glGetActiveUniformsiv(program, <span class=\"number\">1</span>, &amp;indices, GL_UNIFORM_OFFSET, &amp;offset);</span><br><span class=\"line\">glGetActiveUniformsiv(program, <span class=\"number\">1</span>, &amp;indices, GL_UNIFORM_SIZE, &amp;size);</span><br><span class=\"line\">glBufferSubData(GL_UNIFORM_BUFFER, offset, size, updateData);</span><br></pre></td></tr></table></figure>\n<h1></h1>\n<p><br>\n</p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"> @param program#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param bufSize#&gt; binary description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param length#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param binaryFormat#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param binary#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glGetProgramBinary(GLuint program, GLsizei bufSize, GLsizei *length, GLenum *binaryFormat, GLvoid *binary)</span><br></pre></td></tr></table></figure>\n<p>OpenGL ES</p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> OpenGL ES</span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param program#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param binaryFormat#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param binary#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param length#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glProgramBinary(GLuint program, GLenum binaryFormat, <span class=\"keyword\">const</span> GLvoid *binary, GLsizei length)</span><br></pre></td></tr></table></figure>\n<p><code>glProgramBinary</code><code>glProgramiv</code><code>GL_LINK_STATUS</code></p>\n<h1></h1>\n<p>OpenGL ES 3.0</p>\n"},{"title":"OpenGL ES--","catalog":true,"toc_nav_num":true,"date":"2019-08-21T11:10:54.000Z","subtitle":"About OpenGL ES","header-img":"/img/article_header/article_header.png","busuanzi":true,"_content":"\n> OpenGL ES 3.0OpenGLGPUGL\n\n# \n\nOpenGL ES 3.0 APIOpenGL-OpenGL ESOpenGLOpenGL ESOpenGL ES\n-OpenGL ESABAOpenGL ES`glFlush`OpenGL ES`glFlush``glFinish``glFinish``glFinish``glFinish`\n\n# \n\nOpenGL ES 3.0FenceGPUOpenGL ESGL\n`glFinish`GL`glFinish`\n\n# \n\nGL\n\n``` objc\n/**\n GL\n\n @param condition#> GL_SYNC_GPU_COMMANDS_COMPLETE description#>\n @param flags#> 0 description#>\n @return GLsync \n */\nglFenceSync(GLenum condition, GLbitfield flags);\n```\n\nUnsignaledSignaled\n\n\n``` objc\n/**\n \n\n @param sync#>  description#>\n @return void\n */\nglDeleteSync(GLsync sync);\n```\n\n`glDeleteSync`\n\n# \n\n\n\n``` objc\n/**\n \n\n @param sync#>  description#>\n @param flags#> GL_SYNC_FLUSH_COMMANDS_BIT description#>\n @param timeout#>  description#>\n @return GLenum\n */\nglClientWaitSync(GLsync sync, GLbitfield flags, GLuint64 timeout);\n```\n\n`glClientWaitSync``timeout`\n`glClientWaitSync`\n- GL_ARRAY_SIGNALED\n- GL_TIMEOUT_EXPIRED`timeout`\n- GL_CONDITION_SATISFIED\n- GL_WAIT_FAILED\n\n`glWaitSync``glClientWaitSync`GPU\n\n``` objc\n/**\n GPU\n\n @param sync#>  description#>\n @param flags#> 0 description#>\n @param timeout#> GL_TIMEOUT_IGNORED description#>\n @return void\n */\nglWaitSync(GLsync sync, GLbitfield flags, GLuint64 timeout);\n```\n\n# \n\nOpenGL ES 3.0GPU","source":"_posts/2019/opengl-es-sync-and-fence-0821.md","raw":"---\ntitle: \"OpenGL ES--\"\ncatalog: true\ntoc_nav_num: true\ndate: 2019-08-21 19:10:54\nsubtitle: \"About OpenGL ES\"\nheader-img: \"/img/article_header/article_header.png\"\nbusuanzi: true\ntags:\n- iOS\n\n---\n\n> OpenGL ES 3.0OpenGLGPUGL\n\n# \n\nOpenGL ES 3.0 APIOpenGL-OpenGL ESOpenGLOpenGL ESOpenGL ES\n-OpenGL ESABAOpenGL ES`glFlush`OpenGL ES`glFlush``glFinish``glFinish``glFinish``glFinish`\n\n# \n\nOpenGL ES 3.0FenceGPUOpenGL ESGL\n`glFinish`GL`glFinish`\n\n# \n\nGL\n\n``` objc\n/**\n GL\n\n @param condition#> GL_SYNC_GPU_COMMANDS_COMPLETE description#>\n @param flags#> 0 description#>\n @return GLsync \n */\nglFenceSync(GLenum condition, GLbitfield flags);\n```\n\nUnsignaledSignaled\n\n\n``` objc\n/**\n \n\n @param sync#>  description#>\n @return void\n */\nglDeleteSync(GLsync sync);\n```\n\n`glDeleteSync`\n\n# \n\n\n\n``` objc\n/**\n \n\n @param sync#>  description#>\n @param flags#> GL_SYNC_FLUSH_COMMANDS_BIT description#>\n @param timeout#>  description#>\n @return GLenum\n */\nglClientWaitSync(GLsync sync, GLbitfield flags, GLuint64 timeout);\n```\n\n`glClientWaitSync``timeout`\n`glClientWaitSync`\n- GL_ARRAY_SIGNALED\n- GL_TIMEOUT_EXPIRED`timeout`\n- GL_CONDITION_SATISFIED\n- GL_WAIT_FAILED\n\n`glWaitSync``glClientWaitSync`GPU\n\n``` objc\n/**\n GPU\n\n @param sync#>  description#>\n @param flags#> 0 description#>\n @param timeout#> GL_TIMEOUT_IGNORED description#>\n @return void\n */\nglWaitSync(GLsync sync, GLbitfield flags, GLuint64 timeout);\n```\n\n# \n\nOpenGL ES 3.0GPU","slug":"2019/opengl-es-sync-and-fence-0821","published":1,"updated":"2021-06-21T12:34:52.096Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckszp3ndg0011ifnt8nkyveqq","content":"<blockquote>\n<p>OpenGL ES 3.0OpenGLGPUGL</p>\n</blockquote>\n<h1 id=\"\"></h1>\n<p>OpenGL ES 3.0 APIOpenGL-OpenGL ESOpenGLOpenGL ESOpenGL ES<br>\n-OpenGL ESABAOpenGL ES<code>glFlush</code>OpenGL ES<code>glFlush</code><code>glFinish</code><code>glFinish</code><code>glFinish</code><code>glFinish</code></p>\n<h1 id=\"\"></h1>\n<p>OpenGL ES 3.0FenceGPUOpenGL ESGL<br>\n<code>glFinish</code>GL<code>glFinish</code></p>\n<h1 id=\"\"></h1>\n<p>GL</p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> GL</span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param condition#&gt; GL_SYNC_GPU_COMMANDS_COMPLETE description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param flags#&gt; 0 description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return GLsync </span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glFenceSync(GLenum condition, GLbitfield flags);</span><br></pre></td></tr></table></figure>\n<p>UnsignaledSignaled<br>\n</p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param sync#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glDeleteSync(GLsync sync);</span><br></pre></td></tr></table></figure>\n<p><code>glDeleteSync</code></p>\n<h1 id=\"\"></h1>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param sync#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param flags#&gt; GL_SYNC_FLUSH_COMMANDS_BIT description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param timeout#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return GLenum</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glClientWaitSync(GLsync sync, GLbitfield flags, GLuint64 timeout);</span><br></pre></td></tr></table></figure>\n<p><code>glClientWaitSync</code><code>timeout</code><br>\n<code>glClientWaitSync</code></p>\n<ul>\n<li>GL_ARRAY_SIGNALED</li>\n<li>GL_TIMEOUT_EXPIRED<code>timeout</code></li>\n<li>GL_CONDITION_SATISFIED</li>\n<li>GL_WAIT_FAILED</li>\n</ul>\n<p><code>glWaitSync</code><code>glClientWaitSync</code>GPU</p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> GPU</span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param sync#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param flags#&gt; 0 description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param timeout#&gt; GL_TIMEOUT_IGNORED description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glWaitSync(GLsync sync, GLbitfield flags, GLuint64 timeout);</span><br></pre></td></tr></table></figure>\n<h1 id=\"\"></h1>\n<p>OpenGL ES 3.0GPU</p>\n","site":{"data":{}},"excerpt":"","more":"<blockquote>\n<p>OpenGL ES 3.0OpenGLGPUGL</p>\n</blockquote>\n<h1></h1>\n<p>OpenGL ES 3.0 APIOpenGL-OpenGL ESOpenGLOpenGL ESOpenGL ES<br>\n-OpenGL ESABAOpenGL ES<code>glFlush</code>OpenGL ES<code>glFlush</code><code>glFinish</code><code>glFinish</code><code>glFinish</code><code>glFinish</code></p>\n<h1></h1>\n<p>OpenGL ES 3.0FenceGPUOpenGL ESGL<br>\n<code>glFinish</code>GL<code>glFinish</code></p>\n<h1></h1>\n<p>GL</p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> GL</span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param condition#&gt; GL_SYNC_GPU_COMMANDS_COMPLETE description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param flags#&gt; 0 description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return GLsync </span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glFenceSync(GLenum condition, GLbitfield flags);</span><br></pre></td></tr></table></figure>\n<p>UnsignaledSignaled<br>\n</p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param sync#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glDeleteSync(GLsync sync);</span><br></pre></td></tr></table></figure>\n<p><code>glDeleteSync</code></p>\n<h1></h1>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param sync#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param flags#&gt; GL_SYNC_FLUSH_COMMANDS_BIT description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param timeout#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return GLenum</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glClientWaitSync(GLsync sync, GLbitfield flags, GLuint64 timeout);</span><br></pre></td></tr></table></figure>\n<p><code>glClientWaitSync</code><code>timeout</code><br>\n<code>glClientWaitSync</code></p>\n<ul>\n<li>GL_ARRAY_SIGNALED</li>\n<li>GL_TIMEOUT_EXPIRED<code>timeout</code></li>\n<li>GL_CONDITION_SATISFIED</li>\n<li>GL_WAIT_FAILED</li>\n</ul>\n<p><code>glWaitSync</code><code>glClientWaitSync</code>GPU</p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> GPU</span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param sync#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param flags#&gt; 0 description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param timeout#&gt; GL_TIMEOUT_IGNORED description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glWaitSync(GLsync sync, GLbitfield flags, GLuint64 timeout);</span><br></pre></td></tr></table></figure>\n<h1></h1>\n<p>OpenGL ES 3.0GPU</p>\n"},{"title":"OpenGL ES--","catalog":true,"toc_nav_num":true,"date":"2019-07-20T10:28:11.000Z","subtitle":"About OpenGL ES","header-img":"/img/article_header/article_header.png","busuanzi":true,"_content":"\n> 333\n\n# \n\n\n\nOpenGL ES 3.016`glGet*`\n\n``` objc\nGLint maxVertexAttribs; \nglGetIntegerv(GL_MAX_VERTEX_ATTRIBS, &maxVertexAttribs);\n```\n\n## \n\n\n\n``` objc\n// indx(x, 0.0, 0.0, 1.0)\nglVertexAttrib1f(GLuint indx, GLfloat x);\nglVertexAttrib1fv(GLuint indx, const GLfloat *values);\n\n// indx(x, y, 0.0, 1.0)\nglVertexAttrib2f(GLuint indx, GLfloat x, GLfloat y);\nglVertexAttrib2fv(GLuint indx, const GLfloat *values);\n\n// indx(x, y, z, 1.0)\nglVertexAttrib3f(GLuint indx, GLfloat x, GLfloat y, GLfloat z);\nglVertexAttrib3fv(GLuint indx, const GLfloat *values);\n\n// indx(x, y, z, w)\nglVertexAttrib4f(GLuint indx, GLfloat x, GLfloat y, GLfloat z, GLfloat w);\nglVertexAttrib4fv(GLuint indx, const GLfloat *values);\n```\n\n## \n\n\n\n``` objc\n/**\n \n\n @param indx#>  description#>\n @param size#> 1~4 description#>\n @param type#>  description#>\n @param normalized#>  description#>\n @param stride#> sizestrideII+1stride0stride0 description#>\n @param ptr#>  description#>\n @return void\n */\nglVertexAttribPointer(GLuint indx, GLint size, GLenum type, GLboolean normalized, GLsizei stride, const GLvoid *ptr);\n\n/**\n \n\n @param index#>  description#>\n @param size#> 1~4 description#>\n @param type#>  description#>\n @param stride#> sizestrideII+1stride0stride0 description#>\n @param pointer#>  description#>\n @return void\n */\nglVertexAttribIPointer(GLuint index, GLint size, GLenum type, GLsizei stride, const GLvoid *pointer);\n```\n\n\n- --\n- --\n\n### \n\n\n\n### \n\n`glVertexAttribPointer``type`OpenGL ES 3.0`GL_HALF_FLOAT`16`GL_HALF_FLOAT``GL_UNSIGNED_BYTE`4`GL_FLOAT`\n\n### `glVertexAttribPointer`\n\n\n\n``` objc\nGLfloat f;\nGLbyte b;\nf = (GLfloat)b;     // f represents values in the range [-128.0, 127.0]\n```\n\n`GL_BYTE``GL_SHORT``GL_FIXED`[-1.0, 1.0]`GL_UNSIGNED_BYTE``GL_UNSIGNED_SHORT`[0.0, 1.0]\n\n`c`\n\n | \n- | -\nGL_BYTE | max(c/(2<sup>7</sup>-1), -1.0)\nGL_UNSIGNED_BYTE | c/(2<sup>8</sup>-1)\nGL_SHORT | max(c/(2<sup>16</sup>-1), -1.0)\nGL_UNSIGNED_SHORT | c/(2<sup>16</sup>-1)\nGL_FIXED | c/(2<sup>16</sup>)\nGL_FLOAT | c\nGL_HALF_FLOAT_OES | c\n\n`glVertexAttribIPointer`\n\n### \n\nOpenGL ES`glEnableVertexAttribArray``glDisableVertexAttribArray`\n\n``` objc\n// glsl.vsh\n#version 300 es\nlayout(location = 0) in vec4 a_color;\nlayout(location = 1) in vec4 a_position;\nout vec4 v_color;\nvoid mian() {\n    v_color = a_color;\n    gl_Position = a_position;\n}\n```\n\n``` objc\n// glsl.fsh\n#version 300 es\nprecision mudiump float;\nin vec4 v_color;\nout vec4 o_fragColor;\nvoid main() {\n    o_fragColor = v_color;\n}\n```\n\n``` objc\nGLfloat color[4] = {1.0f, 0.0f, 0.0f, 1.0f};\nGLfloat vertexPos[9] = {0.0f, 0.5f, 0.0f,\n                        -0.5f, -0.5f, 0.0f,\n                        0.5f, -0.5f, 0.0f};\nglVertexAttrib4fv(0, color);\nglVertexAttribPointer(1, 3, GL_FLOAT, GL_FALSE, 0, vertexPos);\nglEnableVertexAttribArray(1);\nglDrawArrays(GL_TRIANGLES, 0, 3);\nglDisableVertexAttribArray(1);\n```\n\n`color``glVertexAttrib4fv`0`vertexPos``glVertexAttribPointer``glEnableVertexAttribArray``color``vertexPos`\n\n# \n\n`in`\n\n``` objc\nlayout(location = 0) in vec4 a_position;\nlayout(location = 1) in vec2 a_texcoord;\nlayout(location - 2) in vec3 a_normal;\n```\n\n--`GL_MAX_VERTEX_ATTRIBS`\n\n\n`glGetProgramiv``GL_ACTIVE_ATTRIBUTE``GL_ACTIVE_ATTRIBUTE_MAX_LENGTH``glGetActiveAttrib`\n\n``` objc\nGLint attribsCount;\nGLint attribMaxLength;\nglGetProgramiv(program, GL_ACTIVE_ATTRIBUTES, &attribsCount);\nglGetProgramiv(program, GL_ACTIVE_ATTRIBUTE_MAX_LENGTH, &attribMaxLength);\nfor (int i = 0; i < attribsCount; i++) {\n    GLsizei length;\n    GLint size;\n    GLenum type;\n    GLchar *name = malloc(attribMaxLength * sizeof(GLchar));\n    glGetActiveAttrib(program, i, attribMaxLength, &length, &size, &type, name);\n    NSLog(@\"length: %d, size: %d, type: %u, name: %s\", length, size, type, name);\n}\n```\n\n## \n\nOpenGL ES 3.03\n- `layout(location = N)`\n- OpenGL ES 3.0\n- \n\n`layout(location = N)``glBindAttribLocation`--\n\n``` objc\n/**\n \n\n @param program#>  description#>\n @param index#>  description#>\n @param name#>  description#>\n @return void\n */\nglBindAttribLocation(GLuint program, GLuint index, const GLchar *name);\n```\n\n`name``glBindAttribLocation`\n\nOpenGL ES 3.0OpenGL ES 3.0`glBindAttribLocation`OpenGL ES\nOpenGL ES 3.0`glGetAttribLocation`\n\n``` objc\n/**\n \n\n @param program#>  description#>\n @param name#>  description#>\n @return \n */\nglGetAttribLocation(GLuint program, const GLchar *name);\n```\n\n`glGetAttribLocation``program``name``name``program`-1\n\n# \n\n`glDrawArrays``glDrawElements`OpenGL ES 3.0`glDrawElements`\n\nOpenGL ES 3.0`GL_ARRAY_BUFFER``GL_ELEMENT_ARRAY_BUFFER`\n\n> OpenGL ES 3.0\n\n \n\n``` objc\n// vertex_t\nvoid initVertexBufferObjects(vertex_t *vertexBuffer,\n                             GLushort *indices,\n                             GLuint numVertices,\n                             GLuint numIndices,\n                             GLuint *vboIds) {\n    glGenBuffers(2, vboIds);\n    \n    glBindBuffer(GL_ARRAY_BUFFER, vboIds[0]);\n    glBufferData(GL_ARRAY_BUFFER, numVertices * sizeof(vertex_t), vertexBuffer, GL_STATIC_DRAW);\n    \n    glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, vboIds[1]);\n    glBufferData(GL_ELEMENT_ARRAY_BUFFER, numIndices * sizeof(GLushort), indices, GL_STATIC_DRAW);\n}\n```\n\n\n\n``` objc\n/**\n \n\n @param n#>  description#>\n @param buffers#> n description#>\n @return void\n */\nglGenBuffers(GLsizei n, GLuint *buffers);\n\n/**\n \n\n @param target#> GL_ARRAY_BUFFER, GL_ELEMENT_ARRAY_BUFFER, GL_COPY_READ_BUFFER, GL_COPY_WRITE_BUFFER, GL_PIXEL_PACK_BUFFER, GL_PIXEL_UNPACK_BUFFER, GL_TRANSFROM_FEEDBACK_BUFFER, GL_UNIFORM_BUFFER description#>\n @param buffer#>  description#>\n @return void\n */\nglBindBuffer(GLenum target, GLuint buffer);\n\n/**\n \n\n @param target#> GL_ARRAY_BUFFER, GL_ELEMENT_ARRAY_BUFFER, GL_COPY_READ_BUFFER, GL_COPY_WRITE_BUFFER, GL_PIXEL_PACK_BUFFER, GL_PIXEL_UNPACK_BUFFER, GL_TRANSFROM_FEEDBACK_BUFFER, GL_UNIFORM_BUFFER description#>\n @param size#>  description#>\n @param data#> NULL description#>\n @param usage#>  description#>\n @return void\n */\nglBufferData(GLenum target, GLsizeiptr size, const GLvoid *data, GLenum usage);\n\n/**\n \n\n @param target#> GL_ARRAY_BUFFER, GL_ELEMENT_ARRAY_BUFFER, GL_COPY_READ_BUFFER, GL_COPY_WRITE_BUFFER, GL_PIXEL_PACK_BUFFER, GL_PIXEL_UNPACK_BUFFER, GL_TRANSFROM_FEEDBACK_BUFFER, GL_UNIFORM_BUFFER description#>\n @param offset#>  description#>\n @param size#>  description#>\n @param data#>  description#>\n @return void\n */\nglBufferSubData(GLenum target, GLintptr offset, GLsizeiptr size, const GLvoid *data)\n```\n\n | \n- | -\nGL_STATIC_DRAW | \nGL_STATIC_READ | OpenGL ESOpenGL ES\nGL_STATIC_COPY | OpenGL ESOpenGL ES\nGL_DYNAMIC_DRAW | \nGL_DYNAMIC_READ | OpenGL ESOpenGL ES\nGL_DYNAMIC_COPY | OpenGL ESOpenGL ES\nGL_STREAM_DRAW | \nGL_STREAM_READ | OpenGL ESOpenGL ES\nGL_STREAM_COPY | OpenGL ESOpenGL ES\n\n`glBufferData``glBufferSubData`\n\n\n\n``` objc\n// glsl.vsh\n#version 300 es\nlayout(location = 0) in vec4 vPosition;\nlayout(location = 1) in vec4 vColor;\nuniform float offsetLoc;\nout vec4 v_color;\n\nvoid main() {\n    v_color = vColor;\n    gl_Position = vec4(vPosition.x + offsetLoc, vPosition.yzw);\n}\n```\n\n``` objc\n// glsl.fsh\n#version 300 es\nprecision mediump float;\nin vec4 v_color;\nout vec4 fragColor;\n\nvoid main() {\n    fragColor = v_color;\n}\n```\n\n``` objc\nvoid DrawPrimitiveWithoutVBOs() {\n    GLint vertex_position_size = 3;\n    GLint vertex_color_size = 4;\n    GLushort indices[3] = {0, 1, 2};\n    GLfloat vertices[] = {\n        -0.5f, 0.5f, 0.0f,\n        1.0f, 0.0f, 0.0f, 1.0f,\n        -1.0f, -0.5f, 0.0f,\n        0.0f, 1.0f, 0.0f, 1.0f,\n        0.0f, -0.5f, 0.0f,\n        0.0f, 0.0f, 1.0f, 1.0f\n    };\n    GLfloat *vtxBuf = vertices;\n    GLsizei vtxStride = sizeof(GLfloat) * (vertex_color_size + vertex_position_size);\n    \n    glBindBuffer(GL_ARRAY_BUFFER, 0);\n    glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, 0);\n    \n    glEnableVertexAttribArray(0);\n    glEnableVertexAttribArray(1);\n    \n    glVertexAttribPointer(0, vertex_position_size, GL_FLOAT, GL_FALSE, vtxStride, vtxBuf);\n    vtxBuf += vertex_position_size;\n    glVertexAttribPointer(1, vertex_color_size, GL_FLOAT, GL_FALSE, vtxStride, vtxBuf);\n    \n    glDrawElements(GL_TRIANGLES, 3, GL_UNSIGNED_SHORT, indices);\n    \n    glDisableVertexAttribArray(0);\n    glDisableVertexAttribArray(1);\n}\n\nvoid DrawPrimitiveWithVBOs() {\n    GLvoid *offset = 0;\n    GLuint vboIds[2];\n    GLint vertex_position_size = 3;\n    GLint vertex_color_size = 4;\n    GLushort indices[3] = {0, 1, 2};\n    GLint vtxStride = sizeof(GLfloat) * (vertex_position_size + vertex_color_size);\n    GLfloat vertices[] = {\n        -0.5f, 0.5f, 0.0f,\n        1.0f, 0.0f, 0.0f, 1.0f,\n        -1.0f, -0.5f, 0.0f,\n        0.0f, 1.0f, 0.0f, 1.0f,\n        0.0f, -0.5f, 0.0f,\n        0.0f, 0.0f, 1.0f, 1.0f\n    };\n    GLfloat *vtxBuf = vertices;\n\n    glGenBuffers(2, vboIds);\n    glBindBuffer(GL_ARRAY_BUFFER, vboIds[0]);\n    glBufferData(GL_ARRAY_BUFFER, vtxStride * 3, vtxBuf, GL_STATIC_DRAW);\n    glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, vboIds[1]);\n    glBufferData(GL_ELEMENT_ARRAY_BUFFER, sizeof(GLushort) * 3, indices, GL_STATIC_DRAW);\n    \n    glEnableVertexAttribArray(0);\n    glEnableVertexAttribArray(1);\n    \n    glVertexAttribPointer(0, vertex_position_size, GL_FLOAT, GL_FALSE, vtxStride, offset);\n    offset += vertex_position_size * sizeof(GLfloat);\n    glVertexAttribPointer(1, vertex_color_size, GL_FLOAT, GL_FALSE, vtxStride, offset);\n    \n    glDrawElements(GL_TRIANGLES, 3, GL_UNSIGNED_SHORT, 0);\n    \n    glDisableVertexAttribArray(0);\n    glDisableVertexAttribArray(1);\n    \n    glBindBuffer(GL_ARRAY_BUFFER, 0);\n    glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, 0);\n}\n\n// \nDrawPrimitiveWithoutVBOs();\nglUniform1f(0, 1.0f);\nDrawPrimitiveWithVBOs();\n```\n\n`GL_ARRAY_BUFFER``glVertexAttribPointer``pointer``glBufferData``GL_ELEMENT_ARRAY_BUFFER``glDrawElements``indices``glBufferData`\n\n--\n\n``` objc\nvoid DrawPrimitiveWithVBOs() {\n    GLuint vboIds[3];\n    GLint vertex_position_size = 3;\n    GLint vertex_color_size = 4;\n    GLfloat position[] = {\n        -0.5f, 0.5f, 0.0f,\n        -1.0f, -0.5f, 0.0f,\n        0.0f, -0.5f, 0.0f\n    };\n    GLfloat color[] = {\n        1.0f, 0.0f, 0.0f, 1.0f,\n        0.0f, 1.0f, 0.0f, 1.0f,\n        0.0f, 0.0f, 1.0f, 1.0f\n    };\n    GLushort indices[3] = {0, 1, 2};\n\n    glGenBuffers(3, vboIds);\n    glBindBuffer(GL_ARRAY_BUFFER, vboIds[0]);\n    glBufferData(GL_ARRAY_BUFFER, sizeof(GLfloat) * vertex_position_size * 3, position, GL_STATIC_DRAW);\n    glBindBuffer(GL_ARRAY_BUFFER, vboIds[1]);\n    glBufferData(GL_ARRAY_BUFFER, sizeof(GLfloat) * vertex_color_size * 4, color, GL_STATIC_DRAW);\n    glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, vboIds[2]);\n    glBufferData(GL_ELEMENT_ARRAY_BUFFER, sizeof(GLushort) * 3, indices, GL_STATIC_DRAW);\n    \n    glBindBuffer(GL_ARRAY_BUFFER, vboIds[0]);\n    glEnableVertexAttribArray(0);\n    glVertexAttribPointer(0, vertex_position_size, GL_FLOAT, GL_FALSE, sizeof(GLfloat) * vertex_position_size, 0);\n    glBindBuffer(GL_ARRAY_BUFFER, vboIds[1]);\n    glEnableVertexAttribArray(1);\n    glVertexAttribPointer(1, vertex_color_size, GL_FLOAT, GL_FALSE, sizeof(GLfloat) * vertex_color_size, 0);\n    glDrawElements(GL_TRIANGLES, 3, GL_UNSIGNED_SHORT, 0);\n    \n    glDisableVertexAttribArray(0);\n    glDisableVertexAttribArray(1);\n    \n    glBindBuffer(GL_ARRAY_BUFFER, 0);\n    glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, 0);\n}\n```\n\n\n\n``` objc\n/**\n \n\n @param n#>  description#>\n @param buffers#> n description#>\n @return void\n */\nglDeleteBuffers(GLsizei n, const GLuint *buffers);\n```\n\n\n\n\n\n# \n\nGPUCPUOpenGL ES 3.0VAO`glBindBuffer``glVertexAttribPointer``glEnableVertexAttribArray`OpenGL ES 3.0VAO/\n\nOpenGL ES 3.0VAOID0`glGenVertexArrays`\n\n``` objc\n/**\n \n\n @param n#>  description#>\n @param arrays#> n description#>\n @return void\n */\nglGenVertexArrays(GLsizei n, GLuint *arrays);\n```\n\n`glBindVertexArray`\n\n``` objc\n/**\n \n\n @param array#>  description#>\n @return void\n */\nglBindVertexArray(GLuint array);\n```\n\nVAOVAO`glBindVertexArray``glBindBuffer``glVertexAttribPointer``glEnableVertexAttribArray``glDisableVertexAttribArray`VAO\n\n\n\n``` objc\nvoid DrawPrimitiveWithVAOs() {\n    GLuint vboIds[2];\n    GLint vertex_position_size = 3;\n    GLint vertex_color_size = 4;\n    GLfloat vertices[] = {\n        0.0f, 0.5f, 0.0f,\n        1.0f, 0.0f, 0.0f, 1.0f,\n        -0.5f, -0.5f, 0.0f,\n        0.0f, 1.0f, 0.0f, 1.0f,\n        0.5f, -0.5f, 0.0f,\n        0.0f, 0.0f, 1.0f, 1.0f\n    };\n    GLuint vaoId;\n    GLushort indices[3] = { 0, 1, 2 };\n    glGenBuffers(2, vboIds);\n    glBindBuffer(GL_ARRAY_BUFFER, vboIds[0]);\n    glBufferData(GL_ARRAY_BUFFER, sizeof(vertices), vertices, GL_STATIC_DRAW);\n    glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, vboIds[1]);\n    glBufferData(GL_ELEMENT_ARRAY_BUFFER, sizeof(indices), indices, GL_STATIC_DRAW);\n    \n    glGenVertexArrays(1, &vaoId);\n    glBindVertexArray(vaoId);\n    \n    glBindBuffer(GL_ARRAY_BUFFER, vboIds[0]);\n    glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, vboIds[1]);\n    \n    glEnableVertexAttribArray(0);\n    glEnableVertexAttribArray(1);\n    \n    glVertexAttribPointer(0, vertex_position _size, GL_FLOAT, GL_FALSE, sizeof(GLfloat) * (vertex_position_size + vertex_color_size), 0);\n    glVertexAttribPointer(1, vertex_color_size, GL_FLOAT, GL_FALSE, sizeof(GLfloat) * (vertex_position_size + vertex_color_size), (const void *)(sizeof(GLfloat) * vertex_position_size));\n        \n    glBindVertexArray(0);\n\n    // \n    glBindVertexArray(vaoId);\n    glDrawElements(GL_TRIANGLES, 3, GL_UNSIGNED_SHORT, 0);\n}\n```\n\n`glDeleteVertexArrays`\n\n``` objc\n/**\n \n\n @param n#>  description#>\n @param arrays#> n description#>\n @return void\n */\nglDeleteVertexArrays(GLsizei n, const GLuint *arrays);\n```\n\n# \n\n`glBufferData``glBufferSubData``glBufferData``glBufferSubData`\n- \n- GPU\n\n`glMapBufferRange``glUnmapBuffer`\n\n``` objc\n/**\n \n\n @param target#> GL_ARRAY_BUFFER, GL_ELEMENT_ARRAY_BUFFER, GL_COPY_READ_BUFFER, GL_COPY_WRITE_BUFFER, GL_PIXEL_PACK_BUFFER, GL_PIXEL_UNPACK_BUFFER, GL_TRANSFORM_FEEDBACK_BUFFER, GL_UNIFORM_BUFFER description#>\n @param offset#>  description#>\n @param length#>  description#>\n @param access#>  description#>\n @return GLvoid *\n */\nglMapBufferRange(GLenum target, GLintptr offset, GLsizeiptr length, GLbitfield access);\n```\n\n | \n- | -\nGL_MAP_READ_BIT | \nGL_MAP_WRITE_BIT | \n\n\n\n | \n- | -\nGL_MAP_INVALIDATAE_RANGE_BIT | GL_MAP_READ_BIT\nGL_MAP_INVALIDATE_BUFFER_BIT | GL_MAP_READ_BIT\nGL_MAP_FLUSH_EXPLICIT_BIT | glFlushMappedBufferRangeGL_MAP_WRITE_BIT\nGL_MAP_UNSYNCHRONIZED_BIT | \n\n`glMapBufferRange`NULL`glUnmapBuffer`\n\n``` objc\n/**\n \n\n @param target#> GL_ARRAY_BUFFER description#>\n @return GLboolean\n */\nglUnmapBuffer(GLenum target);\n```\n\n`glUnmapBuffer``GL_TRUE``glMapBufferRange``glUnmapBuffer``GL_FALSE`OpenGL ES\n\n\n``` objc\nGLfloat *vtxMappedBuf;\nGLushort *idxMappedBuf;\nGLfloat vertices[] = {\n    0.0f, 0.5f, 0.0f,\n    1.0f, 0.0f, 0.0f, 1.0f,\n    -0.5f, -0.5f, 0.0f,\n    0.0f, 1.0f, 0.0f, 1.0f,\n    0.5f, -0.5f, 0.0f,\n    0.0f, 0.0f, 1.0f, 1.0f\n};\nGLushort indices[3] = { 0, 1, 2 };\n\nglGenBuffers(2, vboIds);\nglBindBuffer(GL_ARRAY_BUFFER, vboIds[0]);\nglBufferData(GL_ARRAY_BUFFER, sizeof(vertices), NULL, GL_STATIC_DRAW);\nvtxMappedBuf = (GLfloat *)glMapBufferRange(GL_ARRAY_BUFFER, 0, sizeof(vertices), GL_MAP_WRITE_BIT | GL_MAP_INVALIDATE_BUFFER_BIT);\nif (vtxMappedBuf == NULL) {\n    NSLog(@\"Error mapping vertex buffer object\");\n    return;\n}\nmemcpy(vtxMappedBuf, vertices, sizeof(vertices));\nif (glUnmapBuffer(GL_ARRAY_BUFFER) == GL_FALSE) {\n    NSLog(@\"Error unmapping array buffer object\");\n    return;\n}\n\nglBindBuffer(GL_ELEMENT_ARRAY_BUFFER, vboIds[1]);\nglBufferData(GL_ELEMENT_ARRAY_BUFFER, sizeof(indices), NULL, GL_STATIC_DRAW);\nidxMappedBuf = (GLushort *)glMapBufferRange(GL_ELEMENT_ARRAY_BUFFER, 0, sizeof(indices), GL_MAP_WRITE_BIT | GL_MAP_INVALIDATE_BUFFER_BIT);\nif (idxMappedBuf == NULL) {\n    NSLog(@\"Error mapping element buffer object\");\n    return;\n}\nmemcpy(idxMappedBuf, indices, sizeof(indices));\nif (glUnmapBuffer(GL_ELEMENT_ARRAY_BUFFER) == GL_FALSE) {\n    NSLog(@\"Error unmapping element buffer object\");\n    return;\n}\n```\n\n## \n\n`glMapBufferRange``glUnmapBuffer``GL_MAP_FLUSH_EXPLICIT_BIT``GL_MAP_WRITE_BIT``glFlushMappedBufferRange`\n\n``` objc\n/**\n \n\n @param target#> GL_ARRAY_BUFFER, GL_ELEMENT_ARRAY_BUFFER, GL_COPY_READ_BUFFER, GL_COPY_WRITE_BUFFER, GL_PIXEL_PACK_BUFFER, GL_PIXEL_UNPACK_BUFFER, GL_TRANSFORM_FEEDBACK_BUFFER, GL_UNIFORM_BUFFER description#>\n @param offset#>  description#>\n @param length#>  description#>\n @return void\n */\nglFlushMappedBufferRange(GLenum target, GLintptr offset, GLsizeiptr length);\n```\n\n`GL_MAP_FLUSH_EXPLICIT_BIT``glFlushMappedBufferRange`\n\n# \n\n`glBufferData``glBufferSubData``glMapBufferRange`OpenGL ES 3.0\n\n``` objc\n/**\n \n\n @param readTarget#>  description#>\n @param writeTarget#>  description#>\n @param readOffset#>  description#>\n @param writeOffset#>  description#>\n @param size#>  description#>\n @return void\n */\nglCopyBufferSubData(GLenum readTarget, GLenum writeTarget, GLintptr readOffset, GLintptr writeOffset, GLsizeiptr size);\n```\n\n`glCopyBufferSubData``readtarget``writetarget``glBindBuffer``GL_COPY_READ_BUFFER``GL_COPY_WRITE_BUFFER`\n\n# \n\n","source":"_posts/2019/opengl-es-vertex-0720.md","raw":"---\ntitle: \"OpenGL ES--\"\ncatalog: true\ntoc_nav_num: true\ndate: 2019-07-20 18:28:11\nsubtitle: \"About OpenGL ES\"\nheader-img: \"/img/article_header/article_header.png\"\nbusuanzi: true\ntags:\n- iOS\n\n---\n\n> 333\n\n# \n\n\n\nOpenGL ES 3.016`glGet*`\n\n``` objc\nGLint maxVertexAttribs; \nglGetIntegerv(GL_MAX_VERTEX_ATTRIBS, &maxVertexAttribs);\n```\n\n## \n\n\n\n``` objc\n// indx(x, 0.0, 0.0, 1.0)\nglVertexAttrib1f(GLuint indx, GLfloat x);\nglVertexAttrib1fv(GLuint indx, const GLfloat *values);\n\n// indx(x, y, 0.0, 1.0)\nglVertexAttrib2f(GLuint indx, GLfloat x, GLfloat y);\nglVertexAttrib2fv(GLuint indx, const GLfloat *values);\n\n// indx(x, y, z, 1.0)\nglVertexAttrib3f(GLuint indx, GLfloat x, GLfloat y, GLfloat z);\nglVertexAttrib3fv(GLuint indx, const GLfloat *values);\n\n// indx(x, y, z, w)\nglVertexAttrib4f(GLuint indx, GLfloat x, GLfloat y, GLfloat z, GLfloat w);\nglVertexAttrib4fv(GLuint indx, const GLfloat *values);\n```\n\n## \n\n\n\n``` objc\n/**\n \n\n @param indx#>  description#>\n @param size#> 1~4 description#>\n @param type#>  description#>\n @param normalized#>  description#>\n @param stride#> sizestrideII+1stride0stride0 description#>\n @param ptr#>  description#>\n @return void\n */\nglVertexAttribPointer(GLuint indx, GLint size, GLenum type, GLboolean normalized, GLsizei stride, const GLvoid *ptr);\n\n/**\n \n\n @param index#>  description#>\n @param size#> 1~4 description#>\n @param type#>  description#>\n @param stride#> sizestrideII+1stride0stride0 description#>\n @param pointer#>  description#>\n @return void\n */\nglVertexAttribIPointer(GLuint index, GLint size, GLenum type, GLsizei stride, const GLvoid *pointer);\n```\n\n\n- --\n- --\n\n### \n\n\n\n### \n\n`glVertexAttribPointer``type`OpenGL ES 3.0`GL_HALF_FLOAT`16`GL_HALF_FLOAT``GL_UNSIGNED_BYTE`4`GL_FLOAT`\n\n### `glVertexAttribPointer`\n\n\n\n``` objc\nGLfloat f;\nGLbyte b;\nf = (GLfloat)b;     // f represents values in the range [-128.0, 127.0]\n```\n\n`GL_BYTE``GL_SHORT``GL_FIXED`[-1.0, 1.0]`GL_UNSIGNED_BYTE``GL_UNSIGNED_SHORT`[0.0, 1.0]\n\n`c`\n\n | \n- | -\nGL_BYTE | max(c/(2<sup>7</sup>-1), -1.0)\nGL_UNSIGNED_BYTE | c/(2<sup>8</sup>-1)\nGL_SHORT | max(c/(2<sup>16</sup>-1), -1.0)\nGL_UNSIGNED_SHORT | c/(2<sup>16</sup>-1)\nGL_FIXED | c/(2<sup>16</sup>)\nGL_FLOAT | c\nGL_HALF_FLOAT_OES | c\n\n`glVertexAttribIPointer`\n\n### \n\nOpenGL ES`glEnableVertexAttribArray``glDisableVertexAttribArray`\n\n``` objc\n// glsl.vsh\n#version 300 es\nlayout(location = 0) in vec4 a_color;\nlayout(location = 1) in vec4 a_position;\nout vec4 v_color;\nvoid mian() {\n    v_color = a_color;\n    gl_Position = a_position;\n}\n```\n\n``` objc\n// glsl.fsh\n#version 300 es\nprecision mudiump float;\nin vec4 v_color;\nout vec4 o_fragColor;\nvoid main() {\n    o_fragColor = v_color;\n}\n```\n\n``` objc\nGLfloat color[4] = {1.0f, 0.0f, 0.0f, 1.0f};\nGLfloat vertexPos[9] = {0.0f, 0.5f, 0.0f,\n                        -0.5f, -0.5f, 0.0f,\n                        0.5f, -0.5f, 0.0f};\nglVertexAttrib4fv(0, color);\nglVertexAttribPointer(1, 3, GL_FLOAT, GL_FALSE, 0, vertexPos);\nglEnableVertexAttribArray(1);\nglDrawArrays(GL_TRIANGLES, 0, 3);\nglDisableVertexAttribArray(1);\n```\n\n`color``glVertexAttrib4fv`0`vertexPos``glVertexAttribPointer``glEnableVertexAttribArray``color``vertexPos`\n\n# \n\n`in`\n\n``` objc\nlayout(location = 0) in vec4 a_position;\nlayout(location = 1) in vec2 a_texcoord;\nlayout(location - 2) in vec3 a_normal;\n```\n\n--`GL_MAX_VERTEX_ATTRIBS`\n\n\n`glGetProgramiv``GL_ACTIVE_ATTRIBUTE``GL_ACTIVE_ATTRIBUTE_MAX_LENGTH``glGetActiveAttrib`\n\n``` objc\nGLint attribsCount;\nGLint attribMaxLength;\nglGetProgramiv(program, GL_ACTIVE_ATTRIBUTES, &attribsCount);\nglGetProgramiv(program, GL_ACTIVE_ATTRIBUTE_MAX_LENGTH, &attribMaxLength);\nfor (int i = 0; i < attribsCount; i++) {\n    GLsizei length;\n    GLint size;\n    GLenum type;\n    GLchar *name = malloc(attribMaxLength * sizeof(GLchar));\n    glGetActiveAttrib(program, i, attribMaxLength, &length, &size, &type, name);\n    NSLog(@\"length: %d, size: %d, type: %u, name: %s\", length, size, type, name);\n}\n```\n\n## \n\nOpenGL ES 3.03\n- `layout(location = N)`\n- OpenGL ES 3.0\n- \n\n`layout(location = N)``glBindAttribLocation`--\n\n``` objc\n/**\n \n\n @param program#>  description#>\n @param index#>  description#>\n @param name#>  description#>\n @return void\n */\nglBindAttribLocation(GLuint program, GLuint index, const GLchar *name);\n```\n\n`name``glBindAttribLocation`\n\nOpenGL ES 3.0OpenGL ES 3.0`glBindAttribLocation`OpenGL ES\nOpenGL ES 3.0`glGetAttribLocation`\n\n``` objc\n/**\n \n\n @param program#>  description#>\n @param name#>  description#>\n @return \n */\nglGetAttribLocation(GLuint program, const GLchar *name);\n```\n\n`glGetAttribLocation``program``name``name``program`-1\n\n# \n\n`glDrawArrays``glDrawElements`OpenGL ES 3.0`glDrawElements`\n\nOpenGL ES 3.0`GL_ARRAY_BUFFER``GL_ELEMENT_ARRAY_BUFFER`\n\n> OpenGL ES 3.0\n\n \n\n``` objc\n// vertex_t\nvoid initVertexBufferObjects(vertex_t *vertexBuffer,\n                             GLushort *indices,\n                             GLuint numVertices,\n                             GLuint numIndices,\n                             GLuint *vboIds) {\n    glGenBuffers(2, vboIds);\n    \n    glBindBuffer(GL_ARRAY_BUFFER, vboIds[0]);\n    glBufferData(GL_ARRAY_BUFFER, numVertices * sizeof(vertex_t), vertexBuffer, GL_STATIC_DRAW);\n    \n    glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, vboIds[1]);\n    glBufferData(GL_ELEMENT_ARRAY_BUFFER, numIndices * sizeof(GLushort), indices, GL_STATIC_DRAW);\n}\n```\n\n\n\n``` objc\n/**\n \n\n @param n#>  description#>\n @param buffers#> n description#>\n @return void\n */\nglGenBuffers(GLsizei n, GLuint *buffers);\n\n/**\n \n\n @param target#> GL_ARRAY_BUFFER, GL_ELEMENT_ARRAY_BUFFER, GL_COPY_READ_BUFFER, GL_COPY_WRITE_BUFFER, GL_PIXEL_PACK_BUFFER, GL_PIXEL_UNPACK_BUFFER, GL_TRANSFROM_FEEDBACK_BUFFER, GL_UNIFORM_BUFFER description#>\n @param buffer#>  description#>\n @return void\n */\nglBindBuffer(GLenum target, GLuint buffer);\n\n/**\n \n\n @param target#> GL_ARRAY_BUFFER, GL_ELEMENT_ARRAY_BUFFER, GL_COPY_READ_BUFFER, GL_COPY_WRITE_BUFFER, GL_PIXEL_PACK_BUFFER, GL_PIXEL_UNPACK_BUFFER, GL_TRANSFROM_FEEDBACK_BUFFER, GL_UNIFORM_BUFFER description#>\n @param size#>  description#>\n @param data#> NULL description#>\n @param usage#>  description#>\n @return void\n */\nglBufferData(GLenum target, GLsizeiptr size, const GLvoid *data, GLenum usage);\n\n/**\n \n\n @param target#> GL_ARRAY_BUFFER, GL_ELEMENT_ARRAY_BUFFER, GL_COPY_READ_BUFFER, GL_COPY_WRITE_BUFFER, GL_PIXEL_PACK_BUFFER, GL_PIXEL_UNPACK_BUFFER, GL_TRANSFROM_FEEDBACK_BUFFER, GL_UNIFORM_BUFFER description#>\n @param offset#>  description#>\n @param size#>  description#>\n @param data#>  description#>\n @return void\n */\nglBufferSubData(GLenum target, GLintptr offset, GLsizeiptr size, const GLvoid *data)\n```\n\n | \n- | -\nGL_STATIC_DRAW | \nGL_STATIC_READ | OpenGL ESOpenGL ES\nGL_STATIC_COPY | OpenGL ESOpenGL ES\nGL_DYNAMIC_DRAW | \nGL_DYNAMIC_READ | OpenGL ESOpenGL ES\nGL_DYNAMIC_COPY | OpenGL ESOpenGL ES\nGL_STREAM_DRAW | \nGL_STREAM_READ | OpenGL ESOpenGL ES\nGL_STREAM_COPY | OpenGL ESOpenGL ES\n\n`glBufferData``glBufferSubData`\n\n\n\n``` objc\n// glsl.vsh\n#version 300 es\nlayout(location = 0) in vec4 vPosition;\nlayout(location = 1) in vec4 vColor;\nuniform float offsetLoc;\nout vec4 v_color;\n\nvoid main() {\n    v_color = vColor;\n    gl_Position = vec4(vPosition.x + offsetLoc, vPosition.yzw);\n}\n```\n\n``` objc\n// glsl.fsh\n#version 300 es\nprecision mediump float;\nin vec4 v_color;\nout vec4 fragColor;\n\nvoid main() {\n    fragColor = v_color;\n}\n```\n\n``` objc\nvoid DrawPrimitiveWithoutVBOs() {\n    GLint vertex_position_size = 3;\n    GLint vertex_color_size = 4;\n    GLushort indices[3] = {0, 1, 2};\n    GLfloat vertices[] = {\n        -0.5f, 0.5f, 0.0f,\n        1.0f, 0.0f, 0.0f, 1.0f,\n        -1.0f, -0.5f, 0.0f,\n        0.0f, 1.0f, 0.0f, 1.0f,\n        0.0f, -0.5f, 0.0f,\n        0.0f, 0.0f, 1.0f, 1.0f\n    };\n    GLfloat *vtxBuf = vertices;\n    GLsizei vtxStride = sizeof(GLfloat) * (vertex_color_size + vertex_position_size);\n    \n    glBindBuffer(GL_ARRAY_BUFFER, 0);\n    glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, 0);\n    \n    glEnableVertexAttribArray(0);\n    glEnableVertexAttribArray(1);\n    \n    glVertexAttribPointer(0, vertex_position_size, GL_FLOAT, GL_FALSE, vtxStride, vtxBuf);\n    vtxBuf += vertex_position_size;\n    glVertexAttribPointer(1, vertex_color_size, GL_FLOAT, GL_FALSE, vtxStride, vtxBuf);\n    \n    glDrawElements(GL_TRIANGLES, 3, GL_UNSIGNED_SHORT, indices);\n    \n    glDisableVertexAttribArray(0);\n    glDisableVertexAttribArray(1);\n}\n\nvoid DrawPrimitiveWithVBOs() {\n    GLvoid *offset = 0;\n    GLuint vboIds[2];\n    GLint vertex_position_size = 3;\n    GLint vertex_color_size = 4;\n    GLushort indices[3] = {0, 1, 2};\n    GLint vtxStride = sizeof(GLfloat) * (vertex_position_size + vertex_color_size);\n    GLfloat vertices[] = {\n        -0.5f, 0.5f, 0.0f,\n        1.0f, 0.0f, 0.0f, 1.0f,\n        -1.0f, -0.5f, 0.0f,\n        0.0f, 1.0f, 0.0f, 1.0f,\n        0.0f, -0.5f, 0.0f,\n        0.0f, 0.0f, 1.0f, 1.0f\n    };\n    GLfloat *vtxBuf = vertices;\n\n    glGenBuffers(2, vboIds);\n    glBindBuffer(GL_ARRAY_BUFFER, vboIds[0]);\n    glBufferData(GL_ARRAY_BUFFER, vtxStride * 3, vtxBuf, GL_STATIC_DRAW);\n    glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, vboIds[1]);\n    glBufferData(GL_ELEMENT_ARRAY_BUFFER, sizeof(GLushort) * 3, indices, GL_STATIC_DRAW);\n    \n    glEnableVertexAttribArray(0);\n    glEnableVertexAttribArray(1);\n    \n    glVertexAttribPointer(0, vertex_position_size, GL_FLOAT, GL_FALSE, vtxStride, offset);\n    offset += vertex_position_size * sizeof(GLfloat);\n    glVertexAttribPointer(1, vertex_color_size, GL_FLOAT, GL_FALSE, vtxStride, offset);\n    \n    glDrawElements(GL_TRIANGLES, 3, GL_UNSIGNED_SHORT, 0);\n    \n    glDisableVertexAttribArray(0);\n    glDisableVertexAttribArray(1);\n    \n    glBindBuffer(GL_ARRAY_BUFFER, 0);\n    glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, 0);\n}\n\n// \nDrawPrimitiveWithoutVBOs();\nglUniform1f(0, 1.0f);\nDrawPrimitiveWithVBOs();\n```\n\n`GL_ARRAY_BUFFER``glVertexAttribPointer``pointer``glBufferData``GL_ELEMENT_ARRAY_BUFFER``glDrawElements``indices``glBufferData`\n\n--\n\n``` objc\nvoid DrawPrimitiveWithVBOs() {\n    GLuint vboIds[3];\n    GLint vertex_position_size = 3;\n    GLint vertex_color_size = 4;\n    GLfloat position[] = {\n        -0.5f, 0.5f, 0.0f,\n        -1.0f, -0.5f, 0.0f,\n        0.0f, -0.5f, 0.0f\n    };\n    GLfloat color[] = {\n        1.0f, 0.0f, 0.0f, 1.0f,\n        0.0f, 1.0f, 0.0f, 1.0f,\n        0.0f, 0.0f, 1.0f, 1.0f\n    };\n    GLushort indices[3] = {0, 1, 2};\n\n    glGenBuffers(3, vboIds);\n    glBindBuffer(GL_ARRAY_BUFFER, vboIds[0]);\n    glBufferData(GL_ARRAY_BUFFER, sizeof(GLfloat) * vertex_position_size * 3, position, GL_STATIC_DRAW);\n    glBindBuffer(GL_ARRAY_BUFFER, vboIds[1]);\n    glBufferData(GL_ARRAY_BUFFER, sizeof(GLfloat) * vertex_color_size * 4, color, GL_STATIC_DRAW);\n    glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, vboIds[2]);\n    glBufferData(GL_ELEMENT_ARRAY_BUFFER, sizeof(GLushort) * 3, indices, GL_STATIC_DRAW);\n    \n    glBindBuffer(GL_ARRAY_BUFFER, vboIds[0]);\n    glEnableVertexAttribArray(0);\n    glVertexAttribPointer(0, vertex_position_size, GL_FLOAT, GL_FALSE, sizeof(GLfloat) * vertex_position_size, 0);\n    glBindBuffer(GL_ARRAY_BUFFER, vboIds[1]);\n    glEnableVertexAttribArray(1);\n    glVertexAttribPointer(1, vertex_color_size, GL_FLOAT, GL_FALSE, sizeof(GLfloat) * vertex_color_size, 0);\n    glDrawElements(GL_TRIANGLES, 3, GL_UNSIGNED_SHORT, 0);\n    \n    glDisableVertexAttribArray(0);\n    glDisableVertexAttribArray(1);\n    \n    glBindBuffer(GL_ARRAY_BUFFER, 0);\n    glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, 0);\n}\n```\n\n\n\n``` objc\n/**\n \n\n @param n#>  description#>\n @param buffers#> n description#>\n @return void\n */\nglDeleteBuffers(GLsizei n, const GLuint *buffers);\n```\n\n\n\n\n\n# \n\nGPUCPUOpenGL ES 3.0VAO`glBindBuffer``glVertexAttribPointer``glEnableVertexAttribArray`OpenGL ES 3.0VAO/\n\nOpenGL ES 3.0VAOID0`glGenVertexArrays`\n\n``` objc\n/**\n \n\n @param n#>  description#>\n @param arrays#> n description#>\n @return void\n */\nglGenVertexArrays(GLsizei n, GLuint *arrays);\n```\n\n`glBindVertexArray`\n\n``` objc\n/**\n \n\n @param array#>  description#>\n @return void\n */\nglBindVertexArray(GLuint array);\n```\n\nVAOVAO`glBindVertexArray``glBindBuffer``glVertexAttribPointer``glEnableVertexAttribArray``glDisableVertexAttribArray`VAO\n\n\n\n``` objc\nvoid DrawPrimitiveWithVAOs() {\n    GLuint vboIds[2];\n    GLint vertex_position_size = 3;\n    GLint vertex_color_size = 4;\n    GLfloat vertices[] = {\n        0.0f, 0.5f, 0.0f,\n        1.0f, 0.0f, 0.0f, 1.0f,\n        -0.5f, -0.5f, 0.0f,\n        0.0f, 1.0f, 0.0f, 1.0f,\n        0.5f, -0.5f, 0.0f,\n        0.0f, 0.0f, 1.0f, 1.0f\n    };\n    GLuint vaoId;\n    GLushort indices[3] = { 0, 1, 2 };\n    glGenBuffers(2, vboIds);\n    glBindBuffer(GL_ARRAY_BUFFER, vboIds[0]);\n    glBufferData(GL_ARRAY_BUFFER, sizeof(vertices), vertices, GL_STATIC_DRAW);\n    glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, vboIds[1]);\n    glBufferData(GL_ELEMENT_ARRAY_BUFFER, sizeof(indices), indices, GL_STATIC_DRAW);\n    \n    glGenVertexArrays(1, &vaoId);\n    glBindVertexArray(vaoId);\n    \n    glBindBuffer(GL_ARRAY_BUFFER, vboIds[0]);\n    glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, vboIds[1]);\n    \n    glEnableVertexAttribArray(0);\n    glEnableVertexAttribArray(1);\n    \n    glVertexAttribPointer(0, vertex_position _size, GL_FLOAT, GL_FALSE, sizeof(GLfloat) * (vertex_position_size + vertex_color_size), 0);\n    glVertexAttribPointer(1, vertex_color_size, GL_FLOAT, GL_FALSE, sizeof(GLfloat) * (vertex_position_size + vertex_color_size), (const void *)(sizeof(GLfloat) * vertex_position_size));\n        \n    glBindVertexArray(0);\n\n    // \n    glBindVertexArray(vaoId);\n    glDrawElements(GL_TRIANGLES, 3, GL_UNSIGNED_SHORT, 0);\n}\n```\n\n`glDeleteVertexArrays`\n\n``` objc\n/**\n \n\n @param n#>  description#>\n @param arrays#> n description#>\n @return void\n */\nglDeleteVertexArrays(GLsizei n, const GLuint *arrays);\n```\n\n# \n\n`glBufferData``glBufferSubData``glBufferData``glBufferSubData`\n- \n- GPU\n\n`glMapBufferRange``glUnmapBuffer`\n\n``` objc\n/**\n \n\n @param target#> GL_ARRAY_BUFFER, GL_ELEMENT_ARRAY_BUFFER, GL_COPY_READ_BUFFER, GL_COPY_WRITE_BUFFER, GL_PIXEL_PACK_BUFFER, GL_PIXEL_UNPACK_BUFFER, GL_TRANSFORM_FEEDBACK_BUFFER, GL_UNIFORM_BUFFER description#>\n @param offset#>  description#>\n @param length#>  description#>\n @param access#>  description#>\n @return GLvoid *\n */\nglMapBufferRange(GLenum target, GLintptr offset, GLsizeiptr length, GLbitfield access);\n```\n\n | \n- | -\nGL_MAP_READ_BIT | \nGL_MAP_WRITE_BIT | \n\n\n\n | \n- | -\nGL_MAP_INVALIDATAE_RANGE_BIT | GL_MAP_READ_BIT\nGL_MAP_INVALIDATE_BUFFER_BIT | GL_MAP_READ_BIT\nGL_MAP_FLUSH_EXPLICIT_BIT | glFlushMappedBufferRangeGL_MAP_WRITE_BIT\nGL_MAP_UNSYNCHRONIZED_BIT | \n\n`glMapBufferRange`NULL`glUnmapBuffer`\n\n``` objc\n/**\n \n\n @param target#> GL_ARRAY_BUFFER description#>\n @return GLboolean\n */\nglUnmapBuffer(GLenum target);\n```\n\n`glUnmapBuffer``GL_TRUE``glMapBufferRange``glUnmapBuffer``GL_FALSE`OpenGL ES\n\n\n``` objc\nGLfloat *vtxMappedBuf;\nGLushort *idxMappedBuf;\nGLfloat vertices[] = {\n    0.0f, 0.5f, 0.0f,\n    1.0f, 0.0f, 0.0f, 1.0f,\n    -0.5f, -0.5f, 0.0f,\n    0.0f, 1.0f, 0.0f, 1.0f,\n    0.5f, -0.5f, 0.0f,\n    0.0f, 0.0f, 1.0f, 1.0f\n};\nGLushort indices[3] = { 0, 1, 2 };\n\nglGenBuffers(2, vboIds);\nglBindBuffer(GL_ARRAY_BUFFER, vboIds[0]);\nglBufferData(GL_ARRAY_BUFFER, sizeof(vertices), NULL, GL_STATIC_DRAW);\nvtxMappedBuf = (GLfloat *)glMapBufferRange(GL_ARRAY_BUFFER, 0, sizeof(vertices), GL_MAP_WRITE_BIT | GL_MAP_INVALIDATE_BUFFER_BIT);\nif (vtxMappedBuf == NULL) {\n    NSLog(@\"Error mapping vertex buffer object\");\n    return;\n}\nmemcpy(vtxMappedBuf, vertices, sizeof(vertices));\nif (glUnmapBuffer(GL_ARRAY_BUFFER) == GL_FALSE) {\n    NSLog(@\"Error unmapping array buffer object\");\n    return;\n}\n\nglBindBuffer(GL_ELEMENT_ARRAY_BUFFER, vboIds[1]);\nglBufferData(GL_ELEMENT_ARRAY_BUFFER, sizeof(indices), NULL, GL_STATIC_DRAW);\nidxMappedBuf = (GLushort *)glMapBufferRange(GL_ELEMENT_ARRAY_BUFFER, 0, sizeof(indices), GL_MAP_WRITE_BIT | GL_MAP_INVALIDATE_BUFFER_BIT);\nif (idxMappedBuf == NULL) {\n    NSLog(@\"Error mapping element buffer object\");\n    return;\n}\nmemcpy(idxMappedBuf, indices, sizeof(indices));\nif (glUnmapBuffer(GL_ELEMENT_ARRAY_BUFFER) == GL_FALSE) {\n    NSLog(@\"Error unmapping element buffer object\");\n    return;\n}\n```\n\n## \n\n`glMapBufferRange``glUnmapBuffer``GL_MAP_FLUSH_EXPLICIT_BIT``GL_MAP_WRITE_BIT``glFlushMappedBufferRange`\n\n``` objc\n/**\n \n\n @param target#> GL_ARRAY_BUFFER, GL_ELEMENT_ARRAY_BUFFER, GL_COPY_READ_BUFFER, GL_COPY_WRITE_BUFFER, GL_PIXEL_PACK_BUFFER, GL_PIXEL_UNPACK_BUFFER, GL_TRANSFORM_FEEDBACK_BUFFER, GL_UNIFORM_BUFFER description#>\n @param offset#>  description#>\n @param length#>  description#>\n @return void\n */\nglFlushMappedBufferRange(GLenum target, GLintptr offset, GLsizeiptr length);\n```\n\n`GL_MAP_FLUSH_EXPLICIT_BIT``glFlushMappedBufferRange`\n\n# \n\n`glBufferData``glBufferSubData``glMapBufferRange`OpenGL ES 3.0\n\n``` objc\n/**\n \n\n @param readTarget#>  description#>\n @param writeTarget#>  description#>\n @param readOffset#>  description#>\n @param writeOffset#>  description#>\n @param size#>  description#>\n @return void\n */\nglCopyBufferSubData(GLenum readTarget, GLenum writeTarget, GLintptr readOffset, GLintptr writeOffset, GLsizeiptr size);\n```\n\n`glCopyBufferSubData``readtarget``writetarget``glBindBuffer``GL_COPY_READ_BUFFER``GL_COPY_WRITE_BUFFER`\n\n# \n\n","slug":"2019/opengl-es-vertex-0720","published":1,"updated":"2021-06-21T12:34:52.097Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckszp3ndh0013ifnt3qauohoi","content":"<blockquote>\n<p>333</p>\n</blockquote>\n<h1 id=\"\"></h1>\n<p></p>\n<p>OpenGL ES 3.016<code>glGet*</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">GLint maxVertexAttribs; </span><br><span class=\"line\">glGetIntegerv(GL_MAX_VERTEX_ATTRIBS, &amp;maxVertexAttribs);</span><br></pre></td></tr></table></figure>\n<h2 id=\"\"></h2>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// indx(x, 0.0, 0.0, 1.0)</span></span><br><span class=\"line\">glVertexAttrib1f(GLuint indx, GLfloat x);</span><br><span class=\"line\">glVertexAttrib1fv(GLuint indx, <span class=\"keyword\">const</span> GLfloat *values);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// indx(x, y, 0.0, 1.0)</span></span><br><span class=\"line\">glVertexAttrib2f(GLuint indx, GLfloat x, GLfloat y);</span><br><span class=\"line\">glVertexAttrib2fv(GLuint indx, <span class=\"keyword\">const</span> GLfloat *values);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// indx(x, y, z, 1.0)</span></span><br><span class=\"line\">glVertexAttrib3f(GLuint indx, GLfloat x, GLfloat y, GLfloat z);</span><br><span class=\"line\">glVertexAttrib3fv(GLuint indx, <span class=\"keyword\">const</span> GLfloat *values);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// indx(x, y, z, w)</span></span><br><span class=\"line\">glVertexAttrib4f(GLuint indx, GLfloat x, GLfloat y, GLfloat z, GLfloat w);</span><br><span class=\"line\">glVertexAttrib4fv(GLuint indx, <span class=\"keyword\">const</span> GLfloat *values);</span><br></pre></td></tr></table></figure>\n<h2 id=\"\"></h2>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param indx#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param size#&gt; 1~4 description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param type#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param normalized#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param stride#&gt; sizestrideII+1stride0stride0 description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param ptr#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glVertexAttribPointer(GLuint indx, GLint size, GLenum type, GLboolean normalized, GLsizei stride, <span class=\"keyword\">const</span> GLvoid *ptr);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param index#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param size#&gt; 1~4 description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param type#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param stride#&gt; sizestrideII+1stride0stride0 description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param pointer#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glVertexAttribIPointer(GLuint index, GLint size, GLenum type, GLsizei stride, <span class=\"keyword\">const</span> GLvoid *pointer);</span><br></pre></td></tr></table></figure>\n<p></p>\n<ul>\n<li></li>\n<li></li>\n</ul>\n<h3 id=\"\"></h3>\n<p></p>\n<h3 id=\"\"></h3>\n<p><code>glVertexAttribPointer</code><code>type</code>OpenGL ES 3.0<code>GL_HALF_FLOAT</code>16<code>GL_HALF_FLOAT</code><code>GL_UNSIGNED_BYTE</code>4<code>GL_FLOAT</code></p>\n<h3 id=\"glvertexattribpointer\"><code>glVertexAttribPointer</code></h3>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">GLfloat f;</span><br><span class=\"line\">GLbyte b;</span><br><span class=\"line\">f = (GLfloat)b;     <span class=\"comment\">// f represents values in the range [-128.0, 127.0]</span></span><br></pre></td></tr></table></figure>\n<p><code>GL_BYTE</code><code>GL_SHORT</code><code>GL_FIXED</code>[-1.0, 1.0]<code>GL_UNSIGNED_BYTE</code><code>GL_UNSIGNED_SHORT</code>[0.0, 1.0]</p>\n<p><code>c</code></p>\n<table>\n<thead>\n<tr>\n<th></th>\n<th></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>GL_BYTE</td>\n<td>max(c/(2<sup>7</sup>-1), -1.0)</td>\n</tr>\n<tr>\n<td>GL_UNSIGNED_BYTE</td>\n<td>c/(2<sup>8</sup>-1)</td>\n</tr>\n<tr>\n<td>GL_SHORT</td>\n<td>max(c/(2<sup>16</sup>-1), -1.0)</td>\n</tr>\n<tr>\n<td>GL_UNSIGNED_SHORT</td>\n<td>c/(2<sup>16</sup>-1)</td>\n</tr>\n<tr>\n<td>GL_FIXED</td>\n<td>c/(2<sup>16</sup>)</td>\n</tr>\n<tr>\n<td>GL_FLOAT</td>\n<td>c</td>\n</tr>\n<tr>\n<td>GL_HALF_FLOAT_OES</td>\n<td>c</td>\n</tr>\n</tbody>\n</table>\n<p><code>glVertexAttribIPointer</code></p>\n<h3 id=\"\"></h3>\n<p>OpenGL ES<code>glEnableVertexAttribArray</code><code>glDisableVertexAttribArray</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// glsl.vsh</span></span><br><span class=\"line\"><span class=\"meta\">#version 300 es</span></span><br><span class=\"line\">layout(location = <span class=\"number\">0</span>) <span class=\"keyword\">in</span> vec4 a_color;</span><br><span class=\"line\">layout(location = <span class=\"number\">1</span>) <span class=\"keyword\">in</span> vec4 a_position;</span><br><span class=\"line\"><span class=\"keyword\">out</span> vec4 v_color;</span><br><span class=\"line\"><span class=\"keyword\">void</span> mian() &#123;</span><br><span class=\"line\">    v_color = a_color;</span><br><span class=\"line\">    gl_Position = a_position;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// glsl.fsh</span></span><br><span class=\"line\"><span class=\"meta\">#version 300 es</span></span><br><span class=\"line\">precision mudiump <span class=\"keyword\">float</span>;</span><br><span class=\"line\"><span class=\"keyword\">in</span> vec4 v_color;</span><br><span class=\"line\"><span class=\"keyword\">out</span> vec4 o_fragColor;</span><br><span class=\"line\"><span class=\"keyword\">void</span> main() &#123;</span><br><span class=\"line\">    o_fragColor = v_color;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">GLfloat color[<span class=\"number\">4</span>] = &#123;<span class=\"number\">1.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">1.0</span>f&#125;;</span><br><span class=\"line\">GLfloat vertexPos[<span class=\"number\">9</span>] = &#123;<span class=\"number\">0.0</span>f, <span class=\"number\">0.5</span>f, <span class=\"number\">0.0</span>f,</span><br><span class=\"line\">                        <span class=\"number\">-0.5</span>f, <span class=\"number\">-0.5</span>f, <span class=\"number\">0.0</span>f,</span><br><span class=\"line\">                        <span class=\"number\">0.5</span>f, <span class=\"number\">-0.5</span>f, <span class=\"number\">0.0</span>f&#125;;</span><br><span class=\"line\">glVertexAttrib4fv(<span class=\"number\">0</span>, color);</span><br><span class=\"line\">glVertexAttribPointer(<span class=\"number\">1</span>, <span class=\"number\">3</span>, GL_FLOAT, GL_FALSE, <span class=\"number\">0</span>, vertexPos);</span><br><span class=\"line\">glEnableVertexAttribArray(<span class=\"number\">1</span>);</span><br><span class=\"line\">glDrawArrays(GL_TRIANGLES, <span class=\"number\">0</span>, <span class=\"number\">3</span>);</span><br><span class=\"line\">glDisableVertexAttribArray(<span class=\"number\">1</span>);</span><br></pre></td></tr></table></figure>\n<p><code>color</code><code>glVertexAttrib4fv</code>0<code>vertexPos</code><code>glVertexAttribPointer</code><code>glEnableVertexAttribArray</code><code>color</code><code>vertexPos</code></p>\n<h1 id=\"\"></h1>\n<p><code>in</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">layout(location = <span class=\"number\">0</span>) <span class=\"keyword\">in</span> vec4 a_position;</span><br><span class=\"line\">layout(location = <span class=\"number\">1</span>) <span class=\"keyword\">in</span> vec2 a_texcoord;</span><br><span class=\"line\">layout(location - <span class=\"number\">2</span>) <span class=\"keyword\">in</span> vec3 a_normal;</span><br></pre></td></tr></table></figure>\n<p><code>GL_MAX_VERTEX_ATTRIBS</code></p>\n<p><br>\n<code>glGetProgramiv</code><code>GL_ACTIVE_ATTRIBUTE</code><code>GL_ACTIVE_ATTRIBUTE_MAX_LENGTH</code><code>glGetActiveAttrib</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">GLint attribsCount;</span><br><span class=\"line\">GLint attribMaxLength;</span><br><span class=\"line\">glGetProgramiv(program, GL_ACTIVE_ATTRIBUTES, &amp;attribsCount);</span><br><span class=\"line\">glGetProgramiv(program, GL_ACTIVE_ATTRIBUTE_MAX_LENGTH, &amp;attribMaxLength);</span><br><span class=\"line\"><span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; attribsCount; i++) &#123;</span><br><span class=\"line\">    GLsizei length;</span><br><span class=\"line\">    GLint size;</span><br><span class=\"line\">    GLenum type;</span><br><span class=\"line\">    GLchar *name = malloc(attribMaxLength * <span class=\"keyword\">sizeof</span>(GLchar));</span><br><span class=\"line\">    glGetActiveAttrib(program, i, attribMaxLength, &amp;length, &amp;size, &amp;type, name);</span><br><span class=\"line\">    <span class=\"built_in\">NSLog</span>(<span class=\"string\">@\"length: %d, size: %d, type: %u, name: %s\"</span>, length, size, type, name);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"\"></h2>\n<p>OpenGL ES 3.03</p>\n<ul>\n<li><code>layout(location = N)</code></li>\n<li>OpenGL ES 3.0</li>\n<li></li>\n</ul>\n<p><code>layout(location = N)</code><code>glBindAttribLocation</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param program#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param index#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param name#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glBindAttribLocation(GLuint program, GLuint index, <span class=\"keyword\">const</span> GLchar *name);</span><br></pre></td></tr></table></figure>\n<p><code>name</code><code>glBindAttribLocation</code></p>\n<p>OpenGL ES 3.0OpenGL ES 3.0<code>glBindAttribLocation</code>OpenGL ES<br>\nOpenGL ES 3.0<code>glGetAttribLocation</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param program#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param name#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return </span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glGetAttribLocation(GLuint program, <span class=\"keyword\">const</span> GLchar *name);</span><br></pre></td></tr></table></figure>\n<p><code>glGetAttribLocation</code><code>program</code><code>name</code><code>name</code><code>program</code>-1</p>\n<h1 id=\"\"></h1>\n<p><code>glDrawArrays</code><code>glDrawElements</code>OpenGL ES 3.0<code>glDrawElements</code></p>\n<p>OpenGL ES 3.0<code>GL_ARRAY_BUFFER</code><code>GL_ELEMENT_ARRAY_BUFFER</code></p>\n<blockquote>\n<p>OpenGL ES 3.0</p>\n</blockquote>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// vertex_t</span></span><br><span class=\"line\"><span class=\"keyword\">void</span> initVertexBufferObjects(vertex_t *vertexBuffer,</span><br><span class=\"line\">                             GLushort *indices,</span><br><span class=\"line\">                             GLuint numVertices,</span><br><span class=\"line\">                             GLuint numIndices,</span><br><span class=\"line\">                             GLuint *vboIds) &#123;</span><br><span class=\"line\">    glGenBuffers(<span class=\"number\">2</span>, vboIds);</span><br><span class=\"line\">    </span><br><span class=\"line\">    glBindBuffer(GL_ARRAY_BUFFER, vboIds[<span class=\"number\">0</span>]);</span><br><span class=\"line\">    glBufferData(GL_ARRAY_BUFFER, numVertices * <span class=\"keyword\">sizeof</span>(vertex_t), vertexBuffer, GL_STATIC_DRAW);</span><br><span class=\"line\">    </span><br><span class=\"line\">    glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, vboIds[<span class=\"number\">1</span>]);</span><br><span class=\"line\">    glBufferData(GL_ELEMENT_ARRAY_BUFFER, numIndices * <span class=\"keyword\">sizeof</span>(GLushort), indices, GL_STATIC_DRAW);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param n#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param buffers#&gt; n description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glGenBuffers(GLsizei n, GLuint *buffers);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param target#&gt; GL_ARRAY_BUFFER, GL_ELEMENT_ARRAY_BUFFER, GL_COPY_READ_BUFFER, GL_COPY_WRITE_BUFFER, GL_PIXEL_PACK_BUFFER, GL_PIXEL_UNPACK_BUFFER, GL_TRANSFROM_FEEDBACK_BUFFER, GL_UNIFORM_BUFFER description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param buffer#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glBindBuffer(GLenum target, GLuint buffer);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param target#&gt; GL_ARRAY_BUFFER, GL_ELEMENT_ARRAY_BUFFER, GL_COPY_READ_BUFFER, GL_COPY_WRITE_BUFFER, GL_PIXEL_PACK_BUFFER, GL_PIXEL_UNPACK_BUFFER, GL_TRANSFROM_FEEDBACK_BUFFER, GL_UNIFORM_BUFFER description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param size#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param data#&gt; NULL description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param usage#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glBufferData(GLenum target, GLsizeiptr size, <span class=\"keyword\">const</span> GLvoid *data, GLenum usage);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param target#&gt; GL_ARRAY_BUFFER, GL_ELEMENT_ARRAY_BUFFER, GL_COPY_READ_BUFFER, GL_COPY_WRITE_BUFFER, GL_PIXEL_PACK_BUFFER, GL_PIXEL_UNPACK_BUFFER, GL_TRANSFROM_FEEDBACK_BUFFER, GL_UNIFORM_BUFFER description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param offset#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param size#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param data#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glBufferSubData(GLenum target, GLintptr offset, GLsizeiptr size, <span class=\"keyword\">const</span> GLvoid *data)</span><br></pre></td></tr></table></figure>\n<table>\n<thead>\n<tr>\n<th></th>\n<th></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>GL_STATIC_DRAW</td>\n<td></td>\n</tr>\n<tr>\n<td>GL_STATIC_READ</td>\n<td>OpenGL ESOpenGL ES</td>\n</tr>\n<tr>\n<td>GL_STATIC_COPY</td>\n<td>OpenGL ESOpenGL ES</td>\n</tr>\n<tr>\n<td>GL_DYNAMIC_DRAW</td>\n<td></td>\n</tr>\n<tr>\n<td>GL_DYNAMIC_READ</td>\n<td>OpenGL ESOpenGL ES</td>\n</tr>\n<tr>\n<td>GL_DYNAMIC_COPY</td>\n<td>OpenGL ESOpenGL ES</td>\n</tr>\n<tr>\n<td>GL_STREAM_DRAW</td>\n<td></td>\n</tr>\n<tr>\n<td>GL_STREAM_READ</td>\n<td>OpenGL ESOpenGL ES</td>\n</tr>\n<tr>\n<td>GL_STREAM_COPY</td>\n<td>OpenGL ESOpenGL ES</td>\n</tr>\n</tbody>\n</table>\n<p><code>glBufferData</code><code>glBufferSubData</code></p>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// glsl.vsh</span></span><br><span class=\"line\"><span class=\"meta\">#version 300 es</span></span><br><span class=\"line\">layout(location = <span class=\"number\">0</span>) <span class=\"keyword\">in</span> vec4 vPosition;</span><br><span class=\"line\">layout(location = <span class=\"number\">1</span>) <span class=\"keyword\">in</span> vec4 vColor;</span><br><span class=\"line\">uniform <span class=\"keyword\">float</span> offsetLoc;</span><br><span class=\"line\"><span class=\"keyword\">out</span> vec4 v_color;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">void</span> main() &#123;</span><br><span class=\"line\">    v_color = vColor;</span><br><span class=\"line\">    gl_Position = vec4(vPosition.x + offsetLoc, vPosition.yzw);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// glsl.fsh</span></span><br><span class=\"line\"><span class=\"meta\">#version 300 es</span></span><br><span class=\"line\">precision mediump <span class=\"keyword\">float</span>;</span><br><span class=\"line\"><span class=\"keyword\">in</span> vec4 v_color;</span><br><span class=\"line\"><span class=\"keyword\">out</span> vec4 fragColor;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">void</span> main() &#123;</span><br><span class=\"line\">    fragColor = v_color;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">void</span> DrawPrimitiveWithoutVBOs() &#123;</span><br><span class=\"line\">    GLint vertex_position_size = <span class=\"number\">3</span>;</span><br><span class=\"line\">    GLint vertex_color_size = <span class=\"number\">4</span>;</span><br><span class=\"line\">    GLushort indices[<span class=\"number\">3</span>] = &#123;<span class=\"number\">0</span>, <span class=\"number\">1</span>, <span class=\"number\">2</span>&#125;;</span><br><span class=\"line\">    GLfloat vertices[] = &#123;</span><br><span class=\"line\">        <span class=\"number\">-0.5</span>f, <span class=\"number\">0.5</span>f, <span class=\"number\">0.0</span>f,</span><br><span class=\"line\">        <span class=\"number\">1.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">1.0</span>f,</span><br><span class=\"line\">        <span class=\"number\">-1.0</span>f, <span class=\"number\">-0.5</span>f, <span class=\"number\">0.0</span>f,</span><br><span class=\"line\">        <span class=\"number\">0.0</span>f, <span class=\"number\">1.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">1.0</span>f,</span><br><span class=\"line\">        <span class=\"number\">0.0</span>f, <span class=\"number\">-0.5</span>f, <span class=\"number\">0.0</span>f,</span><br><span class=\"line\">        <span class=\"number\">0.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">1.0</span>f, <span class=\"number\">1.0</span>f</span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">    GLfloat *vtxBuf = vertices;</span><br><span class=\"line\">    GLsizei vtxStride = <span class=\"keyword\">sizeof</span>(GLfloat) * (vertex_color_size + vertex_position_size);</span><br><span class=\"line\">    </span><br><span class=\"line\">    glBindBuffer(GL_ARRAY_BUFFER, <span class=\"number\">0</span>);</span><br><span class=\"line\">    glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, <span class=\"number\">0</span>);</span><br><span class=\"line\">    </span><br><span class=\"line\">    glEnableVertexAttribArray(<span class=\"number\">0</span>);</span><br><span class=\"line\">    glEnableVertexAttribArray(<span class=\"number\">1</span>);</span><br><span class=\"line\">    </span><br><span class=\"line\">    glVertexAttribPointer(<span class=\"number\">0</span>, vertex_position_size, GL_FLOAT, GL_FALSE, vtxStride, vtxBuf);</span><br><span class=\"line\">    vtxBuf += vertex_position_size;</span><br><span class=\"line\">    glVertexAttribPointer(<span class=\"number\">1</span>, vertex_color_size, GL_FLOAT, GL_FALSE, vtxStride, vtxBuf);</span><br><span class=\"line\">    </span><br><span class=\"line\">    glDrawElements(GL_TRIANGLES, <span class=\"number\">3</span>, GL_UNSIGNED_SHORT, indices);</span><br><span class=\"line\">    </span><br><span class=\"line\">    glDisableVertexAttribArray(<span class=\"number\">0</span>);</span><br><span class=\"line\">    glDisableVertexAttribArray(<span class=\"number\">1</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">void</span> DrawPrimitiveWithVBOs() &#123;</span><br><span class=\"line\">    GLvoid *offset = <span class=\"number\">0</span>;</span><br><span class=\"line\">    GLuint vboIds[<span class=\"number\">2</span>];</span><br><span class=\"line\">    GLint vertex_position_size = <span class=\"number\">3</span>;</span><br><span class=\"line\">    GLint vertex_color_size = <span class=\"number\">4</span>;</span><br><span class=\"line\">    GLushort indices[<span class=\"number\">3</span>] = &#123;<span class=\"number\">0</span>, <span class=\"number\">1</span>, <span class=\"number\">2</span>&#125;;</span><br><span class=\"line\">    GLint vtxStride = <span class=\"keyword\">sizeof</span>(GLfloat) * (vertex_position_size + vertex_color_size);</span><br><span class=\"line\">    GLfloat vertices[] = &#123;</span><br><span class=\"line\">        <span class=\"number\">-0.5</span>f, <span class=\"number\">0.5</span>f, <span class=\"number\">0.0</span>f,</span><br><span class=\"line\">        <span class=\"number\">1.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">1.0</span>f,</span><br><span class=\"line\">        <span class=\"number\">-1.0</span>f, <span class=\"number\">-0.5</span>f, <span class=\"number\">0.0</span>f,</span><br><span class=\"line\">        <span class=\"number\">0.0</span>f, <span class=\"number\">1.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">1.0</span>f,</span><br><span class=\"line\">        <span class=\"number\">0.0</span>f, <span class=\"number\">-0.5</span>f, <span class=\"number\">0.0</span>f,</span><br><span class=\"line\">        <span class=\"number\">0.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">1.0</span>f, <span class=\"number\">1.0</span>f</span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">    GLfloat *vtxBuf = vertices;</span><br><span class=\"line\"></span><br><span class=\"line\">    glGenBuffers(<span class=\"number\">2</span>, vboIds);</span><br><span class=\"line\">    glBindBuffer(GL_ARRAY_BUFFER, vboIds[<span class=\"number\">0</span>]);</span><br><span class=\"line\">    glBufferData(GL_ARRAY_BUFFER, vtxStride * <span class=\"number\">3</span>, vtxBuf, GL_STATIC_DRAW);</span><br><span class=\"line\">    glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, vboIds[<span class=\"number\">1</span>]);</span><br><span class=\"line\">    glBufferData(GL_ELEMENT_ARRAY_BUFFER, <span class=\"keyword\">sizeof</span>(GLushort) * <span class=\"number\">3</span>, indices, GL_STATIC_DRAW);</span><br><span class=\"line\">    </span><br><span class=\"line\">    glEnableVertexAttribArray(<span class=\"number\">0</span>);</span><br><span class=\"line\">    glEnableVertexAttribArray(<span class=\"number\">1</span>);</span><br><span class=\"line\">    </span><br><span class=\"line\">    glVertexAttribPointer(<span class=\"number\">0</span>, vertex_position_size, GL_FLOAT, GL_FALSE, vtxStride, offset);</span><br><span class=\"line\">    offset += vertex_position_size * <span class=\"keyword\">sizeof</span>(GLfloat);</span><br><span class=\"line\">    glVertexAttribPointer(<span class=\"number\">1</span>, vertex_color_size, GL_FLOAT, GL_FALSE, vtxStride, offset);</span><br><span class=\"line\">    </span><br><span class=\"line\">    glDrawElements(GL_TRIANGLES, <span class=\"number\">3</span>, GL_UNSIGNED_SHORT, <span class=\"number\">0</span>);</span><br><span class=\"line\">    </span><br><span class=\"line\">    glDisableVertexAttribArray(<span class=\"number\">0</span>);</span><br><span class=\"line\">    glDisableVertexAttribArray(<span class=\"number\">1</span>);</span><br><span class=\"line\">    </span><br><span class=\"line\">    glBindBuffer(GL_ARRAY_BUFFER, <span class=\"number\">0</span>);</span><br><span class=\"line\">    glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, <span class=\"number\">0</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\">DrawPrimitiveWithoutVBOs();</span><br><span class=\"line\">glUniform1f(<span class=\"number\">0</span>, <span class=\"number\">1.0</span>f);</span><br><span class=\"line\">DrawPrimitiveWithVBOs();</span><br></pre></td></tr></table></figure>\n<p><code>GL_ARRAY_BUFFER</code><code>glVertexAttribPointer</code><code>pointer</code><code>glBufferData</code><code>GL_ELEMENT_ARRAY_BUFFER</code><code>glDrawElements</code><code>indices</code><code>glBufferData</code></p>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">void</span> DrawPrimitiveWithVBOs() &#123;</span><br><span class=\"line\">    GLuint vboIds[<span class=\"number\">3</span>];</span><br><span class=\"line\">    GLint vertex_position_size = <span class=\"number\">3</span>;</span><br><span class=\"line\">    GLint vertex_color_size = <span class=\"number\">4</span>;</span><br><span class=\"line\">    GLfloat position[] = &#123;</span><br><span class=\"line\">        <span class=\"number\">-0.5</span>f, <span class=\"number\">0.5</span>f, <span class=\"number\">0.0</span>f,</span><br><span class=\"line\">        <span class=\"number\">-1.0</span>f, <span class=\"number\">-0.5</span>f, <span class=\"number\">0.0</span>f,</span><br><span class=\"line\">        <span class=\"number\">0.0</span>f, <span class=\"number\">-0.5</span>f, <span class=\"number\">0.0</span>f</span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">    GLfloat color[] = &#123;</span><br><span class=\"line\">        <span class=\"number\">1.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">1.0</span>f,</span><br><span class=\"line\">        <span class=\"number\">0.0</span>f, <span class=\"number\">1.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">1.0</span>f,</span><br><span class=\"line\">        <span class=\"number\">0.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">1.0</span>f, <span class=\"number\">1.0</span>f</span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">    GLushort indices[<span class=\"number\">3</span>] = &#123;<span class=\"number\">0</span>, <span class=\"number\">1</span>, <span class=\"number\">2</span>&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">    glGenBuffers(<span class=\"number\">3</span>, vboIds);</span><br><span class=\"line\">    glBindBuffer(GL_ARRAY_BUFFER, vboIds[<span class=\"number\">0</span>]);</span><br><span class=\"line\">    glBufferData(GL_ARRAY_BUFFER, <span class=\"keyword\">sizeof</span>(GLfloat) * vertex_position_size * <span class=\"number\">3</span>, position, GL_STATIC_DRAW);</span><br><span class=\"line\">    glBindBuffer(GL_ARRAY_BUFFER, vboIds[<span class=\"number\">1</span>]);</span><br><span class=\"line\">    glBufferData(GL_ARRAY_BUFFER, <span class=\"keyword\">sizeof</span>(GLfloat) * vertex_color_size * <span class=\"number\">4</span>, color, GL_STATIC_DRAW);</span><br><span class=\"line\">    glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, vboIds[<span class=\"number\">2</span>]);</span><br><span class=\"line\">    glBufferData(GL_ELEMENT_ARRAY_BUFFER, <span class=\"keyword\">sizeof</span>(GLushort) * <span class=\"number\">3</span>, indices, GL_STATIC_DRAW);</span><br><span class=\"line\">    </span><br><span class=\"line\">    glBindBuffer(GL_ARRAY_BUFFER, vboIds[<span class=\"number\">0</span>]);</span><br><span class=\"line\">    glEnableVertexAttribArray(<span class=\"number\">0</span>);</span><br><span class=\"line\">    glVertexAttribPointer(<span class=\"number\">0</span>, vertex_position_size, GL_FLOAT, GL_FALSE, <span class=\"keyword\">sizeof</span>(GLfloat) * vertex_position_size, <span class=\"number\">0</span>);</span><br><span class=\"line\">    glBindBuffer(GL_ARRAY_BUFFER, vboIds[<span class=\"number\">1</span>]);</span><br><span class=\"line\">    glEnableVertexAttribArray(<span class=\"number\">1</span>);</span><br><span class=\"line\">    glVertexAttribPointer(<span class=\"number\">1</span>, vertex_color_size, GL_FLOAT, GL_FALSE, <span class=\"keyword\">sizeof</span>(GLfloat) * vertex_color_size, <span class=\"number\">0</span>);</span><br><span class=\"line\">    glDrawElements(GL_TRIANGLES, <span class=\"number\">3</span>, GL_UNSIGNED_SHORT, <span class=\"number\">0</span>);</span><br><span class=\"line\">    </span><br><span class=\"line\">    glDisableVertexAttribArray(<span class=\"number\">0</span>);</span><br><span class=\"line\">    glDisableVertexAttribArray(<span class=\"number\">1</span>);</span><br><span class=\"line\">    </span><br><span class=\"line\">    glBindBuffer(GL_ARRAY_BUFFER, <span class=\"number\">0</span>);</span><br><span class=\"line\">    glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, <span class=\"number\">0</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param n#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param buffers#&gt; n description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glDeleteBuffers(GLsizei n, <span class=\"keyword\">const</span> GLuint *buffers);</span><br></pre></td></tr></table></figure>\n<p></p>\n<p></p>\n<h1 id=\"\"></h1>\n<p>GPUCPUOpenGL ES 3.0VAO<code>glBindBuffer</code><code>glVertexAttribPointer</code><code>glEnableVertexAttribArray</code>OpenGL ES 3.0VAO/</p>\n<p>OpenGL ES 3.0VAOID0<code>glGenVertexArrays</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param n#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param arrays#&gt; n description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glGenVertexArrays(GLsizei n, GLuint *arrays);</span><br></pre></td></tr></table></figure>\n<p><code>glBindVertexArray</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param array#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glBindVertexArray(GLuint array);</span><br></pre></td></tr></table></figure>\n<p>VAOVAO<code>glBindVertexArray</code><code>glBindBuffer</code><code>glVertexAttribPointer</code><code>glEnableVertexAttribArray</code><code>glDisableVertexAttribArray</code>VAO</p>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">void</span> DrawPrimitiveWithVAOs() &#123;</span><br><span class=\"line\">    GLuint vboIds[<span class=\"number\">2</span>];</span><br><span class=\"line\">    GLint vertex_position_size = <span class=\"number\">3</span>;</span><br><span class=\"line\">    GLint vertex_color_size = <span class=\"number\">4</span>;</span><br><span class=\"line\">    GLfloat vertices[] = &#123;</span><br><span class=\"line\">        <span class=\"number\">0.0</span>f, <span class=\"number\">0.5</span>f, <span class=\"number\">0.0</span>f,</span><br><span class=\"line\">        <span class=\"number\">1.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">1.0</span>f,</span><br><span class=\"line\">        <span class=\"number\">-0.5</span>f, <span class=\"number\">-0.5</span>f, <span class=\"number\">0.0</span>f,</span><br><span class=\"line\">        <span class=\"number\">0.0</span>f, <span class=\"number\">1.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">1.0</span>f,</span><br><span class=\"line\">        <span class=\"number\">0.5</span>f, <span class=\"number\">-0.5</span>f, <span class=\"number\">0.0</span>f,</span><br><span class=\"line\">        <span class=\"number\">0.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">1.0</span>f, <span class=\"number\">1.0</span>f</span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">    GLuint vaoId;</span><br><span class=\"line\">    GLushort indices[<span class=\"number\">3</span>] = &#123; <span class=\"number\">0</span>, <span class=\"number\">1</span>, <span class=\"number\">2</span> &#125;;</span><br><span class=\"line\">    glGenBuffers(<span class=\"number\">2</span>, vboIds);</span><br><span class=\"line\">    glBindBuffer(GL_ARRAY_BUFFER, vboIds[<span class=\"number\">0</span>]);</span><br><span class=\"line\">    glBufferData(GL_ARRAY_BUFFER, <span class=\"keyword\">sizeof</span>(vertices), vertices, GL_STATIC_DRAW);</span><br><span class=\"line\">    glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, vboIds[<span class=\"number\">1</span>]);</span><br><span class=\"line\">    glBufferData(GL_ELEMENT_ARRAY_BUFFER, <span class=\"keyword\">sizeof</span>(indices), indices, GL_STATIC_DRAW);</span><br><span class=\"line\">    </span><br><span class=\"line\">    glGenVertexArrays(<span class=\"number\">1</span>, &amp;vaoId);</span><br><span class=\"line\">    glBindVertexArray(vaoId);</span><br><span class=\"line\">    </span><br><span class=\"line\">    glBindBuffer(GL_ARRAY_BUFFER, vboIds[<span class=\"number\">0</span>]);</span><br><span class=\"line\">    glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, vboIds[<span class=\"number\">1</span>]);</span><br><span class=\"line\">    </span><br><span class=\"line\">    glEnableVertexAttribArray(<span class=\"number\">0</span>);</span><br><span class=\"line\">    glEnableVertexAttribArray(<span class=\"number\">1</span>);</span><br><span class=\"line\">    </span><br><span class=\"line\">    glVertexAttribPointer(<span class=\"number\">0</span>, vertex_position _size, GL_FLOAT, GL_FALSE, <span class=\"keyword\">sizeof</span>(GLfloat) * (vertex_position_size + vertex_color_size), <span class=\"number\">0</span>);</span><br><span class=\"line\">    glVertexAttribPointer(<span class=\"number\">1</span>, vertex_color_size, GL_FLOAT, GL_FALSE, <span class=\"keyword\">sizeof</span>(GLfloat) * (vertex_position_size + vertex_color_size), (<span class=\"keyword\">const</span> <span class=\"keyword\">void</span> *)(<span class=\"keyword\">sizeof</span>(GLfloat) * vertex_position_size));</span><br><span class=\"line\">        </span><br><span class=\"line\">    glBindVertexArray(<span class=\"number\">0</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    glBindVertexArray(vaoId);</span><br><span class=\"line\">    glDrawElements(GL_TRIANGLES, <span class=\"number\">3</span>, GL_UNSIGNED_SHORT, <span class=\"number\">0</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><code>glDeleteVertexArrays</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param n#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param arrays#&gt; n description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glDeleteVertexArrays(GLsizei n, <span class=\"keyword\">const</span> GLuint *arrays);</span><br></pre></td></tr></table></figure>\n<h1 id=\"\"></h1>\n<p><code>glBufferData</code><code>glBufferSubData</code><code>glBufferData</code><code>glBufferSubData</code></p>\n<ul>\n<li></li>\n<li>GPU</li>\n</ul>\n<p><code>glMapBufferRange</code><code>glUnmapBuffer</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param target#&gt; GL_ARRAY_BUFFER, GL_ELEMENT_ARRAY_BUFFER, GL_COPY_READ_BUFFER, GL_COPY_WRITE_BUFFER, GL_PIXEL_PACK_BUFFER, GL_PIXEL_UNPACK_BUFFER, GL_TRANSFORM_FEEDBACK_BUFFER, GL_UNIFORM_BUFFER description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param offset#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param length#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param access#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return GLvoid *</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glMapBufferRange(GLenum target, GLintptr offset, GLsizeiptr length, GLbitfield access);</span><br></pre></td></tr></table></figure>\n<table>\n<thead>\n<tr>\n<th></th>\n<th></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>GL_MAP_READ_BIT</td>\n<td></td>\n</tr>\n<tr>\n<td>GL_MAP_WRITE_BIT</td>\n<td></td>\n</tr>\n</tbody>\n</table>\n<p></p>\n<table>\n<thead>\n<tr>\n<th></th>\n<th></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>GL_MAP_INVALIDATAE_RANGE_BIT</td>\n<td>GL_MAP_READ_BIT</td>\n</tr>\n<tr>\n<td>GL_MAP_INVALIDATE_BUFFER_BIT</td>\n<td>GL_MAP_READ_BIT</td>\n</tr>\n<tr>\n<td>GL_MAP_FLUSH_EXPLICIT_BIT</td>\n<td>glFlushMappedBufferRangeGL_MAP_WRITE_BIT</td>\n</tr>\n<tr>\n<td>GL_MAP_UNSYNCHRONIZED_BIT</td>\n<td></td>\n</tr>\n</tbody>\n</table>\n<p><code>glMapBufferRange</code>NULL<code>glUnmapBuffer</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param target#&gt; GL_ARRAY_BUFFER description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return GLboolean</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glUnmapBuffer(GLenum target);</span><br></pre></td></tr></table></figure>\n<p><code>glUnmapBuffer</code><code>GL_TRUE</code><code>glMapBufferRange</code><code>glUnmapBuffer</code><code>GL_FALSE</code>OpenGL ES</p>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">GLfloat *vtxMappedBuf;</span><br><span class=\"line\">GLushort *idxMappedBuf;</span><br><span class=\"line\">GLfloat vertices[] = &#123;</span><br><span class=\"line\">    <span class=\"number\">0.0</span>f, <span class=\"number\">0.5</span>f, <span class=\"number\">0.0</span>f,</span><br><span class=\"line\">    <span class=\"number\">1.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">1.0</span>f,</span><br><span class=\"line\">    <span class=\"number\">-0.5</span>f, <span class=\"number\">-0.5</span>f, <span class=\"number\">0.0</span>f,</span><br><span class=\"line\">    <span class=\"number\">0.0</span>f, <span class=\"number\">1.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">1.0</span>f,</span><br><span class=\"line\">    <span class=\"number\">0.5</span>f, <span class=\"number\">-0.5</span>f, <span class=\"number\">0.0</span>f,</span><br><span class=\"line\">    <span class=\"number\">0.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">1.0</span>f, <span class=\"number\">1.0</span>f</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\">GLushort indices[<span class=\"number\">3</span>] = &#123; <span class=\"number\">0</span>, <span class=\"number\">1</span>, <span class=\"number\">2</span> &#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">glGenBuffers(<span class=\"number\">2</span>, vboIds);</span><br><span class=\"line\">glBindBuffer(GL_ARRAY_BUFFER, vboIds[<span class=\"number\">0</span>]);</span><br><span class=\"line\">glBufferData(GL_ARRAY_BUFFER, <span class=\"keyword\">sizeof</span>(vertices), <span class=\"literal\">NULL</span>, GL_STATIC_DRAW);</span><br><span class=\"line\">vtxMappedBuf = (GLfloat *)glMapBufferRange(GL_ARRAY_BUFFER, <span class=\"number\">0</span>, <span class=\"keyword\">sizeof</span>(vertices), GL_MAP_WRITE_BIT | GL_MAP_INVALIDATE_BUFFER_BIT);</span><br><span class=\"line\"><span class=\"keyword\">if</span> (vtxMappedBuf == <span class=\"literal\">NULL</span>) &#123;</span><br><span class=\"line\">    <span class=\"built_in\">NSLog</span>(<span class=\"string\">@\"Error mapping vertex buffer object\"</span>);</span><br><span class=\"line\">    <span class=\"keyword\">return</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">memcpy(vtxMappedBuf, vertices, <span class=\"keyword\">sizeof</span>(vertices));</span><br><span class=\"line\"><span class=\"keyword\">if</span> (glUnmapBuffer(GL_ARRAY_BUFFER) == GL_FALSE) &#123;</span><br><span class=\"line\">    <span class=\"built_in\">NSLog</span>(<span class=\"string\">@\"Error unmapping array buffer object\"</span>);</span><br><span class=\"line\">    <span class=\"keyword\">return</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, vboIds[<span class=\"number\">1</span>]);</span><br><span class=\"line\">glBufferData(GL_ELEMENT_ARRAY_BUFFER, <span class=\"keyword\">sizeof</span>(indices), <span class=\"literal\">NULL</span>, GL_STATIC_DRAW);</span><br><span class=\"line\">idxMappedBuf = (GLushort *)glMapBufferRange(GL_ELEMENT_ARRAY_BUFFER, <span class=\"number\">0</span>, <span class=\"keyword\">sizeof</span>(indices), GL_MAP_WRITE_BIT | GL_MAP_INVALIDATE_BUFFER_BIT);</span><br><span class=\"line\"><span class=\"keyword\">if</span> (idxMappedBuf == <span class=\"literal\">NULL</span>) &#123;</span><br><span class=\"line\">    <span class=\"built_in\">NSLog</span>(<span class=\"string\">@\"Error mapping element buffer object\"</span>);</span><br><span class=\"line\">    <span class=\"keyword\">return</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">memcpy(idxMappedBuf, indices, <span class=\"keyword\">sizeof</span>(indices));</span><br><span class=\"line\"><span class=\"keyword\">if</span> (glUnmapBuffer(GL_ELEMENT_ARRAY_BUFFER) == GL_FALSE) &#123;</span><br><span class=\"line\">    <span class=\"built_in\">NSLog</span>(<span class=\"string\">@\"Error unmapping element buffer object\"</span>);</span><br><span class=\"line\">    <span class=\"keyword\">return</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"\"></h2>\n<p><code>glMapBufferRange</code><code>glUnmapBuffer</code><code>GL_MAP_FLUSH_EXPLICIT_BIT</code><code>GL_MAP_WRITE_BIT</code><code>glFlushMappedBufferRange</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param target#&gt; GL_ARRAY_BUFFER, GL_ELEMENT_ARRAY_BUFFER, GL_COPY_READ_BUFFER, GL_COPY_WRITE_BUFFER, GL_PIXEL_PACK_BUFFER, GL_PIXEL_UNPACK_BUFFER, GL_TRANSFORM_FEEDBACK_BUFFER, GL_UNIFORM_BUFFER description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param offset#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param length#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glFlushMappedBufferRange(GLenum target, GLintptr offset, GLsizeiptr length);</span><br></pre></td></tr></table></figure>\n<p><code>GL_MAP_FLUSH_EXPLICIT_BIT</code><code>glFlushMappedBufferRange</code></p>\n<h1 id=\"\"></h1>\n<p><code>glBufferData</code><code>glBufferSubData</code><code>glMapBufferRange</code>OpenGL ES 3.0</p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param readTarget#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param writeTarget#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param readOffset#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param writeOffset#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param size#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glCopyBufferSubData(GLenum readTarget, GLenum writeTarget, GLintptr readOffset, GLintptr writeOffset, GLsizeiptr size);</span><br></pre></td></tr></table></figure>\n<p><code>glCopyBufferSubData</code><code>readtarget</code><code>writetarget</code><code>glBindBuffer</code><code>GL_COPY_READ_BUFFER</code><code>GL_COPY_WRITE_BUFFER</code></p>\n<h1 id=\"\"></h1>\n<p></p>\n","site":{"data":{}},"excerpt":"","more":"<blockquote>\n<p>333</p>\n</blockquote>\n<h1></h1>\n<p></p>\n<p>OpenGL ES 3.016<code>glGet*</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">GLint maxVertexAttribs; </span><br><span class=\"line\">glGetIntegerv(GL_MAX_VERTEX_ATTRIBS, &amp;maxVertexAttribs);</span><br></pre></td></tr></table></figure>\n<h2></h2>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// indx(x, 0.0, 0.0, 1.0)</span></span><br><span class=\"line\">glVertexAttrib1f(GLuint indx, GLfloat x);</span><br><span class=\"line\">glVertexAttrib1fv(GLuint indx, <span class=\"keyword\">const</span> GLfloat *values);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// indx(x, y, 0.0, 1.0)</span></span><br><span class=\"line\">glVertexAttrib2f(GLuint indx, GLfloat x, GLfloat y);</span><br><span class=\"line\">glVertexAttrib2fv(GLuint indx, <span class=\"keyword\">const</span> GLfloat *values);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// indx(x, y, z, 1.0)</span></span><br><span class=\"line\">glVertexAttrib3f(GLuint indx, GLfloat x, GLfloat y, GLfloat z);</span><br><span class=\"line\">glVertexAttrib3fv(GLuint indx, <span class=\"keyword\">const</span> GLfloat *values);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// indx(x, y, z, w)</span></span><br><span class=\"line\">glVertexAttrib4f(GLuint indx, GLfloat x, GLfloat y, GLfloat z, GLfloat w);</span><br><span class=\"line\">glVertexAttrib4fv(GLuint indx, <span class=\"keyword\">const</span> GLfloat *values);</span><br></pre></td></tr></table></figure>\n<h2></h2>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param indx#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param size#&gt; 1~4 description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param type#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param normalized#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param stride#&gt; sizestrideII+1stride0stride0 description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param ptr#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glVertexAttribPointer(GLuint indx, GLint size, GLenum type, GLboolean normalized, GLsizei stride, <span class=\"keyword\">const</span> GLvoid *ptr);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param index#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param size#&gt; 1~4 description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param type#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param stride#&gt; sizestrideII+1stride0stride0 description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param pointer#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glVertexAttribIPointer(GLuint index, GLint size, GLenum type, GLsizei stride, <span class=\"keyword\">const</span> GLvoid *pointer);</span><br></pre></td></tr></table></figure>\n<p></p>\n<ul>\n<li></li>\n<li></li>\n</ul>\n<h3></h3>\n<p></p>\n<h3></h3>\n<p><code>glVertexAttribPointer</code><code>type</code>OpenGL ES 3.0<code>GL_HALF_FLOAT</code>16<code>GL_HALF_FLOAT</code><code>GL_UNSIGNED_BYTE</code>4<code>GL_FLOAT</code></p>\n<h3><code>glVertexAttribPointer</code></h3>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">GLfloat f;</span><br><span class=\"line\">GLbyte b;</span><br><span class=\"line\">f = (GLfloat)b;     <span class=\"comment\">// f represents values in the range [-128.0, 127.0]</span></span><br></pre></td></tr></table></figure>\n<p><code>GL_BYTE</code><code>GL_SHORT</code><code>GL_FIXED</code>[-1.0, 1.0]<code>GL_UNSIGNED_BYTE</code><code>GL_UNSIGNED_SHORT</code>[0.0, 1.0]</p>\n<p><code>c</code></p>\n<table>\n<thead>\n<tr>\n<th></th>\n<th></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>GL_BYTE</td>\n<td>max(c/(2<sup>7</sup>-1), -1.0)</td>\n</tr>\n<tr>\n<td>GL_UNSIGNED_BYTE</td>\n<td>c/(2<sup>8</sup>-1)</td>\n</tr>\n<tr>\n<td>GL_SHORT</td>\n<td>max(c/(2<sup>16</sup>-1), -1.0)</td>\n</tr>\n<tr>\n<td>GL_UNSIGNED_SHORT</td>\n<td>c/(2<sup>16</sup>-1)</td>\n</tr>\n<tr>\n<td>GL_FIXED</td>\n<td>c/(2<sup>16</sup>)</td>\n</tr>\n<tr>\n<td>GL_FLOAT</td>\n<td>c</td>\n</tr>\n<tr>\n<td>GL_HALF_FLOAT_OES</td>\n<td>c</td>\n</tr>\n</tbody>\n</table>\n<p><code>glVertexAttribIPointer</code></p>\n<h3></h3>\n<p>OpenGL ES<code>glEnableVertexAttribArray</code><code>glDisableVertexAttribArray</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// glsl.vsh</span></span><br><span class=\"line\"><span class=\"meta\">#version 300 es</span></span><br><span class=\"line\">layout(location = <span class=\"number\">0</span>) <span class=\"keyword\">in</span> vec4 a_color;</span><br><span class=\"line\">layout(location = <span class=\"number\">1</span>) <span class=\"keyword\">in</span> vec4 a_position;</span><br><span class=\"line\"><span class=\"keyword\">out</span> vec4 v_color;</span><br><span class=\"line\"><span class=\"keyword\">void</span> mian() &#123;</span><br><span class=\"line\">    v_color = a_color;</span><br><span class=\"line\">    gl_Position = a_position;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// glsl.fsh</span></span><br><span class=\"line\"><span class=\"meta\">#version 300 es</span></span><br><span class=\"line\">precision mudiump <span class=\"keyword\">float</span>;</span><br><span class=\"line\"><span class=\"keyword\">in</span> vec4 v_color;</span><br><span class=\"line\"><span class=\"keyword\">out</span> vec4 o_fragColor;</span><br><span class=\"line\"><span class=\"keyword\">void</span> main() &#123;</span><br><span class=\"line\">    o_fragColor = v_color;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">GLfloat color[<span class=\"number\">4</span>] = &#123;<span class=\"number\">1.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">1.0</span>f&#125;;</span><br><span class=\"line\">GLfloat vertexPos[<span class=\"number\">9</span>] = &#123;<span class=\"number\">0.0</span>f, <span class=\"number\">0.5</span>f, <span class=\"number\">0.0</span>f,</span><br><span class=\"line\">                        <span class=\"number\">-0.5</span>f, <span class=\"number\">-0.5</span>f, <span class=\"number\">0.0</span>f,</span><br><span class=\"line\">                        <span class=\"number\">0.5</span>f, <span class=\"number\">-0.5</span>f, <span class=\"number\">0.0</span>f&#125;;</span><br><span class=\"line\">glVertexAttrib4fv(<span class=\"number\">0</span>, color);</span><br><span class=\"line\">glVertexAttribPointer(<span class=\"number\">1</span>, <span class=\"number\">3</span>, GL_FLOAT, GL_FALSE, <span class=\"number\">0</span>, vertexPos);</span><br><span class=\"line\">glEnableVertexAttribArray(<span class=\"number\">1</span>);</span><br><span class=\"line\">glDrawArrays(GL_TRIANGLES, <span class=\"number\">0</span>, <span class=\"number\">3</span>);</span><br><span class=\"line\">glDisableVertexAttribArray(<span class=\"number\">1</span>);</span><br></pre></td></tr></table></figure>\n<p><code>color</code><code>glVertexAttrib4fv</code>0<code>vertexPos</code><code>glVertexAttribPointer</code><code>glEnableVertexAttribArray</code><code>color</code><code>vertexPos</code></p>\n<h1></h1>\n<p><code>in</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">layout(location = <span class=\"number\">0</span>) <span class=\"keyword\">in</span> vec4 a_position;</span><br><span class=\"line\">layout(location = <span class=\"number\">1</span>) <span class=\"keyword\">in</span> vec2 a_texcoord;</span><br><span class=\"line\">layout(location - <span class=\"number\">2</span>) <span class=\"keyword\">in</span> vec3 a_normal;</span><br></pre></td></tr></table></figure>\n<p><code>GL_MAX_VERTEX_ATTRIBS</code></p>\n<p><br>\n<code>glGetProgramiv</code><code>GL_ACTIVE_ATTRIBUTE</code><code>GL_ACTIVE_ATTRIBUTE_MAX_LENGTH</code><code>glGetActiveAttrib</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">GLint attribsCount;</span><br><span class=\"line\">GLint attribMaxLength;</span><br><span class=\"line\">glGetProgramiv(program, GL_ACTIVE_ATTRIBUTES, &amp;attribsCount);</span><br><span class=\"line\">glGetProgramiv(program, GL_ACTIVE_ATTRIBUTE_MAX_LENGTH, &amp;attribMaxLength);</span><br><span class=\"line\"><span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; attribsCount; i++) &#123;</span><br><span class=\"line\">    GLsizei length;</span><br><span class=\"line\">    GLint size;</span><br><span class=\"line\">    GLenum type;</span><br><span class=\"line\">    GLchar *name = malloc(attribMaxLength * <span class=\"keyword\">sizeof</span>(GLchar));</span><br><span class=\"line\">    glGetActiveAttrib(program, i, attribMaxLength, &amp;length, &amp;size, &amp;type, name);</span><br><span class=\"line\">    <span class=\"built_in\">NSLog</span>(<span class=\"string\">@\"length: %d, size: %d, type: %u, name: %s\"</span>, length, size, type, name);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2></h2>\n<p>OpenGL ES 3.03</p>\n<ul>\n<li><code>layout(location = N)</code></li>\n<li>OpenGL ES 3.0</li>\n<li></li>\n</ul>\n<p><code>layout(location = N)</code><code>glBindAttribLocation</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param program#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param index#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param name#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glBindAttribLocation(GLuint program, GLuint index, <span class=\"keyword\">const</span> GLchar *name);</span><br></pre></td></tr></table></figure>\n<p><code>name</code><code>glBindAttribLocation</code></p>\n<p>OpenGL ES 3.0OpenGL ES 3.0<code>glBindAttribLocation</code>OpenGL ES<br>\nOpenGL ES 3.0<code>glGetAttribLocation</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param program#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param name#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return </span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glGetAttribLocation(GLuint program, <span class=\"keyword\">const</span> GLchar *name);</span><br></pre></td></tr></table></figure>\n<p><code>glGetAttribLocation</code><code>program</code><code>name</code><code>name</code><code>program</code>-1</p>\n<h1></h1>\n<p><code>glDrawArrays</code><code>glDrawElements</code>OpenGL ES 3.0<code>glDrawElements</code></p>\n<p>OpenGL ES 3.0<code>GL_ARRAY_BUFFER</code><code>GL_ELEMENT_ARRAY_BUFFER</code></p>\n<blockquote>\n<p>OpenGL ES 3.0</p>\n</blockquote>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// vertex_t</span></span><br><span class=\"line\"><span class=\"keyword\">void</span> initVertexBufferObjects(vertex_t *vertexBuffer,</span><br><span class=\"line\">                             GLushort *indices,</span><br><span class=\"line\">                             GLuint numVertices,</span><br><span class=\"line\">                             GLuint numIndices,</span><br><span class=\"line\">                             GLuint *vboIds) &#123;</span><br><span class=\"line\">    glGenBuffers(<span class=\"number\">2</span>, vboIds);</span><br><span class=\"line\">    </span><br><span class=\"line\">    glBindBuffer(GL_ARRAY_BUFFER, vboIds[<span class=\"number\">0</span>]);</span><br><span class=\"line\">    glBufferData(GL_ARRAY_BUFFER, numVertices * <span class=\"keyword\">sizeof</span>(vertex_t), vertexBuffer, GL_STATIC_DRAW);</span><br><span class=\"line\">    </span><br><span class=\"line\">    glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, vboIds[<span class=\"number\">1</span>]);</span><br><span class=\"line\">    glBufferData(GL_ELEMENT_ARRAY_BUFFER, numIndices * <span class=\"keyword\">sizeof</span>(GLushort), indices, GL_STATIC_DRAW);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param n#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param buffers#&gt; n description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glGenBuffers(GLsizei n, GLuint *buffers);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param target#&gt; GL_ARRAY_BUFFER, GL_ELEMENT_ARRAY_BUFFER, GL_COPY_READ_BUFFER, GL_COPY_WRITE_BUFFER, GL_PIXEL_PACK_BUFFER, GL_PIXEL_UNPACK_BUFFER, GL_TRANSFROM_FEEDBACK_BUFFER, GL_UNIFORM_BUFFER description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param buffer#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glBindBuffer(GLenum target, GLuint buffer);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param target#&gt; GL_ARRAY_BUFFER, GL_ELEMENT_ARRAY_BUFFER, GL_COPY_READ_BUFFER, GL_COPY_WRITE_BUFFER, GL_PIXEL_PACK_BUFFER, GL_PIXEL_UNPACK_BUFFER, GL_TRANSFROM_FEEDBACK_BUFFER, GL_UNIFORM_BUFFER description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param size#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param data#&gt; NULL description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param usage#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glBufferData(GLenum target, GLsizeiptr size, <span class=\"keyword\">const</span> GLvoid *data, GLenum usage);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param target#&gt; GL_ARRAY_BUFFER, GL_ELEMENT_ARRAY_BUFFER, GL_COPY_READ_BUFFER, GL_COPY_WRITE_BUFFER, GL_PIXEL_PACK_BUFFER, GL_PIXEL_UNPACK_BUFFER, GL_TRANSFROM_FEEDBACK_BUFFER, GL_UNIFORM_BUFFER description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param offset#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param size#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param data#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glBufferSubData(GLenum target, GLintptr offset, GLsizeiptr size, <span class=\"keyword\">const</span> GLvoid *data)</span><br></pre></td></tr></table></figure>\n<table>\n<thead>\n<tr>\n<th></th>\n<th></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>GL_STATIC_DRAW</td>\n<td></td>\n</tr>\n<tr>\n<td>GL_STATIC_READ</td>\n<td>OpenGL ESOpenGL ES</td>\n</tr>\n<tr>\n<td>GL_STATIC_COPY</td>\n<td>OpenGL ESOpenGL ES</td>\n</tr>\n<tr>\n<td>GL_DYNAMIC_DRAW</td>\n<td></td>\n</tr>\n<tr>\n<td>GL_DYNAMIC_READ</td>\n<td>OpenGL ESOpenGL ES</td>\n</tr>\n<tr>\n<td>GL_DYNAMIC_COPY</td>\n<td>OpenGL ESOpenGL ES</td>\n</tr>\n<tr>\n<td>GL_STREAM_DRAW</td>\n<td></td>\n</tr>\n<tr>\n<td>GL_STREAM_READ</td>\n<td>OpenGL ESOpenGL ES</td>\n</tr>\n<tr>\n<td>GL_STREAM_COPY</td>\n<td>OpenGL ESOpenGL ES</td>\n</tr>\n</tbody>\n</table>\n<p><code>glBufferData</code><code>glBufferSubData</code></p>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// glsl.vsh</span></span><br><span class=\"line\"><span class=\"meta\">#version 300 es</span></span><br><span class=\"line\">layout(location = <span class=\"number\">0</span>) <span class=\"keyword\">in</span> vec4 vPosition;</span><br><span class=\"line\">layout(location = <span class=\"number\">1</span>) <span class=\"keyword\">in</span> vec4 vColor;</span><br><span class=\"line\">uniform <span class=\"keyword\">float</span> offsetLoc;</span><br><span class=\"line\"><span class=\"keyword\">out</span> vec4 v_color;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">void</span> main() &#123;</span><br><span class=\"line\">    v_color = vColor;</span><br><span class=\"line\">    gl_Position = vec4(vPosition.x + offsetLoc, vPosition.yzw);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// glsl.fsh</span></span><br><span class=\"line\"><span class=\"meta\">#version 300 es</span></span><br><span class=\"line\">precision mediump <span class=\"keyword\">float</span>;</span><br><span class=\"line\"><span class=\"keyword\">in</span> vec4 v_color;</span><br><span class=\"line\"><span class=\"keyword\">out</span> vec4 fragColor;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">void</span> main() &#123;</span><br><span class=\"line\">    fragColor = v_color;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">void</span> DrawPrimitiveWithoutVBOs() &#123;</span><br><span class=\"line\">    GLint vertex_position_size = <span class=\"number\">3</span>;</span><br><span class=\"line\">    GLint vertex_color_size = <span class=\"number\">4</span>;</span><br><span class=\"line\">    GLushort indices[<span class=\"number\">3</span>] = &#123;<span class=\"number\">0</span>, <span class=\"number\">1</span>, <span class=\"number\">2</span>&#125;;</span><br><span class=\"line\">    GLfloat vertices[] = &#123;</span><br><span class=\"line\">        <span class=\"number\">-0.5</span>f, <span class=\"number\">0.5</span>f, <span class=\"number\">0.0</span>f,</span><br><span class=\"line\">        <span class=\"number\">1.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">1.0</span>f,</span><br><span class=\"line\">        <span class=\"number\">-1.0</span>f, <span class=\"number\">-0.5</span>f, <span class=\"number\">0.0</span>f,</span><br><span class=\"line\">        <span class=\"number\">0.0</span>f, <span class=\"number\">1.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">1.0</span>f,</span><br><span class=\"line\">        <span class=\"number\">0.0</span>f, <span class=\"number\">-0.5</span>f, <span class=\"number\">0.0</span>f,</span><br><span class=\"line\">        <span class=\"number\">0.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">1.0</span>f, <span class=\"number\">1.0</span>f</span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">    GLfloat *vtxBuf = vertices;</span><br><span class=\"line\">    GLsizei vtxStride = <span class=\"keyword\">sizeof</span>(GLfloat) * (vertex_color_size + vertex_position_size);</span><br><span class=\"line\">    </span><br><span class=\"line\">    glBindBuffer(GL_ARRAY_BUFFER, <span class=\"number\">0</span>);</span><br><span class=\"line\">    glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, <span class=\"number\">0</span>);</span><br><span class=\"line\">    </span><br><span class=\"line\">    glEnableVertexAttribArray(<span class=\"number\">0</span>);</span><br><span class=\"line\">    glEnableVertexAttribArray(<span class=\"number\">1</span>);</span><br><span class=\"line\">    </span><br><span class=\"line\">    glVertexAttribPointer(<span class=\"number\">0</span>, vertex_position_size, GL_FLOAT, GL_FALSE, vtxStride, vtxBuf);</span><br><span class=\"line\">    vtxBuf += vertex_position_size;</span><br><span class=\"line\">    glVertexAttribPointer(<span class=\"number\">1</span>, vertex_color_size, GL_FLOAT, GL_FALSE, vtxStride, vtxBuf);</span><br><span class=\"line\">    </span><br><span class=\"line\">    glDrawElements(GL_TRIANGLES, <span class=\"number\">3</span>, GL_UNSIGNED_SHORT, indices);</span><br><span class=\"line\">    </span><br><span class=\"line\">    glDisableVertexAttribArray(<span class=\"number\">0</span>);</span><br><span class=\"line\">    glDisableVertexAttribArray(<span class=\"number\">1</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">void</span> DrawPrimitiveWithVBOs() &#123;</span><br><span class=\"line\">    GLvoid *offset = <span class=\"number\">0</span>;</span><br><span class=\"line\">    GLuint vboIds[<span class=\"number\">2</span>];</span><br><span class=\"line\">    GLint vertex_position_size = <span class=\"number\">3</span>;</span><br><span class=\"line\">    GLint vertex_color_size = <span class=\"number\">4</span>;</span><br><span class=\"line\">    GLushort indices[<span class=\"number\">3</span>] = &#123;<span class=\"number\">0</span>, <span class=\"number\">1</span>, <span class=\"number\">2</span>&#125;;</span><br><span class=\"line\">    GLint vtxStride = <span class=\"keyword\">sizeof</span>(GLfloat) * (vertex_position_size + vertex_color_size);</span><br><span class=\"line\">    GLfloat vertices[] = &#123;</span><br><span class=\"line\">        <span class=\"number\">-0.5</span>f, <span class=\"number\">0.5</span>f, <span class=\"number\">0.0</span>f,</span><br><span class=\"line\">        <span class=\"number\">1.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">1.0</span>f,</span><br><span class=\"line\">        <span class=\"number\">-1.0</span>f, <span class=\"number\">-0.5</span>f, <span class=\"number\">0.0</span>f,</span><br><span class=\"line\">        <span class=\"number\">0.0</span>f, <span class=\"number\">1.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">1.0</span>f,</span><br><span class=\"line\">        <span class=\"number\">0.0</span>f, <span class=\"number\">-0.5</span>f, <span class=\"number\">0.0</span>f,</span><br><span class=\"line\">        <span class=\"number\">0.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">1.0</span>f, <span class=\"number\">1.0</span>f</span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">    GLfloat *vtxBuf = vertices;</span><br><span class=\"line\"></span><br><span class=\"line\">    glGenBuffers(<span class=\"number\">2</span>, vboIds);</span><br><span class=\"line\">    glBindBuffer(GL_ARRAY_BUFFER, vboIds[<span class=\"number\">0</span>]);</span><br><span class=\"line\">    glBufferData(GL_ARRAY_BUFFER, vtxStride * <span class=\"number\">3</span>, vtxBuf, GL_STATIC_DRAW);</span><br><span class=\"line\">    glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, vboIds[<span class=\"number\">1</span>]);</span><br><span class=\"line\">    glBufferData(GL_ELEMENT_ARRAY_BUFFER, <span class=\"keyword\">sizeof</span>(GLushort) * <span class=\"number\">3</span>, indices, GL_STATIC_DRAW);</span><br><span class=\"line\">    </span><br><span class=\"line\">    glEnableVertexAttribArray(<span class=\"number\">0</span>);</span><br><span class=\"line\">    glEnableVertexAttribArray(<span class=\"number\">1</span>);</span><br><span class=\"line\">    </span><br><span class=\"line\">    glVertexAttribPointer(<span class=\"number\">0</span>, vertex_position_size, GL_FLOAT, GL_FALSE, vtxStride, offset);</span><br><span class=\"line\">    offset += vertex_position_size * <span class=\"keyword\">sizeof</span>(GLfloat);</span><br><span class=\"line\">    glVertexAttribPointer(<span class=\"number\">1</span>, vertex_color_size, GL_FLOAT, GL_FALSE, vtxStride, offset);</span><br><span class=\"line\">    </span><br><span class=\"line\">    glDrawElements(GL_TRIANGLES, <span class=\"number\">3</span>, GL_UNSIGNED_SHORT, <span class=\"number\">0</span>);</span><br><span class=\"line\">    </span><br><span class=\"line\">    glDisableVertexAttribArray(<span class=\"number\">0</span>);</span><br><span class=\"line\">    glDisableVertexAttribArray(<span class=\"number\">1</span>);</span><br><span class=\"line\">    </span><br><span class=\"line\">    glBindBuffer(GL_ARRAY_BUFFER, <span class=\"number\">0</span>);</span><br><span class=\"line\">    glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, <span class=\"number\">0</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\">DrawPrimitiveWithoutVBOs();</span><br><span class=\"line\">glUniform1f(<span class=\"number\">0</span>, <span class=\"number\">1.0</span>f);</span><br><span class=\"line\">DrawPrimitiveWithVBOs();</span><br></pre></td></tr></table></figure>\n<p><code>GL_ARRAY_BUFFER</code><code>glVertexAttribPointer</code><code>pointer</code><code>glBufferData</code><code>GL_ELEMENT_ARRAY_BUFFER</code><code>glDrawElements</code><code>indices</code><code>glBufferData</code></p>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">void</span> DrawPrimitiveWithVBOs() &#123;</span><br><span class=\"line\">    GLuint vboIds[<span class=\"number\">3</span>];</span><br><span class=\"line\">    GLint vertex_position_size = <span class=\"number\">3</span>;</span><br><span class=\"line\">    GLint vertex_color_size = <span class=\"number\">4</span>;</span><br><span class=\"line\">    GLfloat position[] = &#123;</span><br><span class=\"line\">        <span class=\"number\">-0.5</span>f, <span class=\"number\">0.5</span>f, <span class=\"number\">0.0</span>f,</span><br><span class=\"line\">        <span class=\"number\">-1.0</span>f, <span class=\"number\">-0.5</span>f, <span class=\"number\">0.0</span>f,</span><br><span class=\"line\">        <span class=\"number\">0.0</span>f, <span class=\"number\">-0.5</span>f, <span class=\"number\">0.0</span>f</span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">    GLfloat color[] = &#123;</span><br><span class=\"line\">        <span class=\"number\">1.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">1.0</span>f,</span><br><span class=\"line\">        <span class=\"number\">0.0</span>f, <span class=\"number\">1.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">1.0</span>f,</span><br><span class=\"line\">        <span class=\"number\">0.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">1.0</span>f, <span class=\"number\">1.0</span>f</span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">    GLushort indices[<span class=\"number\">3</span>] = &#123;<span class=\"number\">0</span>, <span class=\"number\">1</span>, <span class=\"number\">2</span>&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">    glGenBuffers(<span class=\"number\">3</span>, vboIds);</span><br><span class=\"line\">    glBindBuffer(GL_ARRAY_BUFFER, vboIds[<span class=\"number\">0</span>]);</span><br><span class=\"line\">    glBufferData(GL_ARRAY_BUFFER, <span class=\"keyword\">sizeof</span>(GLfloat) * vertex_position_size * <span class=\"number\">3</span>, position, GL_STATIC_DRAW);</span><br><span class=\"line\">    glBindBuffer(GL_ARRAY_BUFFER, vboIds[<span class=\"number\">1</span>]);</span><br><span class=\"line\">    glBufferData(GL_ARRAY_BUFFER, <span class=\"keyword\">sizeof</span>(GLfloat) * vertex_color_size * <span class=\"number\">4</span>, color, GL_STATIC_DRAW);</span><br><span class=\"line\">    glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, vboIds[<span class=\"number\">2</span>]);</span><br><span class=\"line\">    glBufferData(GL_ELEMENT_ARRAY_BUFFER, <span class=\"keyword\">sizeof</span>(GLushort) * <span class=\"number\">3</span>, indices, GL_STATIC_DRAW);</span><br><span class=\"line\">    </span><br><span class=\"line\">    glBindBuffer(GL_ARRAY_BUFFER, vboIds[<span class=\"number\">0</span>]);</span><br><span class=\"line\">    glEnableVertexAttribArray(<span class=\"number\">0</span>);</span><br><span class=\"line\">    glVertexAttribPointer(<span class=\"number\">0</span>, vertex_position_size, GL_FLOAT, GL_FALSE, <span class=\"keyword\">sizeof</span>(GLfloat) * vertex_position_size, <span class=\"number\">0</span>);</span><br><span class=\"line\">    glBindBuffer(GL_ARRAY_BUFFER, vboIds[<span class=\"number\">1</span>]);</span><br><span class=\"line\">    glEnableVertexAttribArray(<span class=\"number\">1</span>);</span><br><span class=\"line\">    glVertexAttribPointer(<span class=\"number\">1</span>, vertex_color_size, GL_FLOAT, GL_FALSE, <span class=\"keyword\">sizeof</span>(GLfloat) * vertex_color_size, <span class=\"number\">0</span>);</span><br><span class=\"line\">    glDrawElements(GL_TRIANGLES, <span class=\"number\">3</span>, GL_UNSIGNED_SHORT, <span class=\"number\">0</span>);</span><br><span class=\"line\">    </span><br><span class=\"line\">    glDisableVertexAttribArray(<span class=\"number\">0</span>);</span><br><span class=\"line\">    glDisableVertexAttribArray(<span class=\"number\">1</span>);</span><br><span class=\"line\">    </span><br><span class=\"line\">    glBindBuffer(GL_ARRAY_BUFFER, <span class=\"number\">0</span>);</span><br><span class=\"line\">    glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, <span class=\"number\">0</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param n#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param buffers#&gt; n description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glDeleteBuffers(GLsizei n, <span class=\"keyword\">const</span> GLuint *buffers);</span><br></pre></td></tr></table></figure>\n<p></p>\n<p></p>\n<h1></h1>\n<p>GPUCPUOpenGL ES 3.0VAO<code>glBindBuffer</code><code>glVertexAttribPointer</code><code>glEnableVertexAttribArray</code>OpenGL ES 3.0VAO/</p>\n<p>OpenGL ES 3.0VAOID0<code>glGenVertexArrays</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param n#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param arrays#&gt; n description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glGenVertexArrays(GLsizei n, GLuint *arrays);</span><br></pre></td></tr></table></figure>\n<p><code>glBindVertexArray</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param array#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glBindVertexArray(GLuint array);</span><br></pre></td></tr></table></figure>\n<p>VAOVAO<code>glBindVertexArray</code><code>glBindBuffer</code><code>glVertexAttribPointer</code><code>glEnableVertexAttribArray</code><code>glDisableVertexAttribArray</code>VAO</p>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">void</span> DrawPrimitiveWithVAOs() &#123;</span><br><span class=\"line\">    GLuint vboIds[<span class=\"number\">2</span>];</span><br><span class=\"line\">    GLint vertex_position_size = <span class=\"number\">3</span>;</span><br><span class=\"line\">    GLint vertex_color_size = <span class=\"number\">4</span>;</span><br><span class=\"line\">    GLfloat vertices[] = &#123;</span><br><span class=\"line\">        <span class=\"number\">0.0</span>f, <span class=\"number\">0.5</span>f, <span class=\"number\">0.0</span>f,</span><br><span class=\"line\">        <span class=\"number\">1.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">1.0</span>f,</span><br><span class=\"line\">        <span class=\"number\">-0.5</span>f, <span class=\"number\">-0.5</span>f, <span class=\"number\">0.0</span>f,</span><br><span class=\"line\">        <span class=\"number\">0.0</span>f, <span class=\"number\">1.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">1.0</span>f,</span><br><span class=\"line\">        <span class=\"number\">0.5</span>f, <span class=\"number\">-0.5</span>f, <span class=\"number\">0.0</span>f,</span><br><span class=\"line\">        <span class=\"number\">0.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">1.0</span>f, <span class=\"number\">1.0</span>f</span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">    GLuint vaoId;</span><br><span class=\"line\">    GLushort indices[<span class=\"number\">3</span>] = &#123; <span class=\"number\">0</span>, <span class=\"number\">1</span>, <span class=\"number\">2</span> &#125;;</span><br><span class=\"line\">    glGenBuffers(<span class=\"number\">2</span>, vboIds);</span><br><span class=\"line\">    glBindBuffer(GL_ARRAY_BUFFER, vboIds[<span class=\"number\">0</span>]);</span><br><span class=\"line\">    glBufferData(GL_ARRAY_BUFFER, <span class=\"keyword\">sizeof</span>(vertices), vertices, GL_STATIC_DRAW);</span><br><span class=\"line\">    glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, vboIds[<span class=\"number\">1</span>]);</span><br><span class=\"line\">    glBufferData(GL_ELEMENT_ARRAY_BUFFER, <span class=\"keyword\">sizeof</span>(indices), indices, GL_STATIC_DRAW);</span><br><span class=\"line\">    </span><br><span class=\"line\">    glGenVertexArrays(<span class=\"number\">1</span>, &amp;vaoId);</span><br><span class=\"line\">    glBindVertexArray(vaoId);</span><br><span class=\"line\">    </span><br><span class=\"line\">    glBindBuffer(GL_ARRAY_BUFFER, vboIds[<span class=\"number\">0</span>]);</span><br><span class=\"line\">    glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, vboIds[<span class=\"number\">1</span>]);</span><br><span class=\"line\">    </span><br><span class=\"line\">    glEnableVertexAttribArray(<span class=\"number\">0</span>);</span><br><span class=\"line\">    glEnableVertexAttribArray(<span class=\"number\">1</span>);</span><br><span class=\"line\">    </span><br><span class=\"line\">    glVertexAttribPointer(<span class=\"number\">0</span>, vertex_position _size, GL_FLOAT, GL_FALSE, <span class=\"keyword\">sizeof</span>(GLfloat) * (vertex_position_size + vertex_color_size), <span class=\"number\">0</span>);</span><br><span class=\"line\">    glVertexAttribPointer(<span class=\"number\">1</span>, vertex_color_size, GL_FLOAT, GL_FALSE, <span class=\"keyword\">sizeof</span>(GLfloat) * (vertex_position_size + vertex_color_size), (<span class=\"keyword\">const</span> <span class=\"keyword\">void</span> *)(<span class=\"keyword\">sizeof</span>(GLfloat) * vertex_position_size));</span><br><span class=\"line\">        </span><br><span class=\"line\">    glBindVertexArray(<span class=\"number\">0</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    glBindVertexArray(vaoId);</span><br><span class=\"line\">    glDrawElements(GL_TRIANGLES, <span class=\"number\">3</span>, GL_UNSIGNED_SHORT, <span class=\"number\">0</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><code>glDeleteVertexArrays</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param n#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param arrays#&gt; n description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glDeleteVertexArrays(GLsizei n, <span class=\"keyword\">const</span> GLuint *arrays);</span><br></pre></td></tr></table></figure>\n<h1></h1>\n<p><code>glBufferData</code><code>glBufferSubData</code><code>glBufferData</code><code>glBufferSubData</code></p>\n<ul>\n<li></li>\n<li>GPU</li>\n</ul>\n<p><code>glMapBufferRange</code><code>glUnmapBuffer</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param target#&gt; GL_ARRAY_BUFFER, GL_ELEMENT_ARRAY_BUFFER, GL_COPY_READ_BUFFER, GL_COPY_WRITE_BUFFER, GL_PIXEL_PACK_BUFFER, GL_PIXEL_UNPACK_BUFFER, GL_TRANSFORM_FEEDBACK_BUFFER, GL_UNIFORM_BUFFER description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param offset#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param length#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param access#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return GLvoid *</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glMapBufferRange(GLenum target, GLintptr offset, GLsizeiptr length, GLbitfield access);</span><br></pre></td></tr></table></figure>\n<table>\n<thead>\n<tr>\n<th></th>\n<th></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>GL_MAP_READ_BIT</td>\n<td></td>\n</tr>\n<tr>\n<td>GL_MAP_WRITE_BIT</td>\n<td></td>\n</tr>\n</tbody>\n</table>\n<p></p>\n<table>\n<thead>\n<tr>\n<th></th>\n<th></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>GL_MAP_INVALIDATAE_RANGE_BIT</td>\n<td>GL_MAP_READ_BIT</td>\n</tr>\n<tr>\n<td>GL_MAP_INVALIDATE_BUFFER_BIT</td>\n<td>GL_MAP_READ_BIT</td>\n</tr>\n<tr>\n<td>GL_MAP_FLUSH_EXPLICIT_BIT</td>\n<td>glFlushMappedBufferRangeGL_MAP_WRITE_BIT</td>\n</tr>\n<tr>\n<td>GL_MAP_UNSYNCHRONIZED_BIT</td>\n<td></td>\n</tr>\n</tbody>\n</table>\n<p><code>glMapBufferRange</code>NULL<code>glUnmapBuffer</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param target#&gt; GL_ARRAY_BUFFER description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return GLboolean</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glUnmapBuffer(GLenum target);</span><br></pre></td></tr></table></figure>\n<p><code>glUnmapBuffer</code><code>GL_TRUE</code><code>glMapBufferRange</code><code>glUnmapBuffer</code><code>GL_FALSE</code>OpenGL ES</p>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">GLfloat *vtxMappedBuf;</span><br><span class=\"line\">GLushort *idxMappedBuf;</span><br><span class=\"line\">GLfloat vertices[] = &#123;</span><br><span class=\"line\">    <span class=\"number\">0.0</span>f, <span class=\"number\">0.5</span>f, <span class=\"number\">0.0</span>f,</span><br><span class=\"line\">    <span class=\"number\">1.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">1.0</span>f,</span><br><span class=\"line\">    <span class=\"number\">-0.5</span>f, <span class=\"number\">-0.5</span>f, <span class=\"number\">0.0</span>f,</span><br><span class=\"line\">    <span class=\"number\">0.0</span>f, <span class=\"number\">1.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">1.0</span>f,</span><br><span class=\"line\">    <span class=\"number\">0.5</span>f, <span class=\"number\">-0.5</span>f, <span class=\"number\">0.0</span>f,</span><br><span class=\"line\">    <span class=\"number\">0.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">1.0</span>f, <span class=\"number\">1.0</span>f</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\">GLushort indices[<span class=\"number\">3</span>] = &#123; <span class=\"number\">0</span>, <span class=\"number\">1</span>, <span class=\"number\">2</span> &#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">glGenBuffers(<span class=\"number\">2</span>, vboIds);</span><br><span class=\"line\">glBindBuffer(GL_ARRAY_BUFFER, vboIds[<span class=\"number\">0</span>]);</span><br><span class=\"line\">glBufferData(GL_ARRAY_BUFFER, <span class=\"keyword\">sizeof</span>(vertices), <span class=\"literal\">NULL</span>, GL_STATIC_DRAW);</span><br><span class=\"line\">vtxMappedBuf = (GLfloat *)glMapBufferRange(GL_ARRAY_BUFFER, <span class=\"number\">0</span>, <span class=\"keyword\">sizeof</span>(vertices), GL_MAP_WRITE_BIT | GL_MAP_INVALIDATE_BUFFER_BIT);</span><br><span class=\"line\"><span class=\"keyword\">if</span> (vtxMappedBuf == <span class=\"literal\">NULL</span>) &#123;</span><br><span class=\"line\">    <span class=\"built_in\">NSLog</span>(<span class=\"string\">@\"Error mapping vertex buffer object\"</span>);</span><br><span class=\"line\">    <span class=\"keyword\">return</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">memcpy(vtxMappedBuf, vertices, <span class=\"keyword\">sizeof</span>(vertices));</span><br><span class=\"line\"><span class=\"keyword\">if</span> (glUnmapBuffer(GL_ARRAY_BUFFER) == GL_FALSE) &#123;</span><br><span class=\"line\">    <span class=\"built_in\">NSLog</span>(<span class=\"string\">@\"Error unmapping array buffer object\"</span>);</span><br><span class=\"line\">    <span class=\"keyword\">return</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, vboIds[<span class=\"number\">1</span>]);</span><br><span class=\"line\">glBufferData(GL_ELEMENT_ARRAY_BUFFER, <span class=\"keyword\">sizeof</span>(indices), <span class=\"literal\">NULL</span>, GL_STATIC_DRAW);</span><br><span class=\"line\">idxMappedBuf = (GLushort *)glMapBufferRange(GL_ELEMENT_ARRAY_BUFFER, <span class=\"number\">0</span>, <span class=\"keyword\">sizeof</span>(indices), GL_MAP_WRITE_BIT | GL_MAP_INVALIDATE_BUFFER_BIT);</span><br><span class=\"line\"><span class=\"keyword\">if</span> (idxMappedBuf == <span class=\"literal\">NULL</span>) &#123;</span><br><span class=\"line\">    <span class=\"built_in\">NSLog</span>(<span class=\"string\">@\"Error mapping element buffer object\"</span>);</span><br><span class=\"line\">    <span class=\"keyword\">return</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">memcpy(idxMappedBuf, indices, <span class=\"keyword\">sizeof</span>(indices));</span><br><span class=\"line\"><span class=\"keyword\">if</span> (glUnmapBuffer(GL_ELEMENT_ARRAY_BUFFER) == GL_FALSE) &#123;</span><br><span class=\"line\">    <span class=\"built_in\">NSLog</span>(<span class=\"string\">@\"Error unmapping element buffer object\"</span>);</span><br><span class=\"line\">    <span class=\"keyword\">return</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2></h2>\n<p><code>glMapBufferRange</code><code>glUnmapBuffer</code><code>GL_MAP_FLUSH_EXPLICIT_BIT</code><code>GL_MAP_WRITE_BIT</code><code>glFlushMappedBufferRange</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param target#&gt; GL_ARRAY_BUFFER, GL_ELEMENT_ARRAY_BUFFER, GL_COPY_READ_BUFFER, GL_COPY_WRITE_BUFFER, GL_PIXEL_PACK_BUFFER, GL_PIXEL_UNPACK_BUFFER, GL_TRANSFORM_FEEDBACK_BUFFER, GL_UNIFORM_BUFFER description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param offset#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param length#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glFlushMappedBufferRange(GLenum target, GLintptr offset, GLsizeiptr length);</span><br></pre></td></tr></table></figure>\n<p><code>GL_MAP_FLUSH_EXPLICIT_BIT</code><code>glFlushMappedBufferRange</code></p>\n<h1></h1>\n<p><code>glBufferData</code><code>glBufferSubData</code><code>glMapBufferRange</code>OpenGL ES 3.0</p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param readTarget#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param writeTarget#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param readOffset#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param writeOffset#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param size#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glCopyBufferSubData(GLenum readTarget, GLenum writeTarget, GLintptr readOffset, GLintptr writeOffset, GLsizeiptr size);</span><br></pre></td></tr></table></figure>\n<p><code>glCopyBufferSubData</code><code>readtarget</code><code>writetarget</code><code>glBindBuffer</code><code>GL_COPY_READ_BUFFER</code><code>GL_COPY_WRITE_BUFFER</code></p>\n<h1></h1>\n<p></p>\n"},{"title":"OpenGL ES--","catalog":true,"toc_nav_num":true,"date":"2019-08-03T07:45:11.000Z","subtitle":"About OpenGL ES","header-img":"/img/article_header/article_header.png","busuanzi":true,"_content":"\n> \n\n# \n\n\n- --\n- --\n- --\n- --\n\n\n\n![OpenGL ES 3.0](/img/article/20190803/1.png)\n\n## \n\n\n\n### \n\nOpenGL ES 3.0\n- `gl_VertexID``highp`\n- `gl_InstanceID`0`gl_InstanceID``highp`\n- `gl_Position``gl_Position``gl_Position``gl_Position``highp`\n- `gl_PointSize``gl_PointSize`OpenGL ES 3.0`gl_PointSize``highp`\n- `gl_FrontFacing`\n\n### \n\n`gl_DepthRange``gl_DepthRangeParameters`\n\n``` objc\nstruct gl_DepthRangeParameters {\n    highp float near; // near Z\n    highp float far;  // far Z\n    highp float diff; // far - near\n}\n\nuniform gl_DepthRangeParameters gl_DepthRange;\n```\n\n### \n\n\n\n``` objc\nconst mediump int gl_MaxVertexAttribs = 16;\nconst mediump int gl_MaxVertexUniformVectors = 256;\nconst mediump int gl_MaxVertexOutputVectors = 16;\nconst mediump int gl_MaxVertexTextureImageUnits = 16;\nconst mediump int gl_MaxCombinedTextureImageUnits = 32;\n```\n\n\n- `gl_MaxVertexAttribs`ES 3.016\n- `gl_MaxVertexUniformVectors``vec4`ES 3.0256`vec4`\n- `gl_MaxVertexOutputVectors`--`vec4`ES 3.016`vec4`\n- `gl_MaxVertexTextureImageUnits`16\n- `gl_MaxCombinedTextureImageUnits`32.\n\nOpenGL ES 3.0`glGetIntegerv``GL_MAX_VERTEX_ATTRIBS``GL_MAX_VERTEX_UNIFORM_VECTORS``GL_MAX_VARYING_VECTORS``GL_MAX_VERTEX_TEXTURE_IMAGE_UNITS``GL_MAX_COMBINED_TEXTURE_IMAGE_UNITS`\n\n## \n\n`gl_MaxVertexUniformVectors`OpenGL ES 3.0`gl_MaxVertexUnifromVectors`256`vec4`\n- \n- \n- \n- \n\n`const``gl_MaxVertexUniformVectors`\n\nOpenGL ES 3.00.01.0\n\n# \n\niOS`GLKViewController`\n\n## \n\n4x4\n\n``` objc\n// glsl.vsh\n#version 300 es\n\nuniform mat4 u_mvpMatrix;\n\nlayout(location = 0) in vec4 a_position;\nlayout(location = 1) in vec4 a_color;\n\nout vec4 v_color;\n\nvoid main() {\n    v_color = a_color;\n    gl_Position = u_mvpMatrix * a_position;\n}\n```\n\n\n\n``` objc\nself.elapsedTime += self.timeSinceLastUpdate;\nfloat varyingFactor = sin(self.elapsedTime);\n// \nGLKMatrix4 scaleMatrix = GLKMatrix4MakeScale(varyingFactor, varyingFactor, 1.0);\n// \nGLKMatrix4 rotateMatrix = GLKMatrix4MakeRotation(varyingFactor, 0, 0, 1.0);\n// \nGLKMatrix4 translateMatrix = GLKMatrix4MakeTranslation(varyingFactor, 0, 0);\n// \nself.transformMatrix = GLKMatrix4Multiply(translateMatrix, rotateMatrix);\nself.transformMatrix = GLKMatrix4Multiply(self.transformMatrix, scaleMatrix);\n```\n\n# ","source":"_posts/2019/opengl-es-vertex-shader-0803.md","raw":"---\ntitle: \"OpenGL ES--\"\ncatalog: true\ntoc_nav_num: true\ndate: 2019-08-03 15:45:11\nsubtitle: \"About OpenGL ES\"\nheader-img: \"/img/article_header/article_header.png\"\nbusuanzi: true\ntags:\n- iOS\n\n---\n\n> \n\n# \n\n\n- --\n- --\n- --\n- --\n\n\n\n![OpenGL ES 3.0](/img/article/20190803/1.png)\n\n## \n\n\n\n### \n\nOpenGL ES 3.0\n- `gl_VertexID``highp`\n- `gl_InstanceID`0`gl_InstanceID``highp`\n- `gl_Position``gl_Position``gl_Position``gl_Position``highp`\n- `gl_PointSize``gl_PointSize`OpenGL ES 3.0`gl_PointSize``highp`\n- `gl_FrontFacing`\n\n### \n\n`gl_DepthRange``gl_DepthRangeParameters`\n\n``` objc\nstruct gl_DepthRangeParameters {\n    highp float near; // near Z\n    highp float far;  // far Z\n    highp float diff; // far - near\n}\n\nuniform gl_DepthRangeParameters gl_DepthRange;\n```\n\n### \n\n\n\n``` objc\nconst mediump int gl_MaxVertexAttribs = 16;\nconst mediump int gl_MaxVertexUniformVectors = 256;\nconst mediump int gl_MaxVertexOutputVectors = 16;\nconst mediump int gl_MaxVertexTextureImageUnits = 16;\nconst mediump int gl_MaxCombinedTextureImageUnits = 32;\n```\n\n\n- `gl_MaxVertexAttribs`ES 3.016\n- `gl_MaxVertexUniformVectors``vec4`ES 3.0256`vec4`\n- `gl_MaxVertexOutputVectors`--`vec4`ES 3.016`vec4`\n- `gl_MaxVertexTextureImageUnits`16\n- `gl_MaxCombinedTextureImageUnits`32.\n\nOpenGL ES 3.0`glGetIntegerv``GL_MAX_VERTEX_ATTRIBS``GL_MAX_VERTEX_UNIFORM_VECTORS``GL_MAX_VARYING_VECTORS``GL_MAX_VERTEX_TEXTURE_IMAGE_UNITS``GL_MAX_COMBINED_TEXTURE_IMAGE_UNITS`\n\n## \n\n`gl_MaxVertexUniformVectors`OpenGL ES 3.0`gl_MaxVertexUnifromVectors`256`vec4`\n- \n- \n- \n- \n\n`const``gl_MaxVertexUniformVectors`\n\nOpenGL ES 3.00.01.0\n\n# \n\niOS`GLKViewController`\n\n## \n\n4x4\n\n``` objc\n// glsl.vsh\n#version 300 es\n\nuniform mat4 u_mvpMatrix;\n\nlayout(location = 0) in vec4 a_position;\nlayout(location = 1) in vec4 a_color;\n\nout vec4 v_color;\n\nvoid main() {\n    v_color = a_color;\n    gl_Position = u_mvpMatrix * a_position;\n}\n```\n\n\n\n``` objc\nself.elapsedTime += self.timeSinceLastUpdate;\nfloat varyingFactor = sin(self.elapsedTime);\n// \nGLKMatrix4 scaleMatrix = GLKMatrix4MakeScale(varyingFactor, varyingFactor, 1.0);\n// \nGLKMatrix4 rotateMatrix = GLKMatrix4MakeRotation(varyingFactor, 0, 0, 1.0);\n// \nGLKMatrix4 translateMatrix = GLKMatrix4MakeTranslation(varyingFactor, 0, 0);\n// \nself.transformMatrix = GLKMatrix4Multiply(translateMatrix, rotateMatrix);\nself.transformMatrix = GLKMatrix4Multiply(self.transformMatrix, scaleMatrix);\n```\n\n# ","slug":"2019/opengl-es-vertex-shader-0803","published":1,"updated":"2021-06-21T12:34:52.098Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckszp3ndi0015ifntgcux7a4k","content":"<blockquote>\n<p></p>\n</blockquote>\n<h1 id=\"\"></h1>\n<p></p>\n<ul>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n<p></p>\n<p><img src=\"/img/article/20190803/1.png\" alt=\"OpenGL ES 3.0\"></p>\n<h2 id=\"\"></h2>\n<p></p>\n<h3 id=\"\"></h3>\n<p>OpenGL ES 3.0</p>\n<ul>\n<li><code>gl_VertexID</code><code>highp</code></li>\n<li><code>gl_InstanceID</code>0<code>gl_InstanceID</code><code>highp</code></li>\n<li><code>gl_Position</code><code>gl_Position</code><code>gl_Position</code><code>gl_Position</code><code>highp</code></li>\n<li><code>gl_PointSize</code><code>gl_PointSize</code>OpenGL ES 3.0<code>gl_PointSize</code><code>highp</code></li>\n<li><code>gl_FrontFacing</code></li>\n</ul>\n<h3 id=\"\"></h3>\n<p><code>gl_DepthRange</code><code>gl_DepthRangeParameters</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">struct</span> gl_DepthRangeParameters &#123;</span><br><span class=\"line\">    highp <span class=\"keyword\">float</span> near; <span class=\"comment\">// near Z</span></span><br><span class=\"line\">    highp <span class=\"keyword\">float</span> far;  <span class=\"comment\">// far Z</span></span><br><span class=\"line\">    highp <span class=\"keyword\">float</span> diff; <span class=\"comment\">// far - near</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">uniform gl_DepthRangeParameters gl_DepthRange;</span><br></pre></td></tr></table></figure>\n<h3 id=\"\"></h3>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> mediump <span class=\"keyword\">int</span> gl_MaxVertexAttribs = <span class=\"number\">16</span>;</span><br><span class=\"line\"><span class=\"keyword\">const</span> mediump <span class=\"keyword\">int</span> gl_MaxVertexUniformVectors = <span class=\"number\">256</span>;</span><br><span class=\"line\"><span class=\"keyword\">const</span> mediump <span class=\"keyword\">int</span> gl_MaxVertexOutputVectors = <span class=\"number\">16</span>;</span><br><span class=\"line\"><span class=\"keyword\">const</span> mediump <span class=\"keyword\">int</span> gl_MaxVertexTextureImageUnits = <span class=\"number\">16</span>;</span><br><span class=\"line\"><span class=\"keyword\">const</span> mediump <span class=\"keyword\">int</span> gl_MaxCombinedTextureImageUnits = <span class=\"number\">32</span>;</span><br></pre></td></tr></table></figure>\n<p></p>\n<ul>\n<li><code>gl_MaxVertexAttribs</code>ES 3.016</li>\n<li><code>gl_MaxVertexUniformVectors</code><code>vec4</code>ES 3.0256<code>vec4</code></li>\n<li><code>gl_MaxVertexOutputVectors</code><code>vec4</code>ES 3.016<code>vec4</code></li>\n<li><code>gl_MaxVertexTextureImageUnits</code>16</li>\n<li><code>gl_MaxCombinedTextureImageUnits</code>32.</li>\n</ul>\n<p>OpenGL ES 3.0<code>glGetIntegerv</code><code>GL_MAX_VERTEX_ATTRIBS</code><code>GL_MAX_VERTEX_UNIFORM_VECTORS</code><code>GL_MAX_VARYING_VECTORS</code><code>GL_MAX_VERTEX_TEXTURE_IMAGE_UNITS</code><code>GL_MAX_COMBINED_TEXTURE_IMAGE_UNITS</code></p>\n<h2 id=\"\"></h2>\n<p><code>gl_MaxVertexUniformVectors</code>OpenGL ES 3.0<code>gl_MaxVertexUnifromVectors</code>256<code>vec4</code></p>\n<ul>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n<p><code>const</code><code>gl_MaxVertexUniformVectors</code></p>\n<p>OpenGL ES 3.00.01.0</p>\n<h1 id=\"\"></h1>\n<p>iOS<code>GLKViewController</code></p>\n<h2 id=\"\"></h2>\n<p>4x4</p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// glsl.vsh</span></span><br><span class=\"line\"><span class=\"meta\">#version 300 es</span></span><br><span class=\"line\"></span><br><span class=\"line\">uniform mat4 u_mvpMatrix;</span><br><span class=\"line\"></span><br><span class=\"line\">layout(location = <span class=\"number\">0</span>) <span class=\"keyword\">in</span> vec4 a_position;</span><br><span class=\"line\">layout(location = <span class=\"number\">1</span>) <span class=\"keyword\">in</span> vec4 a_color;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">out</span> vec4 v_color;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">void</span> main() &#123;</span><br><span class=\"line\">    v_color = a_color;</span><br><span class=\"line\">    gl_Position = u_mvpMatrix * a_position;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">self</span>.elapsedTime += <span class=\"keyword\">self</span>.timeSinceLastUpdate;</span><br><span class=\"line\"><span class=\"keyword\">float</span> varyingFactor = sin(<span class=\"keyword\">self</span>.elapsedTime);</span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\">GLKMatrix4 scaleMatrix = GLKMatrix4MakeScale(varyingFactor, varyingFactor, <span class=\"number\">1.0</span>);</span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\">GLKMatrix4 rotateMatrix = GLKMatrix4MakeRotation(varyingFactor, <span class=\"number\">0</span>, <span class=\"number\">0</span>, <span class=\"number\">1.0</span>);</span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\">GLKMatrix4 translateMatrix = GLKMatrix4MakeTranslation(varyingFactor, <span class=\"number\">0</span>, <span class=\"number\">0</span>);</span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">self</span>.transformMatrix = GLKMatrix4Multiply(translateMatrix, rotateMatrix);</span><br><span class=\"line\"><span class=\"keyword\">self</span>.transformMatrix = GLKMatrix4Multiply(<span class=\"keyword\">self</span>.transformMatrix, scaleMatrix);</span><br></pre></td></tr></table></figure>\n<h1 id=\"\"></h1>\n","site":{"data":{}},"excerpt":"","more":"<blockquote>\n<p></p>\n</blockquote>\n<h1></h1>\n<p></p>\n<ul>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n<p></p>\n<p><img src=\"/img/article/20190803/1.png\" alt=\"OpenGL ES 3.0\"></p>\n<h2></h2>\n<p></p>\n<h3></h3>\n<p>OpenGL ES 3.0</p>\n<ul>\n<li><code>gl_VertexID</code><code>highp</code></li>\n<li><code>gl_InstanceID</code>0<code>gl_InstanceID</code><code>highp</code></li>\n<li><code>gl_Position</code><code>gl_Position</code><code>gl_Position</code><code>gl_Position</code><code>highp</code></li>\n<li><code>gl_PointSize</code><code>gl_PointSize</code>OpenGL ES 3.0<code>gl_PointSize</code><code>highp</code></li>\n<li><code>gl_FrontFacing</code></li>\n</ul>\n<h3></h3>\n<p><code>gl_DepthRange</code><code>gl_DepthRangeParameters</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">struct</span> gl_DepthRangeParameters &#123;</span><br><span class=\"line\">    highp <span class=\"keyword\">float</span> near; <span class=\"comment\">// near Z</span></span><br><span class=\"line\">    highp <span class=\"keyword\">float</span> far;  <span class=\"comment\">// far Z</span></span><br><span class=\"line\">    highp <span class=\"keyword\">float</span> diff; <span class=\"comment\">// far - near</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">uniform gl_DepthRangeParameters gl_DepthRange;</span><br></pre></td></tr></table></figure>\n<h3></h3>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> mediump <span class=\"keyword\">int</span> gl_MaxVertexAttribs = <span class=\"number\">16</span>;</span><br><span class=\"line\"><span class=\"keyword\">const</span> mediump <span class=\"keyword\">int</span> gl_MaxVertexUniformVectors = <span class=\"number\">256</span>;</span><br><span class=\"line\"><span class=\"keyword\">const</span> mediump <span class=\"keyword\">int</span> gl_MaxVertexOutputVectors = <span class=\"number\">16</span>;</span><br><span class=\"line\"><span class=\"keyword\">const</span> mediump <span class=\"keyword\">int</span> gl_MaxVertexTextureImageUnits = <span class=\"number\">16</span>;</span><br><span class=\"line\"><span class=\"keyword\">const</span> mediump <span class=\"keyword\">int</span> gl_MaxCombinedTextureImageUnits = <span class=\"number\">32</span>;</span><br></pre></td></tr></table></figure>\n<p></p>\n<ul>\n<li><code>gl_MaxVertexAttribs</code>ES 3.016</li>\n<li><code>gl_MaxVertexUniformVectors</code><code>vec4</code>ES 3.0256<code>vec4</code></li>\n<li><code>gl_MaxVertexOutputVectors</code><code>vec4</code>ES 3.016<code>vec4</code></li>\n<li><code>gl_MaxVertexTextureImageUnits</code>16</li>\n<li><code>gl_MaxCombinedTextureImageUnits</code>32.</li>\n</ul>\n<p>OpenGL ES 3.0<code>glGetIntegerv</code><code>GL_MAX_VERTEX_ATTRIBS</code><code>GL_MAX_VERTEX_UNIFORM_VECTORS</code><code>GL_MAX_VARYING_VECTORS</code><code>GL_MAX_VERTEX_TEXTURE_IMAGE_UNITS</code><code>GL_MAX_COMBINED_TEXTURE_IMAGE_UNITS</code></p>\n<h2></h2>\n<p><code>gl_MaxVertexUniformVectors</code>OpenGL ES 3.0<code>gl_MaxVertexUnifromVectors</code>256<code>vec4</code></p>\n<ul>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n<p><code>const</code><code>gl_MaxVertexUniformVectors</code></p>\n<p>OpenGL ES 3.00.01.0</p>\n<h1></h1>\n<p>iOS<code>GLKViewController</code></p>\n<h2></h2>\n<p>4x4</p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// glsl.vsh</span></span><br><span class=\"line\"><span class=\"meta\">#version 300 es</span></span><br><span class=\"line\"></span><br><span class=\"line\">uniform mat4 u_mvpMatrix;</span><br><span class=\"line\"></span><br><span class=\"line\">layout(location = <span class=\"number\">0</span>) <span class=\"keyword\">in</span> vec4 a_position;</span><br><span class=\"line\">layout(location = <span class=\"number\">1</span>) <span class=\"keyword\">in</span> vec4 a_color;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">out</span> vec4 v_color;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">void</span> main() &#123;</span><br><span class=\"line\">    v_color = a_color;</span><br><span class=\"line\">    gl_Position = u_mvpMatrix * a_position;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">self</span>.elapsedTime += <span class=\"keyword\">self</span>.timeSinceLastUpdate;</span><br><span class=\"line\"><span class=\"keyword\">float</span> varyingFactor = sin(<span class=\"keyword\">self</span>.elapsedTime);</span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\">GLKMatrix4 scaleMatrix = GLKMatrix4MakeScale(varyingFactor, varyingFactor, <span class=\"number\">1.0</span>);</span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\">GLKMatrix4 rotateMatrix = GLKMatrix4MakeRotation(varyingFactor, <span class=\"number\">0</span>, <span class=\"number\">0</span>, <span class=\"number\">1.0</span>);</span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\">GLKMatrix4 translateMatrix = GLKMatrix4MakeTranslation(varyingFactor, <span class=\"number\">0</span>, <span class=\"number\">0</span>);</span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">self</span>.transformMatrix = GLKMatrix4Multiply(translateMatrix, rotateMatrix);</span><br><span class=\"line\"><span class=\"keyword\">self</span>.transformMatrix = GLKMatrix4Multiply(<span class=\"keyword\">self</span>.transformMatrix, scaleMatrix);</span><br></pre></td></tr></table></figure>\n<h1></h1>\n"},{"title":" AppDelegate","catalog":true,"toc_nav_num":true,"date":"2019-02-15T10:40:24.000Z","subtitle":"Refactoring Massive App Delegate","header-img":"/img/article_header/article_header.png","busuanzi":true,"_content":"\n>  Swift  AppDelegate   [@V8tr](http://www.vadimbulavin.com/refactoring-massive-app-delegate/)[Demo](https://github.com/Quincy-QC/MassiveAppDelegate)\n\n# Introduction\n\nAppDelegate  iOS \n AppDelegate \n AppDelegates \n\n# Problem Statement\n\nAppDelegate  AppDelegate \n[](https://developer.apple.com/documentation/uikit/uiapplicationdelegate?language=objc) AppDelegate \n[open-source-ios-apps](https://github.com/dkhamsing/open-source-ios-apps) AppDelegates \n- \n- \n-  UI \n-  UserDefaults\n-  token\n-  UIAppearance\n- \n- \n- \n- \n- \n- \n- \n- \n- \n\n\n AppDelegate  Massive App Delegates\n\n# Solution\n\n AppDelegate  recipes\n recipe \n-  [sigle responsibility principle](https://en.wikipedia.org/wiki/Single_responsibility_principle)\n- \n- \n\n## Recipe #1: Command Design Pattern\n\ncommand Design pattern\n AppDelegate \n\n``` Swift\nprotocol Command {\n    func execute()\n}\n\nstruct InitializeThirdPartiesCommand: Command {\n    func execute() {\n        print(\"Third parties are initialized\")\n    }\n}\n\nstruct InitialViewControllerCommand: Command {\n    let keyWindow: UIWindow\n    \n    func execute() {\n        print(\"Pick root view controller here\")\n        keyWindow.frame = UIScreen.main.bounds\n        keyWindow.backgroundColor = UIColor.white\n        keyWindow.makeKeyAndVisible()\n        keyWindow.rootViewController = ViewController()\n    }\n}\n\nstruct InitializeAppearanceCommand: Command {\n    func execute() {\n        print(\"Setup UIAppearance\")\n    }\n}\n\nstruct RegisterToRemoteNotificationsCommand: Command {\n    func execute() {\n        print(\"Register for remote notifications here\")\n    }\n}\n```\n**StartupCommandsBuilder**AppDelegate \n``` Swift\n// MARK: -------- StartupCommandsBuilder --------\n\nfinal class StartupCommandsBuilder {\n    private var window: UIWindow!\n    \n    func setKeyWindow(_ window: UIWindow) -> StartupCommandsBuilder {\n        self.window = window\n        return self\n    }\n    \n    func build() -> [Command] {\n        return [InitializeThirdPartiesCommand(),\n                InitialViewControllerCommand(keyWindow: window),\n                InitializeAppearanceCommand(),\n                RegisterToRemoteNotificationsCommand()]\n    }\n}\n\n// MARK: -------- AppDelegate --------\n\n@UIApplicationMain\nclass AppDelegate: UIResponder, UIApplicationDelegate {\n\n    var window: UIWindow?\n\n\n    func application(_ application: UIApplication, didFinishLaunchingWithOptions launchOptions: [UIApplication.LaunchOptionsKey: Any]?) -> Bool {\n        \n        StartupCommandsBuilder()\n            .setKeyWindow(window!)\n            .build()\n            .forEach { $0.execute() }\n        \n        return true\n    }\n}\n```\n AppDelegate **StartupCommandsBuilder**\n\n- \n-  AppDelegate \n- \n\n## Recipe #2: Composite Design Pattern\n\nComposite Design Pattern iOS **UIView**\n AppDelegate \n``` Swift\ntypealias AppDelegateType = UIResponder & UIApplicationDelegate\n\nclass CompositeAppDelegate: AppDelegateType {\n    private let appDelegates: [AppDelegateType]\n    \n    init(appDelegates: [AppDelegateType]) {\n        self.appDelegates = appDelegates\n    }\n    \n    func application(_ application: UIApplication, didFinishLaunchingWithOptions launchOptions: [UIApplication.LaunchOptionsKey : Any]? = nil) -> Bool {\n        appDelegates.forEach { _ = $0.application?(application, didFinishLaunchingWithOptions: launchOptions) }\n        return true\n    }\n    \n    func application(_ application: UIApplication, didRegisterForRemoteNotificationsWithDeviceToken deviceToken: Data) {\n        appDelegates.forEach { $0.application?(application, didRegisterForRemoteNotificationsWithDeviceToken: deviceToken) }\n    }\n}\n```\n AppDelegates \n``` Swift\nclass PushNotificationAppDelegate: AppDelegateType {\n    func application(_ application: UIApplication, didRegisterForRemoteNotificationsWithDeviceToken deviceToken: Data) {\n        print(\"Registed successfully\")\n    }\n}\n\nclass StartupConfiguratorAppDelegate: AppDelegateType {\n    func application(_ application: UIApplication, didFinishLaunchingWithOptions launchOptions: [UIApplication.LaunchOptionsKey : Any]? = nil) -> Bool {\n        print(\"Perform startup configurations, e.g. build UI stack, setup UIAppearance\")\n        return true\n    }\n}\n\nclass ThirdPartiesConfiguratorAppDelegate: AppDelegateType {\n    func application(_ application: UIApplication, didFinishLaunchingWithOptions launchOptions: [UIApplication.LaunchOptionsKey : Any]? = nil) -> Bool {\n        print(\"Setup third parties\")\n        return true\n    }\n}\n```\n**AppDelegateFactory** AppDelegate \n``` Swift\nenum AppDelegateFactory {\n    static func makeDefault() -> AppDelegateType {\n        return CompositeAppDelegate(appDelegates: [PushNotificationAppDelegate(), StartupConfiguratorAppDelegate(), ThirdPartiesConfiguratorAppDelegate()])\n    }\n}\n\n@UIApplicationMain\nclass AppDelegate: UIResponder, UIApplicationDelegate {\n\n    var window: UIWindow?\n    let appDelegate = AppDelegateFactory.makeDefault()\n\n    func application(_ application: UIApplication, didFinishLaunchingWithOptions launchOptions: [UIApplication.LaunchOptionsKey: Any]?) -> Bool {\n        \n        _ = appDelegate.application?(application, didFinishLaunchingWithOptions: launchOptions)\n        \n        return true\n    }\n    \n    func application(_ application: UIApplication, didRegisterForRemoteNotificationsWithDeviceToken deviceToken: Data) {\n        \n        appDelegate.application?(application, didRegisterForRemoteNotificationsWithDeviceToken: deviceToken)\n    }\n}\n```\n\n-  AppDelegate \n-  AppDelegate \n- \n\n## Recipe #3: Mediator Design Pattern\n\nMediator Design Pattern\n [Mediator Pattern Case Study](http://www.vadimbulavin.com/mediator-pattern-case-study/)\n**AppLifecycleMediator****UIApplication****AppLifecycleListener**\n``` Swift\nprotocol AppLifecycleListener {\n    func onAppWillEnterForeground()\n    func onAppDidEnterBackground()\n    func onAppDidFinishLaunching()\n}\n\nextension AppLifecycleListener {\n    func onAppWillEnterForeground() {}\n    func onAppDidEnterBackground() {}\n    func onAppDidFinishLaunching() {}\n}\n\nstruct listen1: AppLifecycleListener {\n    func onAppDidFinishLaunching() {\n        print(\"app did finish launching1\")\n    }\n    \n    func onAppWillEnterForeground() {\n        print(\"app will enter foreground\")\n    }\n}\n\nstruct listen2: AppLifecycleListener {\n    func onAppDidEnterBackground() {\n        print(\"app did enter background\")\n    }\n}\n\nstruct listen3: AppLifecycleListener {\n    func onAppDidFinishLaunching() {\n        print(\"app did finish launching2\")\n    }\n}\n\nclass AppLifecycleMediator: NSObject {\n    private let listeners: [AppLifecycleListener]\n    \n    init(listeners: [AppLifecycleListener]) {\n        self.listeners = listeners\n        super.init()\n        subscribe()\n    }\n    \n    deinit {\n        NotificationCenter.default.removeObserver(self)\n    }\n    \n    private func subscribe() {\n        NotificationCenter.default.addObserver(self, selector: #selector(onAppWillEnterForeground), name: UIApplication.willEnterForegroundNotification, object: nil)\n        NotificationCenter.default.addObserver(self, selector: #selector(onAppDidEnterBackground), name: UIApplication.didEnterBackgroundNotification, object: nil)\n        NotificationCenter.default.addObserver(self, selector: #selector(onAppDidFinishLaunching), name: UIApplication.didFinishLaunchingNotification, object: nil)\n    }\n    \n    @objc func onAppWillEnterForeground() {\n        listeners.forEach { $0.onAppWillEnterForeground() }\n    }\n    \n    @objc func onAppDidEnterBackground() {\n        listeners.forEach { $0.onAppDidEnterBackground() }\n    }\n    \n    @objc func onAppDidFinishLaunching() {\n        listeners.forEach { $0.onAppDidFinishLaunching() }\n    }\n}\n\nextension AppLifecycleMediator {\n    static func makeDefaultMediator() -> AppLifecycleMediator {\n        return AppLifecycleMediator(listeners: [listen1(), listen2(), listen3()])\n    }\n}\n```\n**AppDelegate**\n``` Swift\n@UIApplicationMain\nclass AppDelegate: UIResponder, UIApplicationDelegate {\n\n    var window: UIWindow?\n\n    let mediator = AppLifecycleMediator.makeDefaultMediator()\n\n    func application(_ application: UIApplication, didFinishLaunchingWithOptions launchOptions: [UIApplication.LaunchOptionsKey: Any]?) -> Bool {\n\n        return true\n    }\n}\n```\n**AppDelegate**\n\n- \n-  AppDelegate \n- \n\n# Summary\n**AppDelegate****AppDelegate**\n\n# Reference\n[Refactoring Massive App Delegate](http://www.vadimbulavin.com/refactoring-massive-app-delegate/)","source":"_posts/2019/refactoring-massive-app-delegate-0215.md","raw":"---\ntitle: \" AppDelegate\"\ncatalog: true\ntoc_nav_num: true\ndate: 2019-02-15 18:40:24\nsubtitle: \"Refactoring Massive App Delegate\"\nheader-img: \"/img/article_header/article_header.png\"\nbusuanzi: true\ntags:\n- iOS - Swift\n\n---\n\n>  Swift  AppDelegate   [@V8tr](http://www.vadimbulavin.com/refactoring-massive-app-delegate/)[Demo](https://github.com/Quincy-QC/MassiveAppDelegate)\n\n# Introduction\n\nAppDelegate  iOS \n AppDelegate \n AppDelegates \n\n# Problem Statement\n\nAppDelegate  AppDelegate \n[](https://developer.apple.com/documentation/uikit/uiapplicationdelegate?language=objc) AppDelegate \n[open-source-ios-apps](https://github.com/dkhamsing/open-source-ios-apps) AppDelegates \n- \n- \n-  UI \n-  UserDefaults\n-  token\n-  UIAppearance\n- \n- \n- \n- \n- \n- \n- \n- \n- \n\n\n AppDelegate  Massive App Delegates\n\n# Solution\n\n AppDelegate  recipes\n recipe \n-  [sigle responsibility principle](https://en.wikipedia.org/wiki/Single_responsibility_principle)\n- \n- \n\n## Recipe #1: Command Design Pattern\n\ncommand Design pattern\n AppDelegate \n\n``` Swift\nprotocol Command {\n    func execute()\n}\n\nstruct InitializeThirdPartiesCommand: Command {\n    func execute() {\n        print(\"Third parties are initialized\")\n    }\n}\n\nstruct InitialViewControllerCommand: Command {\n    let keyWindow: UIWindow\n    \n    func execute() {\n        print(\"Pick root view controller here\")\n        keyWindow.frame = UIScreen.main.bounds\n        keyWindow.backgroundColor = UIColor.white\n        keyWindow.makeKeyAndVisible()\n        keyWindow.rootViewController = ViewController()\n    }\n}\n\nstruct InitializeAppearanceCommand: Command {\n    func execute() {\n        print(\"Setup UIAppearance\")\n    }\n}\n\nstruct RegisterToRemoteNotificationsCommand: Command {\n    func execute() {\n        print(\"Register for remote notifications here\")\n    }\n}\n```\n**StartupCommandsBuilder**AppDelegate \n``` Swift\n// MARK: -------- StartupCommandsBuilder --------\n\nfinal class StartupCommandsBuilder {\n    private var window: UIWindow!\n    \n    func setKeyWindow(_ window: UIWindow) -> StartupCommandsBuilder {\n        self.window = window\n        return self\n    }\n    \n    func build() -> [Command] {\n        return [InitializeThirdPartiesCommand(),\n                InitialViewControllerCommand(keyWindow: window),\n                InitializeAppearanceCommand(),\n                RegisterToRemoteNotificationsCommand()]\n    }\n}\n\n// MARK: -------- AppDelegate --------\n\n@UIApplicationMain\nclass AppDelegate: UIResponder, UIApplicationDelegate {\n\n    var window: UIWindow?\n\n\n    func application(_ application: UIApplication, didFinishLaunchingWithOptions launchOptions: [UIApplication.LaunchOptionsKey: Any]?) -> Bool {\n        \n        StartupCommandsBuilder()\n            .setKeyWindow(window!)\n            .build()\n            .forEach { $0.execute() }\n        \n        return true\n    }\n}\n```\n AppDelegate **StartupCommandsBuilder**\n\n- \n-  AppDelegate \n- \n\n## Recipe #2: Composite Design Pattern\n\nComposite Design Pattern iOS **UIView**\n AppDelegate \n``` Swift\ntypealias AppDelegateType = UIResponder & UIApplicationDelegate\n\nclass CompositeAppDelegate: AppDelegateType {\n    private let appDelegates: [AppDelegateType]\n    \n    init(appDelegates: [AppDelegateType]) {\n        self.appDelegates = appDelegates\n    }\n    \n    func application(_ application: UIApplication, didFinishLaunchingWithOptions launchOptions: [UIApplication.LaunchOptionsKey : Any]? = nil) -> Bool {\n        appDelegates.forEach { _ = $0.application?(application, didFinishLaunchingWithOptions: launchOptions) }\n        return true\n    }\n    \n    func application(_ application: UIApplication, didRegisterForRemoteNotificationsWithDeviceToken deviceToken: Data) {\n        appDelegates.forEach { $0.application?(application, didRegisterForRemoteNotificationsWithDeviceToken: deviceToken) }\n    }\n}\n```\n AppDelegates \n``` Swift\nclass PushNotificationAppDelegate: AppDelegateType {\n    func application(_ application: UIApplication, didRegisterForRemoteNotificationsWithDeviceToken deviceToken: Data) {\n        print(\"Registed successfully\")\n    }\n}\n\nclass StartupConfiguratorAppDelegate: AppDelegateType {\n    func application(_ application: UIApplication, didFinishLaunchingWithOptions launchOptions: [UIApplication.LaunchOptionsKey : Any]? = nil) -> Bool {\n        print(\"Perform startup configurations, e.g. build UI stack, setup UIAppearance\")\n        return true\n    }\n}\n\nclass ThirdPartiesConfiguratorAppDelegate: AppDelegateType {\n    func application(_ application: UIApplication, didFinishLaunchingWithOptions launchOptions: [UIApplication.LaunchOptionsKey : Any]? = nil) -> Bool {\n        print(\"Setup third parties\")\n        return true\n    }\n}\n```\n**AppDelegateFactory** AppDelegate \n``` Swift\nenum AppDelegateFactory {\n    static func makeDefault() -> AppDelegateType {\n        return CompositeAppDelegate(appDelegates: [PushNotificationAppDelegate(), StartupConfiguratorAppDelegate(), ThirdPartiesConfiguratorAppDelegate()])\n    }\n}\n\n@UIApplicationMain\nclass AppDelegate: UIResponder, UIApplicationDelegate {\n\n    var window: UIWindow?\n    let appDelegate = AppDelegateFactory.makeDefault()\n\n    func application(_ application: UIApplication, didFinishLaunchingWithOptions launchOptions: [UIApplication.LaunchOptionsKey: Any]?) -> Bool {\n        \n        _ = appDelegate.application?(application, didFinishLaunchingWithOptions: launchOptions)\n        \n        return true\n    }\n    \n    func application(_ application: UIApplication, didRegisterForRemoteNotificationsWithDeviceToken deviceToken: Data) {\n        \n        appDelegate.application?(application, didRegisterForRemoteNotificationsWithDeviceToken: deviceToken)\n    }\n}\n```\n\n-  AppDelegate \n-  AppDelegate \n- \n\n## Recipe #3: Mediator Design Pattern\n\nMediator Design Pattern\n [Mediator Pattern Case Study](http://www.vadimbulavin.com/mediator-pattern-case-study/)\n**AppLifecycleMediator****UIApplication****AppLifecycleListener**\n``` Swift\nprotocol AppLifecycleListener {\n    func onAppWillEnterForeground()\n    func onAppDidEnterBackground()\n    func onAppDidFinishLaunching()\n}\n\nextension AppLifecycleListener {\n    func onAppWillEnterForeground() {}\n    func onAppDidEnterBackground() {}\n    func onAppDidFinishLaunching() {}\n}\n\nstruct listen1: AppLifecycleListener {\n    func onAppDidFinishLaunching() {\n        print(\"app did finish launching1\")\n    }\n    \n    func onAppWillEnterForeground() {\n        print(\"app will enter foreground\")\n    }\n}\n\nstruct listen2: AppLifecycleListener {\n    func onAppDidEnterBackground() {\n        print(\"app did enter background\")\n    }\n}\n\nstruct listen3: AppLifecycleListener {\n    func onAppDidFinishLaunching() {\n        print(\"app did finish launching2\")\n    }\n}\n\nclass AppLifecycleMediator: NSObject {\n    private let listeners: [AppLifecycleListener]\n    \n    init(listeners: [AppLifecycleListener]) {\n        self.listeners = listeners\n        super.init()\n        subscribe()\n    }\n    \n    deinit {\n        NotificationCenter.default.removeObserver(self)\n    }\n    \n    private func subscribe() {\n        NotificationCenter.default.addObserver(self, selector: #selector(onAppWillEnterForeground), name: UIApplication.willEnterForegroundNotification, object: nil)\n        NotificationCenter.default.addObserver(self, selector: #selector(onAppDidEnterBackground), name: UIApplication.didEnterBackgroundNotification, object: nil)\n        NotificationCenter.default.addObserver(self, selector: #selector(onAppDidFinishLaunching), name: UIApplication.didFinishLaunchingNotification, object: nil)\n    }\n    \n    @objc func onAppWillEnterForeground() {\n        listeners.forEach { $0.onAppWillEnterForeground() }\n    }\n    \n    @objc func onAppDidEnterBackground() {\n        listeners.forEach { $0.onAppDidEnterBackground() }\n    }\n    \n    @objc func onAppDidFinishLaunching() {\n        listeners.forEach { $0.onAppDidFinishLaunching() }\n    }\n}\n\nextension AppLifecycleMediator {\n    static func makeDefaultMediator() -> AppLifecycleMediator {\n        return AppLifecycleMediator(listeners: [listen1(), listen2(), listen3()])\n    }\n}\n```\n**AppDelegate**\n``` Swift\n@UIApplicationMain\nclass AppDelegate: UIResponder, UIApplicationDelegate {\n\n    var window: UIWindow?\n\n    let mediator = AppLifecycleMediator.makeDefaultMediator()\n\n    func application(_ application: UIApplication, didFinishLaunchingWithOptions launchOptions: [UIApplication.LaunchOptionsKey: Any]?) -> Bool {\n\n        return true\n    }\n}\n```\n**AppDelegate**\n\n- \n-  AppDelegate \n- \n\n# Summary\n**AppDelegate****AppDelegate**\n\n# Reference\n[Refactoring Massive App Delegate](http://www.vadimbulavin.com/refactoring-massive-app-delegate/)","slug":"2019/refactoring-massive-app-delegate-0215","published":1,"updated":"2021-06-21T12:34:52.098Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckszp3ndj0017ifntmu76zye6","content":"<blockquote>\n<p> Swift  AppDelegate   <a href=\"http://www.vadimbulavin.com/refactoring-massive-app-delegate/\" target=\"_blank\" rel=\"noopener\">@V8tr</a><a href=\"https://github.com/Quincy-QC/MassiveAppDelegate\" target=\"_blank\" rel=\"noopener\">Demo</a></p>\n</blockquote>\n<h1 id=\"introduction\">Introduction</h1>\n<p>AppDelegate  iOS <br>\n AppDelegate <br>\n AppDelegates </p>\n<h1 id=\"problem-statement\">Problem Statement</h1>\n<p>AppDelegate  AppDelegate <br>\n<a href=\"https://developer.apple.com/documentation/uikit/uiapplicationdelegate?language=objc\" target=\"_blank\" rel=\"noopener\"></a> AppDelegate <br>\n<a href=\"https://github.com/dkhamsing/open-source-ios-apps\" target=\"_blank\" rel=\"noopener\">open-source-ios-apps</a> AppDelegates </p>\n<ul>\n<li></li>\n<li></li>\n<li> UI </li>\n<li> UserDefaults</li>\n<li> token</li>\n<li> UIAppearance</li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n<p><br>\n AppDelegate  Massive App Delegates</p>\n<h1 id=\"solution\">Solution</h1>\n<p> AppDelegate  recipes<br>\n recipe </p>\n<ul>\n<li> <a href=\"https://en.wikipedia.org/wiki/Single_responsibility_principle\" target=\"_blank\" rel=\"noopener\">sigle responsibility principle</a></li>\n<li></li>\n<li></li>\n</ul>\n<h2 id=\"recipe-1-command-design-pattern\">Recipe #1: Command Design Pattern</h2>\n<p>command Design pattern<br>\n AppDelegate </p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">protocol</span> <span class=\"title\">Command</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">execute</span><span class=\"params\">()</span></span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">InitializeThirdPartiesCommand</span>: <span class=\"title\">Command</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">execute</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">print</span>(<span class=\"string\">\"Third parties are initialized\"</span>)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">InitialViewControllerCommand</span>: <span class=\"title\">Command</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> keyWindow: <span class=\"type\">UIWindow</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">execute</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">print</span>(<span class=\"string\">\"Pick root view controller here\"</span>)</span><br><span class=\"line\">        keyWindow.frame = <span class=\"type\">UIScreen</span>.main.bounds</span><br><span class=\"line\">        keyWindow.backgroundColor = <span class=\"type\">UIColor</span>.white</span><br><span class=\"line\">        keyWindow.makeKeyAndVisible()</span><br><span class=\"line\">        keyWindow.rootViewController = <span class=\"type\">ViewController</span>()</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">InitializeAppearanceCommand</span>: <span class=\"title\">Command</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">execute</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">print</span>(<span class=\"string\">\"Setup UIAppearance\"</span>)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">RegisterToRemoteNotificationsCommand</span>: <span class=\"title\">Command</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">execute</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">print</span>(<span class=\"string\">\"Register for remote notifications here\"</span>)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><strong>StartupCommandsBuilder</strong>AppDelegate </p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// MARK: -------- StartupCommandsBuilder --------</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">final</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">StartupCommandsBuilder</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">var</span> window: <span class=\"type\">UIWindow</span>!</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">setKeyWindow</span><span class=\"params\">(<span class=\"number\">_</span> window: UIWindow)</span></span> -&gt; <span class=\"type\">StartupCommandsBuilder</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">self</span>.window = window</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">self</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">build</span><span class=\"params\">()</span></span> -&gt; [<span class=\"type\">Command</span>] &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> [<span class=\"type\">InitializeThirdPartiesCommand</span>(),</span><br><span class=\"line\">                <span class=\"type\">InitialViewControllerCommand</span>(keyWindow: window),</span><br><span class=\"line\">                <span class=\"type\">InitializeAppearanceCommand</span>(),</span><br><span class=\"line\">                <span class=\"type\">RegisterToRemoteNotificationsCommand</span>()]</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// MARK: -------- AppDelegate --------</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@UIApplicationMain</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">AppDelegate</span>: <span class=\"title\">UIResponder</span>, <span class=\"title\">UIApplicationDelegate</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">var</span> window: <span class=\"type\">UIWindow</span>?</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">application</span><span class=\"params\">(<span class=\"number\">_</span> application: UIApplication, didFinishLaunchingWithOptions launchOptions: [UIApplication.LaunchOptionsKey: Any]?)</span></span> -&gt; <span class=\"type\">Bool</span> &#123;</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"type\">StartupCommandsBuilder</span>()</span><br><span class=\"line\">            .setKeyWindow(window!)</span><br><span class=\"line\">            .build()</span><br><span class=\"line\">            .forEach &#123; $<span class=\"number\">0</span>.execute() &#125;</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"literal\">true</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p> AppDelegate <strong>StartupCommandsBuilder</strong><br>\n</p>\n<ul>\n<li></li>\n<li> AppDelegate </li>\n<li></li>\n</ul>\n<h2 id=\"recipe-2-composite-design-pattern\">Recipe #2: Composite Design Pattern</h2>\n<p>Composite Design Pattern iOS <strong>UIView</strong><br>\n AppDelegate </p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">typealias</span> <span class=\"type\">AppDelegateType</span> = <span class=\"type\">UIResponder</span> &amp; <span class=\"type\">UIApplicationDelegate</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">CompositeAppDelegate</span>: <span class=\"title\">AppDelegateType</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">let</span> appDelegates: [<span class=\"type\">AppDelegateType</span>]</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">init</span>(appDelegates: [<span class=\"type\">AppDelegateType</span>]) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">self</span>.appDelegates = appDelegates</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">application</span><span class=\"params\">(<span class=\"number\">_</span> application: UIApplication, didFinishLaunchingWithOptions launchOptions: [UIApplication.LaunchOptionsKey : Any]? = <span class=\"literal\">nil</span>)</span></span> -&gt; <span class=\"type\">Bool</span> &#123;</span><br><span class=\"line\">        appDelegates.forEach &#123; <span class=\"number\">_</span> = $<span class=\"number\">0</span>.application?(application, didFinishLaunchingWithOptions: launchOptions) &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"literal\">true</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">application</span><span class=\"params\">(<span class=\"number\">_</span> application: UIApplication, didRegisterForRemoteNotificationsWithDeviceToken deviceToken: Data)</span></span> &#123;</span><br><span class=\"line\">        appDelegates.forEach &#123; $<span class=\"number\">0</span>.application?(application, didRegisterForRemoteNotificationsWithDeviceToken: deviceToken) &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p> AppDelegates </p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">PushNotificationAppDelegate</span>: <span class=\"title\">AppDelegateType</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">application</span><span class=\"params\">(<span class=\"number\">_</span> application: UIApplication, didRegisterForRemoteNotificationsWithDeviceToken deviceToken: Data)</span></span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">print</span>(<span class=\"string\">\"Registed successfully\"</span>)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">StartupConfiguratorAppDelegate</span>: <span class=\"title\">AppDelegateType</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">application</span><span class=\"params\">(<span class=\"number\">_</span> application: UIApplication, didFinishLaunchingWithOptions launchOptions: [UIApplication.LaunchOptionsKey : Any]? = <span class=\"literal\">nil</span>)</span></span> -&gt; <span class=\"type\">Bool</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">print</span>(<span class=\"string\">\"Perform startup configurations, e.g. build UI stack, setup UIAppearance\"</span>)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"literal\">true</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">ThirdPartiesConfiguratorAppDelegate</span>: <span class=\"title\">AppDelegateType</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">application</span><span class=\"params\">(<span class=\"number\">_</span> application: UIApplication, didFinishLaunchingWithOptions launchOptions: [UIApplication.LaunchOptionsKey : Any]? = <span class=\"literal\">nil</span>)</span></span> -&gt; <span class=\"type\">Bool</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">print</span>(<span class=\"string\">\"Setup third parties\"</span>)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"literal\">true</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><strong>AppDelegateFactory</strong> AppDelegate </p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">enum</span> <span class=\"title\">AppDelegateFactory</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">static</span> <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">makeDefault</span><span class=\"params\">()</span></span> -&gt; <span class=\"type\">AppDelegateType</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"type\">CompositeAppDelegate</span>(appDelegates: [<span class=\"type\">PushNotificationAppDelegate</span>(), <span class=\"type\">StartupConfiguratorAppDelegate</span>(), <span class=\"type\">ThirdPartiesConfiguratorAppDelegate</span>()])</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@UIApplicationMain</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">AppDelegate</span>: <span class=\"title\">UIResponder</span>, <span class=\"title\">UIApplicationDelegate</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">var</span> window: <span class=\"type\">UIWindow</span>?</span><br><span class=\"line\">    <span class=\"keyword\">let</span> appDelegate = <span class=\"type\">AppDelegateFactory</span>.makeDefault()</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">application</span><span class=\"params\">(<span class=\"number\">_</span> application: UIApplication, didFinishLaunchingWithOptions launchOptions: [UIApplication.LaunchOptionsKey: Any]?)</span></span> -&gt; <span class=\"type\">Bool</span> &#123;</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"number\">_</span> = appDelegate.application?(application, didFinishLaunchingWithOptions: launchOptions)</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"literal\">true</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">application</span><span class=\"params\">(<span class=\"number\">_</span> application: UIApplication, didRegisterForRemoteNotificationsWithDeviceToken deviceToken: Data)</span></span> &#123;</span><br><span class=\"line\">        </span><br><span class=\"line\">        appDelegate.application?(application, didRegisterForRemoteNotificationsWithDeviceToken: deviceToken)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p></p>\n<ul>\n<li> AppDelegate </li>\n<li> AppDelegate </li>\n<li></li>\n</ul>\n<h2 id=\"recipe-3-mediator-design-pattern\">Recipe #3: Mediator Design Pattern</h2>\n<p>Mediator Design Pattern<br>\n <a href=\"http://www.vadimbulavin.com/mediator-pattern-case-study/\" target=\"_blank\" rel=\"noopener\">Mediator Pattern Case Study</a><br>\n<strong>AppLifecycleMediator</strong><strong>UIApplication</strong><strong>AppLifecycleListener</strong></p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">protocol</span> <span class=\"title\">AppLifecycleListener</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">onAppWillEnterForeground</span><span class=\"params\">()</span></span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">onAppDidEnterBackground</span><span class=\"params\">()</span></span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">onAppDidFinishLaunching</span><span class=\"params\">()</span></span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">extension</span> <span class=\"title\">AppLifecycleListener</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">onAppWillEnterForeground</span><span class=\"params\">()</span></span> &#123;&#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">onAppDidEnterBackground</span><span class=\"params\">()</span></span> &#123;&#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">onAppDidFinishLaunching</span><span class=\"params\">()</span></span> &#123;&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">listen1</span>: <span class=\"title\">AppLifecycleListener</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">onAppDidFinishLaunching</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">print</span>(<span class=\"string\">\"app did finish launching1\"</span>)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">onAppWillEnterForeground</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">print</span>(<span class=\"string\">\"app will enter foreground\"</span>)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">listen2</span>: <span class=\"title\">AppLifecycleListener</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">onAppDidEnterBackground</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">print</span>(<span class=\"string\">\"app did enter background\"</span>)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">listen3</span>: <span class=\"title\">AppLifecycleListener</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">onAppDidFinishLaunching</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">print</span>(<span class=\"string\">\"app did finish launching2\"</span>)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">AppLifecycleMediator</span>: <span class=\"title\">NSObject</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">let</span> listeners: [<span class=\"type\">AppLifecycleListener</span>]</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">init</span>(listeners: [<span class=\"type\">AppLifecycleListener</span>]) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">self</span>.listeners = listeners</span><br><span class=\"line\">        <span class=\"keyword\">super</span>.<span class=\"keyword\">init</span>()</span><br><span class=\"line\">        subscribe()</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">deinit</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">NotificationCenter</span>.<span class=\"keyword\">default</span>.removeObserver(<span class=\"keyword\">self</span>)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">subscribe</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">        <span class=\"type\">NotificationCenter</span>.<span class=\"keyword\">default</span>.addObserver(<span class=\"keyword\">self</span>, selector: #selector(onAppWillEnterForeground), name: <span class=\"type\">UIApplication</span>.willEnterForegroundNotification, object: <span class=\"literal\">nil</span>)</span><br><span class=\"line\">        <span class=\"type\">NotificationCenter</span>.<span class=\"keyword\">default</span>.addObserver(<span class=\"keyword\">self</span>, selector: #selector(onAppDidEnterBackground), name: <span class=\"type\">UIApplication</span>.didEnterBackgroundNotification, object: <span class=\"literal\">nil</span>)</span><br><span class=\"line\">        <span class=\"type\">NotificationCenter</span>.<span class=\"keyword\">default</span>.addObserver(<span class=\"keyword\">self</span>, selector: #selector(onAppDidFinishLaunching), name: <span class=\"type\">UIApplication</span>.didFinishLaunchingNotification, object: <span class=\"literal\">nil</span>)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"meta\">@objc</span> <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">onAppWillEnterForeground</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">        listeners.forEach &#123; $<span class=\"number\">0</span>.onAppWillEnterForeground() &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"meta\">@objc</span> <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">onAppDidEnterBackground</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">        listeners.forEach &#123; $<span class=\"number\">0</span>.onAppDidEnterBackground() &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"meta\">@objc</span> <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">onAppDidFinishLaunching</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">        listeners.forEach &#123; $<span class=\"number\">0</span>.onAppDidFinishLaunching() &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">extension</span> <span class=\"title\">AppLifecycleMediator</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">static</span> <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">makeDefaultMediator</span><span class=\"params\">()</span></span> -&gt; <span class=\"type\">AppLifecycleMediator</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"type\">AppLifecycleMediator</span>(listeners: [listen1(), listen2(), listen3()])</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><strong>AppDelegate</strong></p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@UIApplicationMain</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">AppDelegate</span>: <span class=\"title\">UIResponder</span>, <span class=\"title\">UIApplicationDelegate</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">var</span> window: <span class=\"type\">UIWindow</span>?</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">let</span> mediator = <span class=\"type\">AppLifecycleMediator</span>.makeDefaultMediator()</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">application</span><span class=\"params\">(<span class=\"number\">_</span> application: UIApplication, didFinishLaunchingWithOptions launchOptions: [UIApplication.LaunchOptionsKey: Any]?)</span></span> -&gt; <span class=\"type\">Bool</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"literal\">true</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><strong>AppDelegate</strong><br>\n</p>\n<ul>\n<li></li>\n<li> AppDelegate </li>\n<li></li>\n</ul>\n<h1 id=\"summary\">Summary</h1>\n<p><strong>AppDelegate</strong><strong>AppDelegate</strong></p>\n<h1 id=\"reference\">Reference</h1>\n<p><a href=\"http://www.vadimbulavin.com/refactoring-massive-app-delegate/\" target=\"_blank\" rel=\"noopener\">Refactoring Massive App Delegate</a></p>\n","site":{"data":{}},"excerpt":"","more":"<blockquote>\n<p> Swift  AppDelegate   <a href=\"http://www.vadimbulavin.com/refactoring-massive-app-delegate/\" target=\"_blank\" rel=\"noopener\">@V8tr</a><a href=\"https://github.com/Quincy-QC/MassiveAppDelegate\" target=\"_blank\" rel=\"noopener\">Demo</a></p>\n</blockquote>\n<h1>Introduction</h1>\n<p>AppDelegate  iOS <br>\n AppDelegate <br>\n AppDelegates </p>\n<h1>Problem Statement</h1>\n<p>AppDelegate  AppDelegate <br>\n<a href=\"https://developer.apple.com/documentation/uikit/uiapplicationdelegate?language=objc\" target=\"_blank\" rel=\"noopener\"></a> AppDelegate <br>\n<a href=\"https://github.com/dkhamsing/open-source-ios-apps\" target=\"_blank\" rel=\"noopener\">open-source-ios-apps</a> AppDelegates </p>\n<ul>\n<li></li>\n<li></li>\n<li> UI </li>\n<li> UserDefaults</li>\n<li> token</li>\n<li> UIAppearance</li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n<p><br>\n AppDelegate  Massive App Delegates</p>\n<h1>Solution</h1>\n<p> AppDelegate  recipes<br>\n recipe </p>\n<ul>\n<li> <a href=\"https://en.wikipedia.org/wiki/Single_responsibility_principle\" target=\"_blank\" rel=\"noopener\">sigle responsibility principle</a></li>\n<li></li>\n<li></li>\n</ul>\n<h2>Recipe #1: Command Design Pattern</h2>\n<p>command Design pattern<br>\n AppDelegate </p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">protocol</span> <span class=\"title\">Command</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">execute</span><span class=\"params\">()</span></span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">InitializeThirdPartiesCommand</span>: <span class=\"title\">Command</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">execute</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">print</span>(<span class=\"string\">\"Third parties are initialized\"</span>)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">InitialViewControllerCommand</span>: <span class=\"title\">Command</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> keyWindow: <span class=\"type\">UIWindow</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">execute</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">print</span>(<span class=\"string\">\"Pick root view controller here\"</span>)</span><br><span class=\"line\">        keyWindow.frame = <span class=\"type\">UIScreen</span>.main.bounds</span><br><span class=\"line\">        keyWindow.backgroundColor = <span class=\"type\">UIColor</span>.white</span><br><span class=\"line\">        keyWindow.makeKeyAndVisible()</span><br><span class=\"line\">        keyWindow.rootViewController = <span class=\"type\">ViewController</span>()</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">InitializeAppearanceCommand</span>: <span class=\"title\">Command</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">execute</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">print</span>(<span class=\"string\">\"Setup UIAppearance\"</span>)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">RegisterToRemoteNotificationsCommand</span>: <span class=\"title\">Command</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">execute</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">print</span>(<span class=\"string\">\"Register for remote notifications here\"</span>)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><strong>StartupCommandsBuilder</strong>AppDelegate </p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// MARK: -------- StartupCommandsBuilder --------</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">final</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">StartupCommandsBuilder</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">var</span> window: <span class=\"type\">UIWindow</span>!</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">setKeyWindow</span><span class=\"params\">(<span class=\"number\">_</span> window: UIWindow)</span></span> -&gt; <span class=\"type\">StartupCommandsBuilder</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">self</span>.window = window</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">self</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">build</span><span class=\"params\">()</span></span> -&gt; [<span class=\"type\">Command</span>] &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> [<span class=\"type\">InitializeThirdPartiesCommand</span>(),</span><br><span class=\"line\">                <span class=\"type\">InitialViewControllerCommand</span>(keyWindow: window),</span><br><span class=\"line\">                <span class=\"type\">InitializeAppearanceCommand</span>(),</span><br><span class=\"line\">                <span class=\"type\">RegisterToRemoteNotificationsCommand</span>()]</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// MARK: -------- AppDelegate --------</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@UIApplicationMain</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">AppDelegate</span>: <span class=\"title\">UIResponder</span>, <span class=\"title\">UIApplicationDelegate</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">var</span> window: <span class=\"type\">UIWindow</span>?</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">application</span><span class=\"params\">(<span class=\"number\">_</span> application: UIApplication, didFinishLaunchingWithOptions launchOptions: [UIApplication.LaunchOptionsKey: Any]?)</span></span> -&gt; <span class=\"type\">Bool</span> &#123;</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"type\">StartupCommandsBuilder</span>()</span><br><span class=\"line\">            .setKeyWindow(window!)</span><br><span class=\"line\">            .build()</span><br><span class=\"line\">            .forEach &#123; $<span class=\"number\">0</span>.execute() &#125;</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"literal\">true</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p> AppDelegate <strong>StartupCommandsBuilder</strong><br>\n</p>\n<ul>\n<li></li>\n<li> AppDelegate </li>\n<li></li>\n</ul>\n<h2>Recipe #2: Composite Design Pattern</h2>\n<p>Composite Design Pattern iOS <strong>UIView</strong><br>\n AppDelegate </p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">typealias</span> <span class=\"type\">AppDelegateType</span> = <span class=\"type\">UIResponder</span> &amp; <span class=\"type\">UIApplicationDelegate</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">CompositeAppDelegate</span>: <span class=\"title\">AppDelegateType</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">let</span> appDelegates: [<span class=\"type\">AppDelegateType</span>]</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">init</span>(appDelegates: [<span class=\"type\">AppDelegateType</span>]) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">self</span>.appDelegates = appDelegates</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">application</span><span class=\"params\">(<span class=\"number\">_</span> application: UIApplication, didFinishLaunchingWithOptions launchOptions: [UIApplication.LaunchOptionsKey : Any]? = <span class=\"literal\">nil</span>)</span></span> -&gt; <span class=\"type\">Bool</span> &#123;</span><br><span class=\"line\">        appDelegates.forEach &#123; <span class=\"number\">_</span> = $<span class=\"number\">0</span>.application?(application, didFinishLaunchingWithOptions: launchOptions) &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"literal\">true</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">application</span><span class=\"params\">(<span class=\"number\">_</span> application: UIApplication, didRegisterForRemoteNotificationsWithDeviceToken deviceToken: Data)</span></span> &#123;</span><br><span class=\"line\">        appDelegates.forEach &#123; $<span class=\"number\">0</span>.application?(application, didRegisterForRemoteNotificationsWithDeviceToken: deviceToken) &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p> AppDelegates </p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">PushNotificationAppDelegate</span>: <span class=\"title\">AppDelegateType</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">application</span><span class=\"params\">(<span class=\"number\">_</span> application: UIApplication, didRegisterForRemoteNotificationsWithDeviceToken deviceToken: Data)</span></span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">print</span>(<span class=\"string\">\"Registed successfully\"</span>)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">StartupConfiguratorAppDelegate</span>: <span class=\"title\">AppDelegateType</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">application</span><span class=\"params\">(<span class=\"number\">_</span> application: UIApplication, didFinishLaunchingWithOptions launchOptions: [UIApplication.LaunchOptionsKey : Any]? = <span class=\"literal\">nil</span>)</span></span> -&gt; <span class=\"type\">Bool</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">print</span>(<span class=\"string\">\"Perform startup configurations, e.g. build UI stack, setup UIAppearance\"</span>)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"literal\">true</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">ThirdPartiesConfiguratorAppDelegate</span>: <span class=\"title\">AppDelegateType</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">application</span><span class=\"params\">(<span class=\"number\">_</span> application: UIApplication, didFinishLaunchingWithOptions launchOptions: [UIApplication.LaunchOptionsKey : Any]? = <span class=\"literal\">nil</span>)</span></span> -&gt; <span class=\"type\">Bool</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">print</span>(<span class=\"string\">\"Setup third parties\"</span>)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"literal\">true</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><strong>AppDelegateFactory</strong> AppDelegate </p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">enum</span> <span class=\"title\">AppDelegateFactory</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">static</span> <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">makeDefault</span><span class=\"params\">()</span></span> -&gt; <span class=\"type\">AppDelegateType</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"type\">CompositeAppDelegate</span>(appDelegates: [<span class=\"type\">PushNotificationAppDelegate</span>(), <span class=\"type\">StartupConfiguratorAppDelegate</span>(), <span class=\"type\">ThirdPartiesConfiguratorAppDelegate</span>()])</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@UIApplicationMain</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">AppDelegate</span>: <span class=\"title\">UIResponder</span>, <span class=\"title\">UIApplicationDelegate</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">var</span> window: <span class=\"type\">UIWindow</span>?</span><br><span class=\"line\">    <span class=\"keyword\">let</span> appDelegate = <span class=\"type\">AppDelegateFactory</span>.makeDefault()</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">application</span><span class=\"params\">(<span class=\"number\">_</span> application: UIApplication, didFinishLaunchingWithOptions launchOptions: [UIApplication.LaunchOptionsKey: Any]?)</span></span> -&gt; <span class=\"type\">Bool</span> &#123;</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"number\">_</span> = appDelegate.application?(application, didFinishLaunchingWithOptions: launchOptions)</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"literal\">true</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">application</span><span class=\"params\">(<span class=\"number\">_</span> application: UIApplication, didRegisterForRemoteNotificationsWithDeviceToken deviceToken: Data)</span></span> &#123;</span><br><span class=\"line\">        </span><br><span class=\"line\">        appDelegate.application?(application, didRegisterForRemoteNotificationsWithDeviceToken: deviceToken)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p></p>\n<ul>\n<li> AppDelegate </li>\n<li> AppDelegate </li>\n<li></li>\n</ul>\n<h2>Recipe #3: Mediator Design Pattern</h2>\n<p>Mediator Design Pattern<br>\n <a href=\"http://www.vadimbulavin.com/mediator-pattern-case-study/\" target=\"_blank\" rel=\"noopener\">Mediator Pattern Case Study</a><br>\n<strong>AppLifecycleMediator</strong><strong>UIApplication</strong><strong>AppLifecycleListener</strong></p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">protocol</span> <span class=\"title\">AppLifecycleListener</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">onAppWillEnterForeground</span><span class=\"params\">()</span></span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">onAppDidEnterBackground</span><span class=\"params\">()</span></span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">onAppDidFinishLaunching</span><span class=\"params\">()</span></span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">extension</span> <span class=\"title\">AppLifecycleListener</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">onAppWillEnterForeground</span><span class=\"params\">()</span></span> &#123;&#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">onAppDidEnterBackground</span><span class=\"params\">()</span></span> &#123;&#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">onAppDidFinishLaunching</span><span class=\"params\">()</span></span> &#123;&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">listen1</span>: <span class=\"title\">AppLifecycleListener</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">onAppDidFinishLaunching</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">print</span>(<span class=\"string\">\"app did finish launching1\"</span>)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">onAppWillEnterForeground</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">print</span>(<span class=\"string\">\"app will enter foreground\"</span>)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">listen2</span>: <span class=\"title\">AppLifecycleListener</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">onAppDidEnterBackground</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">print</span>(<span class=\"string\">\"app did enter background\"</span>)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">listen3</span>: <span class=\"title\">AppLifecycleListener</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">onAppDidFinishLaunching</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">print</span>(<span class=\"string\">\"app did finish launching2\"</span>)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">AppLifecycleMediator</span>: <span class=\"title\">NSObject</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">let</span> listeners: [<span class=\"type\">AppLifecycleListener</span>]</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">init</span>(listeners: [<span class=\"type\">AppLifecycleListener</span>]) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">self</span>.listeners = listeners</span><br><span class=\"line\">        <span class=\"keyword\">super</span>.<span class=\"keyword\">init</span>()</span><br><span class=\"line\">        subscribe()</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">deinit</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">NotificationCenter</span>.<span class=\"keyword\">default</span>.removeObserver(<span class=\"keyword\">self</span>)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">subscribe</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">        <span class=\"type\">NotificationCenter</span>.<span class=\"keyword\">default</span>.addObserver(<span class=\"keyword\">self</span>, selector: #selector(onAppWillEnterForeground), name: <span class=\"type\">UIApplication</span>.willEnterForegroundNotification, object: <span class=\"literal\">nil</span>)</span><br><span class=\"line\">        <span class=\"type\">NotificationCenter</span>.<span class=\"keyword\">default</span>.addObserver(<span class=\"keyword\">self</span>, selector: #selector(onAppDidEnterBackground), name: <span class=\"type\">UIApplication</span>.didEnterBackgroundNotification, object: <span class=\"literal\">nil</span>)</span><br><span class=\"line\">        <span class=\"type\">NotificationCenter</span>.<span class=\"keyword\">default</span>.addObserver(<span class=\"keyword\">self</span>, selector: #selector(onAppDidFinishLaunching), name: <span class=\"type\">UIApplication</span>.didFinishLaunchingNotification, object: <span class=\"literal\">nil</span>)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"meta\">@objc</span> <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">onAppWillEnterForeground</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">        listeners.forEach &#123; $<span class=\"number\">0</span>.onAppWillEnterForeground() &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"meta\">@objc</span> <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">onAppDidEnterBackground</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">        listeners.forEach &#123; $<span class=\"number\">0</span>.onAppDidEnterBackground() &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"meta\">@objc</span> <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">onAppDidFinishLaunching</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">        listeners.forEach &#123; $<span class=\"number\">0</span>.onAppDidFinishLaunching() &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">extension</span> <span class=\"title\">AppLifecycleMediator</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">static</span> <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">makeDefaultMediator</span><span class=\"params\">()</span></span> -&gt; <span class=\"type\">AppLifecycleMediator</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"type\">AppLifecycleMediator</span>(listeners: [listen1(), listen2(), listen3()])</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><strong>AppDelegate</strong></p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@UIApplicationMain</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">AppDelegate</span>: <span class=\"title\">UIResponder</span>, <span class=\"title\">UIApplicationDelegate</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">var</span> window: <span class=\"type\">UIWindow</span>?</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">let</span> mediator = <span class=\"type\">AppLifecycleMediator</span>.makeDefaultMediator()</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">application</span><span class=\"params\">(<span class=\"number\">_</span> application: UIApplication, didFinishLaunchingWithOptions launchOptions: [UIApplication.LaunchOptionsKey: Any]?)</span></span> -&gt; <span class=\"type\">Bool</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"literal\">true</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><strong>AppDelegate</strong><br>\n</p>\n<ul>\n<li></li>\n<li> AppDelegate </li>\n<li></li>\n</ul>\n<h1>Summary</h1>\n<p><strong>AppDelegate</strong><strong>AppDelegate</strong></p>\n<h1>Reference</h1>\n<p><a href=\"http://www.vadimbulavin.com/refactoring-massive-app-delegate/\" target=\"_blank\" rel=\"noopener\">Refactoring Massive App Delegate</a></p>\n"},{"title":"Swift Package Manager","catalog":true,"toc_nav_num":true,"date":"2019-11-22T11:23:09.000Z","subtitle":"Swift Package Manager","header-img":"/img/article_header/article_header.png","busuanzi":true,"_content":"\n# \n\nCocoapodsXcode 11iOS--Swift Package Manager\n\n# \n\n\n\n![1](/img/article/20191122/1.png)\n![2](/img/article/20191122/2.png)\n\nGit`Accounts`\n\nCommit\n\n![3](/img/article/20191122/3.png)\n\n\n\n# SPM\n\n`mkdir ProjName && cd ProjName``swift package init`\n\n\n- README.md\n- Package.swift\n- Sources\n- Tests\n\n\n``` swift\n// swift-tools-version:5.1\n// The swift-tools-version declares the minimum version of Swift required to build this package.\n\nimport PackageDescription\n\nlet package = Package(\n    name: \"MyCategory\",\n    platforms: [\n        .macOS(.v10_13), .iOS(.v11), .tvOS(.v11),\n    ],\n    products: [\n        // Products define the executables and libraries produced by a package, and make them visible to other packages.\n        .library(\n            name: \"MyCategory\",\n            targets: [\"MyCategory\"]),\n    ],\n    dependencies: [\n        // Dependencies declare other packages that this package depends on.\n        // .package(url: /* package url */, from: \"1.0.0\"),\n        .package(url: \"https://github.com/onevcat/Kingfisher.git\", from: \"5.8.3\")\n    ],\n    targets: [\n        // Targets are the basic building blocks of a package. A target can define a module or a test suite.\n        // Targets can depend on other targets in this package, and on products in packages which this package depends on.\n        .target(\n            name: \"MyCategory\",\n            dependencies: [\"Kingfisher\"]),\n        .testTarget(\n            name: \"MyCategoryTests\",\n            dependencies: [\"MyCategory\"]),\n    ]\n)\n```\nCocoapods\n`dependencies`Git`targets`\n\n`Sources`SPM\n``` swift\n#if os(Linux)\n\n// Code specific to Linux\n\n#elseif os(macOS)\n\n// Code specific to macOS\n\n#endif\n\n#if canImport(UIKit)\n\n// Code specific to platforms where UIKit is available\n\n#endif\n```\n\nCocoapodsGitTagReleaseSPM\n\n# \n\nCocoapodsSPM`Package.swift``Sources`\n\n# \n\nSwift Package Manager","source":"_posts/2019/swift-package-manager-1122.md","raw":"---\ntitle: \"Swift Package Manager\"\ncatalog: true\ntoc_nav_num: true\ndate: 2019-11-22 19:23:09\nsubtitle: \"Swift Package Manager\"\nheader-img: \"/img/article_header/article_header.png\"\nbusuanzi: true\ntags:\n- iOS\n\n---\n\n# \n\nCocoapodsXcode 11iOS--Swift Package Manager\n\n# \n\n\n\n![1](/img/article/20191122/1.png)\n![2](/img/article/20191122/2.png)\n\nGit`Accounts`\n\nCommit\n\n![3](/img/article/20191122/3.png)\n\n\n\n# SPM\n\n`mkdir ProjName && cd ProjName``swift package init`\n\n\n- README.md\n- Package.swift\n- Sources\n- Tests\n\n\n``` swift\n// swift-tools-version:5.1\n// The swift-tools-version declares the minimum version of Swift required to build this package.\n\nimport PackageDescription\n\nlet package = Package(\n    name: \"MyCategory\",\n    platforms: [\n        .macOS(.v10_13), .iOS(.v11), .tvOS(.v11),\n    ],\n    products: [\n        // Products define the executables and libraries produced by a package, and make them visible to other packages.\n        .library(\n            name: \"MyCategory\",\n            targets: [\"MyCategory\"]),\n    ],\n    dependencies: [\n        // Dependencies declare other packages that this package depends on.\n        // .package(url: /* package url */, from: \"1.0.0\"),\n        .package(url: \"https://github.com/onevcat/Kingfisher.git\", from: \"5.8.3\")\n    ],\n    targets: [\n        // Targets are the basic building blocks of a package. A target can define a module or a test suite.\n        // Targets can depend on other targets in this package, and on products in packages which this package depends on.\n        .target(\n            name: \"MyCategory\",\n            dependencies: [\"Kingfisher\"]),\n        .testTarget(\n            name: \"MyCategoryTests\",\n            dependencies: [\"MyCategory\"]),\n    ]\n)\n```\nCocoapods\n`dependencies`Git`targets`\n\n`Sources`SPM\n``` swift\n#if os(Linux)\n\n// Code specific to Linux\n\n#elseif os(macOS)\n\n// Code specific to macOS\n\n#endif\n\n#if canImport(UIKit)\n\n// Code specific to platforms where UIKit is available\n\n#endif\n```\n\nCocoapodsGitTagReleaseSPM\n\n# \n\nCocoapodsSPM`Package.swift``Sources`\n\n# \n\nSwift Package Manager","slug":"2019/swift-package-manager-1122","published":1,"updated":"2021-06-21T12:34:52.098Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckszp3ndk0019ifnt44rgw4th","content":"<h1 id=\"\"></h1>\n<p>CocoapodsXcode 11iOSSwift Package Manager</p>\n<h1 id=\"\"></h1>\n<p></p>\n<p><img src=\"/img/article/20191122/1.png\" alt=\"1\"><br>\n<img src=\"/img/article/20191122/2.png\" alt=\"2\"></p>\n<p>Git<code>Accounts</code></p>\n<p>Commit</p>\n<p><img src=\"/img/article/20191122/3.png\" alt=\"3\"></p>\n<p></p>\n<h1 id=\"spm\">SPM</h1>\n<p><code>mkdir ProjName &amp;&amp; cd ProjName</code><code>swift package init</code></p>\n<p></p>\n<ul>\n<li><a href=\"http://README.md\" target=\"_blank\" rel=\"noopener\">README.md</a></li>\n<li>Package.swift</li>\n<li>Sources</li>\n<li>Tests</li>\n</ul>\n<p></p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// swift-tools-version:5.1</span></span><br><span class=\"line\"><span class=\"comment\">// The swift-tools-version declares the minimum version of Swift required to build this package.</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> PackageDescription</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">let</span> package = <span class=\"type\">Package</span>(</span><br><span class=\"line\">    name: <span class=\"string\">\"MyCategory\"</span>,</span><br><span class=\"line\">    platforms: [</span><br><span class=\"line\">        .macOS(.v10_13), .iOS(.v11), .tvOS(.v11),</span><br><span class=\"line\">    ],</span><br><span class=\"line\">    products: [</span><br><span class=\"line\">        <span class=\"comment\">// Products define the executables and libraries produced by a package, and make them visible to other packages.</span></span><br><span class=\"line\">        .library(</span><br><span class=\"line\">            name: <span class=\"string\">\"MyCategory\"</span>,</span><br><span class=\"line\">            targets: [<span class=\"string\">\"MyCategory\"</span>]),</span><br><span class=\"line\">    ],</span><br><span class=\"line\">    dependencies: [</span><br><span class=\"line\">        <span class=\"comment\">// Dependencies declare other packages that this package depends on.</span></span><br><span class=\"line\">        <span class=\"comment\">// .package(url: /* package url */, from: \"1.0.0\"),</span></span><br><span class=\"line\">        .package(url: <span class=\"string\">\"https://github.com/onevcat/Kingfisher.git\"</span>, from: <span class=\"string\">\"5.8.3\"</span>)</span><br><span class=\"line\">    ],</span><br><span class=\"line\">    targets: [</span><br><span class=\"line\">        <span class=\"comment\">// Targets are the basic building blocks of a package. A target can define a module or a test suite.</span></span><br><span class=\"line\">        <span class=\"comment\">// Targets can depend on other targets in this package, and on products in packages which this package depends on.</span></span><br><span class=\"line\">        .target(</span><br><span class=\"line\">            name: <span class=\"string\">\"MyCategory\"</span>,</span><br><span class=\"line\">            dependencies: [<span class=\"string\">\"Kingfisher\"</span>]),</span><br><span class=\"line\">        .testTarget(</span><br><span class=\"line\">            name: <span class=\"string\">\"MyCategoryTests\"</span>,</span><br><span class=\"line\">            dependencies: [<span class=\"string\">\"MyCategory\"</span>]),</span><br><span class=\"line\">    ]</span><br><span class=\"line\">)</span><br></pre></td></tr></table></figure>\n<p>Cocoapods<br>\n<code>dependencies</code>Git<code>targets</code></p>\n<p><code>Sources</code>SPM</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#<span class=\"keyword\">if</span> os(<span class=\"type\">Linux</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// Code specific to Linux</span></span><br><span class=\"line\"></span><br><span class=\"line\">#elseif os(macOS)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// Code specific to macOS</span></span><br><span class=\"line\"></span><br><span class=\"line\">#endif</span><br><span class=\"line\"></span><br><span class=\"line\">#<span class=\"keyword\">if</span> canImport(<span class=\"type\">UIKit</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// Code specific to platforms where UIKit is available</span></span><br><span class=\"line\"></span><br><span class=\"line\">#endif</span><br></pre></td></tr></table></figure>\n<p>CocoapodsGitTagReleaseSPM</p>\n<h1 id=\"\"></h1>\n<p>CocoapodsSPM<code>Package.swift</code><code>Sources</code></p>\n<h1 id=\"\"></h1>\n<p>Swift Package Manager</p>\n","site":{"data":{}},"excerpt":"","more":"<h1></h1>\n<p>CocoapodsXcode 11iOSSwift Package Manager</p>\n<h1></h1>\n<p></p>\n<p><img src=\"/img/article/20191122/1.png\" alt=\"1\"><br>\n<img src=\"/img/article/20191122/2.png\" alt=\"2\"></p>\n<p>Git<code>Accounts</code></p>\n<p>Commit</p>\n<p><img src=\"/img/article/20191122/3.png\" alt=\"3\"></p>\n<p></p>\n<h1>SPM</h1>\n<p><code>mkdir ProjName &amp;&amp; cd ProjName</code><code>swift package init</code></p>\n<p></p>\n<ul>\n<li><a href=\"http://README.md\" target=\"_blank\" rel=\"noopener\">README.md</a></li>\n<li>Package.swift</li>\n<li>Sources</li>\n<li>Tests</li>\n</ul>\n<p></p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// swift-tools-version:5.1</span></span><br><span class=\"line\"><span class=\"comment\">// The swift-tools-version declares the minimum version of Swift required to build this package.</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> PackageDescription</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">let</span> package = <span class=\"type\">Package</span>(</span><br><span class=\"line\">    name: <span class=\"string\">\"MyCategory\"</span>,</span><br><span class=\"line\">    platforms: [</span><br><span class=\"line\">        .macOS(.v10_13), .iOS(.v11), .tvOS(.v11),</span><br><span class=\"line\">    ],</span><br><span class=\"line\">    products: [</span><br><span class=\"line\">        <span class=\"comment\">// Products define the executables and libraries produced by a package, and make them visible to other packages.</span></span><br><span class=\"line\">        .library(</span><br><span class=\"line\">            name: <span class=\"string\">\"MyCategory\"</span>,</span><br><span class=\"line\">            targets: [<span class=\"string\">\"MyCategory\"</span>]),</span><br><span class=\"line\">    ],</span><br><span class=\"line\">    dependencies: [</span><br><span class=\"line\">        <span class=\"comment\">// Dependencies declare other packages that this package depends on.</span></span><br><span class=\"line\">        <span class=\"comment\">// .package(url: /* package url */, from: \"1.0.0\"),</span></span><br><span class=\"line\">        .package(url: <span class=\"string\">\"https://github.com/onevcat/Kingfisher.git\"</span>, from: <span class=\"string\">\"5.8.3\"</span>)</span><br><span class=\"line\">    ],</span><br><span class=\"line\">    targets: [</span><br><span class=\"line\">        <span class=\"comment\">// Targets are the basic building blocks of a package. A target can define a module or a test suite.</span></span><br><span class=\"line\">        <span class=\"comment\">// Targets can depend on other targets in this package, and on products in packages which this package depends on.</span></span><br><span class=\"line\">        .target(</span><br><span class=\"line\">            name: <span class=\"string\">\"MyCategory\"</span>,</span><br><span class=\"line\">            dependencies: [<span class=\"string\">\"Kingfisher\"</span>]),</span><br><span class=\"line\">        .testTarget(</span><br><span class=\"line\">            name: <span class=\"string\">\"MyCategoryTests\"</span>,</span><br><span class=\"line\">            dependencies: [<span class=\"string\">\"MyCategory\"</span>]),</span><br><span class=\"line\">    ]</span><br><span class=\"line\">)</span><br></pre></td></tr></table></figure>\n<p>Cocoapods<br>\n<code>dependencies</code>Git<code>targets</code></p>\n<p><code>Sources</code>SPM</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#<span class=\"keyword\">if</span> os(<span class=\"type\">Linux</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// Code specific to Linux</span></span><br><span class=\"line\"></span><br><span class=\"line\">#elseif os(macOS)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// Code specific to macOS</span></span><br><span class=\"line\"></span><br><span class=\"line\">#endif</span><br><span class=\"line\"></span><br><span class=\"line\">#<span class=\"keyword\">if</span> canImport(<span class=\"type\">UIKit</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// Code specific to platforms where UIKit is available</span></span><br><span class=\"line\"></span><br><span class=\"line\">#endif</span><br></pre></td></tr></table></figure>\n<p>CocoapodsGitTagReleaseSPM</p>\n<h1></h1>\n<p>CocoapodsSPM<code>Package.swift</code><code>Sources</code></p>\n<h1></h1>\n<p>Swift Package Manager</p>\n"},{"title":"UbuntuBBR","catalog":true,"toc_nav_num":true,"date":"2019-11-01T08:01:20.000Z","subtitle":"BBR Accelerate","header-img":"/img/article_header/article_header.png","busuanzi":true,"_content":"\n# Introduction\n\nBBRTCPBottleneck Bandwidth and RTT\n\nUbuntuBBR4.94.9\n\n`uname -a`\n\n4.94.9GCE4.4\n\n# Ubuntu\n\n3264`getconf LONG_BIT`\n\n[kernel.ubuntu.com](http://kernel.ubuntu.com/~kernel-ppa/mainline/)`wget`\n\n644.10.2\n\n```\nsudo wget http://kernel.ubuntu.com/~kernel-ppa/mainline/v4.10.2/linux-image-4.10.2-041002-generic_4.10.2-041002.201703120131_amd64.deb\nrootsudo\n```\n\n\n\n```\nsudo dpkg -i linux-image-4.10.2-041002-generic_4.10.2-041002.201703120131_amd64.deb\n```\n\ngrub\n\n```\nsudo update-grub\n```\n\n`uname -a`\n\n# TCP BBR\n\n\n\n```\necho \"net.core.default_qdisc=fq\" >> /etc/sysctl.conf\necho \"net.ipv4.tcp_congestion_control=bbr\" >> /etc/sysctl.conf\n```\n\n\n\n```\nsudo bash -c 'echo \"net.core.default_qdisc=fq\" >> /etc/sysctl.conf'\nsudo bash -c 'echo \"net.ipv4.tcp_congestion_control=bbr\" >> /etc/sysctl.conf'\n```\n\n\n\n```\nsysctl -p\n```\n\n\n\n```\nsysctl net.ipv4.tcp_available_congestion_control\n```\n\nRRB\n\n```\nnet.ipv4.tcp_available_congestion_control = bbr cubic reno\n```\n\n`lsmod | grep bbr`BBR\n\nBBR","source":"_posts/2019/ubuntu-core-update-and-bbr-accelerate-1101.md","raw":"---\ntitle: \"UbuntuBBR\"\ncatalog: true\ntoc_nav_num: true\ndate: 2019-11-01 16:01:20\nsubtitle: \"BBR Accelerate\"\nheader-img: \"/img/article_header/article_header.png\"\nbusuanzi: true\ntags:\n- Tech\n\n---\n\n# Introduction\n\nBBRTCPBottleneck Bandwidth and RTT\n\nUbuntuBBR4.94.9\n\n`uname -a`\n\n4.94.9GCE4.4\n\n# Ubuntu\n\n3264`getconf LONG_BIT`\n\n[kernel.ubuntu.com](http://kernel.ubuntu.com/~kernel-ppa/mainline/)`wget`\n\n644.10.2\n\n```\nsudo wget http://kernel.ubuntu.com/~kernel-ppa/mainline/v4.10.2/linux-image-4.10.2-041002-generic_4.10.2-041002.201703120131_amd64.deb\nrootsudo\n```\n\n\n\n```\nsudo dpkg -i linux-image-4.10.2-041002-generic_4.10.2-041002.201703120131_amd64.deb\n```\n\ngrub\n\n```\nsudo update-grub\n```\n\n`uname -a`\n\n# TCP BBR\n\n\n\n```\necho \"net.core.default_qdisc=fq\" >> /etc/sysctl.conf\necho \"net.ipv4.tcp_congestion_control=bbr\" >> /etc/sysctl.conf\n```\n\n\n\n```\nsudo bash -c 'echo \"net.core.default_qdisc=fq\" >> /etc/sysctl.conf'\nsudo bash -c 'echo \"net.ipv4.tcp_congestion_control=bbr\" >> /etc/sysctl.conf'\n```\n\n\n\n```\nsysctl -p\n```\n\n\n\n```\nsysctl net.ipv4.tcp_available_congestion_control\n```\n\nRRB\n\n```\nnet.ipv4.tcp_available_congestion_control = bbr cubic reno\n```\n\n`lsmod | grep bbr`BBR\n\nBBR","slug":"2019/ubuntu-core-update-and-bbr-accelerate-1101","published":1,"updated":"2021-06-21T12:34:52.099Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckszp3ndl001bifnt25vphiu5","content":"<h1 id=\"introduction\">Introduction</h1>\n<p>BBRTCPBottleneck Bandwidth and RTT</p>\n<p>UbuntuBBR4.94.9</p>\n<p><code>uname -a</code></p>\n<p>4.94.9GCE4.4</p>\n<h1 id=\"ubuntu\">Ubuntu</h1>\n<p>3264<code>getconf LONG_BIT</code></p>\n<p><a href=\"http://kernel.ubuntu.com/~kernel-ppa/mainline/\" target=\"_blank\" rel=\"noopener\">kernel.ubuntu.com</a><code>wget</code></p>\n<p>644.10.2</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo wget http://kernel.ubuntu.com/~kernel-ppa/mainline/v4.10.2/linux-image-4.10.2-041002-generic_4.10.2-041002.201703120131_amd64.deb</span><br><span class=\"line\">rootsudo</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo dpkg -i linux-image-4.10.2-041002-generic_4.10.2-041002.201703120131_amd64.deb</span><br></pre></td></tr></table></figure>\n<p>grub</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo update-grub</span><br></pre></td></tr></table></figure>\n<p><code>uname -a</code></p>\n<h1 id=\"tcp-bbr\">TCP BBR</h1>\n<p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">echo &quot;net.core.default_qdisc=fq&quot; &gt;&gt; /etc/sysctl.conf</span><br><span class=\"line\">echo &quot;net.ipv4.tcp_congestion_control=bbr&quot; &gt;&gt; /etc/sysctl.conf</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo bash -c &apos;echo &quot;net.core.default_qdisc=fq&quot; &gt;&gt; /etc/sysctl.conf&apos;</span><br><span class=\"line\">sudo bash -c &apos;echo &quot;net.ipv4.tcp_congestion_control=bbr&quot; &gt;&gt; /etc/sysctl.conf&apos;</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sysctl -p</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sysctl net.ipv4.tcp_available_congestion_control</span><br></pre></td></tr></table></figure>\n<p>RRB</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">net.ipv4.tcp_available_congestion_control = bbr cubic reno</span><br></pre></td></tr></table></figure>\n<p><code>lsmod | grep bbr</code>BBR</p>\n<p>BBR</p>\n","site":{"data":{}},"excerpt":"","more":"<h1>Introduction</h1>\n<p>BBRTCPBottleneck Bandwidth and RTT</p>\n<p>UbuntuBBR4.94.9</p>\n<p><code>uname -a</code></p>\n<p>4.94.9GCE4.4</p>\n<h1>Ubuntu</h1>\n<p>3264<code>getconf LONG_BIT</code></p>\n<p><a href=\"http://kernel.ubuntu.com/~kernel-ppa/mainline/\" target=\"_blank\" rel=\"noopener\">kernel.ubuntu.com</a><code>wget</code></p>\n<p>644.10.2</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo wget http://kernel.ubuntu.com/~kernel-ppa/mainline/v4.10.2/linux-image-4.10.2-041002-generic_4.10.2-041002.201703120131_amd64.deb</span><br><span class=\"line\">rootsudo</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo dpkg -i linux-image-4.10.2-041002-generic_4.10.2-041002.201703120131_amd64.deb</span><br></pre></td></tr></table></figure>\n<p>grub</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo update-grub</span><br></pre></td></tr></table></figure>\n<p><code>uname -a</code></p>\n<h1>TCP BBR</h1>\n<p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">echo &quot;net.core.default_qdisc=fq&quot; &gt;&gt; /etc/sysctl.conf</span><br><span class=\"line\">echo &quot;net.ipv4.tcp_congestion_control=bbr&quot; &gt;&gt; /etc/sysctl.conf</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo bash -c &apos;echo &quot;net.core.default_qdisc=fq&quot; &gt;&gt; /etc/sysctl.conf&apos;</span><br><span class=\"line\">sudo bash -c &apos;echo &quot;net.ipv4.tcp_congestion_control=bbr&quot; &gt;&gt; /etc/sysctl.conf&apos;</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sysctl -p</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sysctl net.ipv4.tcp_available_congestion_control</span><br></pre></td></tr></table></figure>\n<p>RRB</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">net.ipv4.tcp_available_congestion_control = bbr cubic reno</span><br></pre></td></tr></table></figure>\n<p><code>lsmod | grep bbr</code>BBR</p>\n<p>BBR</p>\n"},{"title":"","catalog":true,"toc_nav_num":true,"date":"2019-03-26T03:19:05.000Z","subtitle":"Talk About Design Pattern","header-img":"/img/article_header/article_header.png","busuanzi":true,"_content":"\n>  Design Pattern \n\n# \n\n- \n\n- \n\n- \n\n- \n\n- \n\n# \n\n## \n\n\n UIView  CALayer UIView  CALayer \n\n## \n\n\n\n\n## \n\n\n\n\n## \n\n\n KVO  addObserver \n\n## \n\n\n UITableViewDelegate  UITableViewDataSource UITableViewDelegate  UITableView  UITableViewDataSource \n\n## \n\n\n\n\n# \n\n## \n\n(Creational Pattern)\n\n- \n- \n- \n- \n- \n- \n\n### \n\n\n\n\n```objectivec\n#pragma mark ----- SingleInstance.h -----\n\n@interface SingleInstance : NSObject\n\n+ (id)sharedInstance;\n\n@end\n```\n\n```objectivec\n#pragma mark ----- SingleInstance.m -----\n\n@implementation SingleInstance\n\n+ (id)sharedInstance\n{\n    // \n    static Mooc *instance = nil;\n    \n    // dispatch_once instance\n    static dispatch_once_t onceToken;\n    dispatch_once(&onceToken, ^{\n        // \n        instance = [[super allocWithZone:NULL] init];\n    });\n    return instance;\n}\n\n// \n+ (id)allocWithZone:(struct _NSZone *)zone{\n    return [self sharedInstance];\n}\n\n// \n- (id)copyWithZone:(nullable NSZone *)zone{\n    return self;\n}\n\n@end\n```\n\n## \n\n(Structural Pattern)\n- \n- \n\n- \n- \n- \n- \n- \n- \n\n### \n\n\n BaseObjectA  BaseObjectB(BaseObjectA1..., BaseObjectB1...)\n```objectivec\n#pragma mark ----- BaseObjectA.h -----\n\n@interface BaseObjectA : NSObject\n\n// \n@property (nonatomic, strong) BaseObjectB *objB;\n\n// \n- (void)handle;\n\n@end\n```\n\n```objectivec\n#pragma mark ----- BaseObjectA.m -----\n\n@implementation BaseObjectA\n\n /*\n    A1 --> B1B2B3         3\n    A2 --> B1B2B3         3\n    A3 --> B1B2B3         3\n  */\n- (void)handle\n{\n    // override to subclass\n    \n    [self.objB fetchData];\n}\n\n@end\n```\n\n```objectivec\n#pragma mark ----- BaseObjectB.h -----\n\n@interface BaseObjectB : NSObject\n\n- (void)fetchData;\n\n@end\n```\n\n```objectivec\n#pragma mark ----- BaseObjectB.m -----\n\n@implementation BaseObjectB\n\n- (void)fetchData\n{\n    // override to subclass\n}\n\n@end\n```\n\n\n```objectivec\n#pragma mark ----- BridgeDemo.h -----\n\n@interface BridgeDemo : NSObject\n\n- (void)fetch;\n\n@end\n```\n\n```objectivec\n#pragma mark ----- BridgeDemo.m -----\n\n@interface BridgeDemo()\n\n@property (nonatomic, strong) BaseObjectA *objA;\n\n@end\n\n@implementation BridgeDemo\n\n/*\n \n A1 --> B1B2B3         3\n A2 --> B1B2B3         3\n A3 --> B1B2B3         3\n */\n- (void)fetch\n{\n    // ClassA\n    _objA = [[ObjectA1 alloc] init];\n    \n    // ClassB\n    BaseObjectB *b1 = [[ObjectB1 alloc] init];\n    // ClassB1 ClassB\n    _objA.objB = b1;\n    \n    // \n    [_objA handle];\n}\n\n@end\n```\n\n### \n\n\n\n\n```objectivec\n#pragma mark ----- Target.h -----\n\n@interface Target : NSObject\n\n- (void)operation;\n\n@end\n```\n\n```objectivec\n#pragma mark ----- Target.m -----\n\n@implementation Target\n\n- (void)operation\n{\n    // \n}\n\n@end\n```\n\n\n```objectivec\n#pragma mark ----- CoolTarget.h -----\n\n// \n@interface CoolTarget : NSObject\n\n// \n@property (nonatomic, strong) Target *target;\n\n// \n- (void)request;\n\n@end\n```\n\n```objectivec\n#pragma mark ----- CoolTarget.m -----\n\n@implementation CoolTarget\n\n- (void)request\n{\n    // \n    \n    [self.target operation];\n    \n    // \n}\n\n@end\n```\n\n## \n\n(Behavioral Pattern)\n\n- \n- \n- \n- \n- \n- \n- \n- \n- \n- \n- \n\n### \n\n\n\n```objectivec\n#pragma mark ----- BusinessObject.h -----\n\n@class BusinessObject;\n\ntypedef void (^CompletionBlock)(BOOL handled);\ntypedef void (^ResultBlock)(BusinessObject * __nullable handler, BOOL handled);\n\n@interface BusinessObject : NSObject\n\n// \n@property (nonatomic, strong) BusinessObject *nextBusiness;\n\n// \n- (void)handle:(ResultBlock)result;\n\n// \n- (void)handleBusiness:(CompletionBlock)completion;\n\n@end\n```\n\n```objectivec\n#pragma mark ----- BusinessObject.m -----\n\n@implementation BusinessObject\n\n- (void)handle:(ResultBlock)result {\n    CompletionBlock completion = ^(BOOL handled) {\n        if (handled) {\n            result(self, handled);\n        } else {\n            if (self.nextBusiness) {\n                [self.nextBusiness handle:result];\n            } else {\n                result(nil, NO);\n            }\n        }\n    };\n    [self handleBusiness:completion];\n}\n\n\n- (void)handleBusiness:(CompletionBlock)completion {\n    // \n}\n\n@end\n```\n\n(nextBusiness)\n\n### \n\n\n\n\n```objectivec\n#pragma mark ----- Command.h -----\n\n@class Command;\ntypedef void(^CommandCompletionCallBack)(Command* cmd);\n\n@interface Command : NSObject\n@property (nonatomic, copy) CommandCompletionCallBack completion;\n\n- (void)execute;\n- (void)cancel;\n\n- (void)done;\n\n@end\n```\n\n```objectivec\n#pragma mark ----- Command.m -----\n\n@implementation Command\n\n- (void)execute{\n    //override to subclass;\n    [self done];\n}\n\n- (void)cancel {\n    self.completion = nil;\n}\n\n- (void)done {\n    dispatch_async(dispatch_get_main_queue(), ^{\n        if (_completion) {\n            _completion(self);\n        }\n        //\n        self.completion = nil;\n        [[CommandManager sharedInstance].arrayCommands removeObject:self];\n    });\n}\n\n@end\n```\n\n\n\n```objectivec\n#pragma mark ----- CommandManager.h -----\n\n@interface CommandManager : NSObject\n\n// \n@property (nonatomic, strong) NSMutableArray <Command*> *arrayCommands;\n\n// \n+ (instancetype)sharedInstance;\n\n// \n+ (void)executeCommand:(Command *)cmd completion:(CommandCompletionCallBack)completion;\n\n// \n+ (void)cancelCommand:(Command *)cmd;\n\n@end\n```\n\n```objectivec\n@implementation CommandManager\n\n// \n+ (instancetype)sharedInstance {\n    static CommandManager *instance = nil;\n    static dispatch_once_t onceToken;\n    dispatch_once(&onceToken, ^{\n        instance = [[super allocWithZone:NULL] init];\n    });\n    return instance;\n}\n\n// \n+ (id)allocWithZone:(struct _NSZone *)zone {\n    return [self sharedInstance];\n}\n\n// \n- (id)copyWithZone:(nullable NSZone *)zone {\n    return self;\n}\n\n// \n- (id)init {\n    self = [super init];\n    if (self) {\n        // \n        _arrayCommands = [NSMutableArray array];\n    }\n    return self;\n}\n\n+ (void)executeCommand:(Command *)cmd completion:(CommandCompletionCallBack)completion {\n    if (cmd) {\n        // \n        if (![self _isExecutingCommand:cmd]) {\n            // \n            [[[self sharedInstance] arrayCommands] addObject:cmd];\n            // \n            cmd.completion = completion;\n            //\n            [cmd execute];\n        }\n    }\n}\n\n// \n+ (void)cancelCommand:(Command *)cmd {\n    if (cmd) {\n        // \n        [[[self sharedInstance] arrayCommands] removeObject:cmd];\n        // \n        [cmd cancel];\n    }\n}\n\n// \n+ (BOOL)_isExecutingCommand:(Command *)cmd {\n    if (cmd) {\n        NSArray *cmds = [[self sharedInstance] arrayCommands];\n        for (Command *aCmd in cmds) {\n            // \n            if (cmd == aCmd) {\n                return YES;\n            }\n        }\n    }\n    return NO;\n}\n\n@end\n```\n\n# \n\n\n\n# \n\n[ 23 ](https://github.com/xietao3/Study-Plan/blob/master/DesignPatterns/README.md)","source":"_posts/2019/talk-about-design-pattern-0326.md","raw":"---\ntitle: \ncatalog: true\ntoc_nav_num: true\ndate: 2019-03-26 11:19:05\nsubtitle: \"Talk About Design Pattern\"\nheader-img: \"/img/article_header/article_header.png\"\nbusuanzi: true\ntags:\n- iOS - Objective-C\n\n---\n\n>  Design Pattern \n\n# \n\n- \n\n- \n\n- \n\n- \n\n- \n\n# \n\n## \n\n\n UIView  CALayer UIView  CALayer \n\n## \n\n\n\n\n## \n\n\n\n\n## \n\n\n KVO  addObserver \n\n## \n\n\n UITableViewDelegate  UITableViewDataSource UITableViewDelegate  UITableView  UITableViewDataSource \n\n## \n\n\n\n\n# \n\n## \n\n(Creational Pattern)\n\n- \n- \n- \n- \n- \n- \n\n### \n\n\n\n\n```objectivec\n#pragma mark ----- SingleInstance.h -----\n\n@interface SingleInstance : NSObject\n\n+ (id)sharedInstance;\n\n@end\n```\n\n```objectivec\n#pragma mark ----- SingleInstance.m -----\n\n@implementation SingleInstance\n\n+ (id)sharedInstance\n{\n    // \n    static Mooc *instance = nil;\n    \n    // dispatch_once instance\n    static dispatch_once_t onceToken;\n    dispatch_once(&onceToken, ^{\n        // \n        instance = [[super allocWithZone:NULL] init];\n    });\n    return instance;\n}\n\n// \n+ (id)allocWithZone:(struct _NSZone *)zone{\n    return [self sharedInstance];\n}\n\n// \n- (id)copyWithZone:(nullable NSZone *)zone{\n    return self;\n}\n\n@end\n```\n\n## \n\n(Structural Pattern)\n- \n- \n\n- \n- \n- \n- \n- \n- \n\n### \n\n\n BaseObjectA  BaseObjectB(BaseObjectA1..., BaseObjectB1...)\n```objectivec\n#pragma mark ----- BaseObjectA.h -----\n\n@interface BaseObjectA : NSObject\n\n// \n@property (nonatomic, strong) BaseObjectB *objB;\n\n// \n- (void)handle;\n\n@end\n```\n\n```objectivec\n#pragma mark ----- BaseObjectA.m -----\n\n@implementation BaseObjectA\n\n /*\n    A1 --> B1B2B3         3\n    A2 --> B1B2B3         3\n    A3 --> B1B2B3         3\n  */\n- (void)handle\n{\n    // override to subclass\n    \n    [self.objB fetchData];\n}\n\n@end\n```\n\n```objectivec\n#pragma mark ----- BaseObjectB.h -----\n\n@interface BaseObjectB : NSObject\n\n- (void)fetchData;\n\n@end\n```\n\n```objectivec\n#pragma mark ----- BaseObjectB.m -----\n\n@implementation BaseObjectB\n\n- (void)fetchData\n{\n    // override to subclass\n}\n\n@end\n```\n\n\n```objectivec\n#pragma mark ----- BridgeDemo.h -----\n\n@interface BridgeDemo : NSObject\n\n- (void)fetch;\n\n@end\n```\n\n```objectivec\n#pragma mark ----- BridgeDemo.m -----\n\n@interface BridgeDemo()\n\n@property (nonatomic, strong) BaseObjectA *objA;\n\n@end\n\n@implementation BridgeDemo\n\n/*\n \n A1 --> B1B2B3         3\n A2 --> B1B2B3         3\n A3 --> B1B2B3         3\n */\n- (void)fetch\n{\n    // ClassA\n    _objA = [[ObjectA1 alloc] init];\n    \n    // ClassB\n    BaseObjectB *b1 = [[ObjectB1 alloc] init];\n    // ClassB1 ClassB\n    _objA.objB = b1;\n    \n    // \n    [_objA handle];\n}\n\n@end\n```\n\n### \n\n\n\n\n```objectivec\n#pragma mark ----- Target.h -----\n\n@interface Target : NSObject\n\n- (void)operation;\n\n@end\n```\n\n```objectivec\n#pragma mark ----- Target.m -----\n\n@implementation Target\n\n- (void)operation\n{\n    // \n}\n\n@end\n```\n\n\n```objectivec\n#pragma mark ----- CoolTarget.h -----\n\n// \n@interface CoolTarget : NSObject\n\n// \n@property (nonatomic, strong) Target *target;\n\n// \n- (void)request;\n\n@end\n```\n\n```objectivec\n#pragma mark ----- CoolTarget.m -----\n\n@implementation CoolTarget\n\n- (void)request\n{\n    // \n    \n    [self.target operation];\n    \n    // \n}\n\n@end\n```\n\n## \n\n(Behavioral Pattern)\n\n- \n- \n- \n- \n- \n- \n- \n- \n- \n- \n- \n\n### \n\n\n\n```objectivec\n#pragma mark ----- BusinessObject.h -----\n\n@class BusinessObject;\n\ntypedef void (^CompletionBlock)(BOOL handled);\ntypedef void (^ResultBlock)(BusinessObject * __nullable handler, BOOL handled);\n\n@interface BusinessObject : NSObject\n\n// \n@property (nonatomic, strong) BusinessObject *nextBusiness;\n\n// \n- (void)handle:(ResultBlock)result;\n\n// \n- (void)handleBusiness:(CompletionBlock)completion;\n\n@end\n```\n\n```objectivec\n#pragma mark ----- BusinessObject.m -----\n\n@implementation BusinessObject\n\n- (void)handle:(ResultBlock)result {\n    CompletionBlock completion = ^(BOOL handled) {\n        if (handled) {\n            result(self, handled);\n        } else {\n            if (self.nextBusiness) {\n                [self.nextBusiness handle:result];\n            } else {\n                result(nil, NO);\n            }\n        }\n    };\n    [self handleBusiness:completion];\n}\n\n\n- (void)handleBusiness:(CompletionBlock)completion {\n    // \n}\n\n@end\n```\n\n(nextBusiness)\n\n### \n\n\n\n\n```objectivec\n#pragma mark ----- Command.h -----\n\n@class Command;\ntypedef void(^CommandCompletionCallBack)(Command* cmd);\n\n@interface Command : NSObject\n@property (nonatomic, copy) CommandCompletionCallBack completion;\n\n- (void)execute;\n- (void)cancel;\n\n- (void)done;\n\n@end\n```\n\n```objectivec\n#pragma mark ----- Command.m -----\n\n@implementation Command\n\n- (void)execute{\n    //override to subclass;\n    [self done];\n}\n\n- (void)cancel {\n    self.completion = nil;\n}\n\n- (void)done {\n    dispatch_async(dispatch_get_main_queue(), ^{\n        if (_completion) {\n            _completion(self);\n        }\n        //\n        self.completion = nil;\n        [[CommandManager sharedInstance].arrayCommands removeObject:self];\n    });\n}\n\n@end\n```\n\n\n\n```objectivec\n#pragma mark ----- CommandManager.h -----\n\n@interface CommandManager : NSObject\n\n// \n@property (nonatomic, strong) NSMutableArray <Command*> *arrayCommands;\n\n// \n+ (instancetype)sharedInstance;\n\n// \n+ (void)executeCommand:(Command *)cmd completion:(CommandCompletionCallBack)completion;\n\n// \n+ (void)cancelCommand:(Command *)cmd;\n\n@end\n```\n\n```objectivec\n@implementation CommandManager\n\n// \n+ (instancetype)sharedInstance {\n    static CommandManager *instance = nil;\n    static dispatch_once_t onceToken;\n    dispatch_once(&onceToken, ^{\n        instance = [[super allocWithZone:NULL] init];\n    });\n    return instance;\n}\n\n// \n+ (id)allocWithZone:(struct _NSZone *)zone {\n    return [self sharedInstance];\n}\n\n// \n- (id)copyWithZone:(nullable NSZone *)zone {\n    return self;\n}\n\n// \n- (id)init {\n    self = [super init];\n    if (self) {\n        // \n        _arrayCommands = [NSMutableArray array];\n    }\n    return self;\n}\n\n+ (void)executeCommand:(Command *)cmd completion:(CommandCompletionCallBack)completion {\n    if (cmd) {\n        // \n        if (![self _isExecutingCommand:cmd]) {\n            // \n            [[[self sharedInstance] arrayCommands] addObject:cmd];\n            // \n            cmd.completion = completion;\n            //\n            [cmd execute];\n        }\n    }\n}\n\n// \n+ (void)cancelCommand:(Command *)cmd {\n    if (cmd) {\n        // \n        [[[self sharedInstance] arrayCommands] removeObject:cmd];\n        // \n        [cmd cancel];\n    }\n}\n\n// \n+ (BOOL)_isExecutingCommand:(Command *)cmd {\n    if (cmd) {\n        NSArray *cmds = [[self sharedInstance] arrayCommands];\n        for (Command *aCmd in cmds) {\n            // \n            if (cmd == aCmd) {\n                return YES;\n            }\n        }\n    }\n    return NO;\n}\n\n@end\n```\n\n# \n\n\n\n# \n\n[ 23 ](https://github.com/xietao3/Study-Plan/blob/master/DesignPatterns/README.md)","slug":"2019/talk-about-design-pattern-0326","published":1,"updated":"2021-06-21T12:34:52.098Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckszp3ndm001difnt93mw1sge","content":"<blockquote>\n<p> Design Pattern </p>\n</blockquote>\n<h1 id=\"\"></h1>\n<ul>\n<li>\n<p></p>\n</li>\n<li>\n<p></p>\n</li>\n<li>\n<p></p>\n</li>\n<li>\n<p></p>\n</li>\n<li>\n<p></p>\n</li>\n</ul>\n<h1 id=\"\"></h1>\n<h2 id=\"\"></h2>\n<p><br>\n UIView  CALayer UIView  CALayer </p>\n<h2 id=\"\"></h2>\n<p><br>\n</p>\n<h2 id=\"\"></h2>\n<p><br>\n</p>\n<h2 id=\"\"></h2>\n<p><br>\n KVO  addObserver </p>\n<h2 id=\"\"></h2>\n<p><br>\n UITableViewDelegate  UITableViewDataSource UITableViewDelegate  UITableView  UITableViewDataSource </p>\n<h2 id=\"\"></h2>\n<p><br>\n</p>\n<h1 id=\"\"></h1>\n<h2 id=\"\"></h2>\n<p>(Creational Pattern)</p>\n<ul>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n<h3 id=\"\"></h3>\n<p><br>\n</p>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#pragma mark ----- SingleInstance.h -----</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">@interface</span> <span class=\"title\">SingleInstance</span> : <span class=\"title\">NSObject</span></span></span><br><span class=\"line\"></span><br><span class=\"line\">+ (<span class=\"keyword\">id</span>)sharedInstance;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">@end</span></span><br></pre></td></tr></table></figure>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#pragma mark ----- SingleInstance.m -----</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">@implementation</span> <span class=\"title\">SingleInstance</span></span></span><br><span class=\"line\"></span><br><span class=\"line\">+ (<span class=\"keyword\">id</span>)sharedInstance</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">static</span> Mooc *instance = <span class=\"literal\">nil</span>;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">// dispatch_once instance</span></span><br><span class=\"line\">    <span class=\"keyword\">static</span> <span class=\"built_in\">dispatch_once_t</span> onceToken;</span><br><span class=\"line\">    <span class=\"built_in\">dispatch_once</span>(&amp;onceToken, ^&#123;</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        instance = [[<span class=\"keyword\">super</span> allocWithZone:<span class=\"literal\">NULL</span>] init];</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> instance;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\">+ (<span class=\"keyword\">id</span>)allocWithZone:(<span class=\"keyword\">struct</span> _NSZone *)zone&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> [<span class=\"keyword\">self</span> sharedInstance];</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\">- (<span class=\"keyword\">id</span>)copyWithZone:(<span class=\"keyword\">nullable</span> <span class=\"built_in\">NSZone</span> *)zone&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">self</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">@end</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"\"></h2>\n<p>(Structural Pattern)</p>\n<ul>\n<li></li>\n<li><br>\n</li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n<h3 id=\"\"></h3>\n<p><br>\n BaseObjectA  BaseObjectB(BaseObjectA1, BaseObjectB1)</p>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#pragma mark ----- BaseObjectA.h -----</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">@interface</span> <span class=\"title\">BaseObjectA</span> : <span class=\"title\">NSObject</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">@property</span> (<span class=\"keyword\">nonatomic</span>, <span class=\"keyword\">strong</span>) BaseObjectB *objB;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\">- (<span class=\"keyword\">void</span>)handle;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">@end</span></span><br></pre></td></tr></table></figure>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#pragma mark ----- BaseObjectA.m -----</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">@implementation</span> <span class=\"title\">BaseObjectA</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"> <span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">    A1 --&gt; B1B2B3         3</span></span><br><span class=\"line\"><span class=\"comment\">    A2 --&gt; B1B2B3         3</span></span><br><span class=\"line\"><span class=\"comment\">    A3 --&gt; B1B2B3         3</span></span><br><span class=\"line\"><span class=\"comment\">  */</span></span><br><span class=\"line\">- (<span class=\"keyword\">void</span>)handle</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"comment\">// override to subclass</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    [<span class=\"keyword\">self</span>.objB fetchData];</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">@end</span></span><br></pre></td></tr></table></figure>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#pragma mark ----- BaseObjectB.h -----</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">@interface</span> <span class=\"title\">BaseObjectB</span> : <span class=\"title\">NSObject</span></span></span><br><span class=\"line\"></span><br><span class=\"line\">- (<span class=\"keyword\">void</span>)fetchData;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">@end</span></span><br></pre></td></tr></table></figure>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#pragma mark ----- BaseObjectB.m -----</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">@implementation</span> <span class=\"title\">BaseObjectB</span></span></span><br><span class=\"line\"></span><br><span class=\"line\">- (<span class=\"keyword\">void</span>)fetchData</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"comment\">// override to subclass</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">@end</span></span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#pragma mark ----- BridgeDemo.h -----</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">@interface</span> <span class=\"title\">BridgeDemo</span> : <span class=\"title\">NSObject</span></span></span><br><span class=\"line\"></span><br><span class=\"line\">- (<span class=\"keyword\">void</span>)fetch;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">@end</span></span><br></pre></td></tr></table></figure>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#pragma mark ----- BridgeDemo.m -----</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">@interface</span> <span class=\"title\">BridgeDemo</span>()</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">@property</span> (<span class=\"keyword\">nonatomic</span>, <span class=\"keyword\">strong</span>) BaseObjectA *objA;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">@end</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">@implementation</span> <span class=\"title\">BridgeDemo</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"> A1 --&gt; B1B2B3         3</span></span><br><span class=\"line\"><span class=\"comment\"> A2 --&gt; B1B2B3         3</span></span><br><span class=\"line\"><span class=\"comment\"> A3 --&gt; B1B2B3         3</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">- (<span class=\"keyword\">void</span>)fetch</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"comment\">// ClassA</span></span><br><span class=\"line\">    _objA = [[ObjectA1 alloc] init];</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">// ClassB</span></span><br><span class=\"line\">    BaseObjectB *b1 = [[ObjectB1 alloc] init];</span><br><span class=\"line\">    <span class=\"comment\">// ClassB1 ClassB</span></span><br><span class=\"line\">    _objA.objB = b1;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    [_objA handle];</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">@end</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"\"></h3>\n<p></p>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#pragma mark ----- Target.h -----</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">@interface</span> <span class=\"title\">Target</span> : <span class=\"title\">NSObject</span></span></span><br><span class=\"line\"></span><br><span class=\"line\">- (<span class=\"keyword\">void</span>)operation;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">@end</span></span><br></pre></td></tr></table></figure>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#pragma mark ----- Target.m -----</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">@implementation</span> <span class=\"title\">Target</span></span></span><br><span class=\"line\"></span><br><span class=\"line\">- (<span class=\"keyword\">void</span>)operation</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">@end</span></span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#pragma mark ----- CoolTarget.h -----</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">@interface</span> <span class=\"title\">CoolTarget</span> : <span class=\"title\">NSObject</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">@property</span> (<span class=\"keyword\">nonatomic</span>, <span class=\"keyword\">strong</span>) Target *target;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\">- (<span class=\"keyword\">void</span>)request;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">@end</span></span><br></pre></td></tr></table></figure>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#pragma mark ----- CoolTarget.m -----</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">@implementation</span> <span class=\"title\">CoolTarget</span></span></span><br><span class=\"line\"></span><br><span class=\"line\">- (<span class=\"keyword\">void</span>)request</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    </span><br><span class=\"line\">    [<span class=\"keyword\">self</span>.target operation];</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">@end</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"\"></h2>\n<p>(Behavioral Pattern)</p>\n<ul>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n<h3 id=\"\"></h3>\n<p></p>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#pragma mark ----- BusinessObject.h -----</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">@class</span> <span class=\"title\">BusinessObject</span>;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">typedef</span> <span class=\"keyword\">void</span> (^CompletionBlock)(<span class=\"built_in\">BOOL</span> handled);</span><br><span class=\"line\"><span class=\"keyword\">typedef</span> <span class=\"keyword\">void</span> (^ResultBlock)(BusinessObject * __<span class=\"keyword\">nullable</span> handler, <span class=\"built_in\">BOOL</span> handled);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">@interface</span> <span class=\"title\">BusinessObject</span> : <span class=\"title\">NSObject</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">@property</span> (<span class=\"keyword\">nonatomic</span>, <span class=\"keyword\">strong</span>) BusinessObject *nextBusiness;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\">- (<span class=\"keyword\">void</span>)handle:(ResultBlock)result;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\">- (<span class=\"keyword\">void</span>)handleBusiness:(CompletionBlock)completion;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">@end</span></span><br></pre></td></tr></table></figure>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#pragma mark ----- BusinessObject.m -----</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">@implementation</span> <span class=\"title\">BusinessObject</span></span></span><br><span class=\"line\"></span><br><span class=\"line\">- (<span class=\"keyword\">void</span>)handle:(ResultBlock)result &#123;</span><br><span class=\"line\">    CompletionBlock completion = ^(<span class=\"built_in\">BOOL</span> handled) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (handled) &#123;</span><br><span class=\"line\">            result(<span class=\"keyword\">self</span>, handled);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (<span class=\"keyword\">self</span>.nextBusiness) &#123;</span><br><span class=\"line\">                [<span class=\"keyword\">self</span>.nextBusiness handle:result];</span><br><span class=\"line\">            &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                result(<span class=\"literal\">nil</span>, <span class=\"literal\">NO</span>);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">    [<span class=\"keyword\">self</span> handleBusiness:completion];</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">- (<span class=\"keyword\">void</span>)handleBusiness:(CompletionBlock)completion &#123;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">@end</span></span><br></pre></td></tr></table></figure>\n<p>(nextBusiness)</p>\n<h3 id=\"\"></h3>\n<p></p>\n<p></p>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#pragma mark ----- Command.h -----</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">@class</span> <span class=\"title\">Command</span>;</span></span><br><span class=\"line\"><span class=\"keyword\">typedef</span> <span class=\"keyword\">void</span>(^CommandCompletionCallBack)(Command* cmd);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">@interface</span> <span class=\"title\">Command</span> : <span class=\"title\">NSObject</span></span></span><br><span class=\"line\"><span class=\"keyword\">@property</span> (<span class=\"keyword\">nonatomic</span>, <span class=\"keyword\">copy</span>) CommandCompletionCallBack completion;</span><br><span class=\"line\"></span><br><span class=\"line\">- (<span class=\"keyword\">void</span>)execute;</span><br><span class=\"line\">- (<span class=\"keyword\">void</span>)cancel;</span><br><span class=\"line\"></span><br><span class=\"line\">- (<span class=\"keyword\">void</span>)done;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">@end</span></span><br></pre></td></tr></table></figure>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#pragma mark ----- Command.m -----</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">@implementation</span> <span class=\"title\">Command</span></span></span><br><span class=\"line\"></span><br><span class=\"line\">- (<span class=\"keyword\">void</span>)execute&#123;</span><br><span class=\"line\">    <span class=\"comment\">//override to subclass;</span></span><br><span class=\"line\">    [<span class=\"keyword\">self</span> done];</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">- (<span class=\"keyword\">void</span>)cancel &#123;</span><br><span class=\"line\">    <span class=\"keyword\">self</span>.completion = <span class=\"literal\">nil</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">- (<span class=\"keyword\">void</span>)done &#123;</span><br><span class=\"line\">    <span class=\"built_in\">dispatch_async</span>(dispatch_get_main_queue(), ^&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (_completion) &#123;</span><br><span class=\"line\">            _completion(<span class=\"keyword\">self</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"comment\">//</span></span><br><span class=\"line\">        <span class=\"keyword\">self</span>.completion = <span class=\"literal\">nil</span>;</span><br><span class=\"line\">        [[CommandManager sharedInstance].arrayCommands removeObject:<span class=\"keyword\">self</span>];</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">@end</span></span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#pragma mark ----- CommandManager.h -----</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">@interface</span> <span class=\"title\">CommandManager</span> : <span class=\"title\">NSObject</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">@property</span> (<span class=\"keyword\">nonatomic</span>, <span class=\"keyword\">strong</span>) <span class=\"built_in\">NSMutableArray</span> &lt;Command*&gt; *arrayCommands;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\">+ (<span class=\"keyword\">instancetype</span>)sharedInstance;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\">+ (<span class=\"keyword\">void</span>)executeCommand:(Command *)cmd completion:(CommandCompletionCallBack)completion;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\">+ (<span class=\"keyword\">void</span>)cancelCommand:(Command *)cmd;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">@end</span></span><br></pre></td></tr></table></figure>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">@implementation</span> <span class=\"title\">CommandManager</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\">+ (<span class=\"keyword\">instancetype</span>)sharedInstance &#123;</span><br><span class=\"line\">    <span class=\"keyword\">static</span> CommandManager *instance = <span class=\"literal\">nil</span>;</span><br><span class=\"line\">    <span class=\"keyword\">static</span> <span class=\"built_in\">dispatch_once_t</span> onceToken;</span><br><span class=\"line\">    <span class=\"built_in\">dispatch_once</span>(&amp;onceToken, ^&#123;</span><br><span class=\"line\">        instance = [[<span class=\"keyword\">super</span> allocWithZone:<span class=\"literal\">NULL</span>] init];</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> instance;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\">+ (<span class=\"keyword\">id</span>)allocWithZone:(<span class=\"keyword\">struct</span> _NSZone *)zone &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> [<span class=\"keyword\">self</span> sharedInstance];</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\">- (<span class=\"keyword\">id</span>)copyWithZone:(<span class=\"keyword\">nullable</span> <span class=\"built_in\">NSZone</span> *)zone &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">self</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\">- (<span class=\"keyword\">id</span>)init &#123;</span><br><span class=\"line\">    <span class=\"keyword\">self</span> = [<span class=\"keyword\">super</span> init];</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"keyword\">self</span>) &#123;</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        _arrayCommands = [<span class=\"built_in\">NSMutableArray</span> array];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">self</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">+ (<span class=\"keyword\">void</span>)executeCommand:(Command *)cmd completion:(CommandCompletionCallBack)completion &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (cmd) &#123;</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (![<span class=\"keyword\">self</span> _isExecutingCommand:cmd]) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// </span></span><br><span class=\"line\">            [[[<span class=\"keyword\">self</span> sharedInstance] arrayCommands] addObject:cmd];</span><br><span class=\"line\">            <span class=\"comment\">// </span></span><br><span class=\"line\">            cmd.completion = completion;</span><br><span class=\"line\">            <span class=\"comment\">//</span></span><br><span class=\"line\">            [cmd execute];</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\">+ (<span class=\"keyword\">void</span>)cancelCommand:(Command *)cmd &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (cmd) &#123;</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        [[[<span class=\"keyword\">self</span> sharedInstance] arrayCommands] removeObject:cmd];</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        [cmd cancel];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\">+ (<span class=\"built_in\">BOOL</span>)_isExecutingCommand:(Command *)cmd &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (cmd) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">NSArray</span> *cmds = [[<span class=\"keyword\">self</span> sharedInstance] arrayCommands];</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (Command *aCmd <span class=\"keyword\">in</span> cmds) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// </span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (cmd == aCmd) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">return</span> <span class=\"literal\">YES</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"literal\">NO</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">@end</span></span><br></pre></td></tr></table></figure>\n<h1 id=\"\"></h1>\n<p></p>\n<h1 id=\"\"></h1>\n<p><a href=\"https://github.com/xietao3/Study-Plan/blob/master/DesignPatterns/README.md\" target=\"_blank\" rel=\"noopener\"> 23 </a></p>\n","site":{"data":{}},"excerpt":"","more":"<blockquote>\n<p> Design Pattern </p>\n</blockquote>\n<h1></h1>\n<ul>\n<li>\n<p></p>\n</li>\n<li>\n<p></p>\n</li>\n<li>\n<p></p>\n</li>\n<li>\n<p></p>\n</li>\n<li>\n<p></p>\n</li>\n</ul>\n<h1></h1>\n<h2></h2>\n<p><br>\n UIView  CALayer UIView  CALayer </p>\n<h2></h2>\n<p><br>\n</p>\n<h2></h2>\n<p><br>\n</p>\n<h2></h2>\n<p><br>\n KVO  addObserver </p>\n<h2></h2>\n<p><br>\n UITableViewDelegate  UITableViewDataSource UITableViewDelegate  UITableView  UITableViewDataSource </p>\n<h2></h2>\n<p><br>\n</p>\n<h1></h1>\n<h2></h2>\n<p>(Creational Pattern)</p>\n<ul>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n<h3></h3>\n<p><br>\n</p>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#pragma mark ----- SingleInstance.h -----</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">@interface</span> <span class=\"title\">SingleInstance</span> : <span class=\"title\">NSObject</span></span></span><br><span class=\"line\"></span><br><span class=\"line\">+ (<span class=\"keyword\">id</span>)sharedInstance;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">@end</span></span><br></pre></td></tr></table></figure>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#pragma mark ----- SingleInstance.m -----</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">@implementation</span> <span class=\"title\">SingleInstance</span></span></span><br><span class=\"line\"></span><br><span class=\"line\">+ (<span class=\"keyword\">id</span>)sharedInstance</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">static</span> Mooc *instance = <span class=\"literal\">nil</span>;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">// dispatch_once instance</span></span><br><span class=\"line\">    <span class=\"keyword\">static</span> <span class=\"built_in\">dispatch_once_t</span> onceToken;</span><br><span class=\"line\">    <span class=\"built_in\">dispatch_once</span>(&amp;onceToken, ^&#123;</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        instance = [[<span class=\"keyword\">super</span> allocWithZone:<span class=\"literal\">NULL</span>] init];</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> instance;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\">+ (<span class=\"keyword\">id</span>)allocWithZone:(<span class=\"keyword\">struct</span> _NSZone *)zone&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> [<span class=\"keyword\">self</span> sharedInstance];</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\">- (<span class=\"keyword\">id</span>)copyWithZone:(<span class=\"keyword\">nullable</span> <span class=\"built_in\">NSZone</span> *)zone&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">self</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">@end</span></span><br></pre></td></tr></table></figure>\n<h2></h2>\n<p>(Structural Pattern)</p>\n<ul>\n<li></li>\n<li><br>\n</li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n<h3></h3>\n<p><br>\n BaseObjectA  BaseObjectB(BaseObjectA1, BaseObjectB1)</p>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#pragma mark ----- BaseObjectA.h -----</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">@interface</span> <span class=\"title\">BaseObjectA</span> : <span class=\"title\">NSObject</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">@property</span> (<span class=\"keyword\">nonatomic</span>, <span class=\"keyword\">strong</span>) BaseObjectB *objB;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\">- (<span class=\"keyword\">void</span>)handle;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">@end</span></span><br></pre></td></tr></table></figure>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#pragma mark ----- BaseObjectA.m -----</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">@implementation</span> <span class=\"title\">BaseObjectA</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"> <span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">    A1 --&gt; B1B2B3         3</span></span><br><span class=\"line\"><span class=\"comment\">    A2 --&gt; B1B2B3         3</span></span><br><span class=\"line\"><span class=\"comment\">    A3 --&gt; B1B2B3         3</span></span><br><span class=\"line\"><span class=\"comment\">  */</span></span><br><span class=\"line\">- (<span class=\"keyword\">void</span>)handle</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"comment\">// override to subclass</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    [<span class=\"keyword\">self</span>.objB fetchData];</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">@end</span></span><br></pre></td></tr></table></figure>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#pragma mark ----- BaseObjectB.h -----</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">@interface</span> <span class=\"title\">BaseObjectB</span> : <span class=\"title\">NSObject</span></span></span><br><span class=\"line\"></span><br><span class=\"line\">- (<span class=\"keyword\">void</span>)fetchData;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">@end</span></span><br></pre></td></tr></table></figure>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#pragma mark ----- BaseObjectB.m -----</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">@implementation</span> <span class=\"title\">BaseObjectB</span></span></span><br><span class=\"line\"></span><br><span class=\"line\">- (<span class=\"keyword\">void</span>)fetchData</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"comment\">// override to subclass</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">@end</span></span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#pragma mark ----- BridgeDemo.h -----</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">@interface</span> <span class=\"title\">BridgeDemo</span> : <span class=\"title\">NSObject</span></span></span><br><span class=\"line\"></span><br><span class=\"line\">- (<span class=\"keyword\">void</span>)fetch;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">@end</span></span><br></pre></td></tr></table></figure>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#pragma mark ----- BridgeDemo.m -----</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">@interface</span> <span class=\"title\">BridgeDemo</span>()</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">@property</span> (<span class=\"keyword\">nonatomic</span>, <span class=\"keyword\">strong</span>) BaseObjectA *objA;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">@end</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">@implementation</span> <span class=\"title\">BridgeDemo</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"> A1 --&gt; B1B2B3         3</span></span><br><span class=\"line\"><span class=\"comment\"> A2 --&gt; B1B2B3         3</span></span><br><span class=\"line\"><span class=\"comment\"> A3 --&gt; B1B2B3         3</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">- (<span class=\"keyword\">void</span>)fetch</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"comment\">// ClassA</span></span><br><span class=\"line\">    _objA = [[ObjectA1 alloc] init];</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">// ClassB</span></span><br><span class=\"line\">    BaseObjectB *b1 = [[ObjectB1 alloc] init];</span><br><span class=\"line\">    <span class=\"comment\">// ClassB1 ClassB</span></span><br><span class=\"line\">    _objA.objB = b1;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    [_objA handle];</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">@end</span></span><br></pre></td></tr></table></figure>\n<h3></h3>\n<p></p>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#pragma mark ----- Target.h -----</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">@interface</span> <span class=\"title\">Target</span> : <span class=\"title\">NSObject</span></span></span><br><span class=\"line\"></span><br><span class=\"line\">- (<span class=\"keyword\">void</span>)operation;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">@end</span></span><br></pre></td></tr></table></figure>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#pragma mark ----- Target.m -----</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">@implementation</span> <span class=\"title\">Target</span></span></span><br><span class=\"line\"></span><br><span class=\"line\">- (<span class=\"keyword\">void</span>)operation</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">@end</span></span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#pragma mark ----- CoolTarget.h -----</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">@interface</span> <span class=\"title\">CoolTarget</span> : <span class=\"title\">NSObject</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">@property</span> (<span class=\"keyword\">nonatomic</span>, <span class=\"keyword\">strong</span>) Target *target;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\">- (<span class=\"keyword\">void</span>)request;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">@end</span></span><br></pre></td></tr></table></figure>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#pragma mark ----- CoolTarget.m -----</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">@implementation</span> <span class=\"title\">CoolTarget</span></span></span><br><span class=\"line\"></span><br><span class=\"line\">- (<span class=\"keyword\">void</span>)request</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    </span><br><span class=\"line\">    [<span class=\"keyword\">self</span>.target operation];</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">@end</span></span><br></pre></td></tr></table></figure>\n<h2></h2>\n<p>(Behavioral Pattern)</p>\n<ul>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n<h3></h3>\n<p></p>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#pragma mark ----- BusinessObject.h -----</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">@class</span> <span class=\"title\">BusinessObject</span>;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">typedef</span> <span class=\"keyword\">void</span> (^CompletionBlock)(<span class=\"built_in\">BOOL</span> handled);</span><br><span class=\"line\"><span class=\"keyword\">typedef</span> <span class=\"keyword\">void</span> (^ResultBlock)(BusinessObject * __<span class=\"keyword\">nullable</span> handler, <span class=\"built_in\">BOOL</span> handled);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">@interface</span> <span class=\"title\">BusinessObject</span> : <span class=\"title\">NSObject</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">@property</span> (<span class=\"keyword\">nonatomic</span>, <span class=\"keyword\">strong</span>) BusinessObject *nextBusiness;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\">- (<span class=\"keyword\">void</span>)handle:(ResultBlock)result;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\">- (<span class=\"keyword\">void</span>)handleBusiness:(CompletionBlock)completion;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">@end</span></span><br></pre></td></tr></table></figure>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#pragma mark ----- BusinessObject.m -----</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">@implementation</span> <span class=\"title\">BusinessObject</span></span></span><br><span class=\"line\"></span><br><span class=\"line\">- (<span class=\"keyword\">void</span>)handle:(ResultBlock)result &#123;</span><br><span class=\"line\">    CompletionBlock completion = ^(<span class=\"built_in\">BOOL</span> handled) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (handled) &#123;</span><br><span class=\"line\">            result(<span class=\"keyword\">self</span>, handled);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (<span class=\"keyword\">self</span>.nextBusiness) &#123;</span><br><span class=\"line\">                [<span class=\"keyword\">self</span>.nextBusiness handle:result];</span><br><span class=\"line\">            &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                result(<span class=\"literal\">nil</span>, <span class=\"literal\">NO</span>);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">    [<span class=\"keyword\">self</span> handleBusiness:completion];</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">- (<span class=\"keyword\">void</span>)handleBusiness:(CompletionBlock)completion &#123;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">@end</span></span><br></pre></td></tr></table></figure>\n<p>(nextBusiness)</p>\n<h3></h3>\n<p></p>\n<p></p>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#pragma mark ----- Command.h -----</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">@class</span> <span class=\"title\">Command</span>;</span></span><br><span class=\"line\"><span class=\"keyword\">typedef</span> <span class=\"keyword\">void</span>(^CommandCompletionCallBack)(Command* cmd);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">@interface</span> <span class=\"title\">Command</span> : <span class=\"title\">NSObject</span></span></span><br><span class=\"line\"><span class=\"keyword\">@property</span> (<span class=\"keyword\">nonatomic</span>, <span class=\"keyword\">copy</span>) CommandCompletionCallBack completion;</span><br><span class=\"line\"></span><br><span class=\"line\">- (<span class=\"keyword\">void</span>)execute;</span><br><span class=\"line\">- (<span class=\"keyword\">void</span>)cancel;</span><br><span class=\"line\"></span><br><span class=\"line\">- (<span class=\"keyword\">void</span>)done;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">@end</span></span><br></pre></td></tr></table></figure>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#pragma mark ----- Command.m -----</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">@implementation</span> <span class=\"title\">Command</span></span></span><br><span class=\"line\"></span><br><span class=\"line\">- (<span class=\"keyword\">void</span>)execute&#123;</span><br><span class=\"line\">    <span class=\"comment\">//override to subclass;</span></span><br><span class=\"line\">    [<span class=\"keyword\">self</span> done];</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">- (<span class=\"keyword\">void</span>)cancel &#123;</span><br><span class=\"line\">    <span class=\"keyword\">self</span>.completion = <span class=\"literal\">nil</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">- (<span class=\"keyword\">void</span>)done &#123;</span><br><span class=\"line\">    <span class=\"built_in\">dispatch_async</span>(dispatch_get_main_queue(), ^&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (_completion) &#123;</span><br><span class=\"line\">            _completion(<span class=\"keyword\">self</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"comment\">//</span></span><br><span class=\"line\">        <span class=\"keyword\">self</span>.completion = <span class=\"literal\">nil</span>;</span><br><span class=\"line\">        [[CommandManager sharedInstance].arrayCommands removeObject:<span class=\"keyword\">self</span>];</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">@end</span></span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#pragma mark ----- CommandManager.h -----</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">@interface</span> <span class=\"title\">CommandManager</span> : <span class=\"title\">NSObject</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">@property</span> (<span class=\"keyword\">nonatomic</span>, <span class=\"keyword\">strong</span>) <span class=\"built_in\">NSMutableArray</span> &lt;Command*&gt; *arrayCommands;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\">+ (<span class=\"keyword\">instancetype</span>)sharedInstance;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\">+ (<span class=\"keyword\">void</span>)executeCommand:(Command *)cmd completion:(CommandCompletionCallBack)completion;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\">+ (<span class=\"keyword\">void</span>)cancelCommand:(Command *)cmd;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">@end</span></span><br></pre></td></tr></table></figure>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">@implementation</span> <span class=\"title\">CommandManager</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\">+ (<span class=\"keyword\">instancetype</span>)sharedInstance &#123;</span><br><span class=\"line\">    <span class=\"keyword\">static</span> CommandManager *instance = <span class=\"literal\">nil</span>;</span><br><span class=\"line\">    <span class=\"keyword\">static</span> <span class=\"built_in\">dispatch_once_t</span> onceToken;</span><br><span class=\"line\">    <span class=\"built_in\">dispatch_once</span>(&amp;onceToken, ^&#123;</span><br><span class=\"line\">        instance = [[<span class=\"keyword\">super</span> allocWithZone:<span class=\"literal\">NULL</span>] init];</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> instance;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\">+ (<span class=\"keyword\">id</span>)allocWithZone:(<span class=\"keyword\">struct</span> _NSZone *)zone &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> [<span class=\"keyword\">self</span> sharedInstance];</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\">- (<span class=\"keyword\">id</span>)copyWithZone:(<span class=\"keyword\">nullable</span> <span class=\"built_in\">NSZone</span> *)zone &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">self</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\">- (<span class=\"keyword\">id</span>)init &#123;</span><br><span class=\"line\">    <span class=\"keyword\">self</span> = [<span class=\"keyword\">super</span> init];</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"keyword\">self</span>) &#123;</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        _arrayCommands = [<span class=\"built_in\">NSMutableArray</span> array];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">self</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">+ (<span class=\"keyword\">void</span>)executeCommand:(Command *)cmd completion:(CommandCompletionCallBack)completion &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (cmd) &#123;</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (![<span class=\"keyword\">self</span> _isExecutingCommand:cmd]) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// </span></span><br><span class=\"line\">            [[[<span class=\"keyword\">self</span> sharedInstance] arrayCommands] addObject:cmd];</span><br><span class=\"line\">            <span class=\"comment\">// </span></span><br><span class=\"line\">            cmd.completion = completion;</span><br><span class=\"line\">            <span class=\"comment\">//</span></span><br><span class=\"line\">            [cmd execute];</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\">+ (<span class=\"keyword\">void</span>)cancelCommand:(Command *)cmd &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (cmd) &#123;</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        [[[<span class=\"keyword\">self</span> sharedInstance] arrayCommands] removeObject:cmd];</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        [cmd cancel];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\">+ (<span class=\"built_in\">BOOL</span>)_isExecutingCommand:(Command *)cmd &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (cmd) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">NSArray</span> *cmds = [[<span class=\"keyword\">self</span> sharedInstance] arrayCommands];</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (Command *aCmd <span class=\"keyword\">in</span> cmds) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// </span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (cmd == aCmd) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">return</span> <span class=\"literal\">YES</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"literal\">NO</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">@end</span></span><br></pre></td></tr></table></figure>\n<h1></h1>\n<p></p>\n<h1></h1>\n<p><a href=\"https://github.com/xietao3/Study-Plan/blob/master/DesignPatterns/README.md\" target=\"_blank\" rel=\"noopener\"> 23 </a></p>\n"},{"title":"PDF","catalog":true,"toc_nav_num":true,"date":"2020-02-26T11:54:20.000Z","subtitle":"Load PDF File with Signature","header-img":"/img/article_header/article_header.png","busuanzi":true,"_content":"\n# \n\nPDF`UIWebView``WKWebView`PDF\n\n<!-- more -->\n\n# iOS 12\n\n`WKWebView`PDFURL`UIWebView`\n\n# iOS 12\n\n`WKWebView`[pdf.js](https://github.com/mozilla/pdf.js)`pfd.js``html`PDFPDF\n\n`pdf.js`\n- `pdf.js`API\n- `pdf.worker.js`\n\n## \n\n`pdf.js`[](http://mozilla.github.io/pdf.js/getting_started/)\n\n1. `Stable``PDF.js``viewer`\n\n![pdf.js](/img/article/20200226/1.png)\n\n2. [github](https://github.com/mozilla/pdf.js)\n- `gulp generic``pdf.js``pdf.worker.js``build/generic/`\n![](/img/article/20200226/3.png)\n- `gulp minified``pdf.js``pdf.worker.js``build/minified/`\n![](/img/article/20200226/4.png)\n\n\n![](/img/article/20200226/5.png)\n\n## \n\n`Create folder references``Create groups`\n\nPDF\n\n\n\n``` objectivec\n - (void)loadPDFFile:(NSString*)filePath {  \n    NSString *viwerPath = [[NSBundle mainBundle] pathForResource:@\"viewer\" ofType:@\"html\" inDirectory:@\"minified/web\"];\n    NSString *urlStr = [NSString stringWithFormat:@\"%@?file=%@#page=1\", viwerPath, filePath];\n    urlStr = [urlStr stringByAddingPercentEncodingWithAllowedCharacters:[NSCharacterSet URLQueryAllowedCharacterSet]];\n    NSURLRequest *request = [NSURLRequest requestWithURL:[NSURL URLWithString:urlStr]];\n    [self loadRequest:request];\n}\n```\n\n`pdf.js``data.fieldType === 'Sig'`\n\n``` objectivec\n//    if (data.fieldType === 'Sig') {\n//      data.fieldValue = null;\n//\n//      _this3.setFlags(_util.AnnotationFlag.HIDDEN);\n//    }\n```\n\n## \n\n`mozilla``github pages``Viewer`PDF`viewer.html`PDF\n\n``` objectivec\nNSString *urlStr = [NSString stringWithFormat:@\"http://mozilla.github.io/pdf.js/web/viewer.html?file=%@#page=1\", filePath];\n```\n\n`HTML`\n\n## \n\n![](/img/article/20200226/2.png)\n","source":"_posts/2020/load-pdf-with-signature-0226.md","raw":"---\ntitle: \"PDF\"\ncatalog: true\ntoc_nav_num: true\ndate: 2020-02-26 19:54:20\nsubtitle: \"Load PDF File with Signature\"\nheader-img: \"/img/article_header/article_header.png\"\nbusuanzi: true\ntags:\n- iOS - Objective-C\n\n---\n\n# \n\nPDF`UIWebView``WKWebView`PDF\n\n<!-- more -->\n\n# iOS 12\n\n`WKWebView`PDFURL`UIWebView`\n\n# iOS 12\n\n`WKWebView`[pdf.js](https://github.com/mozilla/pdf.js)`pfd.js``html`PDFPDF\n\n`pdf.js`\n- `pdf.js`API\n- `pdf.worker.js`\n\n## \n\n`pdf.js`[](http://mozilla.github.io/pdf.js/getting_started/)\n\n1. `Stable``PDF.js``viewer`\n\n![pdf.js](/img/article/20200226/1.png)\n\n2. [github](https://github.com/mozilla/pdf.js)\n- `gulp generic``pdf.js``pdf.worker.js``build/generic/`\n![](/img/article/20200226/3.png)\n- `gulp minified``pdf.js``pdf.worker.js``build/minified/`\n![](/img/article/20200226/4.png)\n\n\n![](/img/article/20200226/5.png)\n\n## \n\n`Create folder references``Create groups`\n\nPDF\n\n\n\n``` objectivec\n - (void)loadPDFFile:(NSString*)filePath {  \n    NSString *viwerPath = [[NSBundle mainBundle] pathForResource:@\"viewer\" ofType:@\"html\" inDirectory:@\"minified/web\"];\n    NSString *urlStr = [NSString stringWithFormat:@\"%@?file=%@#page=1\", viwerPath, filePath];\n    urlStr = [urlStr stringByAddingPercentEncodingWithAllowedCharacters:[NSCharacterSet URLQueryAllowedCharacterSet]];\n    NSURLRequest *request = [NSURLRequest requestWithURL:[NSURL URLWithString:urlStr]];\n    [self loadRequest:request];\n}\n```\n\n`pdf.js``data.fieldType === 'Sig'`\n\n``` objectivec\n//    if (data.fieldType === 'Sig') {\n//      data.fieldValue = null;\n//\n//      _this3.setFlags(_util.AnnotationFlag.HIDDEN);\n//    }\n```\n\n## \n\n`mozilla``github pages``Viewer`PDF`viewer.html`PDF\n\n``` objectivec\nNSString *urlStr = [NSString stringWithFormat:@\"http://mozilla.github.io/pdf.js/web/viewer.html?file=%@#page=1\", filePath];\n```\n\n`HTML`\n\n## \n\n![](/img/article/20200226/2.png)\n","slug":"2020/load-pdf-with-signature-0226","published":1,"updated":"2021-06-21T12:34:52.099Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckszp3ndn001gifntvbe86ip1","content":"<h1 id=\"\"></h1>\n<p>PDF<code>UIWebView</code><code>WKWebView</code>PDF</p>\n<a id=\"more\"></a>\n<h1 id=\"ios-12\">iOS 12</h1>\n<p><code>WKWebView</code>PDFURL<code>UIWebView</code></p>\n<h1 id=\"ios-12\">iOS 12</h1>\n<p><code>WKWebView</code><a href=\"https://github.com/mozilla/pdf.js\" target=\"_blank\" rel=\"noopener\">pdf.js</a><code>pfd.js</code><code>html</code>PDFPDF</p>\n<p><code>pdf.js</code></p>\n<ul>\n<li><code>pdf.js</code>API</li>\n<li><code>pdf.worker.js</code></li>\n</ul>\n<h2 id=\"\"></h2>\n<p><code>pdf.js</code><a href=\"http://mozilla.github.io/pdf.js/getting_started/\" target=\"_blank\" rel=\"noopener\"></a></p>\n<ol>\n<li><code>Stable</code><code>PDF.js</code><code>viewer</code></li>\n</ol>\n<p><img src=\"/img/article/20200226/1.png\" alt=\"pdf.js\"></p>\n<ol start=\"2\">\n<li><a href=\"https://github.com/mozilla/pdf.js\" target=\"_blank\" rel=\"noopener\">github</a></li>\n</ol>\n<ul>\n<li><code>gulp generic</code><code>pdf.js</code><code>pdf.worker.js</code><code>build/generic/</code><br>\n<img src=\"/img/article/20200226/3.png\" alt=\"\"></li>\n<li><code>gulp minified</code><code>pdf.js</code><code>pdf.worker.js</code><code>build/minified/</code><br>\n<img src=\"/img/article/20200226/4.png\" alt=\"\"></li>\n</ul>\n<p><br>\n<img src=\"/img/article/20200226/5.png\" alt=\"\"></p>\n<h2 id=\"\"></h2>\n<p><code>Create folder references</code><code>Create groups</code></p>\n<p>PDF</p>\n<p></p>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"> - (<span class=\"keyword\">void</span>)loadPDFFile:(<span class=\"built_in\">NSString</span>*)filePath &#123;  </span><br><span class=\"line\">    <span class=\"built_in\">NSString</span> *viwerPath = [[<span class=\"built_in\">NSBundle</span> mainBundle] pathForResource:<span class=\"string\">@\"viewer\"</span> ofType:<span class=\"string\">@\"html\"</span> inDirectory:<span class=\"string\">@\"minified/web\"</span>];</span><br><span class=\"line\">    <span class=\"built_in\">NSString</span> *urlStr = [<span class=\"built_in\">NSString</span> stringWithFormat:<span class=\"string\">@\"%@?file=%@#page=1\"</span>, viwerPath, filePath];</span><br><span class=\"line\">    urlStr = [urlStr stringByAddingPercentEncodingWithAllowedCharacters:[<span class=\"built_in\">NSCharacterSet</span> URLQueryAllowedCharacterSet]];</span><br><span class=\"line\">    <span class=\"built_in\">NSURLRequest</span> *request = [<span class=\"built_in\">NSURLRequest</span> requestWithURL:[<span class=\"built_in\">NSURL</span> URLWithString:urlStr]];</span><br><span class=\"line\">    [<span class=\"keyword\">self</span> loadRequest:request];</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><code>pdf.js</code><code>data.fieldType === 'Sig'</code></p>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//    if (data.fieldType === 'Sig') &#123;</span></span><br><span class=\"line\"><span class=\"comment\">//      data.fieldValue = null;</span></span><br><span class=\"line\"><span class=\"comment\">//</span></span><br><span class=\"line\"><span class=\"comment\">//      _this3.setFlags(_util.AnnotationFlag.HIDDEN);</span></span><br><span class=\"line\"><span class=\"comment\">//    &#125;</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"\"></h2>\n<p><code>mozilla</code><code>github pages</code><code>Viewer</code>PDF<code>viewer.html</code>PDF</p>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">NSString</span> *urlStr = [<span class=\"built_in\">NSString</span> stringWithFormat:<span class=\"string\">@\"http://mozilla.github.io/pdf.js/web/viewer.html?file=%@#page=1\"</span>, filePath];</span><br></pre></td></tr></table></figure>\n<p><code>HTML</code></p>\n<h2 id=\"\"></h2>\n<p><img src=\"/img/article/20200226/2.png\" alt=\"\"></p>\n","site":{"data":{}},"excerpt":"<h1></h1>\n<p>PDF<code>UIWebView</code><code>WKWebView</code>PDF</p>","more":"<h1>iOS 12</h1>\n<p><code>WKWebView</code>PDFURL<code>UIWebView</code></p>\n<h1>iOS 12</h1>\n<p><code>WKWebView</code><a href=\"https://github.com/mozilla/pdf.js\" target=\"_blank\" rel=\"noopener\">pdf.js</a><code>pfd.js</code><code>html</code>PDFPDF</p>\n<p><code>pdf.js</code></p>\n<ul>\n<li><code>pdf.js</code>API</li>\n<li><code>pdf.worker.js</code></li>\n</ul>\n<h2></h2>\n<p><code>pdf.js</code><a href=\"http://mozilla.github.io/pdf.js/getting_started/\" target=\"_blank\" rel=\"noopener\"></a></p>\n<ol>\n<li><code>Stable</code><code>PDF.js</code><code>viewer</code></li>\n</ol>\n<p><img src=\"/img/article/20200226/1.png\" alt=\"pdf.js\"></p>\n<ol start=\"2\">\n<li><a href=\"https://github.com/mozilla/pdf.js\" target=\"_blank\" rel=\"noopener\">github</a></li>\n</ol>\n<ul>\n<li><code>gulp generic</code><code>pdf.js</code><code>pdf.worker.js</code><code>build/generic/</code><br>\n<img src=\"/img/article/20200226/3.png\" alt=\"\"></li>\n<li><code>gulp minified</code><code>pdf.js</code><code>pdf.worker.js</code><code>build/minified/</code><br>\n<img src=\"/img/article/20200226/4.png\" alt=\"\"></li>\n</ul>\n<p><br>\n<img src=\"/img/article/20200226/5.png\" alt=\"\"></p>\n<h2></h2>\n<p><code>Create folder references</code><code>Create groups</code></p>\n<p>PDF</p>\n<p></p>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"> - (<span class=\"keyword\">void</span>)loadPDFFile:(<span class=\"built_in\">NSString</span>*)filePath &#123;  </span><br><span class=\"line\">    <span class=\"built_in\">NSString</span> *viwerPath = [[<span class=\"built_in\">NSBundle</span> mainBundle] pathForResource:<span class=\"string\">@\"viewer\"</span> ofType:<span class=\"string\">@\"html\"</span> inDirectory:<span class=\"string\">@\"minified/web\"</span>];</span><br><span class=\"line\">    <span class=\"built_in\">NSString</span> *urlStr = [<span class=\"built_in\">NSString</span> stringWithFormat:<span class=\"string\">@\"%@?file=%@#page=1\"</span>, viwerPath, filePath];</span><br><span class=\"line\">    urlStr = [urlStr stringByAddingPercentEncodingWithAllowedCharacters:[<span class=\"built_in\">NSCharacterSet</span> URLQueryAllowedCharacterSet]];</span><br><span class=\"line\">    <span class=\"built_in\">NSURLRequest</span> *request = [<span class=\"built_in\">NSURLRequest</span> requestWithURL:[<span class=\"built_in\">NSURL</span> URLWithString:urlStr]];</span><br><span class=\"line\">    [<span class=\"keyword\">self</span> loadRequest:request];</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><code>pdf.js</code><code>data.fieldType === 'Sig'</code></p>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//    if (data.fieldType === 'Sig') &#123;</span></span><br><span class=\"line\"><span class=\"comment\">//      data.fieldValue = null;</span></span><br><span class=\"line\"><span class=\"comment\">//</span></span><br><span class=\"line\"><span class=\"comment\">//      _this3.setFlags(_util.AnnotationFlag.HIDDEN);</span></span><br><span class=\"line\"><span class=\"comment\">//    &#125;</span></span><br></pre></td></tr></table></figure>\n<h2></h2>\n<p><code>mozilla</code><code>github pages</code><code>Viewer</code>PDF<code>viewer.html</code>PDF</p>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">NSString</span> *urlStr = [<span class=\"built_in\">NSString</span> stringWithFormat:<span class=\"string\">@\"http://mozilla.github.io/pdf.js/web/viewer.html?file=%@#page=1\"</span>, filePath];</span><br></pre></td></tr></table></figure>\n<p><code>HTML</code></p>\n<h2></h2>\n<p><img src=\"/img/article/20200226/2.png\" alt=\"\"></p>"},{"title":"NSTimer","catalog":true,"toc_nav_num":true,"date":"2020-03-30T12:04:21.000Z","subtitle":"The Circular Reference Issue with NSTimer","header-img":"/img/article_header/article_header.png","busuanzi":true,"_content":"\n# \n\n`View Controller``Anohter View Controller``pop``Another View Controller`\n\n``` objectivec\nself.timer = [NSTimer timerWithTimeInterval:1.0 target:self selector:@selector(timerAction) userInfo:nil repeats:YES];\n```\n\n`timer``VC``VC``timer``VC``target``timer`\n\n![](/img/article/20200330/1.png)\n\n<!-- more -->\n\n# weak\n\n`Block`--`weak``weak``strong``NSTimer``VC`\n\n# \n\n## invalidate\n\n> This method is the only way to remove a timer from an NSRunLoop object. The NSRunLoop object removes its strong reference to the timer, either just before the invalidate method returns or at some later point.\nIf it was configured with target and user info objects, the receiver removes its strong references to those objects as well.\n\n`NSTimer``invalidate``timer``dealloc``dealloc`\n`viewWillDisappear`\n\n## \n\n`NSObject``TimerWeakTarget`\n\n`TimerWeakTarget`\n``` objectivec\n// TimerWeakTarget.h\n@interface TimerWeakTarget : NSObject\n\n+ (NSTimer *) scheduledTimerWithTimeInterval:(NSTimeInterval)interval\n                                      target:(id)aTarget\n                                    selector:(SEL)aSelector\n                                    userInfo:(id)userInfo\n                                     repeats:(BOOL)repeats;\n\n@end\n```\n\n``` objectivec\n// TimerWeakTarget.m\n@interface TimerWeakTarget ()\n\n@property (weak, nonatomic) id target;\n@property (assign, nonatomic) SEL selector;\n@property (weak, nonatomic) NSTimer *tempTimer;\n\n@end\n\n@implementation TimerWeakTarget\n\n+ (NSTimer *)scheduledTimerWithTimeInterval:(NSTimeInterval)interval target:(id)aTarget selector:(SEL)aSelector userInfo:(id)userInfo repeats:(BOOL)repeats {\n    TimerWeakTarget *timerWeakTarget = [[TimerWeakTarget alloc] init];\n    timerWeakTarget.target = aTarget;\n    timerWeakTarget.selector = aSelector;\n    timerWeakTarget.tempTimer = [NSTimer scheduledTimerWithTimeInterval:interval target:timerWeakTarget selector:@selector(fire:) userInfo:userInfo repeats:repeats];\n    return timerWeakTarget.tempTimer;\n}\n\n\n- (void)fire:(NSTimer *)timer {\n    if (self.target && [self.target respondsToSelector:self.selector]) {\n        [self.target performSelector:self.selector withObject:timer.userInfo];\n    } else {\n        [self.tempTimer invalidate];\n    }\n}\n\n@end\n```\n\n\n``` objectivec\nself.timer = [TimerWeakTarget scheduledTimerWithTimeInterval:1.0 target:self selector:@selector(timerAction) userInfo:nil repeats:YES];\n```\n\n`VC``timer``timer``target``timerWeakTarget``timerWeakTarget``VC`\n\n![](/img/article/20200330/2.png)\n\n## WeakProxy\n\n`NSObject``WeakProxy`\n\n`WeakProxy`\n``` objectivec\n// WeakProxy.h\n@interface WeakProxy : NSObject\n\n+ (instancetype)proxyWithTarget:(id)target;\n\n@end\n```\n\n``` objectivec\n// WeakProxy.m\n@interface WeakProxy ()\n\n@property (weak, nonatomic) id weakTarget;\n\n@end\n\n@implementation WeakProxy\n\n+ (instancetype)proxyWithTarget:(id)target {\n    return [[WeakProxy alloc] initWithTarget:target];\n}\n\n\n- (instancetype)initWithTarget:(id)target {\n    _weakTarget = target;\n    return self;\n}\n\n\n- (id)forwardingTargetForSelector:(SEL)aSelector {\n    return self.weakTarget;\n}\n\n\n/* OR\n- (NSMethodSignature *)methodSignatureForSelector:(SEL)aSelector {\n    return [self.weakTarget methodSignatureForSelector:aSelector];\n}\n\n\n- (void)forwardInvocation:(NSInvocation *)anInvocation {\n    SEL sel = [anInvocation selector];\n    if ([self.weakTarget respondsToSelector:sel]) {\n        [anInvocation invokeWithTarget:self.weakTarget];\n    }\n}\n*/\n\n@end\n```\n\n\n``` objectivec\nself.timer = [NSTimer scheduledTimerWithTimeInterval:1.0 target:[WeakProxy proxyWithTarget:self] selector:@selector(timerAction) userInfo:nil repeats:YES];\n```\n\n`timer``target``WeakProxy``VC`\n\n## GCD\n\n\n``` objectivec\n@interface AnotherViewController ()\n\n@property (strong, nonatomic) dispatch_source_t timer;\n\n@end\n\n@implementation AnotherViewController\n\n- (void)viewDidLoad {\n    [super viewDidLoad];\n   \n    self.timer = dispatch_source_create(DISPATCH_SOURCE_TYPE_TIMER, 0, 0, dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0));\n    dispatch_source_set_timer(self.timer, DISPATCH_TIME_NOW, 1*NSEC_PER_SEC, 0);\n    dispatch_source_set_event_handler(self.timer, ^{\n        dispatch_async(dispatch_get_main_queue(), ^{\n            NSLog(@\"fire\");\n        });\n    });\n    dispatch_resume(self.timer);\n}\n\n@end\n```\n\n\n``` objectivec\ndispatch_source_cancel(self.timer);\n```\n\n## Block:\n\n`iOS 10``API`\n\n``` objectivec\nself.timer = [NSTimer scheduledTimerWithTimeInterval:1.0 repeats:YES block:^(NSTimer * _Nonnull timer) {\n    NSLog(@\"fire\");\n}];\n```\n\n\n","source":"_posts/2020/nstimer-circular-reference-issue-0330.md","raw":"---\ntitle: \"NSTimer\"\ncatalog: true\ntoc_nav_num: true\ndate: 2020-03-30 20:04:21\nsubtitle: \"The Circular Reference Issue with NSTimer\"\nheader-img: \"/img/article_header/article_header.png\"\nbusuanzi: true\ntags:\n- iOS - Objective-C\n\n---\n\n# \n\n`View Controller``Anohter View Controller``pop``Another View Controller`\n\n``` objectivec\nself.timer = [NSTimer timerWithTimeInterval:1.0 target:self selector:@selector(timerAction) userInfo:nil repeats:YES];\n```\n\n`timer``VC``VC``timer``VC``target``timer`\n\n![](/img/article/20200330/1.png)\n\n<!-- more -->\n\n# weak\n\n`Block`--`weak``weak``strong``NSTimer``VC`\n\n# \n\n## invalidate\n\n> This method is the only way to remove a timer from an NSRunLoop object. The NSRunLoop object removes its strong reference to the timer, either just before the invalidate method returns or at some later point.\nIf it was configured with target and user info objects, the receiver removes its strong references to those objects as well.\n\n`NSTimer``invalidate``timer``dealloc``dealloc`\n`viewWillDisappear`\n\n## \n\n`NSObject``TimerWeakTarget`\n\n`TimerWeakTarget`\n``` objectivec\n// TimerWeakTarget.h\n@interface TimerWeakTarget : NSObject\n\n+ (NSTimer *) scheduledTimerWithTimeInterval:(NSTimeInterval)interval\n                                      target:(id)aTarget\n                                    selector:(SEL)aSelector\n                                    userInfo:(id)userInfo\n                                     repeats:(BOOL)repeats;\n\n@end\n```\n\n``` objectivec\n// TimerWeakTarget.m\n@interface TimerWeakTarget ()\n\n@property (weak, nonatomic) id target;\n@property (assign, nonatomic) SEL selector;\n@property (weak, nonatomic) NSTimer *tempTimer;\n\n@end\n\n@implementation TimerWeakTarget\n\n+ (NSTimer *)scheduledTimerWithTimeInterval:(NSTimeInterval)interval target:(id)aTarget selector:(SEL)aSelector userInfo:(id)userInfo repeats:(BOOL)repeats {\n    TimerWeakTarget *timerWeakTarget = [[TimerWeakTarget alloc] init];\n    timerWeakTarget.target = aTarget;\n    timerWeakTarget.selector = aSelector;\n    timerWeakTarget.tempTimer = [NSTimer scheduledTimerWithTimeInterval:interval target:timerWeakTarget selector:@selector(fire:) userInfo:userInfo repeats:repeats];\n    return timerWeakTarget.tempTimer;\n}\n\n\n- (void)fire:(NSTimer *)timer {\n    if (self.target && [self.target respondsToSelector:self.selector]) {\n        [self.target performSelector:self.selector withObject:timer.userInfo];\n    } else {\n        [self.tempTimer invalidate];\n    }\n}\n\n@end\n```\n\n\n``` objectivec\nself.timer = [TimerWeakTarget scheduledTimerWithTimeInterval:1.0 target:self selector:@selector(timerAction) userInfo:nil repeats:YES];\n```\n\n`VC``timer``timer``target``timerWeakTarget``timerWeakTarget``VC`\n\n![](/img/article/20200330/2.png)\n\n## WeakProxy\n\n`NSObject``WeakProxy`\n\n`WeakProxy`\n``` objectivec\n// WeakProxy.h\n@interface WeakProxy : NSObject\n\n+ (instancetype)proxyWithTarget:(id)target;\n\n@end\n```\n\n``` objectivec\n// WeakProxy.m\n@interface WeakProxy ()\n\n@property (weak, nonatomic) id weakTarget;\n\n@end\n\n@implementation WeakProxy\n\n+ (instancetype)proxyWithTarget:(id)target {\n    return [[WeakProxy alloc] initWithTarget:target];\n}\n\n\n- (instancetype)initWithTarget:(id)target {\n    _weakTarget = target;\n    return self;\n}\n\n\n- (id)forwardingTargetForSelector:(SEL)aSelector {\n    return self.weakTarget;\n}\n\n\n/* OR\n- (NSMethodSignature *)methodSignatureForSelector:(SEL)aSelector {\n    return [self.weakTarget methodSignatureForSelector:aSelector];\n}\n\n\n- (void)forwardInvocation:(NSInvocation *)anInvocation {\n    SEL sel = [anInvocation selector];\n    if ([self.weakTarget respondsToSelector:sel]) {\n        [anInvocation invokeWithTarget:self.weakTarget];\n    }\n}\n*/\n\n@end\n```\n\n\n``` objectivec\nself.timer = [NSTimer scheduledTimerWithTimeInterval:1.0 target:[WeakProxy proxyWithTarget:self] selector:@selector(timerAction) userInfo:nil repeats:YES];\n```\n\n`timer``target``WeakProxy``VC`\n\n## GCD\n\n\n``` objectivec\n@interface AnotherViewController ()\n\n@property (strong, nonatomic) dispatch_source_t timer;\n\n@end\n\n@implementation AnotherViewController\n\n- (void)viewDidLoad {\n    [super viewDidLoad];\n   \n    self.timer = dispatch_source_create(DISPATCH_SOURCE_TYPE_TIMER, 0, 0, dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0));\n    dispatch_source_set_timer(self.timer, DISPATCH_TIME_NOW, 1*NSEC_PER_SEC, 0);\n    dispatch_source_set_event_handler(self.timer, ^{\n        dispatch_async(dispatch_get_main_queue(), ^{\n            NSLog(@\"fire\");\n        });\n    });\n    dispatch_resume(self.timer);\n}\n\n@end\n```\n\n\n``` objectivec\ndispatch_source_cancel(self.timer);\n```\n\n## Block:\n\n`iOS 10``API`\n\n``` objectivec\nself.timer = [NSTimer scheduledTimerWithTimeInterval:1.0 repeats:YES block:^(NSTimer * _Nonnull timer) {\n    NSLog(@\"fire\");\n}];\n```\n\n\n","slug":"2020/nstimer-circular-reference-issue-0330","published":1,"updated":"2021-06-21T12:34:52.099Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckszp3ndo001iifntoioxih2w","content":"<h1 id=\"\"></h1>\n<p><code>View Controller</code><code>Anohter View Controller</code><code>pop</code><code>Another View Controller</code></p>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">self</span>.timer = [<span class=\"built_in\">NSTimer</span> timerWithTimeInterval:<span class=\"number\">1.0</span> target:<span class=\"keyword\">self</span> selector:<span class=\"keyword\">@selector</span>(timerAction) userInfo:<span class=\"literal\">nil</span> repeats:<span class=\"literal\">YES</span>];</span><br></pre></td></tr></table></figure>\n<p><code>timer</code><code>VC</code><code>VC</code><code>timer</code><code>VC</code><code>target</code><code>timer</code></p>\n<p><img src=\"/img/article/20200330/1.png\" alt=\"\"></p>\n<a id=\"more\"></a>\n<h1 id=\"weak\">weak</h1>\n<p><code>Block</code><code>weak</code><code>weak</code><code>strong</code><code>NSTimer</code><code>VC</code></p>\n<h1 id=\"\"></h1>\n<h2 id=\"invalidate\">invalidate</h2>\n<blockquote>\n<p>This method is the only way to remove a timer from an NSRunLoop object. The NSRunLoop object removes its strong reference to the timer, either just before the invalidate method returns or at some later point.<br>\nIf it was configured with target and user info objects, the receiver removes its strong references to those objects as well.</p>\n</blockquote>\n<p><code>NSTimer</code><code>invalidate</code><code>timer</code><code>dealloc</code><code>dealloc</code><br>\n<code>viewWillDisappear</code></p>\n<h2 id=\"\"></h2>\n<p><code>NSObject</code><code>TimerWeakTarget</code></p>\n<p><code>TimerWeakTarget</code></p>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// TimerWeakTarget.h</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">@interface</span> <span class=\"title\">TimerWeakTarget</span> : <span class=\"title\">NSObject</span></span></span><br><span class=\"line\"></span><br><span class=\"line\">+ (<span class=\"built_in\">NSTimer</span> *) scheduledTimerWithTimeInterval:(<span class=\"built_in\">NSTimeInterval</span>)interval</span><br><span class=\"line\">                                      target:(<span class=\"keyword\">id</span>)aTarget</span><br><span class=\"line\">                                    selector:(SEL)aSelector</span><br><span class=\"line\">                                    userInfo:(<span class=\"keyword\">id</span>)userInfo</span><br><span class=\"line\">                                     repeats:(<span class=\"built_in\">BOOL</span>)repeats;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">@end</span></span><br></pre></td></tr></table></figure>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// TimerWeakTarget.m</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">@interface</span> <span class=\"title\">TimerWeakTarget</span> ()</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">@property</span> (<span class=\"keyword\">weak</span>, <span class=\"keyword\">nonatomic</span>) <span class=\"keyword\">id</span> target;</span><br><span class=\"line\"><span class=\"keyword\">@property</span> (<span class=\"keyword\">assign</span>, <span class=\"keyword\">nonatomic</span>) SEL selector;</span><br><span class=\"line\"><span class=\"keyword\">@property</span> (<span class=\"keyword\">weak</span>, <span class=\"keyword\">nonatomic</span>) <span class=\"built_in\">NSTimer</span> *tempTimer;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">@end</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">@implementation</span> <span class=\"title\">TimerWeakTarget</span></span></span><br><span class=\"line\"></span><br><span class=\"line\">+ (<span class=\"built_in\">NSTimer</span> *)scheduledTimerWithTimeInterval:(<span class=\"built_in\">NSTimeInterval</span>)interval target:(<span class=\"keyword\">id</span>)aTarget selector:(SEL)aSelector userInfo:(<span class=\"keyword\">id</span>)userInfo repeats:(<span class=\"built_in\">BOOL</span>)repeats &#123;</span><br><span class=\"line\">    TimerWeakTarget *timerWeakTarget = [[TimerWeakTarget alloc] init];</span><br><span class=\"line\">    timerWeakTarget.target = aTarget;</span><br><span class=\"line\">    timerWeakTarget.selector = aSelector;</span><br><span class=\"line\">    timerWeakTarget.tempTimer = [<span class=\"built_in\">NSTimer</span> scheduledTimerWithTimeInterval:interval target:timerWeakTarget selector:<span class=\"keyword\">@selector</span>(fire:) userInfo:userInfo repeats:repeats];</span><br><span class=\"line\">    <span class=\"keyword\">return</span> timerWeakTarget.tempTimer;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">- (<span class=\"keyword\">void</span>)fire:(<span class=\"built_in\">NSTimer</span> *)timer &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"keyword\">self</span>.target &amp;&amp; [<span class=\"keyword\">self</span>.target respondsToSelector:<span class=\"keyword\">self</span>.selector]) &#123;</span><br><span class=\"line\">        [<span class=\"keyword\">self</span>.target performSelector:<span class=\"keyword\">self</span>.selector withObject:timer.userInfo];</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        [<span class=\"keyword\">self</span>.tempTimer invalidate];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">@end</span></span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">self</span>.timer = [TimerWeakTarget scheduledTimerWithTimeInterval:<span class=\"number\">1.0</span> target:<span class=\"keyword\">self</span> selector:<span class=\"keyword\">@selector</span>(timerAction) userInfo:<span class=\"literal\">nil</span> repeats:<span class=\"literal\">YES</span>];</span><br></pre></td></tr></table></figure>\n<p><code>VC</code><code>timer</code><code>timer</code><code>target</code><code>timerWeakTarget</code><code>timerWeakTarget</code><code>VC</code></p>\n<p><img src=\"/img/article/20200330/2.png\" alt=\"\"></p>\n<h2 id=\"weakproxy\">WeakProxy</h2>\n<p><code>NSObject</code><code>WeakProxy</code></p>\n<p><code>WeakProxy</code></p>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// WeakProxy.h</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">@interface</span> <span class=\"title\">WeakProxy</span> : <span class=\"title\">NSObject</span></span></span><br><span class=\"line\"></span><br><span class=\"line\">+ (<span class=\"keyword\">instancetype</span>)proxyWithTarget:(<span class=\"keyword\">id</span>)target;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">@end</span></span><br></pre></td></tr></table></figure>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// WeakProxy.m</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">@interface</span> <span class=\"title\">WeakProxy</span> ()</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">@property</span> (<span class=\"keyword\">weak</span>, <span class=\"keyword\">nonatomic</span>) <span class=\"keyword\">id</span> weakTarget;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">@end</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">@implementation</span> <span class=\"title\">WeakProxy</span></span></span><br><span class=\"line\"></span><br><span class=\"line\">+ (<span class=\"keyword\">instancetype</span>)proxyWithTarget:(<span class=\"keyword\">id</span>)target &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> [[WeakProxy alloc] initWithTarget:target];</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">- (<span class=\"keyword\">instancetype</span>)initWithTarget:(<span class=\"keyword\">id</span>)target &#123;</span><br><span class=\"line\">    _weakTarget = target;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">self</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">- (<span class=\"keyword\">id</span>)forwardingTargetForSelector:(SEL)aSelector &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">self</span>.weakTarget;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/* OR</span></span><br><span class=\"line\"><span class=\"comment\">- (NSMethodSignature *)methodSignatureForSelector:(SEL)aSelector &#123;</span></span><br><span class=\"line\"><span class=\"comment\">    return [self.weakTarget methodSignatureForSelector:aSelector];</span></span><br><span class=\"line\"><span class=\"comment\">&#125;</span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\">- (void)forwardInvocation:(NSInvocation *)anInvocation &#123;</span></span><br><span class=\"line\"><span class=\"comment\">    SEL sel = [anInvocation selector];</span></span><br><span class=\"line\"><span class=\"comment\">    if ([self.weakTarget respondsToSelector:sel]) &#123;</span></span><br><span class=\"line\"><span class=\"comment\">        [anInvocation invokeWithTarget:self.weakTarget];</span></span><br><span class=\"line\"><span class=\"comment\">    &#125;</span></span><br><span class=\"line\"><span class=\"comment\">&#125;</span></span><br><span class=\"line\"><span class=\"comment\">*/</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">@end</span></span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">self</span>.timer = [<span class=\"built_in\">NSTimer</span> scheduledTimerWithTimeInterval:<span class=\"number\">1.0</span> target:[WeakProxy proxyWithTarget:<span class=\"keyword\">self</span>] selector:<span class=\"keyword\">@selector</span>(timerAction) userInfo:<span class=\"literal\">nil</span> repeats:<span class=\"literal\">YES</span>];</span><br></pre></td></tr></table></figure>\n<p><code>timer</code><code>target</code><code>WeakProxy</code><code>VC</code></p>\n<h2 id=\"gcd\">GCD</h2>\n<p></p>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">@interface</span> <span class=\"title\">AnotherViewController</span> ()</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">@property</span> (<span class=\"keyword\">strong</span>, <span class=\"keyword\">nonatomic</span>) dispatch_source_t timer;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">@end</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">@implementation</span> <span class=\"title\">AnotherViewController</span></span></span><br><span class=\"line\"></span><br><span class=\"line\">- (<span class=\"keyword\">void</span>)viewDidLoad &#123;</span><br><span class=\"line\">    [<span class=\"keyword\">super</span> viewDidLoad];</span><br><span class=\"line\">   </span><br><span class=\"line\">    <span class=\"keyword\">self</span>.timer = dispatch_source_create(DISPATCH_SOURCE_TYPE_TIMER, <span class=\"number\">0</span>, <span class=\"number\">0</span>, dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, <span class=\"number\">0</span>));</span><br><span class=\"line\">    dispatch_source_set_timer(<span class=\"keyword\">self</span>.timer, DISPATCH_TIME_NOW, <span class=\"number\">1</span>*<span class=\"built_in\">NSEC_PER_SEC</span>, <span class=\"number\">0</span>);</span><br><span class=\"line\">    dispatch_source_set_event_handler(<span class=\"keyword\">self</span>.timer, ^&#123;</span><br><span class=\"line\">        <span class=\"built_in\">dispatch_async</span>(dispatch_get_main_queue(), ^&#123;</span><br><span class=\"line\">            <span class=\"built_in\">NSLog</span>(<span class=\"string\">@\"fire\"</span>);</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">    dispatch_resume(<span class=\"keyword\">self</span>.timer);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">@end</span></span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">dispatch_source_cancel(<span class=\"keyword\">self</span>.timer);</span><br></pre></td></tr></table></figure>\n<h2 id=\"block\">Block:</h2>\n<p><code>iOS 10</code><code>API</code></p>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">self</span>.timer = [<span class=\"built_in\">NSTimer</span> scheduledTimerWithTimeInterval:<span class=\"number\">1.0</span> repeats:<span class=\"literal\">YES</span> block:^(<span class=\"built_in\">NSTimer</span> * _Nonnull timer) &#123;</span><br><span class=\"line\">    <span class=\"built_in\">NSLog</span>(<span class=\"string\">@\"fire\"</span>);</span><br><span class=\"line\">&#125;];</span><br></pre></td></tr></table></figure>\n","site":{"data":{}},"excerpt":"<h1></h1>\n<p><code>View Controller</code><code>Anohter View Controller</code><code>pop</code><code>Another View Controller</code></p>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">self</span>.timer = [<span class=\"built_in\">NSTimer</span> timerWithTimeInterval:<span class=\"number\">1.0</span> target:<span class=\"keyword\">self</span> selector:<span class=\"keyword\">@selector</span>(timerAction) userInfo:<span class=\"literal\">nil</span> repeats:<span class=\"literal\">YES</span>];</span><br></pre></td></tr></table></figure>\n<p><code>timer</code><code>VC</code><code>VC</code><code>timer</code><code>VC</code><code>target</code><code>timer</code></p>\n<p><img src=\"/img/article/20200330/1.png\" alt=\"\"></p>","more":"<h1>weak</h1>\n<p><code>Block</code><code>weak</code><code>weak</code><code>strong</code><code>NSTimer</code><code>VC</code></p>\n<h1></h1>\n<h2>invalidate</h2>\n<blockquote>\n<p>This method is the only way to remove a timer from an NSRunLoop object. The NSRunLoop object removes its strong reference to the timer, either just before the invalidate method returns or at some later point.<br>\nIf it was configured with target and user info objects, the receiver removes its strong references to those objects as well.</p>\n</blockquote>\n<p><code>NSTimer</code><code>invalidate</code><code>timer</code><code>dealloc</code><code>dealloc</code><br>\n<code>viewWillDisappear</code></p>\n<h2></h2>\n<p><code>NSObject</code><code>TimerWeakTarget</code></p>\n<p><code>TimerWeakTarget</code></p>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// TimerWeakTarget.h</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">@interface</span> <span class=\"title\">TimerWeakTarget</span> : <span class=\"title\">NSObject</span></span></span><br><span class=\"line\"></span><br><span class=\"line\">+ (<span class=\"built_in\">NSTimer</span> *) scheduledTimerWithTimeInterval:(<span class=\"built_in\">NSTimeInterval</span>)interval</span><br><span class=\"line\">                                      target:(<span class=\"keyword\">id</span>)aTarget</span><br><span class=\"line\">                                    selector:(SEL)aSelector</span><br><span class=\"line\">                                    userInfo:(<span class=\"keyword\">id</span>)userInfo</span><br><span class=\"line\">                                     repeats:(<span class=\"built_in\">BOOL</span>)repeats;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">@end</span></span><br></pre></td></tr></table></figure>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// TimerWeakTarget.m</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">@interface</span> <span class=\"title\">TimerWeakTarget</span> ()</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">@property</span> (<span class=\"keyword\">weak</span>, <span class=\"keyword\">nonatomic</span>) <span class=\"keyword\">id</span> target;</span><br><span class=\"line\"><span class=\"keyword\">@property</span> (<span class=\"keyword\">assign</span>, <span class=\"keyword\">nonatomic</span>) SEL selector;</span><br><span class=\"line\"><span class=\"keyword\">@property</span> (<span class=\"keyword\">weak</span>, <span class=\"keyword\">nonatomic</span>) <span class=\"built_in\">NSTimer</span> *tempTimer;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">@end</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">@implementation</span> <span class=\"title\">TimerWeakTarget</span></span></span><br><span class=\"line\"></span><br><span class=\"line\">+ (<span class=\"built_in\">NSTimer</span> *)scheduledTimerWithTimeInterval:(<span class=\"built_in\">NSTimeInterval</span>)interval target:(<span class=\"keyword\">id</span>)aTarget selector:(SEL)aSelector userInfo:(<span class=\"keyword\">id</span>)userInfo repeats:(<span class=\"built_in\">BOOL</span>)repeats &#123;</span><br><span class=\"line\">    TimerWeakTarget *timerWeakTarget = [[TimerWeakTarget alloc] init];</span><br><span class=\"line\">    timerWeakTarget.target = aTarget;</span><br><span class=\"line\">    timerWeakTarget.selector = aSelector;</span><br><span class=\"line\">    timerWeakTarget.tempTimer = [<span class=\"built_in\">NSTimer</span> scheduledTimerWithTimeInterval:interval target:timerWeakTarget selector:<span class=\"keyword\">@selector</span>(fire:) userInfo:userInfo repeats:repeats];</span><br><span class=\"line\">    <span class=\"keyword\">return</span> timerWeakTarget.tempTimer;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">- (<span class=\"keyword\">void</span>)fire:(<span class=\"built_in\">NSTimer</span> *)timer &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"keyword\">self</span>.target &amp;&amp; [<span class=\"keyword\">self</span>.target respondsToSelector:<span class=\"keyword\">self</span>.selector]) &#123;</span><br><span class=\"line\">        [<span class=\"keyword\">self</span>.target performSelector:<span class=\"keyword\">self</span>.selector withObject:timer.userInfo];</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        [<span class=\"keyword\">self</span>.tempTimer invalidate];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">@end</span></span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">self</span>.timer = [TimerWeakTarget scheduledTimerWithTimeInterval:<span class=\"number\">1.0</span> target:<span class=\"keyword\">self</span> selector:<span class=\"keyword\">@selector</span>(timerAction) userInfo:<span class=\"literal\">nil</span> repeats:<span class=\"literal\">YES</span>];</span><br></pre></td></tr></table></figure>\n<p><code>VC</code><code>timer</code><code>timer</code><code>target</code><code>timerWeakTarget</code><code>timerWeakTarget</code><code>VC</code></p>\n<p><img src=\"/img/article/20200330/2.png\" alt=\"\"></p>\n<h2>WeakProxy</h2>\n<p><code>NSObject</code><code>WeakProxy</code></p>\n<p><code>WeakProxy</code></p>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// WeakProxy.h</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">@interface</span> <span class=\"title\">WeakProxy</span> : <span class=\"title\">NSObject</span></span></span><br><span class=\"line\"></span><br><span class=\"line\">+ (<span class=\"keyword\">instancetype</span>)proxyWithTarget:(<span class=\"keyword\">id</span>)target;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">@end</span></span><br></pre></td></tr></table></figure>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// WeakProxy.m</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">@interface</span> <span class=\"title\">WeakProxy</span> ()</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">@property</span> (<span class=\"keyword\">weak</span>, <span class=\"keyword\">nonatomic</span>) <span class=\"keyword\">id</span> weakTarget;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">@end</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">@implementation</span> <span class=\"title\">WeakProxy</span></span></span><br><span class=\"line\"></span><br><span class=\"line\">+ (<span class=\"keyword\">instancetype</span>)proxyWithTarget:(<span class=\"keyword\">id</span>)target &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> [[WeakProxy alloc] initWithTarget:target];</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">- (<span class=\"keyword\">instancetype</span>)initWithTarget:(<span class=\"keyword\">id</span>)target &#123;</span><br><span class=\"line\">    _weakTarget = target;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">self</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">- (<span class=\"keyword\">id</span>)forwardingTargetForSelector:(SEL)aSelector &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">self</span>.weakTarget;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/* OR</span></span><br><span class=\"line\"><span class=\"comment\">- (NSMethodSignature *)methodSignatureForSelector:(SEL)aSelector &#123;</span></span><br><span class=\"line\"><span class=\"comment\">    return [self.weakTarget methodSignatureForSelector:aSelector];</span></span><br><span class=\"line\"><span class=\"comment\">&#125;</span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\">- (void)forwardInvocation:(NSInvocation *)anInvocation &#123;</span></span><br><span class=\"line\"><span class=\"comment\">    SEL sel = [anInvocation selector];</span></span><br><span class=\"line\"><span class=\"comment\">    if ([self.weakTarget respondsToSelector:sel]) &#123;</span></span><br><span class=\"line\"><span class=\"comment\">        [anInvocation invokeWithTarget:self.weakTarget];</span></span><br><span class=\"line\"><span class=\"comment\">    &#125;</span></span><br><span class=\"line\"><span class=\"comment\">&#125;</span></span><br><span class=\"line\"><span class=\"comment\">*/</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">@end</span></span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">self</span>.timer = [<span class=\"built_in\">NSTimer</span> scheduledTimerWithTimeInterval:<span class=\"number\">1.0</span> target:[WeakProxy proxyWithTarget:<span class=\"keyword\">self</span>] selector:<span class=\"keyword\">@selector</span>(timerAction) userInfo:<span class=\"literal\">nil</span> repeats:<span class=\"literal\">YES</span>];</span><br></pre></td></tr></table></figure>\n<p><code>timer</code><code>target</code><code>WeakProxy</code><code>VC</code></p>\n<h2>GCD</h2>\n<p></p>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">@interface</span> <span class=\"title\">AnotherViewController</span> ()</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">@property</span> (<span class=\"keyword\">strong</span>, <span class=\"keyword\">nonatomic</span>) dispatch_source_t timer;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">@end</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">@implementation</span> <span class=\"title\">AnotherViewController</span></span></span><br><span class=\"line\"></span><br><span class=\"line\">- (<span class=\"keyword\">void</span>)viewDidLoad &#123;</span><br><span class=\"line\">    [<span class=\"keyword\">super</span> viewDidLoad];</span><br><span class=\"line\">   </span><br><span class=\"line\">    <span class=\"keyword\">self</span>.timer = dispatch_source_create(DISPATCH_SOURCE_TYPE_TIMER, <span class=\"number\">0</span>, <span class=\"number\">0</span>, dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, <span class=\"number\">0</span>));</span><br><span class=\"line\">    dispatch_source_set_timer(<span class=\"keyword\">self</span>.timer, DISPATCH_TIME_NOW, <span class=\"number\">1</span>*<span class=\"built_in\">NSEC_PER_SEC</span>, <span class=\"number\">0</span>);</span><br><span class=\"line\">    dispatch_source_set_event_handler(<span class=\"keyword\">self</span>.timer, ^&#123;</span><br><span class=\"line\">        <span class=\"built_in\">dispatch_async</span>(dispatch_get_main_queue(), ^&#123;</span><br><span class=\"line\">            <span class=\"built_in\">NSLog</span>(<span class=\"string\">@\"fire\"</span>);</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">    dispatch_resume(<span class=\"keyword\">self</span>.timer);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">@end</span></span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">dispatch_source_cancel(<span class=\"keyword\">self</span>.timer);</span><br></pre></td></tr></table></figure>\n<h2>Block:</h2>\n<p><code>iOS 10</code><code>API</code></p>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">self</span>.timer = [<span class=\"built_in\">NSTimer</span> scheduledTimerWithTimeInterval:<span class=\"number\">1.0</span> repeats:<span class=\"literal\">YES</span> block:^(<span class=\"built_in\">NSTimer</span> * _Nonnull timer) &#123;</span><br><span class=\"line\">    <span class=\"built_in\">NSLog</span>(<span class=\"string\">@\"fire\"</span>);</span><br><span class=\"line\">&#125;];</span><br></pre></td></tr></table></figure>"},{"title":"RealityKit - ","catalog":true,"toc_nav_num":true,"date":"2021-06-21T11:36:20.000Z","subtitle":"RealityKit Experience","header-img":"/img/article_header/article_header.png","busuanzi":true,"_content":"\n# \n\nApple`WWDC21`[Object Capture](https://developer.apple.com/documentation/realitykit/capturing_photographs_for_realitykit_object_capture/)`RealityKit`AR`RealityKit`\n\n# \n\n`RealityKit``ARKit``RealityKit`\n\n# \n\n`ARView`\n![RealityKit](/img/article/20210621/1.png)\n\n`ARView`AR`cameraMode`ARAPI\n``` swift\npublic init(frame frameRect: CGRect, cameraMode: ARView.CameraMode, automaticallyConfigureSession: Bool)\n```\n\n`Scene`AR`ARView``scene``scene`\n\n`Entity``Anchor Entity``Model Entity``Entity``Entity``Entity``Component`\n![RealityKit](/img/article/20210621/2.png)\n\n`Component``Entity``Component``Entity``HasModel``Component`\n\n`Entity``Anchor Entity``Model Entity``Entity`\n\n# Entity\n\n`Entity``HasTransform``HasSynchronization``Transform component``Synchronization component``HasHierarchy``Entity`\n\n## AnchorEntity\n\n`Anchor Entity``HasAnchoring``Anchor Entity``ARView`\n\n## ModelEntity\n\n`Model Entity``HasModel`, `HasPhysics`\n- `HasModel``HasTransform``HasTransform``Model component`\n- `HasPhysics``HasPhysicsBody``HasPhysicsMotion`\n    - `HasPhysicsBody``HasCollision``HasCollision``HasTransform``HasCollision``HasPhysicsBody`\n    - `HasPhysicsMotion`\n\n## Entity\n\n`Entity``Component`Swift\n\n# \n\nARBox\n\n- `Scene``Anchor Entity``HasAnchoring`\n- box`HasModel`\n- `HasPhysics`\n\n``` swift\nclass Box: Entity, HasAnchoring, HasModel, HasPhysics {\n    required init(world: SIMD3<Float>) {\n        super.init()\n        \n        position = world\n\n        // \n        model = ModelComponent(\n            mesh: .generateBox(size: 0.5),\n            materials: [SimpleMaterial(color: .cyan, roughness: 0.5, isMetallic: true)]\n        )\n\n        // \n        collision = CollisionComponent(\n            shapes: [.generateBox(size: [0.5, 0.5, 0.5])],\n            mode: .default,\n            filter: .default\n        )\n\n        // ()\n        physicsBody = {\n            var c = PhysicsBodyComponent(\n                shapes: [ShapeResource.generateBox(size: [0.5, 0.5, 0.5])],\n                density: 0.95,\n                material: .generate(),\n                mode: .kinematic\n            )\n            return c\n        }()\n        \n        // y\n        physicsMotion = PhysicsMotionComponent(linearVelocity: [0, 0, 0], angularVelocity: [0, 1, 0])\n    }\n    \n    required init() {\n        fatalError(\"init() has not been implemented\")\n    }\n}\n```\n\n\n`ARView``ARView``Scene``Box`y\n\n\n``` swift\nclass ViewController: UIViewController {\n    override func viewDidLoad() {\n        super.viewDidLoad() \n\n        let arView = ARView(frame: view.bounds, cameraMode: .nonAR, automaticallyConfigureSession: false)\n        view.addSubview(arView)\n\n        let box = Box(world: [0, 0, 0])\n        arView.scene.addAnchor(box)\n    }\n}\n```\n\n\n![RealityKit](/img/article/20210621/3.png)\n\n# \n\n","source":"_posts/2021/realitykit-0621.md","raw":"---\ntitle: \"RealityKit - \"\ncatalog: true\ntoc_nav_num: true\ndate: 2021-06-21 19:36:20\nsubtitle: \"RealityKit Experience\"\nheader-img: \"/img/article_header/article_header.png\"\nbusuanzi: true\ntags:\n- iOS - Swift\n\n---\n\n# \n\nApple`WWDC21`[Object Capture](https://developer.apple.com/documentation/realitykit/capturing_photographs_for_realitykit_object_capture/)`RealityKit`AR`RealityKit`\n\n# \n\n`RealityKit``ARKit``RealityKit`\n\n# \n\n`ARView`\n![RealityKit](/img/article/20210621/1.png)\n\n`ARView`AR`cameraMode`ARAPI\n``` swift\npublic init(frame frameRect: CGRect, cameraMode: ARView.CameraMode, automaticallyConfigureSession: Bool)\n```\n\n`Scene`AR`ARView``scene``scene`\n\n`Entity``Anchor Entity``Model Entity``Entity``Entity``Entity``Component`\n![RealityKit](/img/article/20210621/2.png)\n\n`Component``Entity``Component``Entity``HasModel``Component`\n\n`Entity``Anchor Entity``Model Entity``Entity`\n\n# Entity\n\n`Entity``HasTransform``HasSynchronization``Transform component``Synchronization component``HasHierarchy``Entity`\n\n## AnchorEntity\n\n`Anchor Entity``HasAnchoring``Anchor Entity``ARView`\n\n## ModelEntity\n\n`Model Entity``HasModel`, `HasPhysics`\n- `HasModel``HasTransform``HasTransform``Model component`\n- `HasPhysics``HasPhysicsBody``HasPhysicsMotion`\n    - `HasPhysicsBody``HasCollision``HasCollision``HasTransform``HasCollision``HasPhysicsBody`\n    - `HasPhysicsMotion`\n\n## Entity\n\n`Entity``Component`Swift\n\n# \n\nARBox\n\n- `Scene``Anchor Entity``HasAnchoring`\n- box`HasModel`\n- `HasPhysics`\n\n``` swift\nclass Box: Entity, HasAnchoring, HasModel, HasPhysics {\n    required init(world: SIMD3<Float>) {\n        super.init()\n        \n        position = world\n\n        // \n        model = ModelComponent(\n            mesh: .generateBox(size: 0.5),\n            materials: [SimpleMaterial(color: .cyan, roughness: 0.5, isMetallic: true)]\n        )\n\n        // \n        collision = CollisionComponent(\n            shapes: [.generateBox(size: [0.5, 0.5, 0.5])],\n            mode: .default,\n            filter: .default\n        )\n\n        // ()\n        physicsBody = {\n            var c = PhysicsBodyComponent(\n                shapes: [ShapeResource.generateBox(size: [0.5, 0.5, 0.5])],\n                density: 0.95,\n                material: .generate(),\n                mode: .kinematic\n            )\n            return c\n        }()\n        \n        // y\n        physicsMotion = PhysicsMotionComponent(linearVelocity: [0, 0, 0], angularVelocity: [0, 1, 0])\n    }\n    \n    required init() {\n        fatalError(\"init() has not been implemented\")\n    }\n}\n```\n\n\n`ARView``ARView``Scene``Box`y\n\n\n``` swift\nclass ViewController: UIViewController {\n    override func viewDidLoad() {\n        super.viewDidLoad() \n\n        let arView = ARView(frame: view.bounds, cameraMode: .nonAR, automaticallyConfigureSession: false)\n        view.addSubview(arView)\n\n        let box = Box(world: [0, 0, 0])\n        arView.scene.addAnchor(box)\n    }\n}\n```\n\n\n![RealityKit](/img/article/20210621/3.png)\n\n# \n\n","slug":"2021/realitykit-0621","published":1,"updated":"2021-08-31T06:44:07.485Z","_id":"ckszp3ndo001kifntx4cx8ahv","comments":1,"layout":"post","photos":[],"link":"","content":"<h1 id=\"\"></h1>\n<p>Apple<code>WWDC21</code><a href=\"https://developer.apple.com/documentation/realitykit/capturing_photographs_for_realitykit_object_capture/\" target=\"_blank\" rel=\"noopener\">Object Capture</a><code>RealityKit</code>AR<code>RealityKit</code></p>\n<h1 id=\"\"></h1>\n<p><code>RealityKit</code><code>ARKit</code><code>RealityKit</code></p>\n<h1 id=\"\"></h1>\n<p><code>ARView</code><br>\n<img src=\"/img/article/20210621/1.png\" alt=\"RealityKit\"></p>\n<p><code>ARView</code>AR<code>cameraMode</code>ARAPI</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">init</span>(frame frameRect: <span class=\"type\">CGRect</span>, cameraMode: <span class=\"type\">ARView</span>.<span class=\"type\">CameraMode</span>, automaticallyConfigureSession: <span class=\"type\">Bool</span>)</span><br></pre></td></tr></table></figure>\n<p><code>Scene</code>AR<code>ARView</code><code>scene</code><code>scene</code></p>\n<p><code>Entity</code><code>Anchor Entity</code><code>Model Entity</code><code>Entity</code><code>Entity</code><code>Entity</code><code>Component</code><br>\n<img src=\"/img/article/20210621/2.png\" alt=\"RealityKit\"></p>\n<p><code>Component</code><code>Entity</code><code>Component</code><code>Entity</code><code>HasModel</code><code>Component</code></p>\n<p><code>Entity</code><code>Anchor Entity</code><code>Model Entity</code><code>Entity</code></p>\n<h1 id=\"entity\">Entity</h1>\n<p><code>Entity</code><code>HasTransform</code><code>HasSynchronization</code><code>Transform component</code><code>Synchronization component</code><code>HasHierarchy</code><code>Entity</code></p>\n<h2 id=\"anchorentity\">AnchorEntity</h2>\n<p><code>Anchor Entity</code><code>HasAnchoring</code><code>Anchor Entity</code><code>ARView</code></p>\n<h2 id=\"modelentity\">ModelEntity</h2>\n<p><code>Model Entity</code><code>HasModel</code>, <code>HasPhysics</code></p>\n<ul>\n<li><code>HasModel</code><code>HasTransform</code><code>HasTransform</code><code>Model component</code></li>\n<li><code>HasPhysics</code><code>HasPhysicsBody</code><code>HasPhysicsMotion</code>\n<ul>\n<li><code>HasPhysicsBody</code><code>HasCollision</code><code>HasCollision</code><code>HasTransform</code><code>HasCollision</code><code>HasPhysicsBody</code></li>\n<li><code>HasPhysicsMotion</code></li>\n</ul>\n</li>\n</ul>\n<h2 id=\"entity\">Entity</h2>\n<p><code>Entity</code><code>Component</code>Swift</p>\n<h1 id=\"\"></h1>\n<p>ARBox<br>\n</p>\n<ul>\n<li><code>Scene</code><code>Anchor Entity</code><code>HasAnchoring</code></li>\n<li>box<code>HasModel</code></li>\n<li><code>HasPhysics</code></li>\n</ul>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Box</span>: <span class=\"title\">Entity</span>, <span class=\"title\">HasAnchoring</span>, <span class=\"title\">HasModel</span>, <span class=\"title\">HasPhysics</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">required</span> <span class=\"keyword\">init</span>(world: <span class=\"type\">SIMD3</span>&lt;<span class=\"type\">Float</span>&gt;) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">super</span>.<span class=\"keyword\">init</span>()</span><br><span class=\"line\">        </span><br><span class=\"line\">        position = world</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        model = <span class=\"type\">ModelComponent</span>(</span><br><span class=\"line\">            mesh: .generateBox(size: <span class=\"number\">0.5</span>),</span><br><span class=\"line\">            materials: [<span class=\"type\">SimpleMaterial</span>(color: .cyan, roughness: <span class=\"number\">0.5</span>, isMetallic: <span class=\"literal\">true</span>)]</span><br><span class=\"line\">        )</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        collision = <span class=\"type\">CollisionComponent</span>(</span><br><span class=\"line\">            shapes: [.generateBox(size: [<span class=\"number\">0.5</span>, <span class=\"number\">0.5</span>, <span class=\"number\">0.5</span>])],</span><br><span class=\"line\">            mode: .<span class=\"keyword\">default</span>,</span><br><span class=\"line\">            <span class=\"built_in\">filter</span>: .<span class=\"keyword\">default</span></span><br><span class=\"line\">        )</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// ()</span></span><br><span class=\"line\">        physicsBody = &#123;</span><br><span class=\"line\">            <span class=\"keyword\">var</span> <span class=\"built_in\">c</span> = <span class=\"type\">PhysicsBodyComponent</span>(</span><br><span class=\"line\">                shapes: [<span class=\"type\">ShapeResource</span>.generateBox(size: [<span class=\"number\">0.5</span>, <span class=\"number\">0.5</span>, <span class=\"number\">0.5</span>])],</span><br><span class=\"line\">                density: <span class=\"number\">0.95</span>,</span><br><span class=\"line\">                material: .generate(),</span><br><span class=\"line\">                mode: .kinematic</span><br><span class=\"line\">            )</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"built_in\">c</span></span><br><span class=\"line\">        &#125;()</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"comment\">// y</span></span><br><span class=\"line\">        physicsMotion = <span class=\"type\">PhysicsMotionComponent</span>(linearVelocity: [<span class=\"number\">0</span>, <span class=\"number\">0</span>, <span class=\"number\">0</span>], angularVelocity: [<span class=\"number\">0</span>, <span class=\"number\">1</span>, <span class=\"number\">0</span>])</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">required</span> <span class=\"keyword\">init</span>() &#123;</span><br><span class=\"line\">        <span class=\"built_in\">fatalError</span>(<span class=\"string\">\"init() has not been implemented\"</span>)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p></p>\n<p><code>ARView</code><code>ARView</code><code>Scene</code><code>Box</code>y<br>\n</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">ViewController</span>: <span class=\"title\">UIViewController</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">override</span> <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">viewDidLoad</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">super</span>.viewDidLoad() </span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">let</span> arView = <span class=\"type\">ARView</span>(frame: view.bounds, cameraMode: .nonAR, automaticallyConfigureSession: <span class=\"literal\">false</span>)</span><br><span class=\"line\">        view.addSubview(arView)</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">let</span> box = <span class=\"type\">Box</span>(world: [<span class=\"number\">0</span>, <span class=\"number\">0</span>, <span class=\"number\">0</span>])</span><br><span class=\"line\">        arView.scene.addAnchor(box)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><br>\n<img src=\"/img/article/20210621/3.png\" alt=\"RealityKit\"></p>\n<h1 id=\"\"></h1>\n<p></p>\n","site":{"data":{}},"excerpt":"","more":"<h1></h1>\n<p>Apple<code>WWDC21</code><a href=\"https://developer.apple.com/documentation/realitykit/capturing_photographs_for_realitykit_object_capture/\" target=\"_blank\" rel=\"noopener\">Object Capture</a><code>RealityKit</code>AR<code>RealityKit</code></p>\n<h1></h1>\n<p><code>RealityKit</code><code>ARKit</code><code>RealityKit</code></p>\n<h1></h1>\n<p><code>ARView</code><br>\n<img src=\"/img/article/20210621/1.png\" alt=\"RealityKit\"></p>\n<p><code>ARView</code>AR<code>cameraMode</code>ARAPI</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">init</span>(frame frameRect: <span class=\"type\">CGRect</span>, cameraMode: <span class=\"type\">ARView</span>.<span class=\"type\">CameraMode</span>, automaticallyConfigureSession: <span class=\"type\">Bool</span>)</span><br></pre></td></tr></table></figure>\n<p><code>Scene</code>AR<code>ARView</code><code>scene</code><code>scene</code></p>\n<p><code>Entity</code><code>Anchor Entity</code><code>Model Entity</code><code>Entity</code><code>Entity</code><code>Entity</code><code>Component</code><br>\n<img src=\"/img/article/20210621/2.png\" alt=\"RealityKit\"></p>\n<p><code>Component</code><code>Entity</code><code>Component</code><code>Entity</code><code>HasModel</code><code>Component</code></p>\n<p><code>Entity</code><code>Anchor Entity</code><code>Model Entity</code><code>Entity</code></p>\n<h1>Entity</h1>\n<p><code>Entity</code><code>HasTransform</code><code>HasSynchronization</code><code>Transform component</code><code>Synchronization component</code><code>HasHierarchy</code><code>Entity</code></p>\n<h2>AnchorEntity</h2>\n<p><code>Anchor Entity</code><code>HasAnchoring</code><code>Anchor Entity</code><code>ARView</code></p>\n<h2>ModelEntity</h2>\n<p><code>Model Entity</code><code>HasModel</code>, <code>HasPhysics</code></p>\n<ul>\n<li><code>HasModel</code><code>HasTransform</code><code>HasTransform</code><code>Model component</code></li>\n<li><code>HasPhysics</code><code>HasPhysicsBody</code><code>HasPhysicsMotion</code>\n<ul>\n<li><code>HasPhysicsBody</code><code>HasCollision</code><code>HasCollision</code><code>HasTransform</code><code>HasCollision</code><code>HasPhysicsBody</code></li>\n<li><code>HasPhysicsMotion</code></li>\n</ul>\n</li>\n</ul>\n<h2>Entity</h2>\n<p><code>Entity</code><code>Component</code>Swift</p>\n<h1></h1>\n<p>ARBox<br>\n</p>\n<ul>\n<li><code>Scene</code><code>Anchor Entity</code><code>HasAnchoring</code></li>\n<li>box<code>HasModel</code></li>\n<li><code>HasPhysics</code></li>\n</ul>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Box</span>: <span class=\"title\">Entity</span>, <span class=\"title\">HasAnchoring</span>, <span class=\"title\">HasModel</span>, <span class=\"title\">HasPhysics</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">required</span> <span class=\"keyword\">init</span>(world: <span class=\"type\">SIMD3</span>&lt;<span class=\"type\">Float</span>&gt;) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">super</span>.<span class=\"keyword\">init</span>()</span><br><span class=\"line\">        </span><br><span class=\"line\">        position = world</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        model = <span class=\"type\">ModelComponent</span>(</span><br><span class=\"line\">            mesh: .generateBox(size: <span class=\"number\">0.5</span>),</span><br><span class=\"line\">            materials: [<span class=\"type\">SimpleMaterial</span>(color: .cyan, roughness: <span class=\"number\">0.5</span>, isMetallic: <span class=\"literal\">true</span>)]</span><br><span class=\"line\">        )</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        collision = <span class=\"type\">CollisionComponent</span>(</span><br><span class=\"line\">            shapes: [.generateBox(size: [<span class=\"number\">0.5</span>, <span class=\"number\">0.5</span>, <span class=\"number\">0.5</span>])],</span><br><span class=\"line\">            mode: .<span class=\"keyword\">default</span>,</span><br><span class=\"line\">            <span class=\"built_in\">filter</span>: .<span class=\"keyword\">default</span></span><br><span class=\"line\">        )</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// ()</span></span><br><span class=\"line\">        physicsBody = &#123;</span><br><span class=\"line\">            <span class=\"keyword\">var</span> <span class=\"built_in\">c</span> = <span class=\"type\">PhysicsBodyComponent</span>(</span><br><span class=\"line\">                shapes: [<span class=\"type\">ShapeResource</span>.generateBox(size: [<span class=\"number\">0.5</span>, <span class=\"number\">0.5</span>, <span class=\"number\">0.5</span>])],</span><br><span class=\"line\">                density: <span class=\"number\">0.95</span>,</span><br><span class=\"line\">                material: .generate(),</span><br><span class=\"line\">                mode: .kinematic</span><br><span class=\"line\">            )</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"built_in\">c</span></span><br><span class=\"line\">        &#125;()</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"comment\">// y</span></span><br><span class=\"line\">        physicsMotion = <span class=\"type\">PhysicsMotionComponent</span>(linearVelocity: [<span class=\"number\">0</span>, <span class=\"number\">0</span>, <span class=\"number\">0</span>], angularVelocity: [<span class=\"number\">0</span>, <span class=\"number\">1</span>, <span class=\"number\">0</span>])</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">required</span> <span class=\"keyword\">init</span>() &#123;</span><br><span class=\"line\">        <span class=\"built_in\">fatalError</span>(<span class=\"string\">\"init() has not been implemented\"</span>)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p></p>\n<p><code>ARView</code><code>ARView</code><code>Scene</code><code>Box</code>y<br>\n</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">ViewController</span>: <span class=\"title\">UIViewController</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">override</span> <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">viewDidLoad</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">super</span>.viewDidLoad() </span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">let</span> arView = <span class=\"type\">ARView</span>(frame: view.bounds, cameraMode: .nonAR, automaticallyConfigureSession: <span class=\"literal\">false</span>)</span><br><span class=\"line\">        view.addSubview(arView)</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">let</span> box = <span class=\"type\">Box</span>(world: [<span class=\"number\">0</span>, <span class=\"number\">0</span>, <span class=\"number\">0</span>])</span><br><span class=\"line\">        arView.scene.addAnchor(box)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><br>\n<img src=\"/img/article/20210621/3.png\" alt=\"RealityKit\"></p>\n<h1></h1>\n<p></p>\n"},{"title":"mapflatMapcompactMap","catalog":true,"toc_nav_num":true,"date":"2020-01-19T12:01:29.000Z","subtitle":"Talk About map, flatMap and compactMap","header-img":"/img/article_header/article_header.png","busuanzi":true,"_content":"\n# \n\n`map`Swift`flatMap``compactMap`\n\n<!-- more -->\n\n# map\n\n`map`\n\n``` swift\nlet nums = [1, 2, 3]\nlet res = nums.map { $0 + 1 }\nprint(res) // [2, 3, 4]\n```\n\n`map`\n\n`map`\n\n``` swift\nfunc map<T>(_ transform: (Value) throws -> T) rethrows -> [T]\n```\n\n`transform``(Value)``T``T`\n\n`map`\n\n# flatMap\n\n`flatMap`\n\n\n\n``` swift\nlet nums = [[1, 2], [3, 4]]\nlet mapRes = nums.map { $0.map { $0 + 1 } }\nlet flatRes = nums.flatMap { $0.map { $0 + 1 } }\nprint(mapRes)  // [[2, 3], [4, 5]]\nprint(flatRes) // [2, 3, 4, 5]\n```\n\n`map``flatMap`\n\n`map`\n\n``` swift\nfunc flatMap<SegmentOfResult>(_ transform: (Value) throws -> SegmentOfResult) rethrows -> [SegmentOfResult.Element] where SegmentOfResult : Sequence\n```\n\n`map`\n\n``` swift\nfunc flatMap<T>(_ transform: (Value) throws -> T) rethrows -> [T.Element] where T : Sequence\n```\n\n`map``T``Sequence``[T.Element]``map`\n\n`flatMap`[](https://github.com/apple/swift/blob/master/stdlib/public/core/FlatMap.swift)\n\n``` swift\nextension LazySequenceProtocol {\n  /// Returns the concatenated results of mapping the given transformation over\n  /// this sequence.\n  ///\n  /// Use this method to receive a single-level sequence when your\n  /// transformation produces a sequence or collection for each element.\n  /// Calling `flatMap(_:)` on a sequence `s` is equivalent to calling\n  /// `s.map(transform).joined()`.\n  ///\n  /// - Complexity: O(1)\n  @inlinable // lazy-performance\n  public func flatMap<SegmentOfResult>(\n    _ transform: @escaping (Elements.Element) -> SegmentOfResult\n  ) -> LazySequence<\n    FlattenSequence<LazyMapSequence<Elements, SegmentOfResult>>> {\n    return self.map(transform).joined()\n  }\n}\n```\n\n`flatMap``map``joined``joined``flatMap`\n\n`flatMap``compactMap`\n\n``` swift\n@available(swift, deprecated: 4.1, renamed: \"compactMap(_:)\", message: \"Please use compactMap(_:) for the case where closure returns an optional value\")\nfunc flatMap<ElementOfResult>(_ transform: (Value) throws -> ElementOfResult?) rethrows -> [ElementOfResult] // Deprecated\n```\n\n`compactMap`\n\n# compactMap\n\n\n\n``` swift\nlet nums = [1, 2, nil, 3, 4]\nlet res = nums.compactMap { $0 }\nprint(res) // [1, 2, 3, 4]\n```\n\n`map``compactMap``nil`\n\n`compactMap`\n\n``` swift\nfunc compactMap<ElementOfResult>(_ transform: (Value) throws -> ElementOfResult?) rethrows -> [ElementOfResult]\n```\n\n\n\n``` swift\nfunc compactMap<T>(_ transform: (Value) throws -> T?) rethrows -> [T]\n```\n\n`map``transform``T``[T]`\n\n[](https://github.com/apple/swift/blob/master/stdlib/public/core/FlatMap.swift)\n\n``` swift\nextension LazySequenceProtocol {\n  /// Returns the non-`nil` results of mapping the given transformation over\n  /// this sequence.\n  ///\n  /// Use this method to receive a sequence of non-optional values when your\n  /// transformation produces an optional value.\n  ///\n  /// - Parameter transform: A closure that accepts an element of this sequence\n  ///   as its argument and returns an optional value.\n  ///\n  /// - Complexity: O(1)\n  @inlinable // lazy-performance\n  public func compactMap<ElementOfResult>(\n    _ transform: @escaping (Elements.Element) -> ElementOfResult?\n  ) -> LazyMapSequence<\n    LazyFilterSequence<\n      LazyMapSequence<Elements, ElementOfResult?>>,\n    ElementOfResult\n  > {\n    return self.map(transform).filter { $0 != nil }.map { $0! }\n  }\n}\n```\n\n`map``filter``compactMap`\n\n# \n\n","source":"_posts/2020/talk-about-map-flatmap-compactmap-0119.md","raw":"---\ntitle: \"mapflatMapcompactMap\"\ncatalog: true\ntoc_nav_num: true\ndate: 2020-01-19 20:01:29\nsubtitle: \"Talk About map, flatMap and compactMap\"\nheader-img: \"/img/article_header/article_header.png\"\nbusuanzi: true\ntags:\n- iOS - Swift\n\n---\n\n# \n\n`map`Swift`flatMap``compactMap`\n\n<!-- more -->\n\n# map\n\n`map`\n\n``` swift\nlet nums = [1, 2, 3]\nlet res = nums.map { $0 + 1 }\nprint(res) // [2, 3, 4]\n```\n\n`map`\n\n`map`\n\n``` swift\nfunc map<T>(_ transform: (Value) throws -> T) rethrows -> [T]\n```\n\n`transform``(Value)``T``T`\n\n`map`\n\n# flatMap\n\n`flatMap`\n\n\n\n``` swift\nlet nums = [[1, 2], [3, 4]]\nlet mapRes = nums.map { $0.map { $0 + 1 } }\nlet flatRes = nums.flatMap { $0.map { $0 + 1 } }\nprint(mapRes)  // [[2, 3], [4, 5]]\nprint(flatRes) // [2, 3, 4, 5]\n```\n\n`map``flatMap`\n\n`map`\n\n``` swift\nfunc flatMap<SegmentOfResult>(_ transform: (Value) throws -> SegmentOfResult) rethrows -> [SegmentOfResult.Element] where SegmentOfResult : Sequence\n```\n\n`map`\n\n``` swift\nfunc flatMap<T>(_ transform: (Value) throws -> T) rethrows -> [T.Element] where T : Sequence\n```\n\n`map``T``Sequence``[T.Element]``map`\n\n`flatMap`[](https://github.com/apple/swift/blob/master/stdlib/public/core/FlatMap.swift)\n\n``` swift\nextension LazySequenceProtocol {\n  /// Returns the concatenated results of mapping the given transformation over\n  /// this sequence.\n  ///\n  /// Use this method to receive a single-level sequence when your\n  /// transformation produces a sequence or collection for each element.\n  /// Calling `flatMap(_:)` on a sequence `s` is equivalent to calling\n  /// `s.map(transform).joined()`.\n  ///\n  /// - Complexity: O(1)\n  @inlinable // lazy-performance\n  public func flatMap<SegmentOfResult>(\n    _ transform: @escaping (Elements.Element) -> SegmentOfResult\n  ) -> LazySequence<\n    FlattenSequence<LazyMapSequence<Elements, SegmentOfResult>>> {\n    return self.map(transform).joined()\n  }\n}\n```\n\n`flatMap``map``joined``joined``flatMap`\n\n`flatMap``compactMap`\n\n``` swift\n@available(swift, deprecated: 4.1, renamed: \"compactMap(_:)\", message: \"Please use compactMap(_:) for the case where closure returns an optional value\")\nfunc flatMap<ElementOfResult>(_ transform: (Value) throws -> ElementOfResult?) rethrows -> [ElementOfResult] // Deprecated\n```\n\n`compactMap`\n\n# compactMap\n\n\n\n``` swift\nlet nums = [1, 2, nil, 3, 4]\nlet res = nums.compactMap { $0 }\nprint(res) // [1, 2, 3, 4]\n```\n\n`map``compactMap``nil`\n\n`compactMap`\n\n``` swift\nfunc compactMap<ElementOfResult>(_ transform: (Value) throws -> ElementOfResult?) rethrows -> [ElementOfResult]\n```\n\n\n\n``` swift\nfunc compactMap<T>(_ transform: (Value) throws -> T?) rethrows -> [T]\n```\n\n`map``transform``T``[T]`\n\n[](https://github.com/apple/swift/blob/master/stdlib/public/core/FlatMap.swift)\n\n``` swift\nextension LazySequenceProtocol {\n  /// Returns the non-`nil` results of mapping the given transformation over\n  /// this sequence.\n  ///\n  /// Use this method to receive a sequence of non-optional values when your\n  /// transformation produces an optional value.\n  ///\n  /// - Parameter transform: A closure that accepts an element of this sequence\n  ///   as its argument and returns an optional value.\n  ///\n  /// - Complexity: O(1)\n  @inlinable // lazy-performance\n  public func compactMap<ElementOfResult>(\n    _ transform: @escaping (Elements.Element) -> ElementOfResult?\n  ) -> LazyMapSequence<\n    LazyFilterSequence<\n      LazyMapSequence<Elements, ElementOfResult?>>,\n    ElementOfResult\n  > {\n    return self.map(transform).filter { $0 != nil }.map { $0! }\n  }\n}\n```\n\n`map``filter``compactMap`\n\n# \n\n","slug":"2020/talk-about-map-flatmap-compactmap-0119","published":1,"updated":"2021-06-21T12:34:52.099Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckszp3ndq001nifntul8qymgj","content":"<h1 id=\"\"></h1>\n<p><code>map</code>Swift<code>flatMap</code><code>compactMap</code></p>\n<a id=\"more\"></a>\n<h1 id=\"map\">map</h1>\n<p><code>map</code></p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> nums = [<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>]</span><br><span class=\"line\"><span class=\"keyword\">let</span> res = nums.<span class=\"built_in\">map</span> &#123; $<span class=\"number\">0</span> + <span class=\"number\">1</span> &#125;</span><br><span class=\"line\"><span class=\"built_in\">print</span>(res) <span class=\"comment\">// [2, 3, 4]</span></span><br></pre></td></tr></table></figure>\n<p><code>map</code></p>\n<p><code>map</code></p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">map</span>&lt;T&gt;<span class=\"params\">(<span class=\"number\">_</span> transform: <span class=\"params\">(Value)</span></span></span> <span class=\"keyword\">throws</span> -&gt; <span class=\"type\">T</span>) <span class=\"keyword\">rethrows</span> -&gt; [<span class=\"type\">T</span>]</span><br></pre></td></tr></table></figure>\n<p><code>transform</code><code>(Value)</code><code>T</code><code>T</code></p>\n<p><code>map</code></p>\n<h1 id=\"flatmap\">flatMap</h1>\n<p><code>flatMap</code></p>\n<p></p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> nums = [[<span class=\"number\">1</span>, <span class=\"number\">2</span>], [<span class=\"number\">3</span>, <span class=\"number\">4</span>]]</span><br><span class=\"line\"><span class=\"keyword\">let</span> mapRes = nums.<span class=\"built_in\">map</span> &#123; $<span class=\"number\">0</span>.<span class=\"built_in\">map</span> &#123; $<span class=\"number\">0</span> + <span class=\"number\">1</span> &#125; &#125;</span><br><span class=\"line\"><span class=\"keyword\">let</span> flatRes = nums.flatMap &#123; $<span class=\"number\">0</span>.<span class=\"built_in\">map</span> &#123; $<span class=\"number\">0</span> + <span class=\"number\">1</span> &#125; &#125;</span><br><span class=\"line\"><span class=\"built_in\">print</span>(mapRes)  <span class=\"comment\">// [[2, 3], [4, 5]]</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(flatRes) <span class=\"comment\">// [2, 3, 4, 5]</span></span><br></pre></td></tr></table></figure>\n<p><code>map</code><code>flatMap</code></p>\n<p><code>map</code></p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">flatMap</span>&lt;SegmentOfResult&gt;<span class=\"params\">(<span class=\"number\">_</span> transform: <span class=\"params\">(Value)</span></span></span> <span class=\"keyword\">throws</span> -&gt; <span class=\"type\">SegmentOfResult</span>) <span class=\"keyword\">rethrows</span> -&gt; [<span class=\"type\">SegmentOfResult</span>.<span class=\"type\">Element</span>] <span class=\"keyword\">where</span> <span class=\"type\">SegmentOfResult</span> : <span class=\"type\">Sequence</span></span><br></pre></td></tr></table></figure>\n<p><code>map</code></p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">flatMap</span>&lt;T&gt;<span class=\"params\">(<span class=\"number\">_</span> transform: <span class=\"params\">(Value)</span></span></span> <span class=\"keyword\">throws</span> -&gt; <span class=\"type\">T</span>) <span class=\"keyword\">rethrows</span> -&gt; [<span class=\"type\">T</span>.<span class=\"type\">Element</span>] <span class=\"keyword\">where</span> <span class=\"type\">T</span> : <span class=\"type\">Sequence</span></span><br></pre></td></tr></table></figure>\n<p><code>map</code><code>T</code><code>Sequence</code><code>[T.Element]</code><code>map</code></p>\n<p><code>flatMap</code><a href=\"https://github.com/apple/swift/blob/master/stdlib/public/core/FlatMap.swift\" target=\"_blank\" rel=\"noopener\"></a></p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">extension</span> <span class=\"title\">LazySequenceProtocol</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"comment\">/// Returns the concatenated results of mapping the given transformation over</span></span><br><span class=\"line\">  <span class=\"comment\">/// this sequence.</span></span><br><span class=\"line\">  <span class=\"comment\">///</span></span><br><span class=\"line\">  <span class=\"comment\">/// Use this method to receive a single-level sequence when your</span></span><br><span class=\"line\">  <span class=\"comment\">/// transformation produces a sequence or collection for each element.</span></span><br><span class=\"line\">  <span class=\"comment\">/// Calling `flatMap(_:)` on a sequence `s` is equivalent to calling</span></span><br><span class=\"line\">  <span class=\"comment\">/// `s.map(transform).joined()`.</span></span><br><span class=\"line\">  <span class=\"comment\">///</span></span><br><span class=\"line\">  <span class=\"comment\">/// - Complexity: O(1)</span></span><br><span class=\"line\">  @inlinable <span class=\"comment\">// lazy-performance</span></span><br><span class=\"line\">  <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">flatMap</span>&lt;SegmentOfResult&gt;<span class=\"params\">(</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"params\">    <span class=\"number\">_</span> transform: @escaping <span class=\"params\">(Elements.Element)</span></span></span> -&gt; <span class=\"type\">SegmentOfResult</span></span><br><span class=\"line\">  ) -&gt; <span class=\"type\">LazySequence</span>&lt;</span><br><span class=\"line\">    <span class=\"type\">FlattenSequence</span>&lt;<span class=\"type\">LazyMapSequence</span>&lt;<span class=\"type\">Elements</span>, <span class=\"type\">SegmentOfResult</span>&gt;&gt;&gt; &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">self</span>.<span class=\"built_in\">map</span>(transform).joined()</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><code>flatMap</code><code>map</code><code>joined</code><code>joined</code><code>flatMap</code></p>\n<p><code>flatMap</code><code>compactMap</code></p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@available</span>(swift, deprecated: <span class=\"number\">4.1</span>, renamed: <span class=\"string\">\"compactMap(_:)\"</span>, message: <span class=\"string\">\"Please use compactMap(_:) for the case where closure returns an optional value\"</span>)</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">flatMap</span>&lt;ElementOfResult&gt;<span class=\"params\">(<span class=\"number\">_</span> transform: <span class=\"params\">(Value)</span></span></span> <span class=\"keyword\">throws</span> -&gt; <span class=\"type\">ElementOfResult</span>?) <span class=\"keyword\">rethrows</span> -&gt; [<span class=\"type\">ElementOfResult</span>] <span class=\"comment\">// Deprecated</span></span><br></pre></td></tr></table></figure>\n<p><code>compactMap</code></p>\n<h1 id=\"compactmap\">compactMap</h1>\n<p></p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> nums = [<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"literal\">nil</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>]</span><br><span class=\"line\"><span class=\"keyword\">let</span> res = nums.compactMap &#123; $<span class=\"number\">0</span> &#125;</span><br><span class=\"line\"><span class=\"built_in\">print</span>(res) <span class=\"comment\">// [1, 2, 3, 4]</span></span><br></pre></td></tr></table></figure>\n<p><code>map</code><code>compactMap</code><code>nil</code></p>\n<p><code>compactMap</code></p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">compactMap</span>&lt;ElementOfResult&gt;<span class=\"params\">(<span class=\"number\">_</span> transform: <span class=\"params\">(Value)</span></span></span> <span class=\"keyword\">throws</span> -&gt; <span class=\"type\">ElementOfResult</span>?) <span class=\"keyword\">rethrows</span> -&gt; [<span class=\"type\">ElementOfResult</span>]</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">compactMap</span>&lt;T&gt;<span class=\"params\">(<span class=\"number\">_</span> transform: <span class=\"params\">(Value)</span></span></span> <span class=\"keyword\">throws</span> -&gt; <span class=\"type\">T</span>?) <span class=\"keyword\">rethrows</span> -&gt; [<span class=\"type\">T</span>]</span><br></pre></td></tr></table></figure>\n<p><code>map</code><code>transform</code><code>T</code><code>[T]</code></p>\n<p><a href=\"https://github.com/apple/swift/blob/master/stdlib/public/core/FlatMap.swift\" target=\"_blank\" rel=\"noopener\"></a></p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">extension</span> <span class=\"title\">LazySequenceProtocol</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"comment\">/// Returns the non-`nil` results of mapping the given transformation over</span></span><br><span class=\"line\">  <span class=\"comment\">/// this sequence.</span></span><br><span class=\"line\">  <span class=\"comment\">///</span></span><br><span class=\"line\">  <span class=\"comment\">/// Use this method to receive a sequence of non-optional values when your</span></span><br><span class=\"line\">  <span class=\"comment\">/// transformation produces an optional value.</span></span><br><span class=\"line\">  <span class=\"comment\">///</span></span><br><span class=\"line\">  <span class=\"comment\">/// - Parameter transform: A closure that accepts an element of this sequence</span></span><br><span class=\"line\">  <span class=\"comment\">///   as its argument and returns an optional value.</span></span><br><span class=\"line\">  <span class=\"comment\">///</span></span><br><span class=\"line\">  <span class=\"comment\">/// - Complexity: O(1)</span></span><br><span class=\"line\">  @inlinable <span class=\"comment\">// lazy-performance</span></span><br><span class=\"line\">  <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">compactMap</span>&lt;ElementOfResult&gt;<span class=\"params\">(</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"params\">    <span class=\"number\">_</span> transform: @escaping <span class=\"params\">(Elements.Element)</span></span></span> -&gt; <span class=\"type\">ElementOfResult</span>?</span><br><span class=\"line\">  ) -&gt; <span class=\"type\">LazyMapSequence</span>&lt;</span><br><span class=\"line\">    <span class=\"type\">LazyFilterSequence</span>&lt;</span><br><span class=\"line\">      <span class=\"type\">LazyMapSequence</span>&lt;<span class=\"type\">Elements</span>, <span class=\"type\">ElementOfResult</span>?&gt;&gt;,</span><br><span class=\"line\">    <span class=\"type\">ElementOfResult</span></span><br><span class=\"line\">  &gt; &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">self</span>.<span class=\"built_in\">map</span>(transform).<span class=\"built_in\">filter</span> &#123; $<span class=\"number\">0</span> != <span class=\"literal\">nil</span> &#125;.<span class=\"built_in\">map</span> &#123; $<span class=\"number\">0</span>! &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><code>map</code><code>filter</code><code>compactMap</code></p>\n<h1 id=\"\"></h1>\n<p></p>\n","site":{"data":{}},"excerpt":"<h1></h1>\n<p><code>map</code>Swift<code>flatMap</code><code>compactMap</code></p>","more":"<h1>map</h1>\n<p><code>map</code></p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> nums = [<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>]</span><br><span class=\"line\"><span class=\"keyword\">let</span> res = nums.<span class=\"built_in\">map</span> &#123; $<span class=\"number\">0</span> + <span class=\"number\">1</span> &#125;</span><br><span class=\"line\"><span class=\"built_in\">print</span>(res) <span class=\"comment\">// [2, 3, 4]</span></span><br></pre></td></tr></table></figure>\n<p><code>map</code></p>\n<p><code>map</code></p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">map</span>&lt;T&gt;<span class=\"params\">(<span class=\"number\">_</span> transform: <span class=\"params\">(Value)</span></span></span> <span class=\"keyword\">throws</span> -&gt; <span class=\"type\">T</span>) <span class=\"keyword\">rethrows</span> -&gt; [<span class=\"type\">T</span>]</span><br></pre></td></tr></table></figure>\n<p><code>transform</code><code>(Value)</code><code>T</code><code>T</code></p>\n<p><code>map</code></p>\n<h1>flatMap</h1>\n<p><code>flatMap</code></p>\n<p></p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> nums = [[<span class=\"number\">1</span>, <span class=\"number\">2</span>], [<span class=\"number\">3</span>, <span class=\"number\">4</span>]]</span><br><span class=\"line\"><span class=\"keyword\">let</span> mapRes = nums.<span class=\"built_in\">map</span> &#123; $<span class=\"number\">0</span>.<span class=\"built_in\">map</span> &#123; $<span class=\"number\">0</span> + <span class=\"number\">1</span> &#125; &#125;</span><br><span class=\"line\"><span class=\"keyword\">let</span> flatRes = nums.flatMap &#123; $<span class=\"number\">0</span>.<span class=\"built_in\">map</span> &#123; $<span class=\"number\">0</span> + <span class=\"number\">1</span> &#125; &#125;</span><br><span class=\"line\"><span class=\"built_in\">print</span>(mapRes)  <span class=\"comment\">// [[2, 3], [4, 5]]</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(flatRes) <span class=\"comment\">// [2, 3, 4, 5]</span></span><br></pre></td></tr></table></figure>\n<p><code>map</code><code>flatMap</code></p>\n<p><code>map</code></p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">flatMap</span>&lt;SegmentOfResult&gt;<span class=\"params\">(<span class=\"number\">_</span> transform: <span class=\"params\">(Value)</span></span></span> <span class=\"keyword\">throws</span> -&gt; <span class=\"type\">SegmentOfResult</span>) <span class=\"keyword\">rethrows</span> -&gt; [<span class=\"type\">SegmentOfResult</span>.<span class=\"type\">Element</span>] <span class=\"keyword\">where</span> <span class=\"type\">SegmentOfResult</span> : <span class=\"type\">Sequence</span></span><br></pre></td></tr></table></figure>\n<p><code>map</code></p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">flatMap</span>&lt;T&gt;<span class=\"params\">(<span class=\"number\">_</span> transform: <span class=\"params\">(Value)</span></span></span> <span class=\"keyword\">throws</span> -&gt; <span class=\"type\">T</span>) <span class=\"keyword\">rethrows</span> -&gt; [<span class=\"type\">T</span>.<span class=\"type\">Element</span>] <span class=\"keyword\">where</span> <span class=\"type\">T</span> : <span class=\"type\">Sequence</span></span><br></pre></td></tr></table></figure>\n<p><code>map</code><code>T</code><code>Sequence</code><code>[T.Element]</code><code>map</code></p>\n<p><code>flatMap</code><a href=\"https://github.com/apple/swift/blob/master/stdlib/public/core/FlatMap.swift\" target=\"_blank\" rel=\"noopener\"></a></p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">extension</span> <span class=\"title\">LazySequenceProtocol</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"comment\">/// Returns the concatenated results of mapping the given transformation over</span></span><br><span class=\"line\">  <span class=\"comment\">/// this sequence.</span></span><br><span class=\"line\">  <span class=\"comment\">///</span></span><br><span class=\"line\">  <span class=\"comment\">/// Use this method to receive a single-level sequence when your</span></span><br><span class=\"line\">  <span class=\"comment\">/// transformation produces a sequence or collection for each element.</span></span><br><span class=\"line\">  <span class=\"comment\">/// Calling `flatMap(_:)` on a sequence `s` is equivalent to calling</span></span><br><span class=\"line\">  <span class=\"comment\">/// `s.map(transform).joined()`.</span></span><br><span class=\"line\">  <span class=\"comment\">///</span></span><br><span class=\"line\">  <span class=\"comment\">/// - Complexity: O(1)</span></span><br><span class=\"line\">  @inlinable <span class=\"comment\">// lazy-performance</span></span><br><span class=\"line\">  <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">flatMap</span>&lt;SegmentOfResult&gt;<span class=\"params\">(</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"params\">    <span class=\"number\">_</span> transform: @escaping <span class=\"params\">(Elements.Element)</span></span></span> -&gt; <span class=\"type\">SegmentOfResult</span></span><br><span class=\"line\">  ) -&gt; <span class=\"type\">LazySequence</span>&lt;</span><br><span class=\"line\">    <span class=\"type\">FlattenSequence</span>&lt;<span class=\"type\">LazyMapSequence</span>&lt;<span class=\"type\">Elements</span>, <span class=\"type\">SegmentOfResult</span>&gt;&gt;&gt; &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">self</span>.<span class=\"built_in\">map</span>(transform).joined()</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><code>flatMap</code><code>map</code><code>joined</code><code>joined</code><code>flatMap</code></p>\n<p><code>flatMap</code><code>compactMap</code></p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@available</span>(swift, deprecated: <span class=\"number\">4.1</span>, renamed: <span class=\"string\">\"compactMap(_:)\"</span>, message: <span class=\"string\">\"Please use compactMap(_:) for the case where closure returns an optional value\"</span>)</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">flatMap</span>&lt;ElementOfResult&gt;<span class=\"params\">(<span class=\"number\">_</span> transform: <span class=\"params\">(Value)</span></span></span> <span class=\"keyword\">throws</span> -&gt; <span class=\"type\">ElementOfResult</span>?) <span class=\"keyword\">rethrows</span> -&gt; [<span class=\"type\">ElementOfResult</span>] <span class=\"comment\">// Deprecated</span></span><br></pre></td></tr></table></figure>\n<p><code>compactMap</code></p>\n<h1>compactMap</h1>\n<p></p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> nums = [<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"literal\">nil</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>]</span><br><span class=\"line\"><span class=\"keyword\">let</span> res = nums.compactMap &#123; $<span class=\"number\">0</span> &#125;</span><br><span class=\"line\"><span class=\"built_in\">print</span>(res) <span class=\"comment\">// [1, 2, 3, 4]</span></span><br></pre></td></tr></table></figure>\n<p><code>map</code><code>compactMap</code><code>nil</code></p>\n<p><code>compactMap</code></p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">compactMap</span>&lt;ElementOfResult&gt;<span class=\"params\">(<span class=\"number\">_</span> transform: <span class=\"params\">(Value)</span></span></span> <span class=\"keyword\">throws</span> -&gt; <span class=\"type\">ElementOfResult</span>?) <span class=\"keyword\">rethrows</span> -&gt; [<span class=\"type\">ElementOfResult</span>]</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">compactMap</span>&lt;T&gt;<span class=\"params\">(<span class=\"number\">_</span> transform: <span class=\"params\">(Value)</span></span></span> <span class=\"keyword\">throws</span> -&gt; <span class=\"type\">T</span>?) <span class=\"keyword\">rethrows</span> -&gt; [<span class=\"type\">T</span>]</span><br></pre></td></tr></table></figure>\n<p><code>map</code><code>transform</code><code>T</code><code>[T]</code></p>\n<p><a href=\"https://github.com/apple/swift/blob/master/stdlib/public/core/FlatMap.swift\" target=\"_blank\" rel=\"noopener\"></a></p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">extension</span> <span class=\"title\">LazySequenceProtocol</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"comment\">/// Returns the non-`nil` results of mapping the given transformation over</span></span><br><span class=\"line\">  <span class=\"comment\">/// this sequence.</span></span><br><span class=\"line\">  <span class=\"comment\">///</span></span><br><span class=\"line\">  <span class=\"comment\">/// Use this method to receive a sequence of non-optional values when your</span></span><br><span class=\"line\">  <span class=\"comment\">/// transformation produces an optional value.</span></span><br><span class=\"line\">  <span class=\"comment\">///</span></span><br><span class=\"line\">  <span class=\"comment\">/// - Parameter transform: A closure that accepts an element of this sequence</span></span><br><span class=\"line\">  <span class=\"comment\">///   as its argument and returns an optional value.</span></span><br><span class=\"line\">  <span class=\"comment\">///</span></span><br><span class=\"line\">  <span class=\"comment\">/// - Complexity: O(1)</span></span><br><span class=\"line\">  @inlinable <span class=\"comment\">// lazy-performance</span></span><br><span class=\"line\">  <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">compactMap</span>&lt;ElementOfResult&gt;<span class=\"params\">(</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"params\">    <span class=\"number\">_</span> transform: @escaping <span class=\"params\">(Elements.Element)</span></span></span> -&gt; <span class=\"type\">ElementOfResult</span>?</span><br><span class=\"line\">  ) -&gt; <span class=\"type\">LazyMapSequence</span>&lt;</span><br><span class=\"line\">    <span class=\"type\">LazyFilterSequence</span>&lt;</span><br><span class=\"line\">      <span class=\"type\">LazyMapSequence</span>&lt;<span class=\"type\">Elements</span>, <span class=\"type\">ElementOfResult</span>?&gt;&gt;,</span><br><span class=\"line\">    <span class=\"type\">ElementOfResult</span></span><br><span class=\"line\">  &gt; &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">self</span>.<span class=\"built_in\">map</span>(transform).<span class=\"built_in\">filter</span> &#123; $<span class=\"number\">0</span> != <span class=\"literal\">nil</span> &#125;.<span class=\"built_in\">map</span> &#123; $<span class=\"number\">0</span>! &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><code>map</code><code>filter</code><code>compactMap</code></p>\n<h1></h1>\n<p></p>"},{"title":"OpenGL ES","catalog":true,"toc_nav_num":true,"date":"2019-05-19T10:20:03.000Z","subtitle":"Open Graphics Library for Embedded Systems","header-img":"/img/article_header/article_header.png","busuanzi":true,"_content":"\n# Introduction\n\nOpen Graphics Library(OpenGL)2D3D2D3DOpenGL3D2DOpenGLOpenGL\n\nOpenGL for Embedded Systems(OpenGL ES)openGL\n\n![OpenGL ES](/img/article/20190519/1.png)\n\nOpenGL ESiOSGPU2D3DGPUOpenGL ESOpenGL ES3D\n\n# Checklist for Building OpenGL ES Apps for iOS\n\nOpenGL ESGPUAPIOpenGL ESOpenGL ESiOS*EAGLContext*iOSOpenGL ES*GLKView**CAEAGLLayer*\n\niOSOpenGL ESOpenGL ESiOS\n1. OpenGL ES\n2. OpenGL ES\n3. OpenGL ES\n4. iOS\n5. \n6. XcodeInstrumentsOpenGL ES\n\n## OpenGL ES\n\nOpenGL ES 3.0OpenGL ES 2.0OpenGL ES 1.1\n- OpenGL ES 3.0iOS 7GPU\n- OpenGL ES 2.0iOS\n- OpenGL ES 1.1iOS\n\niOS[iOS Device Compatibility Reference](https://developer.apple.com/library/archive/documentation/DeviceInformation/Reference/iOSDeviceCompatibility/Introduction/Introduction.html#//apple_ref/doc/uid/TP40013599)\n\n## OpenGL ES\n\n[iOS Device Compatibility Reference](https://developer.apple.com/library/archive/documentation/DeviceInformation/Reference/iOSDeviceCompatibility/Introduction/Introduction.html#//apple_ref/doc/uid/TP40013599)iOSiOSOpenGL ES\n\n`glGet`*gl.h**MAX_TEXTURE_SIZE**MAX_VERTEX_ATTRIBS*\n\n`glGetIntegerv``glGetStringi`OpenGL ES 3.0\n``` objectivec\n/// #import <OpenGLES/ES3/gl.h>\nBOOL CheckForExtensions(NSString *searchName) {\n    int max = 0;\n    glGetIntegerv(GL_NUM_EXTENSIONS, &max);\n    NSMutableSet *extensions = [NSMutableSet set];\n    for (int i = 0; i < max; i++) {\n        [extensions addObject:@((char *)glGetStringi(GL_EXTENSIONS, i))];\n    }\n    return [extensions containsObject:searchName];\n}\n/// OpenGL ES 2.01.1glGetString(GL_EXTENSIONS)\n```\n\n## \n\niOS\n- *GLKit*OpenGL ESviewOpenGL ESUIKit[Drawing with OpenGL ES and GLKit](#drawing-with-opengl-es-and-glkit)\n- *CAEAGLLayer*OpenGL ESCore Animation\n- OpenGL ESOpenGL ES\n\nCore Animation[Drawing to Other Rendering Destinatons](#drawing-to-other-rendering-destinations)\n\n## iOS\n\niOSOpenGL ESOpenGL ES\n\niOS\n\niOS[Multitasking, High Resolution, and Other iOS Features](#multitasking,-high-resolution,-and-other-ios-features)\n\n## \n\nOpenGL ESOpenGLOpenGL ES\n\niOS[OpenGL ES Design Guidelines](#opengl-es-design-guidelines)[Concurrency and OpenGL ES](#concurrency-and-opengl-es)\n\n## \n\nXcodeInstrumentsOpenGL ES[Debugging and Profiling](#debugging-and-profiling)\n\n# Configuring OpenGL ES Contexts\n\nOpenGL ESOpenGL ES\n\nOpenGL ES*EAGLContext**EAGLContext*OpenGL ESCore Animation\n\n## OpenGL ES\n\niOSOpenGL ES\n\n`setCurrentContext:`\n``` objectivec\n[EAGLContext setCurrentContext:context];\n```\n\n*EAGLContext*`currentContext`\n\n> `glFlush`\n\nOpenGL ES*EAGLContext*`setCurrentContext:`*EAGLContext*\n\n## OpenGL ES\n\n*EAGLContext*OpenGL ESOpenGL ES 1.12.03.0OpenGL ES 2.03.02.03.0OpenGL ES 3.03.0\n\n*EAGLContext*OpenGL ESnil\n``` objectivec\nEAGLContext* CreateBestEAGLContext() {\n    EAGLContext *context = [[EAGLContext alloc] initWithAPI:kEAGLRenderingAPIOpenGLES3];\n    if (context == nil) {\n        context = [[EAGLContext alloc] initWithAPI:kEAGLRenderingAPIOpenGLES2];\n    }\n    return context;\n}\n```\n\n## EAGL Sharegroup\n\nOpenGL ESOpenGL ES*EAGLSharegroup*OpenGL ES*ESGLSharegroup*\n\nOpenGL ESOpenGL ES\n\nsharegroupsharegroup\n\n![OpenGL ES Sharegroup](/img/article/20190519/2.png)\n\nsharegroup\n- \n- OpenGL ES*GLKtextureLoader*\n\nsharegroup`initAPI:`sharegroup`initAPI:sharegroup:`sharegroup\n\n``` objectivec\nEAGLContext* firstContext = CreateBestEAGLContext();\nEAGLContext* secondContext = [[EAGLContext alloc] initWithAPI:[firstContext API] sharegroup: [firstContext sharegroup]];\n```\n\nsharegroupOpenGL ES\n- \n- \n- \n\nOpenGL ES\n- `glFlush`\n- OpenGL ES\n- `glFlush`\n- \n\n> OpenGL ESOpengGL ES\n\n# Drawing with OpenGL ES and GLKit\n\nGLKitOpenGL ES*GLKView*OpenGL ES*GLKViewController*GLKitOpenGL ESUIKitOpenGL ESGLKitOpenGL ES 2.03.0\n\n## GLKitOpenGL ES\n\n*GLKView*OpenGL ESUIView*UIView*`drawRect:`Quartz 2D*GLKView*OpenGL ES*GLKView*OpenGL ESCore Animation\n\nUIKitGLKit--Core Animation`setNeedsDisplay`\n\n![Rending OpenGL ES content with a GLKit view](/img/article/20190519/3.png)\n\n### GLKit View\n\nGLKView*EAGLContext*\n\n- *initWithFrame:context:*\n- *context*\n\nGLKitOpenGL ES\n\n``` objectivec\n- (void)viewDidLoad {\n    [super viewDidLoad];\n    \n    EAGLContext *context = CreateBestEAGLContext();\n    GLKView *glkView = [[GLKView alloc] initWithFrame:self.view.bounds context:context];\n    // Configure renderbuffers\n    glkView.drawableColorFormat = GLKViewDrawableColorFormatSRGBA8888;\n    glkView.drawableDepthFormat = GLKViewDrawableDepthFormat24;\n    glkView.drawableStencilFormat = GLKViewDrawableStencilFormat8;\n    // enable multisampling\n    // multisampling3D\n    glkView.drawableMultisample = GLKViewDrawableMultisample4X;\n    [self.view addSubview:glkView];\n}\n```\n\n### GLKit View\n\nOpenGL ESOpenGL ESCore Animation*GLKView*\n\n``` objectivec\n- (void)drawRect:(CGRect)rect {\n    // clear the framebuffer\n    glClearColor(0.0, 0.0, 0.1, 1.0);\n    glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);\n    // Draw using previously configured texture, shader, uniforms, and vertex array\n    glBindTexture(GL_TEXTURE_2D, _planetTexture);\n    glUseProgram(_diffuseShading);\n    glUniformMatrix4fv(_uniformModelViewProjectionMatrix, 1, 0, _modelViewProjectionMatrix.m);\n    glBindVertexArray(_planetMesh);\n    glDrawElements(GL_TRIANGLE_STRIP, 256, GL_UNSIGNED_SHORT, NULL);\n}\n```\n\n> *glClear*OpenGL ES\n\n*GLKView*OpenGL ESOpenGL ES\n\n- \n    + *EAGLContext*\n    + \n    + \n    + OpenGL ES\n- \n    + multisamplingmultisampling\n    + \n    + Core Animation\n\n## \n\nOpenGL ESOpenGL ES 2.03.0\n\nGLKit--GLKViewGLKView`drawInRect:`*GLKViewDelegate*`glkView:drawInRect:`\n\n``` objectivec\n- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions {\n    // Create a context\n    EAGLContext *context = [[EAGLContext alloc] initWithAPI:kEAGLRenderingAPIOpenGLES2];\n    [EAGLContext setCurrentContext:context];\n    \n    // Choose a rendering class based on device features\n    GLint maxTextureSize;\n    glGetIntegerv(GL_MAX_TEXTURE_SIZE, &maxTextureSize);\n    if (maxTextureSize > 2048) {\n        self.renderer = [[MyBigTextureRenderer alloc] initWithContext:context];\n    } else {\n        self.renderer = [[MyRenderer alloc] initWithContext:context];\n    }\n    GLKView *view = (GLKView *)self.window.rootViewController.view;\n    view.delegate = self.renderer;\n    view.context = context;\n    return YES;\n}\n```\n\n## GLKitOpenGL ES\n\n*GLKView*OpenGL ES--*GLKit**GLKView*\n\n![The animation loop](/img/article/20190519/4.png)\n\n### \n\n*update*GLKViewController`glkViewControllerUpdate:``timeSinceLastUpdate`\n\n`display`GPUOpenGL ESOpenGL ES\n\n`framesPerSecond``preferredFramesPerSecond`--\n\n> \n\n### GLKit\n\n``` objectivec\n@implementation PlanetViewController // subclass of GLKViewController\n \n- (void)viewDidLoad {\n    [super viewDidLoad];\n \n    // Create an OpenGL ES context and assign it to the view loaded from storyboard\n    GLKView *view = (GLKView *)self.view;\n    view.context = [[EAGLContext alloc] initWithAPI:kEAGLRenderingAPIOpenGLES2];\n \n    // Set animation frame rate\n    self.preferredFramesPerSecond = 60;\n \n    // Not shown: load shaders, textures and vertex arrays, set up projection matrix\n    [self setupGL];\n}\n \n- (void)update {\n    _rotation += self.timeSinceLastUpdate * M_PI_2; // one quarter rotation per second\n \n    // Set up transform matrices for the rotating planet\n    GLKMatrix4 modelViewMatrix = GLKMatrix4MakeRotation(_rotation, 0.0f, 1.0f, 0.0f);\n    _normalMatrix = GLKMatrix3InvertAndTranspose(GLKMatrix4GetMatrix3(modelViewMatrix), NULL);\n    _modelViewProjectionMatrix = GLKMatrix4Multiply(_projectionMatrix, modelViewMatrix);\n}\n \n- (void)glkView:(GLKView *)view drawInRect:(CGRect)rect {\n    // Clear the framebuffer\n    glClearColor(0.0f, 0.0f, 0.1f, 1.0f);\n    glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);\n \n    // Set shader uniforms to values calculated in -update\n    glUseProgram(_diffuseShading);\n    glUniformMatrix4fv(_uniformModelViewProjectionMatrix, 1, 0, _modelViewProjectionMatrix.m);\n    glUniformMatrix3fv(_uniformNormalMatrix, 1, 0, _normalMatrix.m);\n \n    // Draw using previously configured texture and vertex array\n    glBindTexture(GL_TEXTURE_2D, _planetTexture);\n    glBindVertexArrayOES(_planetMesh);\n    glDrawElements(GL_TRIANGLE_STRIP, 256, GL_UNSIGNED_SHORT, 0);\n}\n@end\n```\n\n`viewDidLoad`OpenGL ES`update``glkView:drawInRect:`\n\n# Drawing to Other Rendering Destinations\n\nOpenGL ESOpenGL ES\n\n![Famebuffer with color and depth renderbuffers](/img/article/20190519/5.png)\n\nOpenGL ES\n\n## \n\n\n- [](#)\n- [](#)\n- Core AnimationCore Animation-aware[Core Animation](#Core-Animation)\n\n### \n\nOpenGL ES\n\n1. \n``` objectivec\nGLuint framebuffer;\nglGenFramebuffers(1, &framebuffer);\nglBindFramebuffer(GL_FRAMEBUFFER, framebuffer);\n```\n\n2. \n``` objectivec\nGLuint colorRenderbuffer;\nglGenRenderbuffers(1, &colorRenderbuffer);\nglBindRenderbuffer(GL_RENDERBUFFER, colorRenderbuffer);\nglRenderbufferStorage(GL_RENDERBUFFER, GL_RGBA, width, height);\nglFramebufferRenderbuffer(GL_FRAMEBUFFER, GL_COLOR_ATTACHMENT0, GL_RENDERBUFFER, colorRenderbuffer);\n```\n\n3. /\n``` objectivec\nGLuint depthRenderbuffer;\nglGenRenderbuffers(1, &depthRenderbuffer);\nglBindRenderbuffer(GL_RENDERBUFFER, depthRenderbuffer);\nglRenderbufferStorage(GL_RENDERBUFFER, GL_DEPTH_COMPONENT16, width, height);\nglFramebufferRenderbuffer(GL_FRAMEBUFFER, GL_DEPTH_ATTACHMENT, GL_RENDERBUFFER, depthRenderbuffer);\n```\n\n4. \n``` objectivec\nGLenum status = glCheckFramebufferStatus(GL_FRAMEBUFFER);\nif (status != GL_FRAMEBUFFER_COMPLETE) {\n    NSLog(@\"failed to make complete framebuffer object %x\", status);\n}\n```\n\n`glReadPixels`CPU\n\n### \n\n\n1. \n2. \n``` objectivec\nGLuint texture;\nglGenTextures(1, &texture);\nglBindTexture(GL_TEXTURE_2D, texture);\nglTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_LINEAR);   // \nglTexImage2D(GL_TEXTURE_2D, 0, GL_RGBA8, width, height, 0, GL_RGBA, GL_UNSIGNED_BYTE, NULL);\nglFramebufferTexture2D(GL_FRAMEBUFFER, GL_COLOR_ATTACHMENT0, GL_TEXTURE_2D, texture, 0);\n```\n3. \n4. \n\n*OES_depth_texture*\n\n### Core Animation\n\nCore AnimationiOSiOSUIKitQuartz 2DOpenGL ESOpenGL ES*CAEAGLLayer*Core AnimationCore AnimationOpenGL ESCore Animation\n\n![Core Animation shares the renderbuffer width OpenGL ES](/img/article/20190519/6.png)\n\n*CAEAGLLayer*OpenGL ESCore AnimationCore Animation\n\n> GLKViewOpenGL ES\n\nCore AnimationOpenGL ES\n1. *CAEAGLLayer**opaue*YES*CAEAGLLayer*`drawableProperties`Core Animation[EAGLDrawable Protocol Reference](https://developer.apple.com/documentation/opengles/eagldrawable?language=objc)\n2. OpenGL ES\n3. \n4. `renderbufferStorage:fromDrawable:`\n``` objectivec\nGLuint colorRenderbuffer;\nglGenRenderbuffers(1, &colorRenderbuffer);\nglBindRenderbuffer(GL_RENDERBUFFER, colorRenderbuffer);\n[myContext renderbufferStorage:GL_RENDERBUFFER fromDrawable:myEAGLLayer];\nglFramebufferRenderbuffer(GL_FRAMEBUFFER, GL_COLOR_ATTACHMENT0, GL_RENDERBUFFER, colorRenderbuffer);\n```\n> Core Animation`bounds`\n5. \n```\nGLuint width, height;\nglGetRenderbufferParameteriv(GL_RENDERBUFFER, GL_RENDERBUFFER_WIDTH, &width);\nglGetRenderbufferParameteriv(GL_RENDERBUFFER, GL_RENDERBUFFER_HEIGHT, &height);\n```\nOpenGL ES\n6. \n7. \n8. *CAEAGLLayer*`addSublayer:`Core Animation\n\n## \n\n\n\n### \n\nCore AnimationOpenGL ESGLKit\n\non-demand\n\n`CADisplayLink``displayLink`Core Animation`displayLink`\n\n> *GLKViewController*`CADisplayLink``GLKView`*GLKit*`CADisplayLink`\n\n```\nCADisplayLink *displayLink = [self.view.window.screen displayLinkWithTarget:self selector:@selector(drawFrame)];\n[displayLink addToRunLoop:[NSRunLoop currentRunLoop] forMode:NSDefaultRunLoopMode];\n```\n\n`drawFrame``displayLink``timestamp`\n\n`displayLink`60Hz60`displayLink``frameInterval`3320\n\n> \n\n### \n\nOpenGL ES\n\n![iOS OpenGL Rendering Steps](/img/article/20190519/7.png)\n\n#### \n\n`glClear`\n\n``` objectivec\nglBindFramebuffer(GL_FRAMEBUFFER, framebuffer);\nglClear(GL_DEPTH_BUFFER_BIT | GL_COLOR_BUFFER_BIT);\n```\n\n`glClear`OpenGL ES\n\n#### \n\nOpenGL ESGPUGPU\n\n[OpenGL ES Design Guidelines](#opengl-es-design-guidelines)OpenGL ES\n\n#### \n\n[OpenGL ES Design Guidelines](#opengl-es-design-guidelines)OpenGL ES\n\n#### \n\n[](#)\n\n#### \n\nOpenGL ESOpenGL ES\n\n\n\n``` objectivec\nconst GLenum discards = {GL_DEPTH_ATTACHMENT};\nglBindFramebuffer(GL_FRAMEBUFFER, framebuffer);\nglDiscardFramebufferEXT(GL_FRAMEBUFFER, 1, discards)\n```\n\n> `glDiscardFramebufferEXT`OpengGL ES1.02.0`EXT_discard_framebuffer`OpenGL ES 3.0`glInvalidateFramebuffer`\n\n#### Core Animation\n\nrenderbufferCore Animation\n\n``` objectivec\nglBindRenderbuffer(GL_RENDERBUFFER, colorRenderbuffer);\n[context presentRenderbuffer: GL_RENDERBUFFER];\n```\n\n\n\n`CAEAGLLayer``drawableProperties``kEAGLDrawablePropertyRetainedBacking``YES``glClear``GL_COLOR_BUFFER_BIT`iOS\n\n## \n\n3DOpenGL ES 3.0OpenGL ES 1.02.0`APPLE_framebuffer_multisample`\n\n\n\n![How multisampling](/img/article/20190519/8.png)\n\n`glRenderbufferStorageMultisampleAPPLE`\n\n``` objectivec\nGLuint sampleFramebuffer;\nglGenFramebuffers(1, &sampleFramebuffer);\nglBindFramebuffer(GL_FRAMEBUFFER, sampleFramebuffer);\n\nGLuint sampleColorRenderbuffer;\nglGenRenderbuffers(1, &sampleColorRenderbuffer);\nglBindRenderbuffer(GL_RENDERBUFFER, sampleColorRenderbuffer);\nglRenderbufferStorageMultisample(GL_RENDERBUFFER, 4, GL_RGBA8_OES, width, height);\nglFramebufferRenderbuffer(GL_FRAMEBUFFER, GL_COLOR_ATTACHMENT0, GL_RENDERBUFFER, sampleColorRenderbuffer);\n\nGLuint sampleDepthRenderbuffer;\nglGenRenderbuffers(1, &sampleDepthRenderbuffer);\nglBindRenderbuffer(GL_RENDERBUFFER, sampleDepthRenderbuffer);\nglRenderbufferStorageMultisample(GL_RENDERBUFFER, 4, GL_DEPTH_COMPONENT16, width, height);\nglFramebufferRenderbuffer(GL_FRAMEBUFFER, GL_DEPTH_ATTACHMENT, GL_RENDERBUFFER, sampleDepthRenderbuffer);\n\nif (glCheckFramebufferStatus(GL_FRAMEBUFFER) != GL_FRAMEBUFFER_COMPLETE) {\n    NSLog(@\"Failed to make complete framebuffer object %x\", glCheckFramebufferStatus(GL_FRAMEBUFFER));\n}\n```\n\n\n1. \n\n``` obejctivec\nglBindFramebuffer(GL_FRAMEBUFFER, sampleFramebuffer);\nglViewport(0, 0, framebufferWidth, framebufferHeight);  // \nglClear(GL_COLOR_BUFFER_BIT, GL_DEPTH_BUFFER_BIT);\n```\n\n2. \n\n``` objectivec\nglBindFramebuffer(GL_DRAW_FRAMEBUFFER_APPLE, resolveFramebuffer);\nglBindFramebuffer(GL_READ_FRAMEBUFFER_APPLE, smapleFramebuffer);\nglResolveMultisampleFramebufferAPPLE();\n```\n\n3. \n\n``` objectivec\nconst GLenum discards[] = {GL_COLOR_ATTACHMENT0, GL_DEPTH_ATTACHMENT};\nglDiscardFramebufferEXT(GL_READ_FRAMEBUFFER_APPLE, 2, discards);\n```\n\n4. \n\n``` objectivec\nglBindRenderBuffer(GL_RENDERBUFFER, colorRenderbuffer);\n[context presentRenderbuffer: GL_RENDERBUFFER];\n```\n\n\n\n> OpenGL ES 1.02.0OpenGL ES 3.0API\n\n# Multitasking, High Resolution, and Other iOS Features\n\nOpenGL ESiOSiOSOpenGL ESiOSOpenGL ES\n\n## OpenGL ES\n\n[App States and Multitasking](https://developer.apple.com/library/archive/documentation/iPhone/Conceptual/iPhoneOSProgrammingGuide/BackgroundExecution/BackgroundExecution.html#//apple_ref/doc/uid/TP40007072-CH4)\n\nOpenGL ESOpenGL ES\n\n### \n\nOpenGL ESOpenGL ESiOSOpenGL ESGPU\n\nGLKitOpenGL ES`GLKViewController`\n\nGLKitGLKViewOpenGL ES\n1. `applicationWillResignActive:``glFinish`\n2. `applicationDidEnterBackground:`OpenGL ES`glFinish`\n3. `applicationDidEnterBackground:`OpenGL ES\n4. `applicationWillEnterForeground:`\n\n`glFinish`OpenGL ESOpenGL ES\n\n### \n\nOpenGL ES\n- \n- OpenGL ESOpenGL ES\n\n\n\n\n- \n- \n\nOpenGL ES\n\nGLKit`GLKViewController`\n\n## \n\nGLKit`contentScaleFactor` UIKit[Supporting High-Resolution Screens In Views](https://developer.apple.com/library/archive/documentation/2DDrawing/Conceptual/DrawingPrintingiOS/SupportingHiResScreensInViews/SupportingHiResScreensInViews.html#//apple_ref/doc/uid/TP40010156-CH15)\n\nCore AnimationOpenGL ES1.0Retina`CAEAGLayer`\n\n\n\n> OpenGL ES API1.0`glScissor``glBlitFramebuffer``glLineWidth``glPointSize``gl_PointSize`\n\nRetinaGPU\n- [Tuning Your OpenGL ES App](tuning-your-openGL-es-app)\n- \n- 1.01.51.02.0\n- GLKView`drawableColorFormat``drawableDepthFormat`\n- GLKView`drawableMultisample`GLKit[](#)\n\n## \n\nOpenGL ESOpenGL ES`supportedInterfaceOrientations`\n\n`GLKViewController``GLKView``GLKView``GLKViewController``viewWillLayoutSubviews``viewDidLayoutSubviews``GLKView``layoutSubviews`\n\nCore AnimationOpenGL ES\n\n## OpenGL ES\n\niOS\n\n\n1. [Multiple Display Programming Guide for iOS](https://developer.apple.com/library/archive/documentation/WindowsViews/Conceptual/WindowAndScreenGuide/Introduction/Introduction.html#//apple_ref/doc/uid/TP40012555)\n2. \n    - GLKit`GLKViewController``GLKView``rootViewController`\n    - Core Animation`screen``dispalyLinkWithTarget:slector:`\n\n# OpenGL ES Design Guidelines\n\niOSOpenGL ES\n\n## OpenGL ES\n\nOpenGL ES-\n\n### OpenGL ES-\n\nOpenGL ESGPU\n\n![OpenGL ES client-server architecture](/img/article/20190519/9.png)\n\nOpenGL ESOpenGL ES\n\n### OpenGL ES\n\n\n\n![OpenGL ES graphics pipline](/img/article/20190519/10.png)\n\nOpenGL ES\n\n--\n\n> \n\n## OpenGL ES\n\niOS3OpenGL ES\n\n### OpenGL ES 3.0\n\nOpenGL ES 3.0iOS 7OpenGL ES 3.0[OpenGL ES API Registry](http://www.khronos.org/registry/OpenGL/index_es.php)\n[OpenGL ES 3.0](https://developer.apple.com/library/archive/documentation/3DDrawing/Conceptual/OpenGLES_ProgrammingGuide/OpenGLESApplicationDesign/OpenGLESApplicationDesign.html#//apple_ref/doc/uid/TP40008793-CH6-SW13)\n### OpenGL ES 2.0\n### OpenGL ES 1.0\n\n## OpenGL ES\n\nOpenGL ES\n- OpenGL ES\n- \n\nOpenGL ES\n\n![App model for managing resources](/img/article/20190519/11.png)\n\nOpenGL ESOpenGLESOpenGL ES\n\nOpenGL ESOpenGL ESCPUGPUOpenGL ESiOSOpenGL ES\n\nOpenGL ESGPUCPU\n\n\n\nOpenGL ES\n\n\n- \n- \n- \n\n\n\n### Flush\n\nOpenGL ESOpenGL ES--OpenGL ES\n\nOpenGL ES\n- `glFlush`\n- `glFinish`\n- `glReadPixels`\n- \n\n#### glFlush\n\nOpenGL`glFlush`CPUGPUiOSiOSOpenGL ES`glFlush``glFinish`\n- OpenGL ESiOS\n- OpenGL ES`glFlush``glFlush`iOS APIsCore ImageOpenGL ES\n\n#### OpenGL ES\n\n`glGet*()``glGetError()`OpenGL ESCPUOpenGL ES\n\nOpenGL ESXcodeOpenGL ES`glGetError``glCheckFramebufferStatus()``glGetProgramInfoLog()``glValidateProgram()`\n\n### OpenGL ES\n\nOpenGLOpenGL ESOpenGL ESOpenGL ESOpenGL ES\n\n### \n\nOpenGL ESOpenGL ESOpenGL ESOpenGL ES--CPUGPU\n\n![Single-buffered texture data](/img/article/20190519/12.png)\n\nGPUCPUCPUGPUOpenGL ES\n\n![Double-buffered texture data](/img/article/20190519/13.png)\n\n-\n\niOS\n\n### OpenGL ES\n\nOpenGL ES`glEnable``glDisable`\n\n`glUniform`OpenGL ES\n\n--\n\n#### OpenGL ES\n\nOpenGL ES[]()\n\n#### \n\nOpenGL ESOpenGL ESCPUOpenGL ES--\n\nOpenGL ESiOS\n- \n- \n- OpenGL ES\n\n# Best Practices for Working with Vertex Data\n\nOpenGL ESOpenGL ES\n\nOpenGL ES 2.03.0OpenGL ES 1.1\n\n`GLubyte`r,g,b,aOpenGL ES10\n\n![Conversion of attribute data to shader variables](/img/article/20190519/14.png)\n\nOpenGL ESOpenGL ESOpenGL ESOpenGL ES\n\nOpenGL ES\n- \n- OpenGL ES\n- \n- \n\n## \n\niOSiOS\n\n\n\n- \n- \n- \n    + OpenGL ES 2.0\n    + OpenGL ES 1.1DOT3`GL_DOT3_RGB`\n\n## \n\nOpenGL ES 2.03.0OpenGL ES 1.1`glColor4ub``glTexCoord2f`\n\n> ...\n\n# Reference\n\n> [About OpenGL ES](https://developer.apple.com/library/archive/documentation/3DDrawing/Conceptual/OpenGLES_ProgrammingGuide/Introduction/Introduction.html#//apple_ref/doc/uid/TP40008793-CH1-SW1)","source":"_posts/2019/opengl-es-study-0519.md","raw":"---\ntitle: \"OpenGL ES\"\ncatalog: true\ntoc_nav_num: true\ndate: 2019-05-19 18:20:03\nsubtitle: \"Open Graphics Library for Embedded Systems\"\nheader-img: \"/img/article_header/article_header.png\"\nbusuanzi: true\ntags: \n- iOS\n\n---\n\n# Introduction\n\nOpen Graphics Library(OpenGL)2D3D2D3DOpenGL3D2DOpenGLOpenGL\n\nOpenGL for Embedded Systems(OpenGL ES)openGL\n\n![OpenGL ES](/img/article/20190519/1.png)\n\nOpenGL ESiOSGPU2D3DGPUOpenGL ESOpenGL ES3D\n\n# Checklist for Building OpenGL ES Apps for iOS\n\nOpenGL ESGPUAPIOpenGL ESOpenGL ESiOS*EAGLContext*iOSOpenGL ES*GLKView**CAEAGLLayer*\n\niOSOpenGL ESOpenGL ESiOS\n1. OpenGL ES\n2. OpenGL ES\n3. OpenGL ES\n4. iOS\n5. \n6. XcodeInstrumentsOpenGL ES\n\n## OpenGL ES\n\nOpenGL ES 3.0OpenGL ES 2.0OpenGL ES 1.1\n- OpenGL ES 3.0iOS 7GPU\n- OpenGL ES 2.0iOS\n- OpenGL ES 1.1iOS\n\niOS[iOS Device Compatibility Reference](https://developer.apple.com/library/archive/documentation/DeviceInformation/Reference/iOSDeviceCompatibility/Introduction/Introduction.html#//apple_ref/doc/uid/TP40013599)\n\n## OpenGL ES\n\n[iOS Device Compatibility Reference](https://developer.apple.com/library/archive/documentation/DeviceInformation/Reference/iOSDeviceCompatibility/Introduction/Introduction.html#//apple_ref/doc/uid/TP40013599)iOSiOSOpenGL ES\n\n`glGet`*gl.h**MAX_TEXTURE_SIZE**MAX_VERTEX_ATTRIBS*\n\n`glGetIntegerv``glGetStringi`OpenGL ES 3.0\n``` objectivec\n/// #import <OpenGLES/ES3/gl.h>\nBOOL CheckForExtensions(NSString *searchName) {\n    int max = 0;\n    glGetIntegerv(GL_NUM_EXTENSIONS, &max);\n    NSMutableSet *extensions = [NSMutableSet set];\n    for (int i = 0; i < max; i++) {\n        [extensions addObject:@((char *)glGetStringi(GL_EXTENSIONS, i))];\n    }\n    return [extensions containsObject:searchName];\n}\n/// OpenGL ES 2.01.1glGetString(GL_EXTENSIONS)\n```\n\n## \n\niOS\n- *GLKit*OpenGL ESviewOpenGL ESUIKit[Drawing with OpenGL ES and GLKit](#drawing-with-opengl-es-and-glkit)\n- *CAEAGLLayer*OpenGL ESCore Animation\n- OpenGL ESOpenGL ES\n\nCore Animation[Drawing to Other Rendering Destinatons](#drawing-to-other-rendering-destinations)\n\n## iOS\n\niOSOpenGL ESOpenGL ES\n\niOS\n\niOS[Multitasking, High Resolution, and Other iOS Features](#multitasking,-high-resolution,-and-other-ios-features)\n\n## \n\nOpenGL ESOpenGLOpenGL ES\n\niOS[OpenGL ES Design Guidelines](#opengl-es-design-guidelines)[Concurrency and OpenGL ES](#concurrency-and-opengl-es)\n\n## \n\nXcodeInstrumentsOpenGL ES[Debugging and Profiling](#debugging-and-profiling)\n\n# Configuring OpenGL ES Contexts\n\nOpenGL ESOpenGL ES\n\nOpenGL ES*EAGLContext**EAGLContext*OpenGL ESCore Animation\n\n## OpenGL ES\n\niOSOpenGL ES\n\n`setCurrentContext:`\n``` objectivec\n[EAGLContext setCurrentContext:context];\n```\n\n*EAGLContext*`currentContext`\n\n> `glFlush`\n\nOpenGL ES*EAGLContext*`setCurrentContext:`*EAGLContext*\n\n## OpenGL ES\n\n*EAGLContext*OpenGL ESOpenGL ES 1.12.03.0OpenGL ES 2.03.02.03.0OpenGL ES 3.03.0\n\n*EAGLContext*OpenGL ESnil\n``` objectivec\nEAGLContext* CreateBestEAGLContext() {\n    EAGLContext *context = [[EAGLContext alloc] initWithAPI:kEAGLRenderingAPIOpenGLES3];\n    if (context == nil) {\n        context = [[EAGLContext alloc] initWithAPI:kEAGLRenderingAPIOpenGLES2];\n    }\n    return context;\n}\n```\n\n## EAGL Sharegroup\n\nOpenGL ESOpenGL ES*EAGLSharegroup*OpenGL ES*ESGLSharegroup*\n\nOpenGL ESOpenGL ES\n\nsharegroupsharegroup\n\n![OpenGL ES Sharegroup](/img/article/20190519/2.png)\n\nsharegroup\n- \n- OpenGL ES*GLKtextureLoader*\n\nsharegroup`initAPI:`sharegroup`initAPI:sharegroup:`sharegroup\n\n``` objectivec\nEAGLContext* firstContext = CreateBestEAGLContext();\nEAGLContext* secondContext = [[EAGLContext alloc] initWithAPI:[firstContext API] sharegroup: [firstContext sharegroup]];\n```\n\nsharegroupOpenGL ES\n- \n- \n- \n\nOpenGL ES\n- `glFlush`\n- OpenGL ES\n- `glFlush`\n- \n\n> OpenGL ESOpengGL ES\n\n# Drawing with OpenGL ES and GLKit\n\nGLKitOpenGL ES*GLKView*OpenGL ES*GLKViewController*GLKitOpenGL ESUIKitOpenGL ESGLKitOpenGL ES 2.03.0\n\n## GLKitOpenGL ES\n\n*GLKView*OpenGL ESUIView*UIView*`drawRect:`Quartz 2D*GLKView*OpenGL ES*GLKView*OpenGL ESCore Animation\n\nUIKitGLKit--Core Animation`setNeedsDisplay`\n\n![Rending OpenGL ES content with a GLKit view](/img/article/20190519/3.png)\n\n### GLKit View\n\nGLKView*EAGLContext*\n\n- *initWithFrame:context:*\n- *context*\n\nGLKitOpenGL ES\n\n``` objectivec\n- (void)viewDidLoad {\n    [super viewDidLoad];\n    \n    EAGLContext *context = CreateBestEAGLContext();\n    GLKView *glkView = [[GLKView alloc] initWithFrame:self.view.bounds context:context];\n    // Configure renderbuffers\n    glkView.drawableColorFormat = GLKViewDrawableColorFormatSRGBA8888;\n    glkView.drawableDepthFormat = GLKViewDrawableDepthFormat24;\n    glkView.drawableStencilFormat = GLKViewDrawableStencilFormat8;\n    // enable multisampling\n    // multisampling3D\n    glkView.drawableMultisample = GLKViewDrawableMultisample4X;\n    [self.view addSubview:glkView];\n}\n```\n\n### GLKit View\n\nOpenGL ESOpenGL ESCore Animation*GLKView*\n\n``` objectivec\n- (void)drawRect:(CGRect)rect {\n    // clear the framebuffer\n    glClearColor(0.0, 0.0, 0.1, 1.0);\n    glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);\n    // Draw using previously configured texture, shader, uniforms, and vertex array\n    glBindTexture(GL_TEXTURE_2D, _planetTexture);\n    glUseProgram(_diffuseShading);\n    glUniformMatrix4fv(_uniformModelViewProjectionMatrix, 1, 0, _modelViewProjectionMatrix.m);\n    glBindVertexArray(_planetMesh);\n    glDrawElements(GL_TRIANGLE_STRIP, 256, GL_UNSIGNED_SHORT, NULL);\n}\n```\n\n> *glClear*OpenGL ES\n\n*GLKView*OpenGL ESOpenGL ES\n\n- \n    + *EAGLContext*\n    + \n    + \n    + OpenGL ES\n- \n    + multisamplingmultisampling\n    + \n    + Core Animation\n\n## \n\nOpenGL ESOpenGL ES 2.03.0\n\nGLKit--GLKViewGLKView`drawInRect:`*GLKViewDelegate*`glkView:drawInRect:`\n\n``` objectivec\n- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions {\n    // Create a context\n    EAGLContext *context = [[EAGLContext alloc] initWithAPI:kEAGLRenderingAPIOpenGLES2];\n    [EAGLContext setCurrentContext:context];\n    \n    // Choose a rendering class based on device features\n    GLint maxTextureSize;\n    glGetIntegerv(GL_MAX_TEXTURE_SIZE, &maxTextureSize);\n    if (maxTextureSize > 2048) {\n        self.renderer = [[MyBigTextureRenderer alloc] initWithContext:context];\n    } else {\n        self.renderer = [[MyRenderer alloc] initWithContext:context];\n    }\n    GLKView *view = (GLKView *)self.window.rootViewController.view;\n    view.delegate = self.renderer;\n    view.context = context;\n    return YES;\n}\n```\n\n## GLKitOpenGL ES\n\n*GLKView*OpenGL ES--*GLKit**GLKView*\n\n![The animation loop](/img/article/20190519/4.png)\n\n### \n\n*update*GLKViewController`glkViewControllerUpdate:``timeSinceLastUpdate`\n\n`display`GPUOpenGL ESOpenGL ES\n\n`framesPerSecond``preferredFramesPerSecond`--\n\n> \n\n### GLKit\n\n``` objectivec\n@implementation PlanetViewController // subclass of GLKViewController\n \n- (void)viewDidLoad {\n    [super viewDidLoad];\n \n    // Create an OpenGL ES context and assign it to the view loaded from storyboard\n    GLKView *view = (GLKView *)self.view;\n    view.context = [[EAGLContext alloc] initWithAPI:kEAGLRenderingAPIOpenGLES2];\n \n    // Set animation frame rate\n    self.preferredFramesPerSecond = 60;\n \n    // Not shown: load shaders, textures and vertex arrays, set up projection matrix\n    [self setupGL];\n}\n \n- (void)update {\n    _rotation += self.timeSinceLastUpdate * M_PI_2; // one quarter rotation per second\n \n    // Set up transform matrices for the rotating planet\n    GLKMatrix4 modelViewMatrix = GLKMatrix4MakeRotation(_rotation, 0.0f, 1.0f, 0.0f);\n    _normalMatrix = GLKMatrix3InvertAndTranspose(GLKMatrix4GetMatrix3(modelViewMatrix), NULL);\n    _modelViewProjectionMatrix = GLKMatrix4Multiply(_projectionMatrix, modelViewMatrix);\n}\n \n- (void)glkView:(GLKView *)view drawInRect:(CGRect)rect {\n    // Clear the framebuffer\n    glClearColor(0.0f, 0.0f, 0.1f, 1.0f);\n    glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);\n \n    // Set shader uniforms to values calculated in -update\n    glUseProgram(_diffuseShading);\n    glUniformMatrix4fv(_uniformModelViewProjectionMatrix, 1, 0, _modelViewProjectionMatrix.m);\n    glUniformMatrix3fv(_uniformNormalMatrix, 1, 0, _normalMatrix.m);\n \n    // Draw using previously configured texture and vertex array\n    glBindTexture(GL_TEXTURE_2D, _planetTexture);\n    glBindVertexArrayOES(_planetMesh);\n    glDrawElements(GL_TRIANGLE_STRIP, 256, GL_UNSIGNED_SHORT, 0);\n}\n@end\n```\n\n`viewDidLoad`OpenGL ES`update``glkView:drawInRect:`\n\n# Drawing to Other Rendering Destinations\n\nOpenGL ESOpenGL ES\n\n![Famebuffer with color and depth renderbuffers](/img/article/20190519/5.png)\n\nOpenGL ES\n\n## \n\n\n- [](#)\n- [](#)\n- Core AnimationCore Animation-aware[Core Animation](#Core-Animation)\n\n### \n\nOpenGL ES\n\n1. \n``` objectivec\nGLuint framebuffer;\nglGenFramebuffers(1, &framebuffer);\nglBindFramebuffer(GL_FRAMEBUFFER, framebuffer);\n```\n\n2. \n``` objectivec\nGLuint colorRenderbuffer;\nglGenRenderbuffers(1, &colorRenderbuffer);\nglBindRenderbuffer(GL_RENDERBUFFER, colorRenderbuffer);\nglRenderbufferStorage(GL_RENDERBUFFER, GL_RGBA, width, height);\nglFramebufferRenderbuffer(GL_FRAMEBUFFER, GL_COLOR_ATTACHMENT0, GL_RENDERBUFFER, colorRenderbuffer);\n```\n\n3. /\n``` objectivec\nGLuint depthRenderbuffer;\nglGenRenderbuffers(1, &depthRenderbuffer);\nglBindRenderbuffer(GL_RENDERBUFFER, depthRenderbuffer);\nglRenderbufferStorage(GL_RENDERBUFFER, GL_DEPTH_COMPONENT16, width, height);\nglFramebufferRenderbuffer(GL_FRAMEBUFFER, GL_DEPTH_ATTACHMENT, GL_RENDERBUFFER, depthRenderbuffer);\n```\n\n4. \n``` objectivec\nGLenum status = glCheckFramebufferStatus(GL_FRAMEBUFFER);\nif (status != GL_FRAMEBUFFER_COMPLETE) {\n    NSLog(@\"failed to make complete framebuffer object %x\", status);\n}\n```\n\n`glReadPixels`CPU\n\n### \n\n\n1. \n2. \n``` objectivec\nGLuint texture;\nglGenTextures(1, &texture);\nglBindTexture(GL_TEXTURE_2D, texture);\nglTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_LINEAR);   // \nglTexImage2D(GL_TEXTURE_2D, 0, GL_RGBA8, width, height, 0, GL_RGBA, GL_UNSIGNED_BYTE, NULL);\nglFramebufferTexture2D(GL_FRAMEBUFFER, GL_COLOR_ATTACHMENT0, GL_TEXTURE_2D, texture, 0);\n```\n3. \n4. \n\n*OES_depth_texture*\n\n### Core Animation\n\nCore AnimationiOSiOSUIKitQuartz 2DOpenGL ESOpenGL ES*CAEAGLLayer*Core AnimationCore AnimationOpenGL ESCore Animation\n\n![Core Animation shares the renderbuffer width OpenGL ES](/img/article/20190519/6.png)\n\n*CAEAGLLayer*OpenGL ESCore AnimationCore Animation\n\n> GLKViewOpenGL ES\n\nCore AnimationOpenGL ES\n1. *CAEAGLLayer**opaue*YES*CAEAGLLayer*`drawableProperties`Core Animation[EAGLDrawable Protocol Reference](https://developer.apple.com/documentation/opengles/eagldrawable?language=objc)\n2. OpenGL ES\n3. \n4. `renderbufferStorage:fromDrawable:`\n``` objectivec\nGLuint colorRenderbuffer;\nglGenRenderbuffers(1, &colorRenderbuffer);\nglBindRenderbuffer(GL_RENDERBUFFER, colorRenderbuffer);\n[myContext renderbufferStorage:GL_RENDERBUFFER fromDrawable:myEAGLLayer];\nglFramebufferRenderbuffer(GL_FRAMEBUFFER, GL_COLOR_ATTACHMENT0, GL_RENDERBUFFER, colorRenderbuffer);\n```\n> Core Animation`bounds`\n5. \n```\nGLuint width, height;\nglGetRenderbufferParameteriv(GL_RENDERBUFFER, GL_RENDERBUFFER_WIDTH, &width);\nglGetRenderbufferParameteriv(GL_RENDERBUFFER, GL_RENDERBUFFER_HEIGHT, &height);\n```\nOpenGL ES\n6. \n7. \n8. *CAEAGLLayer*`addSublayer:`Core Animation\n\n## \n\n\n\n### \n\nCore AnimationOpenGL ESGLKit\n\non-demand\n\n`CADisplayLink``displayLink`Core Animation`displayLink`\n\n> *GLKViewController*`CADisplayLink``GLKView`*GLKit*`CADisplayLink`\n\n```\nCADisplayLink *displayLink = [self.view.window.screen displayLinkWithTarget:self selector:@selector(drawFrame)];\n[displayLink addToRunLoop:[NSRunLoop currentRunLoop] forMode:NSDefaultRunLoopMode];\n```\n\n`drawFrame``displayLink``timestamp`\n\n`displayLink`60Hz60`displayLink``frameInterval`3320\n\n> \n\n### \n\nOpenGL ES\n\n![iOS OpenGL Rendering Steps](/img/article/20190519/7.png)\n\n#### \n\n`glClear`\n\n``` objectivec\nglBindFramebuffer(GL_FRAMEBUFFER, framebuffer);\nglClear(GL_DEPTH_BUFFER_BIT | GL_COLOR_BUFFER_BIT);\n```\n\n`glClear`OpenGL ES\n\n#### \n\nOpenGL ESGPUGPU\n\n[OpenGL ES Design Guidelines](#opengl-es-design-guidelines)OpenGL ES\n\n#### \n\n[OpenGL ES Design Guidelines](#opengl-es-design-guidelines)OpenGL ES\n\n#### \n\n[](#)\n\n#### \n\nOpenGL ESOpenGL ES\n\n\n\n``` objectivec\nconst GLenum discards = {GL_DEPTH_ATTACHMENT};\nglBindFramebuffer(GL_FRAMEBUFFER, framebuffer);\nglDiscardFramebufferEXT(GL_FRAMEBUFFER, 1, discards)\n```\n\n> `glDiscardFramebufferEXT`OpengGL ES1.02.0`EXT_discard_framebuffer`OpenGL ES 3.0`glInvalidateFramebuffer`\n\n#### Core Animation\n\nrenderbufferCore Animation\n\n``` objectivec\nglBindRenderbuffer(GL_RENDERBUFFER, colorRenderbuffer);\n[context presentRenderbuffer: GL_RENDERBUFFER];\n```\n\n\n\n`CAEAGLLayer``drawableProperties``kEAGLDrawablePropertyRetainedBacking``YES``glClear``GL_COLOR_BUFFER_BIT`iOS\n\n## \n\n3DOpenGL ES 3.0OpenGL ES 1.02.0`APPLE_framebuffer_multisample`\n\n\n\n![How multisampling](/img/article/20190519/8.png)\n\n`glRenderbufferStorageMultisampleAPPLE`\n\n``` objectivec\nGLuint sampleFramebuffer;\nglGenFramebuffers(1, &sampleFramebuffer);\nglBindFramebuffer(GL_FRAMEBUFFER, sampleFramebuffer);\n\nGLuint sampleColorRenderbuffer;\nglGenRenderbuffers(1, &sampleColorRenderbuffer);\nglBindRenderbuffer(GL_RENDERBUFFER, sampleColorRenderbuffer);\nglRenderbufferStorageMultisample(GL_RENDERBUFFER, 4, GL_RGBA8_OES, width, height);\nglFramebufferRenderbuffer(GL_FRAMEBUFFER, GL_COLOR_ATTACHMENT0, GL_RENDERBUFFER, sampleColorRenderbuffer);\n\nGLuint sampleDepthRenderbuffer;\nglGenRenderbuffers(1, &sampleDepthRenderbuffer);\nglBindRenderbuffer(GL_RENDERBUFFER, sampleDepthRenderbuffer);\nglRenderbufferStorageMultisample(GL_RENDERBUFFER, 4, GL_DEPTH_COMPONENT16, width, height);\nglFramebufferRenderbuffer(GL_FRAMEBUFFER, GL_DEPTH_ATTACHMENT, GL_RENDERBUFFER, sampleDepthRenderbuffer);\n\nif (glCheckFramebufferStatus(GL_FRAMEBUFFER) != GL_FRAMEBUFFER_COMPLETE) {\n    NSLog(@\"Failed to make complete framebuffer object %x\", glCheckFramebufferStatus(GL_FRAMEBUFFER));\n}\n```\n\n\n1. \n\n``` obejctivec\nglBindFramebuffer(GL_FRAMEBUFFER, sampleFramebuffer);\nglViewport(0, 0, framebufferWidth, framebufferHeight);  // \nglClear(GL_COLOR_BUFFER_BIT, GL_DEPTH_BUFFER_BIT);\n```\n\n2. \n\n``` objectivec\nglBindFramebuffer(GL_DRAW_FRAMEBUFFER_APPLE, resolveFramebuffer);\nglBindFramebuffer(GL_READ_FRAMEBUFFER_APPLE, smapleFramebuffer);\nglResolveMultisampleFramebufferAPPLE();\n```\n\n3. \n\n``` objectivec\nconst GLenum discards[] = {GL_COLOR_ATTACHMENT0, GL_DEPTH_ATTACHMENT};\nglDiscardFramebufferEXT(GL_READ_FRAMEBUFFER_APPLE, 2, discards);\n```\n\n4. \n\n``` objectivec\nglBindRenderBuffer(GL_RENDERBUFFER, colorRenderbuffer);\n[context presentRenderbuffer: GL_RENDERBUFFER];\n```\n\n\n\n> OpenGL ES 1.02.0OpenGL ES 3.0API\n\n# Multitasking, High Resolution, and Other iOS Features\n\nOpenGL ESiOSiOSOpenGL ESiOSOpenGL ES\n\n## OpenGL ES\n\n[App States and Multitasking](https://developer.apple.com/library/archive/documentation/iPhone/Conceptual/iPhoneOSProgrammingGuide/BackgroundExecution/BackgroundExecution.html#//apple_ref/doc/uid/TP40007072-CH4)\n\nOpenGL ESOpenGL ES\n\n### \n\nOpenGL ESOpenGL ESiOSOpenGL ESGPU\n\nGLKitOpenGL ES`GLKViewController`\n\nGLKitGLKViewOpenGL ES\n1. `applicationWillResignActive:``glFinish`\n2. `applicationDidEnterBackground:`OpenGL ES`glFinish`\n3. `applicationDidEnterBackground:`OpenGL ES\n4. `applicationWillEnterForeground:`\n\n`glFinish`OpenGL ESOpenGL ES\n\n### \n\nOpenGL ES\n- \n- OpenGL ESOpenGL ES\n\n\n\n\n- \n- \n\nOpenGL ES\n\nGLKit`GLKViewController`\n\n## \n\nGLKit`contentScaleFactor` UIKit[Supporting High-Resolution Screens In Views](https://developer.apple.com/library/archive/documentation/2DDrawing/Conceptual/DrawingPrintingiOS/SupportingHiResScreensInViews/SupportingHiResScreensInViews.html#//apple_ref/doc/uid/TP40010156-CH15)\n\nCore AnimationOpenGL ES1.0Retina`CAEAGLayer`\n\n\n\n> OpenGL ES API1.0`glScissor``glBlitFramebuffer``glLineWidth``glPointSize``gl_PointSize`\n\nRetinaGPU\n- [Tuning Your OpenGL ES App](tuning-your-openGL-es-app)\n- \n- 1.01.51.02.0\n- GLKView`drawableColorFormat``drawableDepthFormat`\n- GLKView`drawableMultisample`GLKit[](#)\n\n## \n\nOpenGL ESOpenGL ES`supportedInterfaceOrientations`\n\n`GLKViewController``GLKView``GLKView``GLKViewController``viewWillLayoutSubviews``viewDidLayoutSubviews``GLKView``layoutSubviews`\n\nCore AnimationOpenGL ES\n\n## OpenGL ES\n\niOS\n\n\n1. [Multiple Display Programming Guide for iOS](https://developer.apple.com/library/archive/documentation/WindowsViews/Conceptual/WindowAndScreenGuide/Introduction/Introduction.html#//apple_ref/doc/uid/TP40012555)\n2. \n    - GLKit`GLKViewController``GLKView``rootViewController`\n    - Core Animation`screen``dispalyLinkWithTarget:slector:`\n\n# OpenGL ES Design Guidelines\n\niOSOpenGL ES\n\n## OpenGL ES\n\nOpenGL ES-\n\n### OpenGL ES-\n\nOpenGL ESGPU\n\n![OpenGL ES client-server architecture](/img/article/20190519/9.png)\n\nOpenGL ESOpenGL ES\n\n### OpenGL ES\n\n\n\n![OpenGL ES graphics pipline](/img/article/20190519/10.png)\n\nOpenGL ES\n\n--\n\n> \n\n## OpenGL ES\n\niOS3OpenGL ES\n\n### OpenGL ES 3.0\n\nOpenGL ES 3.0iOS 7OpenGL ES 3.0[OpenGL ES API Registry](http://www.khronos.org/registry/OpenGL/index_es.php)\n[OpenGL ES 3.0](https://developer.apple.com/library/archive/documentation/3DDrawing/Conceptual/OpenGLES_ProgrammingGuide/OpenGLESApplicationDesign/OpenGLESApplicationDesign.html#//apple_ref/doc/uid/TP40008793-CH6-SW13)\n### OpenGL ES 2.0\n### OpenGL ES 1.0\n\n## OpenGL ES\n\nOpenGL ES\n- OpenGL ES\n- \n\nOpenGL ES\n\n![App model for managing resources](/img/article/20190519/11.png)\n\nOpenGL ESOpenGLESOpenGL ES\n\nOpenGL ESOpenGL ESCPUGPUOpenGL ESiOSOpenGL ES\n\nOpenGL ESGPUCPU\n\n\n\nOpenGL ES\n\n\n- \n- \n- \n\n\n\n### Flush\n\nOpenGL ESOpenGL ES--OpenGL ES\n\nOpenGL ES\n- `glFlush`\n- `glFinish`\n- `glReadPixels`\n- \n\n#### glFlush\n\nOpenGL`glFlush`CPUGPUiOSiOSOpenGL ES`glFlush``glFinish`\n- OpenGL ESiOS\n- OpenGL ES`glFlush``glFlush`iOS APIsCore ImageOpenGL ES\n\n#### OpenGL ES\n\n`glGet*()``glGetError()`OpenGL ESCPUOpenGL ES\n\nOpenGL ESXcodeOpenGL ES`glGetError``glCheckFramebufferStatus()``glGetProgramInfoLog()``glValidateProgram()`\n\n### OpenGL ES\n\nOpenGLOpenGL ESOpenGL ESOpenGL ESOpenGL ES\n\n### \n\nOpenGL ESOpenGL ESOpenGL ESOpenGL ES--CPUGPU\n\n![Single-buffered texture data](/img/article/20190519/12.png)\n\nGPUCPUCPUGPUOpenGL ES\n\n![Double-buffered texture data](/img/article/20190519/13.png)\n\n-\n\niOS\n\n### OpenGL ES\n\nOpenGL ES`glEnable``glDisable`\n\n`glUniform`OpenGL ES\n\n--\n\n#### OpenGL ES\n\nOpenGL ES[]()\n\n#### \n\nOpenGL ESOpenGL ESCPUOpenGL ES--\n\nOpenGL ESiOS\n- \n- \n- OpenGL ES\n\n# Best Practices for Working with Vertex Data\n\nOpenGL ESOpenGL ES\n\nOpenGL ES 2.03.0OpenGL ES 1.1\n\n`GLubyte`r,g,b,aOpenGL ES10\n\n![Conversion of attribute data to shader variables](/img/article/20190519/14.png)\n\nOpenGL ESOpenGL ESOpenGL ESOpenGL ES\n\nOpenGL ES\n- \n- OpenGL ES\n- \n- \n\n## \n\niOSiOS\n\n\n\n- \n- \n- \n    + OpenGL ES 2.0\n    + OpenGL ES 1.1DOT3`GL_DOT3_RGB`\n\n## \n\nOpenGL ES 2.03.0OpenGL ES 1.1`glColor4ub``glTexCoord2f`\n\n> ...\n\n# Reference\n\n> [About OpenGL ES](https://developer.apple.com/library/archive/documentation/3DDrawing/Conceptual/OpenGLES_ProgrammingGuide/Introduction/Introduction.html#//apple_ref/doc/uid/TP40008793-CH1-SW1)","slug":"2019/opengl-es-study-0519","published":1,"updated":"2021-06-21T12:34:52.096Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckszp3ndz001yifnt26widzhc","content":"<h1 id=\"introduction\">Introduction</h1>\n<p>Open Graphics Library(OpenGL)2D3D2D3DOpenGL3D2DOpenGLOpenGL</p>\n<p>OpenGL for Embedded Systems(OpenGL ES)openGL</p>\n<p><img src=\"/img/article/20190519/1.png\" alt=\"OpenGL ES\"></p>\n<p>OpenGL ESiOSGPU2D3DGPUOpenGL ESOpenGL ES3D</p>\n<h1 id=\"checklist-for-building-opengl-es-apps-for-ios\">Checklist for Building OpenGL ES Apps for iOS</h1>\n<p>OpenGL ESGPUAPIOpenGL ESOpenGL ESiOS<em>EAGLContext</em>iOSOpenGL ES<em>GLKView</em><em>CAEAGLLayer</em></p>\n<p>iOSOpenGL ESOpenGL ESiOS</p>\n<ol>\n<li>OpenGL ES</li>\n<li>OpenGL ES</li>\n<li>OpenGL ES</li>\n<li>iOS</li>\n<li></li>\n<li>XcodeInstrumentsOpenGL ES</li>\n</ol>\n<h2 id=\"opengl-es\">OpenGL ES</h2>\n<p>OpenGL ES 3.0OpenGL ES 2.0OpenGL ES 1.1</p>\n<ul>\n<li>OpenGL ES 3.0iOS 7GPU</li>\n<li>OpenGL ES 2.0iOS</li>\n<li>OpenGL ES 1.1iOS</li>\n</ul>\n<p>iOS<a href=\"https://developer.apple.com/library/archive/documentation/DeviceInformation/Reference/iOSDeviceCompatibility/Introduction/Introduction.html#//apple_ref/doc/uid/TP40013599\" target=\"_blank\" rel=\"noopener\">iOS Device Compatibility Reference</a></p>\n<h2 id=\"opengl-es\">OpenGL ES</h2>\n<p><a href=\"https://developer.apple.com/library/archive/documentation/DeviceInformation/Reference/iOSDeviceCompatibility/Introduction/Introduction.html#//apple_ref/doc/uid/TP40013599\" target=\"_blank\" rel=\"noopener\">iOS Device Compatibility Reference</a>iOSiOSOpenGL ES</p>\n<p><code>glGet</code><em>gl.h</em><em>MAX_TEXTURE_SIZE</em><em>MAX_VERTEX_ATTRIBS</em></p>\n<p><code>glGetIntegerv</code><code>glGetStringi</code>OpenGL ES 3.0</p>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/// #import &lt;OpenGLES/ES3/gl.h&gt;</span></span><br><span class=\"line\"><span class=\"built_in\">BOOL</span> CheckForExtensions(<span class=\"built_in\">NSString</span> *searchName) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> max = <span class=\"number\">0</span>;</span><br><span class=\"line\">    glGetIntegerv(GL_NUM_EXTENSIONS, &amp;max);</span><br><span class=\"line\">    <span class=\"built_in\">NSMutableSet</span> *extensions = [<span class=\"built_in\">NSMutableSet</span> set];</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; max; i++) &#123;</span><br><span class=\"line\">        [extensions addObject:@((<span class=\"keyword\">char</span> *)glGetStringi(GL_EXTENSIONS, i))];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> [extensions containsObject:searchName];</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">/// OpenGL ES 2.01.1glGetString(GL_EXTENSIONS)</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"\"></h2>\n<p>iOS</p>\n<ul>\n<li><em>GLKit</em>OpenGL ESviewOpenGL ESUIKit<a href=\"#drawing-with-opengl-es-and-glkit\">Drawing with OpenGL ES and GLKit</a></li>\n<li><em>CAEAGLLayer</em>OpenGL ESCore Animation</li>\n<li>OpenGL ESOpenGL ES</li>\n</ul>\n<p>Core Animation<a href=\"#drawing-to-other-rendering-destinations\">Drawing to Other Rendering Destinatons</a></p>\n<h2 id=\"ios\">iOS</h2>\n<p>iOSOpenGL ESOpenGL ES</p>\n<p>iOS</p>\n<p>iOS<a href=\"#multitasking,-high-resolution,-and-other-ios-features\">Multitasking, High Resolution, and Other iOS Features</a></p>\n<h2 id=\"\"></h2>\n<p>OpenGL ESOpenGLOpenGL ES</p>\n<p>iOS<a href=\"#opengl-es-design-guidelines\">OpenGL ES Design Guidelines</a><a href=\"#concurrency-and-opengl-es\">Concurrency and OpenGL ES</a></p>\n<h2 id=\"\"></h2>\n<p>XcodeInstrumentsOpenGL ES<a href=\"#debugging-and-profiling\">Debugging and Profiling</a></p>\n<h1 id=\"configuring-opengl-es-contexts\">Configuring OpenGL ES Contexts</h1>\n<p>OpenGL ESOpenGL ES</p>\n<p>OpenGL ES<em>EAGLContext</em><em>EAGLContext</em>OpenGL ESCore Animation</p>\n<h2 id=\"opengl-es\">OpenGL ES</h2>\n<p>iOSOpenGL ES</p>\n<p><code>setCurrentContext:</code></p>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[EAGLContext setCurrentContext:context];</span><br></pre></td></tr></table></figure>\n<p><em>EAGLContext</em><code>currentContext</code></p>\n<blockquote>\n<p><code>glFlush</code></p>\n</blockquote>\n<p>OpenGL ES<em>EAGLContext</em><code>setCurrentContext:</code><em>EAGLContext</em></p>\n<h2 id=\"opengl-es\">OpenGL ES</h2>\n<p><em>EAGLContext</em>OpenGL ESOpenGL ES 1.12.03.0OpenGL ES 2.03.02.03.0OpenGL ES 3.03.0</p>\n<p><em>EAGLContext</em>OpenGL ESnil</p>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">EAGLContext* CreateBestEAGLContext() &#123;</span><br><span class=\"line\">    EAGLContext *context = [[EAGLContext alloc] initWithAPI:kEAGLRenderingAPIOpenGLES3];</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (context == <span class=\"literal\">nil</span>) &#123;</span><br><span class=\"line\">        context = [[EAGLContext alloc] initWithAPI:kEAGLRenderingAPIOpenGLES2];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> context;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"eagl-sharegroup\">EAGL Sharegroup</h2>\n<p>OpenGL ESOpenGL ES<em>EAGLSharegroup</em>OpenGL ES<em>ESGLSharegroup</em></p>\n<p>OpenGL ESOpenGL ES</p>\n<p>sharegroupsharegroup</p>\n<p><img src=\"/img/article/20190519/2.png\" alt=\"OpenGL ES Sharegroup\"></p>\n<p>sharegroup</p>\n<ul>\n<li></li>\n<li>OpenGL ES<em>GLKtextureLoader</em></li>\n</ul>\n<p>sharegroup<code>initAPI:</code>sharegroup<code>initAPI:sharegroup:</code>sharegroup</p>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">EAGLContext* firstContext = CreateBestEAGLContext();</span><br><span class=\"line\">EAGLContext* secondContext = [[EAGLContext alloc] initWithAPI:[firstContext API] sharegroup: [firstContext sharegroup]];</span><br></pre></td></tr></table></figure>\n<p>sharegroupOpenGL ES</p>\n<ul>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n<p>OpenGL ES</p>\n<ul>\n<li><code>glFlush</code></li>\n<li>OpenGL ES</li>\n<li><code>glFlush</code></li>\n<li></li>\n</ul>\n<blockquote>\n<p>OpenGL ESOpengGL ES</p>\n</blockquote>\n<h1 id=\"drawing-with-opengl-es-and-glkit\">Drawing with OpenGL ES and GLKit</h1>\n<p>GLKitOpenGL ES<em>GLKView</em>OpenGL ES<em>GLKViewController</em>GLKitOpenGL ESUIKitOpenGL ESGLKitOpenGL ES 2.03.0</p>\n<h2 id=\"glkitopengl-es\">GLKitOpenGL ES</h2>\n<p><em>GLKView</em>OpenGL ESUIView<em>UIView</em><code>drawRect:</code>Quartz 2D<em>GLKView</em>OpenGL ES<em>GLKView</em>OpenGL ESCore Animation</p>\n<p>UIKitGLKitCore Animation<code>setNeedsDisplay</code></p>\n<p><img src=\"/img/article/20190519/3.png\" alt=\"Rending OpenGL ES content with a GLKit view\"></p>\n<h3 id=\"glkit-view\">GLKit View</h3>\n<p>GLKView<em>EAGLContext</em></p>\n<ul>\n<li>*initWithFrame:context:*</li>\n<li><em>context</em></li>\n</ul>\n<p>GLKitOpenGL ES</p>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">- (<span class=\"keyword\">void</span>)viewDidLoad &#123;</span><br><span class=\"line\">    [<span class=\"keyword\">super</span> viewDidLoad];</span><br><span class=\"line\">    </span><br><span class=\"line\">    EAGLContext *context = CreateBestEAGLContext();</span><br><span class=\"line\">    GLKView *glkView = [[GLKView alloc] initWithFrame:<span class=\"keyword\">self</span>.view.bounds context:context];</span><br><span class=\"line\">    <span class=\"comment\">// Configure renderbuffers</span></span><br><span class=\"line\">    glkView.drawableColorFormat = GLKViewDrawableColorFormatSRGBA8888;</span><br><span class=\"line\">    glkView.drawableDepthFormat = GLKViewDrawableDepthFormat24;</span><br><span class=\"line\">    glkView.drawableStencilFormat = GLKViewDrawableStencilFormat8;</span><br><span class=\"line\">    <span class=\"comment\">// enable multisampling</span></span><br><span class=\"line\">    <span class=\"comment\">// multisampling3D</span></span><br><span class=\"line\">    glkView.drawableMultisample = GLKViewDrawableMultisample4X;</span><br><span class=\"line\">    [<span class=\"keyword\">self</span>.view addSubview:glkView];</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"glkit-view\">GLKit View</h3>\n<p>OpenGL ESOpenGL ESCore Animation<em>GLKView</em></p>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">- (<span class=\"keyword\">void</span>)drawRect:(<span class=\"built_in\">CGRect</span>)rect &#123;</span><br><span class=\"line\">    <span class=\"comment\">// clear the framebuffer</span></span><br><span class=\"line\">    glClearColor(<span class=\"number\">0.0</span>, <span class=\"number\">0.0</span>, <span class=\"number\">0.1</span>, <span class=\"number\">1.0</span>);</span><br><span class=\"line\">    glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);</span><br><span class=\"line\">    <span class=\"comment\">// Draw using previously configured texture, shader, uniforms, and vertex array</span></span><br><span class=\"line\">    glBindTexture(GL_TEXTURE_2D, _planetTexture);</span><br><span class=\"line\">    glUseProgram(_diffuseShading);</span><br><span class=\"line\">    glUniformMatrix4fv(_uniformModelViewProjectionMatrix, <span class=\"number\">1</span>, <span class=\"number\">0</span>, _modelViewProjectionMatrix.m);</span><br><span class=\"line\">    glBindVertexArray(_planetMesh);</span><br><span class=\"line\">    glDrawElements(GL_TRIANGLE_STRIP, <span class=\"number\">256</span>, GL_UNSIGNED_SHORT, <span class=\"literal\">NULL</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p><em>glClear</em>OpenGL ES</p>\n</blockquote>\n<p><em>GLKView</em>OpenGL ESOpenGL ES</p>\n<ul>\n<li>\n<ul>\n<li><em>EAGLContext</em></li>\n<li></li>\n<li></li>\n<li>OpenGL ES</li>\n</ul>\n</li>\n<li>\n<ul>\n<li>multisamplingmultisampling</li>\n<li></li>\n<li>Core Animation</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"\"></h2>\n<p>OpenGL ESOpenGL ES 2.03.0</p>\n<p>GLKitGLKViewGLKView<code>drawInRect:</code><em>GLKViewDelegate</em><code>glkView:drawInRect:</code></p>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">- (<span class=\"built_in\">BOOL</span>)application:(<span class=\"built_in\">UIApplication</span> *)application didFinishLaunchingWithOptions:(<span class=\"built_in\">NSDictionary</span> *)launchOptions &#123;</span><br><span class=\"line\">    <span class=\"comment\">// Create a context</span></span><br><span class=\"line\">    EAGLContext *context = [[EAGLContext alloc] initWithAPI:kEAGLRenderingAPIOpenGLES2];</span><br><span class=\"line\">    [EAGLContext setCurrentContext:context];</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">// Choose a rendering class based on device features</span></span><br><span class=\"line\">    GLint maxTextureSize;</span><br><span class=\"line\">    glGetIntegerv(GL_MAX_TEXTURE_SIZE, &amp;maxTextureSize);</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (maxTextureSize &gt; <span class=\"number\">2048</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">self</span>.renderer = [[MyBigTextureRenderer alloc] initWithContext:context];</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">self</span>.renderer = [[MyRenderer alloc] initWithContext:context];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    GLKView *view = (GLKView *)<span class=\"keyword\">self</span>.window.rootViewController.view;</span><br><span class=\"line\">    view.delegate = <span class=\"keyword\">self</span>.renderer;</span><br><span class=\"line\">    view.context = context;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"literal\">YES</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"glkitopengl-es\">GLKitOpenGL ES</h2>\n<p><em>GLKView</em>OpenGL ES<em>GLKit</em><em>GLKView</em></p>\n<p><img src=\"/img/article/20190519/4.png\" alt=\"The animation loop\"></p>\n<h3 id=\"\"></h3>\n<p><em>update</em>GLKViewController<code>glkViewControllerUpdate:</code><code>timeSinceLastUpdate</code></p>\n<p><code>display</code>GPUOpenGL ESOpenGL ES</p>\n<p><code>framesPerSecond</code><code>preferredFramesPerSecond</code></p>\n<blockquote>\n<p></p>\n</blockquote>\n<h3 id=\"glkit\">GLKit</h3>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">@implementation</span> <span class=\"title\">PlanetViewController</span> // <span class=\"title\">subclass</span> <span class=\"title\">of</span> <span class=\"title\">GLKViewController</span></span></span><br><span class=\"line\"> </span><br><span class=\"line\">- (<span class=\"keyword\">void</span>)viewDidLoad &#123;</span><br><span class=\"line\">    [<span class=\"keyword\">super</span> viewDidLoad];</span><br><span class=\"line\"> </span><br><span class=\"line\">    <span class=\"comment\">// Create an OpenGL ES context and assign it to the view loaded from storyboard</span></span><br><span class=\"line\">    GLKView *view = (GLKView *)<span class=\"keyword\">self</span>.view;</span><br><span class=\"line\">    view.context = [[EAGLContext alloc] initWithAPI:kEAGLRenderingAPIOpenGLES2];</span><br><span class=\"line\"> </span><br><span class=\"line\">    <span class=\"comment\">// Set animation frame rate</span></span><br><span class=\"line\">    <span class=\"keyword\">self</span>.preferredFramesPerSecond = <span class=\"number\">60</span>;</span><br><span class=\"line\"> </span><br><span class=\"line\">    <span class=\"comment\">// Not shown: load shaders, textures and vertex arrays, set up projection matrix</span></span><br><span class=\"line\">    [<span class=\"keyword\">self</span> setupGL];</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"> </span><br><span class=\"line\">- (<span class=\"keyword\">void</span>)update &#123;</span><br><span class=\"line\">    _rotation += <span class=\"keyword\">self</span>.timeSinceLastUpdate * M_PI_2; <span class=\"comment\">// one quarter rotation per second</span></span><br><span class=\"line\"> </span><br><span class=\"line\">    <span class=\"comment\">// Set up transform matrices for the rotating planet</span></span><br><span class=\"line\">    GLKMatrix4 modelViewMatrix = GLKMatrix4MakeRotation(_rotation, <span class=\"number\">0.0</span>f, <span class=\"number\">1.0</span>f, <span class=\"number\">0.0</span>f);</span><br><span class=\"line\">    _normalMatrix = GLKMatrix3InvertAndTranspose(GLKMatrix4GetMatrix3(modelViewMatrix), <span class=\"literal\">NULL</span>);</span><br><span class=\"line\">    _modelViewProjectionMatrix = GLKMatrix4Multiply(_projectionMatrix, modelViewMatrix);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"> </span><br><span class=\"line\">- (<span class=\"keyword\">void</span>)glkView:(GLKView *)view drawInRect:(<span class=\"built_in\">CGRect</span>)rect &#123;</span><br><span class=\"line\">    <span class=\"comment\">// Clear the framebuffer</span></span><br><span class=\"line\">    glClearColor(<span class=\"number\">0.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">0.1</span>f, <span class=\"number\">1.0</span>f);</span><br><span class=\"line\">    glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);</span><br><span class=\"line\"> </span><br><span class=\"line\">    <span class=\"comment\">// Set shader uniforms to values calculated in -update</span></span><br><span class=\"line\">    glUseProgram(_diffuseShading);</span><br><span class=\"line\">    glUniformMatrix4fv(_uniformModelViewProjectionMatrix, <span class=\"number\">1</span>, <span class=\"number\">0</span>, _modelViewProjectionMatrix.m);</span><br><span class=\"line\">    glUniformMatrix3fv(_uniformNormalMatrix, <span class=\"number\">1</span>, <span class=\"number\">0</span>, _normalMatrix.m);</span><br><span class=\"line\"> </span><br><span class=\"line\">    <span class=\"comment\">// Draw using previously configured texture and vertex array</span></span><br><span class=\"line\">    glBindTexture(GL_TEXTURE_2D, _planetTexture);</span><br><span class=\"line\">    glBindVertexArrayOES(_planetMesh);</span><br><span class=\"line\">    glDrawElements(GL_TRIANGLE_STRIP, <span class=\"number\">256</span>, GL_UNSIGNED_SHORT, <span class=\"number\">0</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">@end</span></span><br></pre></td></tr></table></figure>\n<p><code>viewDidLoad</code>OpenGL ES<code>update</code><code>glkView:drawInRect:</code></p>\n<h1 id=\"drawing-to-other-rendering-destinations\">Drawing to Other Rendering Destinations</h1>\n<p>OpenGL ESOpenGL ES</p>\n<p><img src=\"/img/article/20190519/5.png\" alt=\"Famebuffer with color and depth renderbuffers\"></p>\n<p>OpenGL ES</p>\n<h2 id=\"\"></h2>\n<p></p>\n<ul>\n<li><a href=\"#%E5%88%9B%E5%BB%BA%E7%A6%BB%E5%B1%8F%E7%BC%93%E5%86%B2%E5%8C%BA%E5%AF%B9%E8%B1%A1\"></a></li>\n<li><a href=\"#%E4%BD%BF%E7%94%A8%E5%B8%A7%E7%BC%93%E5%86%B2%E5%8C%BA%E5%AF%B9%E8%B1%A1%E6%B8%B2%E6%9F%93%E7%BA%B9%E7%90%86\"></a></li>\n<li>Core AnimationCore Animation-aware<a href=\"#%E6%B8%B2%E6%9F%93%E5%88%B0Core-Animation%E5%B1%82%E7%BA%A7\">Core Animation</a></li>\n</ul>\n<h3 id=\"\"></h3>\n<p>OpenGL ES</p>\n<ol>\n<li></li>\n</ol>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">GLuint framebuffer;</span><br><span class=\"line\">glGenFramebuffers(<span class=\"number\">1</span>, &amp;framebuffer);</span><br><span class=\"line\">glBindFramebuffer(GL_FRAMEBUFFER, framebuffer);</span><br></pre></td></tr></table></figure>\n<ol start=\"2\">\n<li></li>\n</ol>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">GLuint colorRenderbuffer;</span><br><span class=\"line\">glGenRenderbuffers(<span class=\"number\">1</span>, &amp;colorRenderbuffer);</span><br><span class=\"line\">glBindRenderbuffer(GL_RENDERBUFFER, colorRenderbuffer);</span><br><span class=\"line\">glRenderbufferStorage(GL_RENDERBUFFER, GL_RGBA, width, height);</span><br><span class=\"line\">glFramebufferRenderbuffer(GL_FRAMEBUFFER, GL_COLOR_ATTACHMENT0, GL_RENDERBUFFER, colorRenderbuffer);</span><br></pre></td></tr></table></figure>\n<ol start=\"3\">\n<li>/</li>\n</ol>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">GLuint depthRenderbuffer;</span><br><span class=\"line\">glGenRenderbuffers(<span class=\"number\">1</span>, &amp;depthRenderbuffer);</span><br><span class=\"line\">glBindRenderbuffer(GL_RENDERBUFFER, depthRenderbuffer);</span><br><span class=\"line\">glRenderbufferStorage(GL_RENDERBUFFER, GL_DEPTH_COMPONENT16, width, height);</span><br><span class=\"line\">glFramebufferRenderbuffer(GL_FRAMEBUFFER, GL_DEPTH_ATTACHMENT, GL_RENDERBUFFER, depthRenderbuffer);</span><br></pre></td></tr></table></figure>\n<ol start=\"4\">\n<li></li>\n</ol>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">GLenum status = glCheckFramebufferStatus(GL_FRAMEBUFFER);</span><br><span class=\"line\"><span class=\"keyword\">if</span> (status != GL_FRAMEBUFFER_COMPLETE) &#123;</span><br><span class=\"line\">    <span class=\"built_in\">NSLog</span>(<span class=\"string\">@\"failed to make complete framebuffer object %x\"</span>, status);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><code>glReadPixels</code>CPU</p>\n<h3 id=\"\"></h3>\n<p></p>\n<ol>\n<li></li>\n<li></li>\n</ol>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">GLuint texture;</span><br><span class=\"line\">glGenTextures(<span class=\"number\">1</span>, &amp;texture);</span><br><span class=\"line\">glBindTexture(GL_TEXTURE_2D, texture);</span><br><span class=\"line\">glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_LINEAR);   <span class=\"comment\">// </span></span><br><span class=\"line\">glTexImage2D(GL_TEXTURE_2D, <span class=\"number\">0</span>, GL_RGBA8, width, height, <span class=\"number\">0</span>, GL_RGBA, GL_UNSIGNED_BYTE, <span class=\"literal\">NULL</span>);</span><br><span class=\"line\">glFramebufferTexture2D(GL_FRAMEBUFFER, GL_COLOR_ATTACHMENT0, GL_TEXTURE_2D, texture, <span class=\"number\">0</span>);</span><br></pre></td></tr></table></figure>\n<ol start=\"3\">\n<li></li>\n<li></li>\n</ol>\n<p><em>OES_depth_texture</em></p>\n<h3 id=\"core-animation\">Core Animation</h3>\n<p>Core AnimationiOSiOSUIKitQuartz 2DOpenGL ESOpenGL ES<em>CAEAGLLayer</em>Core AnimationCore AnimationOpenGL ESCore Animation</p>\n<p><img src=\"/img/article/20190519/6.png\" alt=\"Core Animation shares the renderbuffer width OpenGL ES\"></p>\n<p><em>CAEAGLLayer</em>OpenGL ESCore AnimationCore Animation</p>\n<blockquote>\n<p>GLKViewOpenGL ES</p>\n</blockquote>\n<p>Core AnimationOpenGL ES</p>\n<ol>\n<li><em>CAEAGLLayer</em><em>opaue</em>YES<em>CAEAGLLayer</em><code>drawableProperties</code>Core Animation<a href=\"https://developer.apple.com/documentation/opengles/eagldrawable?language=objc\" target=\"_blank\" rel=\"noopener\">EAGLDrawable Protocol Reference</a></li>\n<li>OpenGL ES</li>\n<li></li>\n<li><code>renderbufferStorage:fromDrawable:</code></li>\n</ol>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">GLuint colorRenderbuffer;</span><br><span class=\"line\">glGenRenderbuffers(<span class=\"number\">1</span>, &amp;colorRenderbuffer);</span><br><span class=\"line\">glBindRenderbuffer(GL_RENDERBUFFER, colorRenderbuffer);</span><br><span class=\"line\">[myContext renderbufferStorage:GL_RENDERBUFFER fromDrawable:myEAGLLayer];</span><br><span class=\"line\">glFramebufferRenderbuffer(GL_FRAMEBUFFER, GL_COLOR_ATTACHMENT0, GL_RENDERBUFFER, colorRenderbuffer);</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>Core Animation<code>bounds</code></p>\n</blockquote>\n<ol start=\"5\">\n<li></li>\n</ol>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">GLuint width, height;</span><br><span class=\"line\">glGetRenderbufferParameteriv(GL_RENDERBUFFER, GL_RENDERBUFFER_WIDTH, &amp;width);</span><br><span class=\"line\">glGetRenderbufferParameteriv(GL_RENDERBUFFER, GL_RENDERBUFFER_HEIGHT, &amp;height);</span><br></pre></td></tr></table></figure>\n<p>OpenGL ES</p>\n<ol start=\"6\">\n<li></li>\n<li></li>\n<li><em>CAEAGLLayer</em><code>addSublayer:</code>Core Animation</li>\n</ol>\n<h2 id=\"\"></h2>\n<p></p>\n<h3 id=\"\"></h3>\n<p>Core AnimationOpenGL ESGLKit</p>\n<p>on-demand</p>\n<p><code>CADisplayLink</code><code>displayLink</code>Core Animation<code>displayLink</code></p>\n<blockquote>\n<p><em>GLKViewController</em><code>CADisplayLink</code><code>GLKView</code><em>GLKit</em><code>CADisplayLink</code></p>\n</blockquote>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">CADisplayLink *displayLink = [self.view.window.screen displayLinkWithTarget:self selector:@selector(drawFrame)];</span><br><span class=\"line\">[displayLink addToRunLoop:[NSRunLoop currentRunLoop] forMode:NSDefaultRunLoopMode];</span><br></pre></td></tr></table></figure>\n<p><code>drawFrame</code><code>displayLink</code><code>timestamp</code></p>\n<p><code>displayLink</code>60Hz60<code>displayLink</code><code>frameInterval</code>3320</p>\n<blockquote>\n<p></p>\n</blockquote>\n<h3 id=\"\"></h3>\n<p>OpenGL ES</p>\n<p><img src=\"/img/article/20190519/7.png\" alt=\"iOS OpenGL Rendering Steps\"></p>\n<h4 id=\"\"></h4>\n<p><code>glClear</code></p>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">glBindFramebuffer(GL_FRAMEBUFFER, framebuffer);</span><br><span class=\"line\">glClear(GL_DEPTH_BUFFER_BIT | GL_COLOR_BUFFER_BIT);</span><br></pre></td></tr></table></figure>\n<p><code>glClear</code>OpenGL ES</p>\n<h4 id=\"\"></h4>\n<p>OpenGL ESGPUGPU</p>\n<p><a href=\"#opengl-es-design-guidelines\">OpenGL ES Design Guidelines</a>OpenGL ES</p>\n<h4 id=\"\"></h4>\n<p><a href=\"#opengl-es-design-guidelines\">OpenGL ES Design Guidelines</a>OpenGL ES</p>\n<h4 id=\"\"></h4>\n<p><a href=\"#%E4%BD%BF%E7%94%A8%E5%A4%9A%E9%87%8D%E9%87%87%E6%A0%B7%E6%8F%90%E9%AB%98%E5%9B%BE%E7%89%87%E8%B4%A8%E9%87%8F\"></a></p>\n<h4 id=\"\"></h4>\n<p>OpenGL ESOpenGL ES</p>\n<p></p>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> GLenum discards = &#123;GL_DEPTH_ATTACHMENT&#125;;</span><br><span class=\"line\">glBindFramebuffer(GL_FRAMEBUFFER, framebuffer);</span><br><span class=\"line\">glDiscardFramebufferEXT(GL_FRAMEBUFFER, <span class=\"number\">1</span>, discards)</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p><code>glDiscardFramebufferEXT</code>OpengGL ES1.02.0<code>EXT_discard_framebuffer</code>OpenGL ES 3.0<code>glInvalidateFramebuffer</code></p>\n</blockquote>\n<h4 id=\"core-animation\">Core Animation</h4>\n<p>renderbufferCore Animation</p>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">glBindRenderbuffer(GL_RENDERBUFFER, colorRenderbuffer);</span><br><span class=\"line\">[context presentRenderbuffer: GL_RENDERBUFFER];</span><br></pre></td></tr></table></figure>\n<p></p>\n<p><code>CAEAGLLayer</code><code>drawableProperties</code><code>kEAGLDrawablePropertyRetainedBacking</code><code>YES</code><code>glClear</code><code>GL_COLOR_BUFFER_BIT</code>iOS</p>\n<h2 id=\"\"></h2>\n<p>3DOpenGL ES 3.0OpenGL ES 1.02.0<code>APPLE_framebuffer_multisample</code></p>\n<p></p>\n<p><img src=\"/img/article/20190519/8.png\" alt=\"How multisampling\"></p>\n<p><code>glRenderbufferStorageMultisampleAPPLE</code></p>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">GLuint sampleFramebuffer;</span><br><span class=\"line\">glGenFramebuffers(<span class=\"number\">1</span>, &amp;sampleFramebuffer);</span><br><span class=\"line\">glBindFramebuffer(GL_FRAMEBUFFER, sampleFramebuffer);</span><br><span class=\"line\"></span><br><span class=\"line\">GLuint sampleColorRenderbuffer;</span><br><span class=\"line\">glGenRenderbuffers(<span class=\"number\">1</span>, &amp;sampleColorRenderbuffer);</span><br><span class=\"line\">glBindRenderbuffer(GL_RENDERBUFFER, sampleColorRenderbuffer);</span><br><span class=\"line\">glRenderbufferStorageMultisample(GL_RENDERBUFFER, <span class=\"number\">4</span>, GL_RGBA8_OES, width, height);</span><br><span class=\"line\">glFramebufferRenderbuffer(GL_FRAMEBUFFER, GL_COLOR_ATTACHMENT0, GL_RENDERBUFFER, sampleColorRenderbuffer);</span><br><span class=\"line\"></span><br><span class=\"line\">GLuint sampleDepthRenderbuffer;</span><br><span class=\"line\">glGenRenderbuffers(<span class=\"number\">1</span>, &amp;sampleDepthRenderbuffer);</span><br><span class=\"line\">glBindRenderbuffer(GL_RENDERBUFFER, sampleDepthRenderbuffer);</span><br><span class=\"line\">glRenderbufferStorageMultisample(GL_RENDERBUFFER, <span class=\"number\">4</span>, GL_DEPTH_COMPONENT16, width, height);</span><br><span class=\"line\">glFramebufferRenderbuffer(GL_FRAMEBUFFER, GL_DEPTH_ATTACHMENT, GL_RENDERBUFFER, sampleDepthRenderbuffer);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> (glCheckFramebufferStatus(GL_FRAMEBUFFER) != GL_FRAMEBUFFER_COMPLETE) &#123;</span><br><span class=\"line\">    <span class=\"built_in\">NSLog</span>(<span class=\"string\">@\"Failed to make complete framebuffer object %x\"</span>, glCheckFramebufferStatus(GL_FRAMEBUFFER));</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p></p>\n<ol>\n<li></li>\n</ol>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">glBindFramebuffer(GL_FRAMEBUFFER, sampleFramebuffer);</span><br><span class=\"line\">glViewport(0, 0, framebufferWidth, framebufferHeight);  // </span><br><span class=\"line\">glClear(GL_COLOR_BUFFER_BIT, GL_DEPTH_BUFFER_BIT);</span><br></pre></td></tr></table></figure>\n<ol start=\"2\">\n<li></li>\n</ol>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">glBindFramebuffer(GL_DRAW_FRAMEBUFFER_APPLE, resolveFramebuffer);</span><br><span class=\"line\">glBindFramebuffer(GL_READ_FRAMEBUFFER_APPLE, smapleFramebuffer);</span><br><span class=\"line\">glResolveMultisampleFramebufferAPPLE();</span><br></pre></td></tr></table></figure>\n<ol start=\"3\">\n<li></li>\n</ol>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> GLenum discards[] = &#123;GL_COLOR_ATTACHMENT0, GL_DEPTH_ATTACHMENT&#125;;</span><br><span class=\"line\">glDiscardFramebufferEXT(GL_READ_FRAMEBUFFER_APPLE, <span class=\"number\">2</span>, discards);</span><br></pre></td></tr></table></figure>\n<ol start=\"4\">\n<li></li>\n</ol>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">glBindRenderBuffer(GL_RENDERBUFFER, colorRenderbuffer);</span><br><span class=\"line\">[context presentRenderbuffer: GL_RENDERBUFFER];</span><br></pre></td></tr></table></figure>\n<p></p>\n<blockquote>\n<p>OpenGL ES 1.02.0OpenGL ES 3.0API</p>\n</blockquote>\n<h1 id=\"multitasking-high-resolution-and-other-ios-features\">Multitasking, High Resolution, and Other iOS Features</h1>\n<p>OpenGL ESiOSiOSOpenGL ESiOSOpenGL ES</p>\n<h2 id=\"opengl-es\">OpenGL ES</h2>\n<p><a href=\"https://developer.apple.com/library/archive/documentation/iPhone/Conceptual/iPhoneOSProgrammingGuide/BackgroundExecution/BackgroundExecution.html#//apple_ref/doc/uid/TP40007072-CH4\" target=\"_blank\" rel=\"noopener\">App States and Multitasking</a></p>\n<p>OpenGL ESOpenGL ES</p>\n<h3 id=\"\"></h3>\n<p>OpenGL ESOpenGL ESiOSOpenGL ESGPU</p>\n<p>GLKitOpenGL ES<code>GLKViewController</code></p>\n<p>GLKitGLKViewOpenGL ES</p>\n<ol>\n<li><code>applicationWillResignActive:</code><code>glFinish</code></li>\n<li><code>applicationDidEnterBackground:</code>OpenGL ES<code>glFinish</code></li>\n<li><code>applicationDidEnterBackground:</code>OpenGL ES</li>\n<li><code>applicationWillEnterForeground:</code></li>\n</ol>\n<p><code>glFinish</code>OpenGL ESOpenGL ES</p>\n<h3 id=\"\"></h3>\n<p>OpenGL ES</p>\n<ul>\n<li></li>\n<li>OpenGL ESOpenGL ES</li>\n</ul>\n<p></p>\n<p></p>\n<ul>\n<li></li>\n<li></li>\n</ul>\n<p>OpenGL ES</p>\n<p>GLKit<code>GLKViewController</code></p>\n<h2 id=\"\"></h2>\n<p>GLKit<code>contentScaleFactor</code> UIKit<a href=\"https://developer.apple.com/library/archive/documentation/2DDrawing/Conceptual/DrawingPrintingiOS/SupportingHiResScreensInViews/SupportingHiResScreensInViews.html#//apple_ref/doc/uid/TP40010156-CH15\" target=\"_blank\" rel=\"noopener\">Supporting High-Resolution Screens In Views</a></p>\n<p>Core AnimationOpenGL ES1.0Retina<code>CAEAGLayer</code></p>\n<p></p>\n<blockquote>\n<p>OpenGL ES API1.0<code>glScissor</code><code>glBlitFramebuffer</code><code>glLineWidth</code><code>glPointSize</code><code>gl_PointSize</code></p>\n</blockquote>\n<p>RetinaGPU</p>\n<ul>\n<li><a href=\"tuning-your-openGL-es-app\">Tuning Your OpenGL ES App</a></li>\n<li></li>\n<li>1.01.51.02.0</li>\n<li>GLKView<code>drawableColorFormat</code><code>drawableDepthFormat</code></li>\n<li>GLKView<code>drawableMultisample</code>GLKit<a href=\"#%E4%BD%BF%E7%94%A8%E5%A4%9A%E9%87%8D%E9%87%87%E6%A0%B7%E6%8F%90%E9%AB%98%E5%9B%BE%E7%89%87%E8%B4%A8%E9%87%8F\"></a></li>\n</ul>\n<h2 id=\"\"></h2>\n<p>OpenGL ESOpenGL ES<code>supportedInterfaceOrientations</code></p>\n<p><code>GLKViewController</code><code>GLKView</code><code>GLKView</code><code>GLKViewController</code><code>viewWillLayoutSubviews</code><code>viewDidLayoutSubviews</code><code>GLKView</code><code>layoutSubviews</code></p>\n<p>Core AnimationOpenGL ES</p>\n<h2 id=\"opengl-es\">OpenGL ES</h2>\n<p>iOS</p>\n<p></p>\n<ol>\n<li><a href=\"https://developer.apple.com/library/archive/documentation/WindowsViews/Conceptual/WindowAndScreenGuide/Introduction/Introduction.html#//apple_ref/doc/uid/TP40012555\" target=\"_blank\" rel=\"noopener\">Multiple Display Programming Guide for iOS</a></li>\n<li>\n<ul>\n<li>GLKit<code>GLKViewController</code><code>GLKView</code><code>rootViewController</code></li>\n<li>Core Animation<code>screen</code><code>dispalyLinkWithTarget:slector:</code></li>\n</ul>\n</li>\n</ol>\n<h1 id=\"opengl-es-design-guidelines\">OpenGL ES Design Guidelines</h1>\n<p>iOSOpenGL ES</p>\n<h2 id=\"opengl-es\">OpenGL ES</h2>\n<p>OpenGL ES-</p>\n<h3 id=\"opengl-es-\">OpenGL ES-</h3>\n<p>OpenGL ESGPU</p>\n<p><img src=\"/img/article/20190519/9.png\" alt=\"OpenGL ES client-server architecture\"></p>\n<p>OpenGL ESOpenGL ES</p>\n<h3 id=\"opengl-es\">OpenGL ES</h3>\n<p></p>\n<p><img src=\"/img/article/20190519/10.png\" alt=\"OpenGL ES graphics pipline\"></p>\n<p>OpenGL ES</p>\n<p></p>\n<blockquote>\n<p></p>\n</blockquote>\n<h2 id=\"opengl-es\">OpenGL ES</h2>\n<p>iOS3OpenGL ES</p>\n<h3 id=\"opengl-es-30\">OpenGL ES 3.0</h3>\n<p>OpenGL ES 3.0iOS 7OpenGL ES 3.0<a href=\"http://www.khronos.org/registry/OpenGL/index_es.php\" target=\"_blank\" rel=\"noopener\">OpenGL ES API Registry</a><br>\n<a href=\"https://developer.apple.com/library/archive/documentation/3DDrawing/Conceptual/OpenGLES_ProgrammingGuide/OpenGLESApplicationDesign/OpenGLESApplicationDesign.html#//apple_ref/doc/uid/TP40008793-CH6-SW13\" target=\"_blank\" rel=\"noopener\">OpenGL ES 3.0</a></p>\n<h3 id=\"opengl-es-20\">OpenGL ES 2.0</h3>\n<h3 id=\"opengl-es-10\">OpenGL ES 1.0</h3>\n<h2 id=\"opengl-es\">OpenGL ES</h2>\n<p>OpenGL ES</p>\n<ul>\n<li>OpenGL ES</li>\n<li></li>\n</ul>\n<p>OpenGL ES</p>\n<p><img src=\"/img/article/20190519/11.png\" alt=\"App model for managing resources\"></p>\n<p>OpenGL ESOpenGLESOpenGL ES</p>\n<p>OpenGL ESOpenGL ESCPUGPUOpenGL ESiOSOpenGL ES</p>\n<p>OpenGL ESGPUCPU</p>\n<p></p>\n<p>OpenGL ES</p>\n<p></p>\n<ul>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n<p></p>\n<h3 id=\"flush\">Flush</h3>\n<p>OpenGL ESOpenGL ESOpenGL ES</p>\n<p>OpenGL ES</p>\n<ul>\n<li><code>glFlush</code></li>\n<li><code>glFinish</code></li>\n<li><code>glReadPixels</code></li>\n<li></li>\n</ul>\n<h4 id=\"glflush\">glFlush</h4>\n<p>OpenGL<code>glFlush</code>CPUGPUiOSiOSOpenGL ES<code>glFlush</code><code>glFinish</code></p>\n<ul>\n<li>OpenGL ESiOS</li>\n<li>OpenGL ES<code>glFlush</code><code>glFlush</code>iOS APIsCore ImageOpenGL ES</li>\n</ul>\n<h4 id=\"opengl-es\">OpenGL ES</h4>\n<p><code>glGet*()</code><code>glGetError()</code>OpenGL ESCPUOpenGL ES</p>\n<p>OpenGL ESXcodeOpenGL ES<code>glGetError</code><code>glCheckFramebufferStatus()</code><code>glGetProgramInfoLog()</code><code>glValidateProgram()</code></p>\n<h3 id=\"opengl-es\">OpenGL ES</h3>\n<p>OpenGLOpenGL ESOpenGL ESOpenGL ESOpenGL ES</p>\n<h3 id=\"\"></h3>\n<p>OpenGL ESOpenGL ESOpenGL ESOpenGL ESCPUGPU</p>\n<p><img src=\"/img/article/20190519/12.png\" alt=\"Single-buffered texture data\"></p>\n<p>GPUCPUCPUGPUOpenGL ES</p>\n<p><img src=\"/img/article/20190519/13.png\" alt=\"Double-buffered texture data\"></p>\n<p>-</p>\n<p>iOS</p>\n<h3 id=\"opengl-es\">OpenGL ES</h3>\n<p>OpenGL ES<code>glEnable</code><code>glDisable</code></p>\n<p><code>glUniform</code>OpenGL ES</p>\n<p></p>\n<h4 id=\"opengl-es\">OpenGL ES</h4>\n<p>OpenGL ES<a href=\"%E4%BD%BF%E7%94%A8%E9%A1%B6%E7%82%B9%E6%95%B0%E7%BB%84%E5%AF%B9%E8%B1%A1%E5%90%88%E5%B9%B6%E9%A1%B6%E7%82%B9%E6%95%B0%E7%BB%84%E7%8A%B6%E6%80%81%E6%9B%B4%E6%94%B9\"></a></p>\n<h4 id=\"\"></h4>\n<p>OpenGL ESOpenGL ESCPUOpenGL ES</p>\n<p>OpenGL ESiOS</p>\n<ul>\n<li></li>\n<li></li>\n<li>OpenGL ES</li>\n</ul>\n<h1 id=\"best-practices-for-working-with-vertex-data\">Best Practices for Working with Vertex Data</h1>\n<p>OpenGL ESOpenGL ES</p>\n<p>OpenGL ES 2.03.0OpenGL ES 1.1</p>\n<p><code>GLubyte</code>r,g,b,aOpenGL ES10</p>\n<p><img src=\"/img/article/20190519/14.png\" alt=\"Conversion of attribute data to shader variables\"></p>\n<p>OpenGL ESOpenGL ESOpenGL ESOpenGL ES</p>\n<p>OpenGL ES</p>\n<ul>\n<li></li>\n<li>OpenGL ES</li>\n<li></li>\n<li></li>\n</ul>\n<h2 id=\"\"></h2>\n<p>iOSiOS</p>\n<p></p>\n<ul>\n<li></li>\n<li></li>\n<li>\n<ul>\n<li>OpenGL ES 2.0</li>\n<li>OpenGL ES 1.1DOT3<code>GL_DOT3_RGB</code></li>\n</ul>\n</li>\n</ul>\n<h2 id=\"\"></h2>\n<p>OpenGL ES 2.03.0OpenGL ES 1.1<code>glColor4ub</code><code>glTexCoord2f</code></p>\n<blockquote>\n<p></p>\n</blockquote>\n<h1 id=\"reference\">Reference</h1>\n<blockquote>\n<p><a href=\"https://developer.apple.com/library/archive/documentation/3DDrawing/Conceptual/OpenGLES_ProgrammingGuide/Introduction/Introduction.html#//apple_ref/doc/uid/TP40008793-CH1-SW1\" target=\"_blank\" rel=\"noopener\">About OpenGL ES</a></p>\n</blockquote>\n","site":{"data":{}},"excerpt":"","more":"<h1>Introduction</h1>\n<p>Open Graphics Library(OpenGL)2D3D2D3DOpenGL3D2DOpenGLOpenGL</p>\n<p>OpenGL for Embedded Systems(OpenGL ES)openGL</p>\n<p><img src=\"/img/article/20190519/1.png\" alt=\"OpenGL ES\"></p>\n<p>OpenGL ESiOSGPU2D3DGPUOpenGL ESOpenGL ES3D</p>\n<h1>Checklist for Building OpenGL ES Apps for iOS</h1>\n<p>OpenGL ESGPUAPIOpenGL ESOpenGL ESiOS<em>EAGLContext</em>iOSOpenGL ES<em>GLKView</em><em>CAEAGLLayer</em></p>\n<p>iOSOpenGL ESOpenGL ESiOS</p>\n<ol>\n<li>OpenGL ES</li>\n<li>OpenGL ES</li>\n<li>OpenGL ES</li>\n<li>iOS</li>\n<li></li>\n<li>XcodeInstrumentsOpenGL ES</li>\n</ol>\n<h2>OpenGL ES</h2>\n<p>OpenGL ES 3.0OpenGL ES 2.0OpenGL ES 1.1</p>\n<ul>\n<li>OpenGL ES 3.0iOS 7GPU</li>\n<li>OpenGL ES 2.0iOS</li>\n<li>OpenGL ES 1.1iOS</li>\n</ul>\n<p>iOS<a href=\"https://developer.apple.com/library/archive/documentation/DeviceInformation/Reference/iOSDeviceCompatibility/Introduction/Introduction.html#//apple_ref/doc/uid/TP40013599\" target=\"_blank\" rel=\"noopener\">iOS Device Compatibility Reference</a></p>\n<h2>OpenGL ES</h2>\n<p><a href=\"https://developer.apple.com/library/archive/documentation/DeviceInformation/Reference/iOSDeviceCompatibility/Introduction/Introduction.html#//apple_ref/doc/uid/TP40013599\" target=\"_blank\" rel=\"noopener\">iOS Device Compatibility Reference</a>iOSiOSOpenGL ES</p>\n<p><code>glGet</code><em>gl.h</em><em>MAX_TEXTURE_SIZE</em><em>MAX_VERTEX_ATTRIBS</em></p>\n<p><code>glGetIntegerv</code><code>glGetStringi</code>OpenGL ES 3.0</p>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/// #import &lt;OpenGLES/ES3/gl.h&gt;</span></span><br><span class=\"line\"><span class=\"built_in\">BOOL</span> CheckForExtensions(<span class=\"built_in\">NSString</span> *searchName) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> max = <span class=\"number\">0</span>;</span><br><span class=\"line\">    glGetIntegerv(GL_NUM_EXTENSIONS, &amp;max);</span><br><span class=\"line\">    <span class=\"built_in\">NSMutableSet</span> *extensions = [<span class=\"built_in\">NSMutableSet</span> set];</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; max; i++) &#123;</span><br><span class=\"line\">        [extensions addObject:@((<span class=\"keyword\">char</span> *)glGetStringi(GL_EXTENSIONS, i))];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> [extensions containsObject:searchName];</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">/// OpenGL ES 2.01.1glGetString(GL_EXTENSIONS)</span></span><br></pre></td></tr></table></figure>\n<h2></h2>\n<p>iOS</p>\n<ul>\n<li><em>GLKit</em>OpenGL ESviewOpenGL ESUIKit<a href=\"#drawing-with-opengl-es-and-glkit\">Drawing with OpenGL ES and GLKit</a></li>\n<li><em>CAEAGLLayer</em>OpenGL ESCore Animation</li>\n<li>OpenGL ESOpenGL ES</li>\n</ul>\n<p>Core Animation<a href=\"#drawing-to-other-rendering-destinations\">Drawing to Other Rendering Destinatons</a></p>\n<h2>iOS</h2>\n<p>iOSOpenGL ESOpenGL ES</p>\n<p>iOS</p>\n<p>iOS<a href=\"#multitasking,-high-resolution,-and-other-ios-features\">Multitasking, High Resolution, and Other iOS Features</a></p>\n<h2></h2>\n<p>OpenGL ESOpenGLOpenGL ES</p>\n<p>iOS<a href=\"#opengl-es-design-guidelines\">OpenGL ES Design Guidelines</a><a href=\"#concurrency-and-opengl-es\">Concurrency and OpenGL ES</a></p>\n<h2></h2>\n<p>XcodeInstrumentsOpenGL ES<a href=\"#debugging-and-profiling\">Debugging and Profiling</a></p>\n<h1>Configuring OpenGL ES Contexts</h1>\n<p>OpenGL ESOpenGL ES</p>\n<p>OpenGL ES<em>EAGLContext</em><em>EAGLContext</em>OpenGL ESCore Animation</p>\n<h2>OpenGL ES</h2>\n<p>iOSOpenGL ES</p>\n<p><code>setCurrentContext:</code></p>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[EAGLContext setCurrentContext:context];</span><br></pre></td></tr></table></figure>\n<p><em>EAGLContext</em><code>currentContext</code></p>\n<blockquote>\n<p><code>glFlush</code></p>\n</blockquote>\n<p>OpenGL ES<em>EAGLContext</em><code>setCurrentContext:</code><em>EAGLContext</em></p>\n<h2>OpenGL ES</h2>\n<p><em>EAGLContext</em>OpenGL ESOpenGL ES 1.12.03.0OpenGL ES 2.03.02.03.0OpenGL ES 3.03.0</p>\n<p><em>EAGLContext</em>OpenGL ESnil</p>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">EAGLContext* CreateBestEAGLContext() &#123;</span><br><span class=\"line\">    EAGLContext *context = [[EAGLContext alloc] initWithAPI:kEAGLRenderingAPIOpenGLES3];</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (context == <span class=\"literal\">nil</span>) &#123;</span><br><span class=\"line\">        context = [[EAGLContext alloc] initWithAPI:kEAGLRenderingAPIOpenGLES2];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> context;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2>EAGL Sharegroup</h2>\n<p>OpenGL ESOpenGL ES<em>EAGLSharegroup</em>OpenGL ES<em>ESGLSharegroup</em></p>\n<p>OpenGL ESOpenGL ES</p>\n<p>sharegroupsharegroup</p>\n<p><img src=\"/img/article/20190519/2.png\" alt=\"OpenGL ES Sharegroup\"></p>\n<p>sharegroup</p>\n<ul>\n<li></li>\n<li>OpenGL ES<em>GLKtextureLoader</em></li>\n</ul>\n<p>sharegroup<code>initAPI:</code>sharegroup<code>initAPI:sharegroup:</code>sharegroup</p>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">EAGLContext* firstContext = CreateBestEAGLContext();</span><br><span class=\"line\">EAGLContext* secondContext = [[EAGLContext alloc] initWithAPI:[firstContext API] sharegroup: [firstContext sharegroup]];</span><br></pre></td></tr></table></figure>\n<p>sharegroupOpenGL ES</p>\n<ul>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n<p>OpenGL ES</p>\n<ul>\n<li><code>glFlush</code></li>\n<li>OpenGL ES</li>\n<li><code>glFlush</code></li>\n<li></li>\n</ul>\n<blockquote>\n<p>OpenGL ESOpengGL ES</p>\n</blockquote>\n<h1>Drawing with OpenGL ES and GLKit</h1>\n<p>GLKitOpenGL ES<em>GLKView</em>OpenGL ES<em>GLKViewController</em>GLKitOpenGL ESUIKitOpenGL ESGLKitOpenGL ES 2.03.0</p>\n<h2>GLKitOpenGL ES</h2>\n<p><em>GLKView</em>OpenGL ESUIView<em>UIView</em><code>drawRect:</code>Quartz 2D<em>GLKView</em>OpenGL ES<em>GLKView</em>OpenGL ESCore Animation</p>\n<p>UIKitGLKitCore Animation<code>setNeedsDisplay</code></p>\n<p><img src=\"/img/article/20190519/3.png\" alt=\"Rending OpenGL ES content with a GLKit view\"></p>\n<h3>GLKit View</h3>\n<p>GLKView<em>EAGLContext</em></p>\n<ul>\n<li>*initWithFrame:context:*</li>\n<li><em>context</em></li>\n</ul>\n<p>GLKitOpenGL ES</p>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">- (<span class=\"keyword\">void</span>)viewDidLoad &#123;</span><br><span class=\"line\">    [<span class=\"keyword\">super</span> viewDidLoad];</span><br><span class=\"line\">    </span><br><span class=\"line\">    EAGLContext *context = CreateBestEAGLContext();</span><br><span class=\"line\">    GLKView *glkView = [[GLKView alloc] initWithFrame:<span class=\"keyword\">self</span>.view.bounds context:context];</span><br><span class=\"line\">    <span class=\"comment\">// Configure renderbuffers</span></span><br><span class=\"line\">    glkView.drawableColorFormat = GLKViewDrawableColorFormatSRGBA8888;</span><br><span class=\"line\">    glkView.drawableDepthFormat = GLKViewDrawableDepthFormat24;</span><br><span class=\"line\">    glkView.drawableStencilFormat = GLKViewDrawableStencilFormat8;</span><br><span class=\"line\">    <span class=\"comment\">// enable multisampling</span></span><br><span class=\"line\">    <span class=\"comment\">// multisampling3D</span></span><br><span class=\"line\">    glkView.drawableMultisample = GLKViewDrawableMultisample4X;</span><br><span class=\"line\">    [<span class=\"keyword\">self</span>.view addSubview:glkView];</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3>GLKit View</h3>\n<p>OpenGL ESOpenGL ESCore Animation<em>GLKView</em></p>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">- (<span class=\"keyword\">void</span>)drawRect:(<span class=\"built_in\">CGRect</span>)rect &#123;</span><br><span class=\"line\">    <span class=\"comment\">// clear the framebuffer</span></span><br><span class=\"line\">    glClearColor(<span class=\"number\">0.0</span>, <span class=\"number\">0.0</span>, <span class=\"number\">0.1</span>, <span class=\"number\">1.0</span>);</span><br><span class=\"line\">    glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);</span><br><span class=\"line\">    <span class=\"comment\">// Draw using previously configured texture, shader, uniforms, and vertex array</span></span><br><span class=\"line\">    glBindTexture(GL_TEXTURE_2D, _planetTexture);</span><br><span class=\"line\">    glUseProgram(_diffuseShading);</span><br><span class=\"line\">    glUniformMatrix4fv(_uniformModelViewProjectionMatrix, <span class=\"number\">1</span>, <span class=\"number\">0</span>, _modelViewProjectionMatrix.m);</span><br><span class=\"line\">    glBindVertexArray(_planetMesh);</span><br><span class=\"line\">    glDrawElements(GL_TRIANGLE_STRIP, <span class=\"number\">256</span>, GL_UNSIGNED_SHORT, <span class=\"literal\">NULL</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p><em>glClear</em>OpenGL ES</p>\n</blockquote>\n<p><em>GLKView</em>OpenGL ESOpenGL ES</p>\n<ul>\n<li>\n<ul>\n<li><em>EAGLContext</em></li>\n<li></li>\n<li></li>\n<li>OpenGL ES</li>\n</ul>\n</li>\n<li>\n<ul>\n<li>multisamplingmultisampling</li>\n<li></li>\n<li>Core Animation</li>\n</ul>\n</li>\n</ul>\n<h2></h2>\n<p>OpenGL ESOpenGL ES 2.03.0</p>\n<p>GLKitGLKViewGLKView<code>drawInRect:</code><em>GLKViewDelegate</em><code>glkView:drawInRect:</code></p>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">- (<span class=\"built_in\">BOOL</span>)application:(<span class=\"built_in\">UIApplication</span> *)application didFinishLaunchingWithOptions:(<span class=\"built_in\">NSDictionary</span> *)launchOptions &#123;</span><br><span class=\"line\">    <span class=\"comment\">// Create a context</span></span><br><span class=\"line\">    EAGLContext *context = [[EAGLContext alloc] initWithAPI:kEAGLRenderingAPIOpenGLES2];</span><br><span class=\"line\">    [EAGLContext setCurrentContext:context];</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">// Choose a rendering class based on device features</span></span><br><span class=\"line\">    GLint maxTextureSize;</span><br><span class=\"line\">    glGetIntegerv(GL_MAX_TEXTURE_SIZE, &amp;maxTextureSize);</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (maxTextureSize &gt; <span class=\"number\">2048</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">self</span>.renderer = [[MyBigTextureRenderer alloc] initWithContext:context];</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">self</span>.renderer = [[MyRenderer alloc] initWithContext:context];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    GLKView *view = (GLKView *)<span class=\"keyword\">self</span>.window.rootViewController.view;</span><br><span class=\"line\">    view.delegate = <span class=\"keyword\">self</span>.renderer;</span><br><span class=\"line\">    view.context = context;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"literal\">YES</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2>GLKitOpenGL ES</h2>\n<p><em>GLKView</em>OpenGL ES<em>GLKit</em><em>GLKView</em></p>\n<p><img src=\"/img/article/20190519/4.png\" alt=\"The animation loop\"></p>\n<h3></h3>\n<p><em>update</em>GLKViewController<code>glkViewControllerUpdate:</code><code>timeSinceLastUpdate</code></p>\n<p><code>display</code>GPUOpenGL ESOpenGL ES</p>\n<p><code>framesPerSecond</code><code>preferredFramesPerSecond</code></p>\n<blockquote>\n<p></p>\n</blockquote>\n<h3>GLKit</h3>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">@implementation</span> <span class=\"title\">PlanetViewController</span> // <span class=\"title\">subclass</span> <span class=\"title\">of</span> <span class=\"title\">GLKViewController</span></span></span><br><span class=\"line\"> </span><br><span class=\"line\">- (<span class=\"keyword\">void</span>)viewDidLoad &#123;</span><br><span class=\"line\">    [<span class=\"keyword\">super</span> viewDidLoad];</span><br><span class=\"line\"> </span><br><span class=\"line\">    <span class=\"comment\">// Create an OpenGL ES context and assign it to the view loaded from storyboard</span></span><br><span class=\"line\">    GLKView *view = (GLKView *)<span class=\"keyword\">self</span>.view;</span><br><span class=\"line\">    view.context = [[EAGLContext alloc] initWithAPI:kEAGLRenderingAPIOpenGLES2];</span><br><span class=\"line\"> </span><br><span class=\"line\">    <span class=\"comment\">// Set animation frame rate</span></span><br><span class=\"line\">    <span class=\"keyword\">self</span>.preferredFramesPerSecond = <span class=\"number\">60</span>;</span><br><span class=\"line\"> </span><br><span class=\"line\">    <span class=\"comment\">// Not shown: load shaders, textures and vertex arrays, set up projection matrix</span></span><br><span class=\"line\">    [<span class=\"keyword\">self</span> setupGL];</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"> </span><br><span class=\"line\">- (<span class=\"keyword\">void</span>)update &#123;</span><br><span class=\"line\">    _rotation += <span class=\"keyword\">self</span>.timeSinceLastUpdate * M_PI_2; <span class=\"comment\">// one quarter rotation per second</span></span><br><span class=\"line\"> </span><br><span class=\"line\">    <span class=\"comment\">// Set up transform matrices for the rotating planet</span></span><br><span class=\"line\">    GLKMatrix4 modelViewMatrix = GLKMatrix4MakeRotation(_rotation, <span class=\"number\">0.0</span>f, <span class=\"number\">1.0</span>f, <span class=\"number\">0.0</span>f);</span><br><span class=\"line\">    _normalMatrix = GLKMatrix3InvertAndTranspose(GLKMatrix4GetMatrix3(modelViewMatrix), <span class=\"literal\">NULL</span>);</span><br><span class=\"line\">    _modelViewProjectionMatrix = GLKMatrix4Multiply(_projectionMatrix, modelViewMatrix);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"> </span><br><span class=\"line\">- (<span class=\"keyword\">void</span>)glkView:(GLKView *)view drawInRect:(<span class=\"built_in\">CGRect</span>)rect &#123;</span><br><span class=\"line\">    <span class=\"comment\">// Clear the framebuffer</span></span><br><span class=\"line\">    glClearColor(<span class=\"number\">0.0</span>f, <span class=\"number\">0.0</span>f, <span class=\"number\">0.1</span>f, <span class=\"number\">1.0</span>f);</span><br><span class=\"line\">    glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);</span><br><span class=\"line\"> </span><br><span class=\"line\">    <span class=\"comment\">// Set shader uniforms to values calculated in -update</span></span><br><span class=\"line\">    glUseProgram(_diffuseShading);</span><br><span class=\"line\">    glUniformMatrix4fv(_uniformModelViewProjectionMatrix, <span class=\"number\">1</span>, <span class=\"number\">0</span>, _modelViewProjectionMatrix.m);</span><br><span class=\"line\">    glUniformMatrix3fv(_uniformNormalMatrix, <span class=\"number\">1</span>, <span class=\"number\">0</span>, _normalMatrix.m);</span><br><span class=\"line\"> </span><br><span class=\"line\">    <span class=\"comment\">// Draw using previously configured texture and vertex array</span></span><br><span class=\"line\">    glBindTexture(GL_TEXTURE_2D, _planetTexture);</span><br><span class=\"line\">    glBindVertexArrayOES(_planetMesh);</span><br><span class=\"line\">    glDrawElements(GL_TRIANGLE_STRIP, <span class=\"number\">256</span>, GL_UNSIGNED_SHORT, <span class=\"number\">0</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">@end</span></span><br></pre></td></tr></table></figure>\n<p><code>viewDidLoad</code>OpenGL ES<code>update</code><code>glkView:drawInRect:</code></p>\n<h1>Drawing to Other Rendering Destinations</h1>\n<p>OpenGL ESOpenGL ES</p>\n<p><img src=\"/img/article/20190519/5.png\" alt=\"Famebuffer with color and depth renderbuffers\"></p>\n<p>OpenGL ES</p>\n<h2></h2>\n<p></p>\n<ul>\n<li><a href=\"#%E5%88%9B%E5%BB%BA%E7%A6%BB%E5%B1%8F%E7%BC%93%E5%86%B2%E5%8C%BA%E5%AF%B9%E8%B1%A1\"></a></li>\n<li><a href=\"#%E4%BD%BF%E7%94%A8%E5%B8%A7%E7%BC%93%E5%86%B2%E5%8C%BA%E5%AF%B9%E8%B1%A1%E6%B8%B2%E6%9F%93%E7%BA%B9%E7%90%86\"></a></li>\n<li>Core AnimationCore Animation-aware<a href=\"#%E6%B8%B2%E6%9F%93%E5%88%B0Core-Animation%E5%B1%82%E7%BA%A7\">Core Animation</a></li>\n</ul>\n<h3></h3>\n<p>OpenGL ES</p>\n<ol>\n<li></li>\n</ol>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">GLuint framebuffer;</span><br><span class=\"line\">glGenFramebuffers(<span class=\"number\">1</span>, &amp;framebuffer);</span><br><span class=\"line\">glBindFramebuffer(GL_FRAMEBUFFER, framebuffer);</span><br></pre></td></tr></table></figure>\n<ol start=\"2\">\n<li></li>\n</ol>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">GLuint colorRenderbuffer;</span><br><span class=\"line\">glGenRenderbuffers(<span class=\"number\">1</span>, &amp;colorRenderbuffer);</span><br><span class=\"line\">glBindRenderbuffer(GL_RENDERBUFFER, colorRenderbuffer);</span><br><span class=\"line\">glRenderbufferStorage(GL_RENDERBUFFER, GL_RGBA, width, height);</span><br><span class=\"line\">glFramebufferRenderbuffer(GL_FRAMEBUFFER, GL_COLOR_ATTACHMENT0, GL_RENDERBUFFER, colorRenderbuffer);</span><br></pre></td></tr></table></figure>\n<ol start=\"3\">\n<li>/</li>\n</ol>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">GLuint depthRenderbuffer;</span><br><span class=\"line\">glGenRenderbuffers(<span class=\"number\">1</span>, &amp;depthRenderbuffer);</span><br><span class=\"line\">glBindRenderbuffer(GL_RENDERBUFFER, depthRenderbuffer);</span><br><span class=\"line\">glRenderbufferStorage(GL_RENDERBUFFER, GL_DEPTH_COMPONENT16, width, height);</span><br><span class=\"line\">glFramebufferRenderbuffer(GL_FRAMEBUFFER, GL_DEPTH_ATTACHMENT, GL_RENDERBUFFER, depthRenderbuffer);</span><br></pre></td></tr></table></figure>\n<ol start=\"4\">\n<li></li>\n</ol>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">GLenum status = glCheckFramebufferStatus(GL_FRAMEBUFFER);</span><br><span class=\"line\"><span class=\"keyword\">if</span> (status != GL_FRAMEBUFFER_COMPLETE) &#123;</span><br><span class=\"line\">    <span class=\"built_in\">NSLog</span>(<span class=\"string\">@\"failed to make complete framebuffer object %x\"</span>, status);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><code>glReadPixels</code>CPU</p>\n<h3></h3>\n<p></p>\n<ol>\n<li></li>\n<li></li>\n</ol>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">GLuint texture;</span><br><span class=\"line\">glGenTextures(<span class=\"number\">1</span>, &amp;texture);</span><br><span class=\"line\">glBindTexture(GL_TEXTURE_2D, texture);</span><br><span class=\"line\">glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_LINEAR);   <span class=\"comment\">// </span></span><br><span class=\"line\">glTexImage2D(GL_TEXTURE_2D, <span class=\"number\">0</span>, GL_RGBA8, width, height, <span class=\"number\">0</span>, GL_RGBA, GL_UNSIGNED_BYTE, <span class=\"literal\">NULL</span>);</span><br><span class=\"line\">glFramebufferTexture2D(GL_FRAMEBUFFER, GL_COLOR_ATTACHMENT0, GL_TEXTURE_2D, texture, <span class=\"number\">0</span>);</span><br></pre></td></tr></table></figure>\n<ol start=\"3\">\n<li></li>\n<li></li>\n</ol>\n<p><em>OES_depth_texture</em></p>\n<h3>Core Animation</h3>\n<p>Core AnimationiOSiOSUIKitQuartz 2DOpenGL ESOpenGL ES<em>CAEAGLLayer</em>Core AnimationCore AnimationOpenGL ESCore Animation</p>\n<p><img src=\"/img/article/20190519/6.png\" alt=\"Core Animation shares the renderbuffer width OpenGL ES\"></p>\n<p><em>CAEAGLLayer</em>OpenGL ESCore AnimationCore Animation</p>\n<blockquote>\n<p>GLKViewOpenGL ES</p>\n</blockquote>\n<p>Core AnimationOpenGL ES</p>\n<ol>\n<li><em>CAEAGLLayer</em><em>opaue</em>YES<em>CAEAGLLayer</em><code>drawableProperties</code>Core Animation<a href=\"https://developer.apple.com/documentation/opengles/eagldrawable?language=objc\" target=\"_blank\" rel=\"noopener\">EAGLDrawable Protocol Reference</a></li>\n<li>OpenGL ES</li>\n<li></li>\n<li><code>renderbufferStorage:fromDrawable:</code></li>\n</ol>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">GLuint colorRenderbuffer;</span><br><span class=\"line\">glGenRenderbuffers(<span class=\"number\">1</span>, &amp;colorRenderbuffer);</span><br><span class=\"line\">glBindRenderbuffer(GL_RENDERBUFFER, colorRenderbuffer);</span><br><span class=\"line\">[myContext renderbufferStorage:GL_RENDERBUFFER fromDrawable:myEAGLLayer];</span><br><span class=\"line\">glFramebufferRenderbuffer(GL_FRAMEBUFFER, GL_COLOR_ATTACHMENT0, GL_RENDERBUFFER, colorRenderbuffer);</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>Core Animation<code>bounds</code></p>\n</blockquote>\n<ol start=\"5\">\n<li></li>\n</ol>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">GLuint width, height;</span><br><span class=\"line\">glGetRenderbufferParameteriv(GL_RENDERBUFFER, GL_RENDERBUFFER_WIDTH, &amp;width);</span><br><span class=\"line\">glGetRenderbufferParameteriv(GL_RENDERBUFFER, GL_RENDERBUFFER_HEIGHT, &amp;height);</span><br></pre></td></tr></table></figure>\n<p>OpenGL ES</p>\n<ol start=\"6\">\n<li></li>\n<li></li>\n<li><em>CAEAGLLayer</em><code>addSublayer:</code>Core Animation</li>\n</ol>\n<h2></h2>\n<p></p>\n<h3></h3>\n<p>Core AnimationOpenGL ESGLKit</p>\n<p>on-demand</p>\n<p><code>CADisplayLink</code><code>displayLink</code>Core Animation<code>displayLink</code></p>\n<blockquote>\n<p><em>GLKViewController</em><code>CADisplayLink</code><code>GLKView</code><em>GLKit</em><code>CADisplayLink</code></p>\n</blockquote>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">CADisplayLink *displayLink = [self.view.window.screen displayLinkWithTarget:self selector:@selector(drawFrame)];</span><br><span class=\"line\">[displayLink addToRunLoop:[NSRunLoop currentRunLoop] forMode:NSDefaultRunLoopMode];</span><br></pre></td></tr></table></figure>\n<p><code>drawFrame</code><code>displayLink</code><code>timestamp</code></p>\n<p><code>displayLink</code>60Hz60<code>displayLink</code><code>frameInterval</code>3320</p>\n<blockquote>\n<p></p>\n</blockquote>\n<h3></h3>\n<p>OpenGL ES</p>\n<p><img src=\"/img/article/20190519/7.png\" alt=\"iOS OpenGL Rendering Steps\"></p>\n<h4></h4>\n<p><code>glClear</code></p>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">glBindFramebuffer(GL_FRAMEBUFFER, framebuffer);</span><br><span class=\"line\">glClear(GL_DEPTH_BUFFER_BIT | GL_COLOR_BUFFER_BIT);</span><br></pre></td></tr></table></figure>\n<p><code>glClear</code>OpenGL ES</p>\n<h4></h4>\n<p>OpenGL ESGPUGPU</p>\n<p><a href=\"#opengl-es-design-guidelines\">OpenGL ES Design Guidelines</a>OpenGL ES</p>\n<h4></h4>\n<p><a href=\"#opengl-es-design-guidelines\">OpenGL ES Design Guidelines</a>OpenGL ES</p>\n<h4></h4>\n<p><a href=\"#%E4%BD%BF%E7%94%A8%E5%A4%9A%E9%87%8D%E9%87%87%E6%A0%B7%E6%8F%90%E9%AB%98%E5%9B%BE%E7%89%87%E8%B4%A8%E9%87%8F\"></a></p>\n<h4></h4>\n<p>OpenGL ESOpenGL ES</p>\n<p></p>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> GLenum discards = &#123;GL_DEPTH_ATTACHMENT&#125;;</span><br><span class=\"line\">glBindFramebuffer(GL_FRAMEBUFFER, framebuffer);</span><br><span class=\"line\">glDiscardFramebufferEXT(GL_FRAMEBUFFER, <span class=\"number\">1</span>, discards)</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p><code>glDiscardFramebufferEXT</code>OpengGL ES1.02.0<code>EXT_discard_framebuffer</code>OpenGL ES 3.0<code>glInvalidateFramebuffer</code></p>\n</blockquote>\n<h4>Core Animation</h4>\n<p>renderbufferCore Animation</p>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">glBindRenderbuffer(GL_RENDERBUFFER, colorRenderbuffer);</span><br><span class=\"line\">[context presentRenderbuffer: GL_RENDERBUFFER];</span><br></pre></td></tr></table></figure>\n<p></p>\n<p><code>CAEAGLLayer</code><code>drawableProperties</code><code>kEAGLDrawablePropertyRetainedBacking</code><code>YES</code><code>glClear</code><code>GL_COLOR_BUFFER_BIT</code>iOS</p>\n<h2></h2>\n<p>3DOpenGL ES 3.0OpenGL ES 1.02.0<code>APPLE_framebuffer_multisample</code></p>\n<p></p>\n<p><img src=\"/img/article/20190519/8.png\" alt=\"How multisampling\"></p>\n<p><code>glRenderbufferStorageMultisampleAPPLE</code></p>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">GLuint sampleFramebuffer;</span><br><span class=\"line\">glGenFramebuffers(<span class=\"number\">1</span>, &amp;sampleFramebuffer);</span><br><span class=\"line\">glBindFramebuffer(GL_FRAMEBUFFER, sampleFramebuffer);</span><br><span class=\"line\"></span><br><span class=\"line\">GLuint sampleColorRenderbuffer;</span><br><span class=\"line\">glGenRenderbuffers(<span class=\"number\">1</span>, &amp;sampleColorRenderbuffer);</span><br><span class=\"line\">glBindRenderbuffer(GL_RENDERBUFFER, sampleColorRenderbuffer);</span><br><span class=\"line\">glRenderbufferStorageMultisample(GL_RENDERBUFFER, <span class=\"number\">4</span>, GL_RGBA8_OES, width, height);</span><br><span class=\"line\">glFramebufferRenderbuffer(GL_FRAMEBUFFER, GL_COLOR_ATTACHMENT0, GL_RENDERBUFFER, sampleColorRenderbuffer);</span><br><span class=\"line\"></span><br><span class=\"line\">GLuint sampleDepthRenderbuffer;</span><br><span class=\"line\">glGenRenderbuffers(<span class=\"number\">1</span>, &amp;sampleDepthRenderbuffer);</span><br><span class=\"line\">glBindRenderbuffer(GL_RENDERBUFFER, sampleDepthRenderbuffer);</span><br><span class=\"line\">glRenderbufferStorageMultisample(GL_RENDERBUFFER, <span class=\"number\">4</span>, GL_DEPTH_COMPONENT16, width, height);</span><br><span class=\"line\">glFramebufferRenderbuffer(GL_FRAMEBUFFER, GL_DEPTH_ATTACHMENT, GL_RENDERBUFFER, sampleDepthRenderbuffer);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> (glCheckFramebufferStatus(GL_FRAMEBUFFER) != GL_FRAMEBUFFER_COMPLETE) &#123;</span><br><span class=\"line\">    <span class=\"built_in\">NSLog</span>(<span class=\"string\">@\"Failed to make complete framebuffer object %x\"</span>, glCheckFramebufferStatus(GL_FRAMEBUFFER));</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p></p>\n<ol>\n<li></li>\n</ol>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">glBindFramebuffer(GL_FRAMEBUFFER, sampleFramebuffer);</span><br><span class=\"line\">glViewport(0, 0, framebufferWidth, framebufferHeight);  // </span><br><span class=\"line\">glClear(GL_COLOR_BUFFER_BIT, GL_DEPTH_BUFFER_BIT);</span><br></pre></td></tr></table></figure>\n<ol start=\"2\">\n<li></li>\n</ol>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">glBindFramebuffer(GL_DRAW_FRAMEBUFFER_APPLE, resolveFramebuffer);</span><br><span class=\"line\">glBindFramebuffer(GL_READ_FRAMEBUFFER_APPLE, smapleFramebuffer);</span><br><span class=\"line\">glResolveMultisampleFramebufferAPPLE();</span><br></pre></td></tr></table></figure>\n<ol start=\"3\">\n<li></li>\n</ol>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> GLenum discards[] = &#123;GL_COLOR_ATTACHMENT0, GL_DEPTH_ATTACHMENT&#125;;</span><br><span class=\"line\">glDiscardFramebufferEXT(GL_READ_FRAMEBUFFER_APPLE, <span class=\"number\">2</span>, discards);</span><br></pre></td></tr></table></figure>\n<ol start=\"4\">\n<li></li>\n</ol>\n<figure class=\"highlight objectivec\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">glBindRenderBuffer(GL_RENDERBUFFER, colorRenderbuffer);</span><br><span class=\"line\">[context presentRenderbuffer: GL_RENDERBUFFER];</span><br></pre></td></tr></table></figure>\n<p></p>\n<blockquote>\n<p>OpenGL ES 1.02.0OpenGL ES 3.0API</p>\n</blockquote>\n<h1>Multitasking, High Resolution, and Other iOS Features</h1>\n<p>OpenGL ESiOSiOSOpenGL ESiOSOpenGL ES</p>\n<h2>OpenGL ES</h2>\n<p><a href=\"https://developer.apple.com/library/archive/documentation/iPhone/Conceptual/iPhoneOSProgrammingGuide/BackgroundExecution/BackgroundExecution.html#//apple_ref/doc/uid/TP40007072-CH4\" target=\"_blank\" rel=\"noopener\">App States and Multitasking</a></p>\n<p>OpenGL ESOpenGL ES</p>\n<h3></h3>\n<p>OpenGL ESOpenGL ESiOSOpenGL ESGPU</p>\n<p>GLKitOpenGL ES<code>GLKViewController</code></p>\n<p>GLKitGLKViewOpenGL ES</p>\n<ol>\n<li><code>applicationWillResignActive:</code><code>glFinish</code></li>\n<li><code>applicationDidEnterBackground:</code>OpenGL ES<code>glFinish</code></li>\n<li><code>applicationDidEnterBackground:</code>OpenGL ES</li>\n<li><code>applicationWillEnterForeground:</code></li>\n</ol>\n<p><code>glFinish</code>OpenGL ESOpenGL ES</p>\n<h3></h3>\n<p>OpenGL ES</p>\n<ul>\n<li></li>\n<li>OpenGL ESOpenGL ES</li>\n</ul>\n<p></p>\n<p></p>\n<ul>\n<li></li>\n<li></li>\n</ul>\n<p>OpenGL ES</p>\n<p>GLKit<code>GLKViewController</code></p>\n<h2></h2>\n<p>GLKit<code>contentScaleFactor</code> UIKit<a href=\"https://developer.apple.com/library/archive/documentation/2DDrawing/Conceptual/DrawingPrintingiOS/SupportingHiResScreensInViews/SupportingHiResScreensInViews.html#//apple_ref/doc/uid/TP40010156-CH15\" target=\"_blank\" rel=\"noopener\">Supporting High-Resolution Screens In Views</a></p>\n<p>Core AnimationOpenGL ES1.0Retina<code>CAEAGLayer</code></p>\n<p></p>\n<blockquote>\n<p>OpenGL ES API1.0<code>glScissor</code><code>glBlitFramebuffer</code><code>glLineWidth</code><code>glPointSize</code><code>gl_PointSize</code></p>\n</blockquote>\n<p>RetinaGPU</p>\n<ul>\n<li><a href=\"tuning-your-openGL-es-app\">Tuning Your OpenGL ES App</a></li>\n<li></li>\n<li>1.01.51.02.0</li>\n<li>GLKView<code>drawableColorFormat</code><code>drawableDepthFormat</code></li>\n<li>GLKView<code>drawableMultisample</code>GLKit<a href=\"#%E4%BD%BF%E7%94%A8%E5%A4%9A%E9%87%8D%E9%87%87%E6%A0%B7%E6%8F%90%E9%AB%98%E5%9B%BE%E7%89%87%E8%B4%A8%E9%87%8F\"></a></li>\n</ul>\n<h2></h2>\n<p>OpenGL ESOpenGL ES<code>supportedInterfaceOrientations</code></p>\n<p><code>GLKViewController</code><code>GLKView</code><code>GLKView</code><code>GLKViewController</code><code>viewWillLayoutSubviews</code><code>viewDidLayoutSubviews</code><code>GLKView</code><code>layoutSubviews</code></p>\n<p>Core AnimationOpenGL ES</p>\n<h2>OpenGL ES</h2>\n<p>iOS</p>\n<p></p>\n<ol>\n<li><a href=\"https://developer.apple.com/library/archive/documentation/WindowsViews/Conceptual/WindowAndScreenGuide/Introduction/Introduction.html#//apple_ref/doc/uid/TP40012555\" target=\"_blank\" rel=\"noopener\">Multiple Display Programming Guide for iOS</a></li>\n<li>\n<ul>\n<li>GLKit<code>GLKViewController</code><code>GLKView</code><code>rootViewController</code></li>\n<li>Core Animation<code>screen</code><code>dispalyLinkWithTarget:slector:</code></li>\n</ul>\n</li>\n</ol>\n<h1>OpenGL ES Design Guidelines</h1>\n<p>iOSOpenGL ES</p>\n<h2>OpenGL ES</h2>\n<p>OpenGL ES-</p>\n<h3>OpenGL ES-</h3>\n<p>OpenGL ESGPU</p>\n<p><img src=\"/img/article/20190519/9.png\" alt=\"OpenGL ES client-server architecture\"></p>\n<p>OpenGL ESOpenGL ES</p>\n<h3>OpenGL ES</h3>\n<p></p>\n<p><img src=\"/img/article/20190519/10.png\" alt=\"OpenGL ES graphics pipline\"></p>\n<p>OpenGL ES</p>\n<p></p>\n<blockquote>\n<p></p>\n</blockquote>\n<h2>OpenGL ES</h2>\n<p>iOS3OpenGL ES</p>\n<h3>OpenGL ES 3.0</h3>\n<p>OpenGL ES 3.0iOS 7OpenGL ES 3.0<a href=\"http://www.khronos.org/registry/OpenGL/index_es.php\" target=\"_blank\" rel=\"noopener\">OpenGL ES API Registry</a><br>\n<a href=\"https://developer.apple.com/library/archive/documentation/3DDrawing/Conceptual/OpenGLES_ProgrammingGuide/OpenGLESApplicationDesign/OpenGLESApplicationDesign.html#//apple_ref/doc/uid/TP40008793-CH6-SW13\" target=\"_blank\" rel=\"noopener\">OpenGL ES 3.0</a></p>\n<h3>OpenGL ES 2.0</h3>\n<h3>OpenGL ES 1.0</h3>\n<h2>OpenGL ES</h2>\n<p>OpenGL ES</p>\n<ul>\n<li>OpenGL ES</li>\n<li></li>\n</ul>\n<p>OpenGL ES</p>\n<p><img src=\"/img/article/20190519/11.png\" alt=\"App model for managing resources\"></p>\n<p>OpenGL ESOpenGLESOpenGL ES</p>\n<p>OpenGL ESOpenGL ESCPUGPUOpenGL ESiOSOpenGL ES</p>\n<p>OpenGL ESGPUCPU</p>\n<p></p>\n<p>OpenGL ES</p>\n<p></p>\n<ul>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n<p></p>\n<h3>Flush</h3>\n<p>OpenGL ESOpenGL ESOpenGL ES</p>\n<p>OpenGL ES</p>\n<ul>\n<li><code>glFlush</code></li>\n<li><code>glFinish</code></li>\n<li><code>glReadPixels</code></li>\n<li></li>\n</ul>\n<h4>glFlush</h4>\n<p>OpenGL<code>glFlush</code>CPUGPUiOSiOSOpenGL ES<code>glFlush</code><code>glFinish</code></p>\n<ul>\n<li>OpenGL ESiOS</li>\n<li>OpenGL ES<code>glFlush</code><code>glFlush</code>iOS APIsCore ImageOpenGL ES</li>\n</ul>\n<h4>OpenGL ES</h4>\n<p><code>glGet*()</code><code>glGetError()</code>OpenGL ESCPUOpenGL ES</p>\n<p>OpenGL ESXcodeOpenGL ES<code>glGetError</code><code>glCheckFramebufferStatus()</code><code>glGetProgramInfoLog()</code><code>glValidateProgram()</code></p>\n<h3>OpenGL ES</h3>\n<p>OpenGLOpenGL ESOpenGL ESOpenGL ESOpenGL ES</p>\n<h3></h3>\n<p>OpenGL ESOpenGL ESOpenGL ESOpenGL ESCPUGPU</p>\n<p><img src=\"/img/article/20190519/12.png\" alt=\"Single-buffered texture data\"></p>\n<p>GPUCPUCPUGPUOpenGL ES</p>\n<p><img src=\"/img/article/20190519/13.png\" alt=\"Double-buffered texture data\"></p>\n<p>-</p>\n<p>iOS</p>\n<h3>OpenGL ES</h3>\n<p>OpenGL ES<code>glEnable</code><code>glDisable</code></p>\n<p><code>glUniform</code>OpenGL ES</p>\n<p></p>\n<h4>OpenGL ES</h4>\n<p>OpenGL ES<a href=\"%E4%BD%BF%E7%94%A8%E9%A1%B6%E7%82%B9%E6%95%B0%E7%BB%84%E5%AF%B9%E8%B1%A1%E5%90%88%E5%B9%B6%E9%A1%B6%E7%82%B9%E6%95%B0%E7%BB%84%E7%8A%B6%E6%80%81%E6%9B%B4%E6%94%B9\"></a></p>\n<h4></h4>\n<p>OpenGL ESOpenGL ESCPUOpenGL ES</p>\n<p>OpenGL ESiOS</p>\n<ul>\n<li></li>\n<li></li>\n<li>OpenGL ES</li>\n</ul>\n<h1>Best Practices for Working with Vertex Data</h1>\n<p>OpenGL ESOpenGL ES</p>\n<p>OpenGL ES 2.03.0OpenGL ES 1.1</p>\n<p><code>GLubyte</code>r,g,b,aOpenGL ES10</p>\n<p><img src=\"/img/article/20190519/14.png\" alt=\"Conversion of attribute data to shader variables\"></p>\n<p>OpenGL ESOpenGL ESOpenGL ESOpenGL ES</p>\n<p>OpenGL ES</p>\n<ul>\n<li></li>\n<li>OpenGL ES</li>\n<li></li>\n<li></li>\n</ul>\n<h2></h2>\n<p>iOSiOS</p>\n<p></p>\n<ul>\n<li></li>\n<li></li>\n<li>\n<ul>\n<li>OpenGL ES 2.0</li>\n<li>OpenGL ES 1.1DOT3<code>GL_DOT3_RGB</code></li>\n</ul>\n</li>\n</ul>\n<h2></h2>\n<p>OpenGL ES 2.03.0OpenGL ES 1.1<code>glColor4ub</code><code>glTexCoord2f</code></p>\n<blockquote>\n<p></p>\n</blockquote>\n<h1>Reference</h1>\n<blockquote>\n<p><a href=\"https://developer.apple.com/library/archive/documentation/3DDrawing/Conceptual/OpenGLES_ProgrammingGuide/Introduction/Introduction.html#//apple_ref/doc/uid/TP40008793-CH1-SW1\" target=\"_blank\" rel=\"noopener\">About OpenGL ES</a></p>\n</blockquote>\n"},{"title":"OpenGL ES--","catalog":true,"toc_nav_num":true,"date":"2019-08-10T08:38:20.000Z","subtitle":"About OpenGL ES","header-img":"/img/article_header/article_header.png","busuanzi":true,"_content":"\n> OpenGL ES 3.0\n\n# \n\n3DOpenGL ES 3.02D2D3D\n\n\n## 2D\n\n2DOpenGL ESTexeltexture pixelsOpenGL ES\n\n | \n- | -\nGL_RED | ()\nGL_RG | ()\nGL_RGB | ()\nGL_RGBA | (Alpha)\nGL_LUMINANCE | ()\nGL_LUMINANCE_ALPHA | (Alpha)\nGL_ALPHA | (Alpha)\nGL_DEPTH_COMPONENT | ()\nGL_DEPTH_STENCIL | ()\nGL_RED_INTEGER | ()\nGL_RG_INTEGER | ()\nGL_RGB_INTEGER | ()\nGL_RGBA_INTERGER | (Alpha)\n\n2D3D2D2D(s, t)(u, v)\n\n![2D](/img/article/20190810/1.png)\n\n`st`(0.0, 0.0)`st`(1.0, 1.0)[0.0, 1.0]\n\n## \n\n2DOpenGL ES 3.062D3D6(+X, -X, +Y, -Y, +Z, -Z)\n3D(s, t, r)(s, t, r)3D(x, y, z)3D2D(s, t)3D\n\n![3D](/img/article/20190810/2.png)\n\n2D3D2D\n\n## 3D\n\nOpenGL ES 3.03D3D2D3(s, t, r)3Dr3D(s, t)2D3D2D3Dmip\n\n![3D](/img/article/20190810/3.png)\n\n## 2D\n\nOpenGL ES 3.02D2D3D2D2D2D3D3D2Dmip2Dmip2Dmip3D3Dmip\n\n2D3D(s, t, r)r2D(s, t)2D\n\n## \n\nOpenGL ES`glGenTextures`\n\n``` objc\n/**\n \n\n @param n#>  description#>\n @param textures#> nID description#>\n @return void\n */\nglGenTextures(GLsizei n, GLuint *textures);\n```\n\n`glGenTextures``glDeleteTextures`\n\n``` objc\n/**\n \n\n @param n#>  description#>\n @param textures#> nID description#>\n @return void\n */\nglDeleteTextures(GLsizei n, const GLuint *textures);\n```\n\n`glGenTextures`ID(`glTexImage2D``glTexParameter`)`glBindTexture`\n\n``` objc\n/**\n \n\n @param target#> GL_TEXTURE_2DGL_TEXTURE_3DGL_TEXTURE_2D_ARRAYGL_TEXTURE_CUBE_MAP description#>\n @param texture#>  description#>\n @return void\n */\nglBindTexture(GLenum target, GLuint texture);\n```\n\n2D`glTexImage2D`OpenGL ES 3.02D(`glTexStorage2D`)`glTexSubImage2D`--`glTexImage2D`--\n\n``` objc\n/**\n 2D\n\n @param target#> GL_TEXTURE_2DGL_TEXTURE_CUBE_MAP_POSITIVE_(X, Y, Z)GL_TEXTURE_CUBE_MAP_NEGATIVE_(X, Y, Z) description#>\n @param level#> mip0mip description#>\n @param internalformat#> GL_RGBAGL_RGBGL_LUMINANCE_ALPHAGL_LUMINANCEGL_ALPHAGL_RGBGL_DEPTH_COMPONENT16 description#>\n @param width#>  description#>\n @param height#>  description#>\n @param border#> OpenGL ESOpenGL0 description#>\n @param format#> GL_RED(_INTEGER)GL_RG(_INTEGER)GL_RGB(_INTERGER)GL_RGBA(_INTEGER)GL_DEPTH_COMPONENTGL_DEPTH_STENCILGL_LUMINANCE_ALPHAGL_ALPHA description#>\n @param type#>  description#>\n @param pixels#> width*height*`glPixelStorei`GL_UNPACK_ALIGHMENT description#>\n @return void\n */\nglTexImage2D(GLenum target, GLint level, GLint internalformat, GLsizei width, GLsizei height, GLint border, GLenum format, GLenum type, const GLvoid *pixels);\n```\n\nRGB 2x2 2D\n\n``` objc\nGLuint textureId;\nGLubyte pixels[] = {\n    255, 0, 0,\n    0, 255, 0,\n    0, 0, 255,\n    255, 255, 0\n};\n\n// User tightly packed data\nglPixelStorei(GL_UNPACK_ALIGNMENT, 1);\n\n// Generate a texture object\nglGenTextures(1, &textureId);\n\n// Bind the texture object\nglBindTexture(GL_TEXTURE_2D, textureId);\n\n// Load the texture\nglTexImage2D(GL_TEXTURE_2D, 0, GL_RGB, 2, 2, 0, GL_RGB, GL_UNSIGNED_BYTE, pixels);\n\n// Set the filtering mode\nglTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_NEAREST);\nglTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_NEAREST);\n```\n\n`pixels`2x2RGB[0, 255]8[0, 255][0.0, 1.0]\n`glTexImage2D``glPixelStorei``glTexImage2D``GL_UNPACK_ALIGNMENT`44\n1\n\n``` objc\n/**\n \n\n @param pname#> glTexImage2DglTexImage3DglTexSubImage2DglTexSubImage3DGL_UNPACK_ROW_LENGTHGL_UNPACK_IMAGE_HEIGHTGL_UNPACK_SKIP_PIXELSGL_UNPACK_SKIP_ROWSGL_UNPACK_SKIP_IMAGESGL_UNPACK_ALIGNMENTglReadPixelsGL_PACK_ROW_LENGTHGL_PACK_IMAGE_HEIGHTGL_PACK_SKIP_PIXELSGL_PACK_SKIP_ROWSGL_PACK_SKIP_IMAGESGL_PACK_ALIGNMENT description#>\n @param param#>  description#>\n @return void\n */\nglPixelStorei(GLenum pname, GLint param);\n```\n\n`glPixelStorei``GL_PACK_xxxx``glReadPixels``glPixelStorei``GL_UNPACK_ALIGNMENT`\n\n |  | \n- | - | -\nGL_UNPACK_ALIGNMENT GL_PACK_ALIGNMENT | 4 | 41\nGL_UNPACK_ROW_LENGTH GL_PACK_ROW_LENGTH | 0 | 00\nGL_UNPACK_IMAGE_HEIGHT GL_PACK_IMAGE_HEIGHT | 0 | 03D3D0\nGL_UNPACK_SKIP_PIXELS GL_PACK_SKIP_PIXELS | 0 | 0\nGL_UNPACK_SKIP_ROWS GL_PACK_SKIP_ROWS | 0 | 0\nGL_UNPACK_SKIP_IMAGES GL_PACK_SKIP_IMAGES | 0 | 03D\n\n`glTexParameteri``GL_NEAREST`mipmip`GL_LINEAR`mip\n\n## mip\n\n2D2DOpenGL ES2D`GL_NEAREST`\nOpenGL ESmipmipmappingmip--mipmip1x1mipmip4\n[GenMipMap2D](https://github.com/danginsburg/opengles3-book/blob/master/Chapter_9/MipMap2D/MipMap2D.c)mipRGB8mipmip`glTexImage2D`\nmipmipmip\n\n``` objc\nglTexImage2D(GL_TEXTURE_2D, 0, GL_RGB, width, height, 0, GL_RGB, GL_UNSIGNED_BYTE, pixels);\nint level = 1;\nGLubyte *prevImage = &pixels[0];\nGLubyte *newImage;\nwhile (width > 1 && height > 1) {\n    int newWidth, newHeight;\n    \n    // Generate the next mipmap level\n    GenMipMap2D(prevImage, &newImage, width, height, &newWidth, &newHeight);\n    \n    // Load the mipmap level\n    glTexImage2D(GL_TEXTURE_2D, level, GL_RGB, newWidth, newHeight, 0, GL_RGB, GL_UNSIGNED_BYTE, newImage);\n    \n    // Free the previous image\n    free(prevImage);\n    \n    // Set the previous image for the next iteration\n    prevImage = newImage;\n    level += 1;\n    \n    // Half the width and height\n    width = newWidth;\n    height = newHeight;\n}\nfree(newImage);\n```\n\nAPImip\n`glTexParameter[i|f][v]`\n\n``` objc\nglTexParameteri(GLenum target, GLenum pname, GLint param)\nglTexParameteriv(GLenum target, GLenum pname, const GLint *params);\nglTexParameterf(GLenum target, GLenum pname, GLfloat param);\nglTexParameterfv(GLenum target, GLenum pname, const GLfloat *params);\n```\n\n`pname``GL_TEXTURE_MAG_FILTER``param``GL_NEAREST``GL_LINEAR``GL_NEAREST``GL_LINEAR`4\n`pname``GL_TEXTURE_MIN_FILTER``param`\n- `GL_NEAREST` -- \n- `GL_LINEAR` -- \n- `GL_NEAREST_MIPMAP_NEAREST` -- mip\n- `GL_NEAREST_MIPMAP_LINEAR` -- mip\n- `GL_LINEAR_MIPMAP_NEAREST` -- mip\n- `GL_LINEAR_MIPMAP_LINEAR` -- mip\n\n> `GL_NEAREST``GL_LINEAR`mipmip\n\nmipmip\n\n### \n\nOpenGL ES 3.0OpenGL ES 2.0OpenGL ES 3.0--OpenGL ES 3.0\n\n## mip\n\nmipOpenGL ES 3.0`glGenerateMipmap`mip\n\n``` objc\n/**\n mip\n\n @param target#> mipGL_TEXTURE_2DGL_TEXTURE_3DGL_TEXTURE_2D_ARRAYGL_TEXTURE_CUBE_MAP description#>\n @return void\n */\nglGenerateMipmap(GLenum target);\n\n```\n\n`glGenerateMipmap`0mip2D0002D2D3Dmip\nOpenGL ES 3.0mipmip\nmipCPUmip`glGenerateMipmap`CPUmip\n\n## \n\n[0.0, 1.0]`glTexParameter[i|f][v]`str`GL_TEXTURE_WRAP_S`s[0.0, 1.0]`GL_TEXTURE_WRAP_T`t`GL_TEXTURE_WRAP_R`rr3D2DOpenGL ES\n\n | \n- | -\nGL_REPEAT | \nGL_CLAMP_TO_EDGE | \nGL_MIRRORED_REPEAT | \n\n`GL_CLAMP_TO_DEGE`\n\n## \n\nSwizzleRRGRGBRGBA`GL_RED`(0, 0, 0, R)(R, R, R, 1)(R, 0, 0, 1)RGBA`glTexParameter[i|f][v]``GL_TEXTURE_SWIZZLE_R``GL_TEXTURE_SWIZZLE_G``GL_TEXTURE_SWIZZLE_B``GL_TEXTURE_SWIZZLE_A`RGBA`GL_RED``GL_GREEN``GL_BLUE``GL_ALPHA``GL_ZERO``GL_ONE`01\n\n## \n\nmipGPSmipOpenGL ES 3.0`glTexParameter[i|f][v]``GL_TEXTURE_BASE_LEVEL`mip0mip`GL_TEXTURE_MAX_LEVEL`mip1000mip\nmipOpenGL ESLODmipmip`GL_TEXTURE_MIN_LOD``GL_TEXTURE_MAX_LOD`LODmipLODmipmipLOD\n\n## \n\n`GL_TEXTURE_COMPARE_FUNC``GL_TEXTURE_COMPARE_MODE`PCFPCF01\n`GL_TEXTURE_COMPARE_MODE``GL_NONE``GL_COMPARE_REF_TO_TEXTURE`(s, t, r)r91`GL_TEXTURE_COMPARE_FUNC``GL_LEQUAL``GL_GEQUAL``GL_LESS``GL_GREATER``GL_EQUAL``GL_NOTEQUAL``GL_ALWAYS``GL_NEVER`\n\n## \n\nOpenGL ES 3.0OpenGL ES 2.0\n2D`glTexImage2D`OpenGL ESOpenGL ES\n\n`glTexImage2D`\n\n |  |  | \n- | - | - | -\nGL_RGB | GL_RGB | GL_UNSIGNED_BYTE | 8/8/8 RGB 24- \nGL_RGB | GL_RGB | GL_UNSIGNED_SHORT_5_6_5 | 5/6/5 RGB 16- \nGL_RGBA | GL_RGBA | GL_UNSIGNED_BYTE | 8/8/8/8 RGBA 32- \nGL_RGBA | GL_RGBA | GL_UNSIGNED_SHORT_4_4_4_4 | 4/4/4/4 RGBA 16- \nGL_RGBA | GL_RGBA | GL_UNSIGNED_SHORT_5_5_5_1 | 5/5/5/1 RGBA 16- \nGL_LUMINANCE_ALPHA | GL_LUMINANCE_ALPHA | GL_UNSIGNED_BYTE | 8/8 LA 16- \nGL_LUMINANCE | GL_LUMINANCE | GL_UNSIGNED_BYTE | 8L 8- \nGL_ALPHA | GL_ALPHA | GL_UNSIGNED_BYTE | 8A 8- \n\n\n\n### \n\n[0.0, 1.0]*_SNORM[-1.0, 1.0]`GL_UNSIGNED_BYTE``GL_R8`8([0, 255])[0.0, 1.0]`GL_BYTE``GL_R8_SNORM`8[-128, 127][-1.0, 1.0]\n\n![glTexImage2D](/img/article/20190810/4.png)\n\n### \n\nOpenGL ES 3.01632RRGRGBRGBA1~4OpenGL ES 3.016\n\n![glTexImage2D](/img/article/20190810/5.png)\n\n### \n\n\nRRGRGBAcolor attachmentAlpha\n\n![glTexImage2D](/img/article/20190810/6.png)\n![glTexImage2D](/img/article/20190810/7.png)\n\n### \n\nRGBHDROpenGL ES 3.0`GL_RGB9_E5`3RGB5515RGB9\n\n![](/img/article/20190810/8.png)\n\n### sRGB\n\nOpenGL ES 3.0sRGBsRGBsRGB\nsRGBsRGBsRGBsRGBsRGB\nsRGBsRGBsRGBsRGBsRGB`pow(value, 2.0)`sRGB->`(value, 1/2.2)`->sRGBsRGBsRGB\n\n |  |  |  | R | F\n- | - | - | - | - | -\nGL_SRGB8 | GL_RGB | GL_UNSIGNED_BYTE | 8/8/8 SRGB | | X\nGL_SRGB8_ALPHA8 | GL_RGBA | GL_UNSIGNED_BYTE | 8/8/8/8 RGBA | X | X\n\n### \n\nOpenGL ES 3.0OpenGL ES 3.0\n\n |  | \n- | - | -\nGL_DEPTH_COMPONENT16 | GL_DEPTH_COMPONENT | GL_UNSIGNED_SHORT\nGL_DEPTH_COMPONENT16 | GL_DEPTH_COMPONENT | GL_UNSIGNED_INTp\nGL_DEPTH_COMPONENT24 | GL_DEPTH_COMPONENT | GL_UNSIGNED_INT\nGL_DEPTH_COMPONENT43F | GL_DEPTH_COMPONENT | GL_FLOAT\nGL_DEPTH24_STENCIL8 | GL_DEPTH_STENCIL | GL_UNSIGNED_INT_24_8\nGL_DEPTH32F_STENCIL8 | GL_DEPTH_STENCIL | GL_FLOAT_32_UNSIGNED_INT_24_8_REV\n\n## \n\n2D\n\n``` objc\n// Vertex shader\n# version 300 es\nlayout(location = 0) in vec4 a_position;\nlayout(location = 1) in vec2 a_texCoord;\nout vec2 v_texCoord;\nvoid main()\n{\n    gl_Position = a_position;\n    v_texCoord = a_texCoord;\n}\n```\n\n``` objc\n// Fragment shader\n# version 300 es\nprecision mediump float;\nin vec2 v_texCoord;\nlayout(location = 0) out vec4 outColor;\nuniform sampler2D s_texture;\nvoid main()\n{\n    outColor = texture(s_texture, v_texCoord);\n}\n```\n\n`sampler2D``s_texture`0`GL_TEXTURE0`1`GL_TEXTURE1`OpenGL ES 3.0 API`glActiveTexture`\n\n``` objc\n/**\n \n\n @param texture#> GL_TEXTURE0, 1, 2 description#>\n @return void\n */\nglActiveTexture(GLenum texture);\n```\n\n`glActiveTexture``glBindTexture`OpenGL ES`GL_MAX_TEXTURE_IMAGE_UNITS``glGetintegerv``GL_MAX_VERTEX_TEXTURE_IMAGE_UNITS``glGetintegerv`\n\n`glBindTexture``glUniformli``texture``texture`\n\n``` objc\n/**\n 2D\n\n @param sampler#>  description#>\n @param coord#> 2D description#>\n @param bias#> mipmipLOD description#>\n @return vec4 \n */\ntexture(sampler2D sampler, vec2 coord[, float bias]);\n```\n\n`texture``vec4``vec4`[](/article/2019/opengl-es-texture-0810/#)\n\n | \n- | -\nGL_RED | (R, 0.0 0.0, 1.0)\nGL_RG | (R, G, 0.0, 1.0)\nGL_RGB | (R, G, B, 1.0)\nGL_RGBA | (R, G, B, A)\nGL_LUMINANCE | (L, L, L, 1.0)\nGL_LUMINANCE_ALPHA | (L, L, L, A)\nGL_ALPHA | (0.0, 0.0, 0.0, A)\n\n\n\n``` objc\n- (void)setupVertices {\n    \n    GLfloat vertices[] = {\n        -1.0, -1.0, 0,\n        0, 0,\n        -1.0, 1.0, 0,\n        0, 1,\n        1.0, -1.0, 0,\n        1, 0,\n        1.0, 1.0, 0,\n        1, 1\n    };\n    \n    // \n    GLuint texture = [self createTextureWithImage:[UIImage imageNamed:@\"9\"]];\n    \n    GLuint program = [self createProgram];\n    glUseProgram(program);\n    glViewport(0, 0, [self getViewportWidth], [self getViewportHeight]);\n    \n    glClear(GL_COLOR_BUFFER_BIT);\n    glClearColor(0.0, 0.0, 0.0, 1.0);\n    \n    // \n    glActiveTexture(GL_TEXTURE0);\n    int textureLocation = glGetUniformLocation(program, \"s_texture\");\n    glBindTexture(GL_TEXTURE_2D, texture);\n    glUniform1i(textureLocation, 0);\n    \n    GLuint vbo;\n    glGenBuffers(1, &vbo);\n    glBindBuffer(GL_ARRAY_BUFFER, vbo);\n    glBufferData(GL_ARRAY_BUFFER, sizeof(vertices), vertices, GL_STATIC_DRAW);\n    \n    glEnableVertexAttribArray(0);\n    glVertexAttribPointer(0, 3, GL_FLOAT, GL_FALSE, sizeof(GLfloat)*5, 0);\n    glEnableVertexAttribArray(1);\n    glVertexAttribPointer(1, 2, GL_FLOAT, GL_FALSE, sizeof(GLfloat)*5, (GLvoid *)(sizeof(GLfloat)*3));\n    \n    glDrawArrays(GL_TRIANGLE_STRIP, 0, 4);\n    \n    [self.context presentRenderbuffer:GL_RENDERBUFFER];\n}\n\n\n- (GLuint)createTextureWithImage:(UIImage *)image {\n    //  UIImage  CGImageRef\n    CGImageRef cgImageRef = [image CGImage];\n    GLuint width = (GLuint)CGImageGetWidth(cgImageRef);\n    GLuint height = (GLuint)CGImageGetHeight(cgImageRef);\n    CGRect rect = CGRectMake(0, 0, width, height);\n    \n    // \n    CGColorSpaceRef colorSpace = CGColorSpaceCreateDeviceRGB();\n    //  xx4RGBA\n    void *imageData = malloc(width * height * 4);\n    /**\n     \n\n     @param data#>  description#>\n     @param width#>  description#>\n     @param height#>  description#>\n     @param bitsPerComponent#> 32RGBA8 description#>\n     @param bytesPerRow#> bit description#>\n     @param space#>  description#>\n     @param bitmapInfo#> bitmap description#>\n     @return \n     */\n    CGContextRef context = CGBitmapContextCreate(imageData, width, height, 8, width * 4, colorSpace, kCGImageAlphaPremultipliedLast | kCGBitmapByteOrder32Big);\n    // -\n    CGContextTranslateCTM(context, 0, height);\n    CGContextScaleCTM(context, 1.0f, -1.0f);\n    CGColorSpaceRelease(colorSpace);\n    CGContextClearRect(context, rect);\n    CGContextDrawImage(context, rect, cgImageRef);\n    \n    // \n    GLuint textureID;\n    glGenTextures(1, &textureID);\n    glBindTexture(GL_TEXTURE_2D, textureID);\n    glTexImage2D(GL_TEXTURE_2D, 0, GL_RGBA, width, height, 0, GL_RGBA, GL_UNSIGNED_BYTE, imageData); // \n    \n    // \n    glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_WRAP_S, GL_CLAMP_TO_EDGE);\n    glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_WRAP_T, GL_CLAMP_TO_EDGE);\n    glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_LINEAR);\n    glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_LINEAR);\n    \n    // \n    glBindTexture(GL_TEXTURE_2D, 0);\n    \n    // \n    CGContextRelease(context);\n    free(imageData);\n    \n    return textureID;\n}\n```\n\n## \n\n2D`GL_TEXTURE_CUBE_MAP_POSITIVE_(X|Y|Z)``GL_TEXTURE_CUBE_NEGATIVE_(X|Y|Z)``glTexImage2D`\n\n``` objc\n// Vertex shader\n#version 300 es\nlayout(location = 0) in vec4 a_position;\nlayout(location = 1) in vec3 a_normal;\nout vec3 v_normal;\nvoid mian()\n{\n    gl_Position = a_position;\n    v_normal = a_normal;\n}\n```\n\n``` objc\n// Fragment shader\n#version 300 es\nprecision mediump float;\nin vec3 v_normal;\nlayout(location = 0) out vec4 outColor;\nuniform samplerCube s_texture;\nvoid main()\n{\n    outColor = texture(s_texture, v_normal);\n}\n```\n\n`texture``texture`\n\n``` objc\n/**\n \n\n @param sampler#>  description#>\n @param coord#> 3D description#>\n @param bias#> mipmipLOD description#>\n @return vec4 \n */\ntexture(samplerCube sampler, vec3 coord[, float bias]);\n```\n\n2D32`sampleCube`2D\n\n## 3D2D\n\n2DOpenGL ES 3.03D2D3D2D`glTexImage3D``glTexImage2D`\n\n``` objc\n/**\n 3D2D\n\n @param target#> GL_TEXTURE_3DGL_TEXTURE_2D_ARRAY description#>\n @param level#> mip0mip description#>\n @param internalformat#>  description#>\n @param width#>  description#>\n @param height#>  description#>\n @param depth#> 3D description#>\n @param border#> OpenGL ES0 description#>\n @param format#>  description#>\n @param type#>  description#>\n @param pixels#> width*height*depth2D description#>\n @return void\n */\nglTexImage3D(GLenum target, GLint level, GLint internalformat, GLsizei width, GLsizei height, GLsizei depth, GLint border, GLenum format, GLenum type, const GLvoid *pixels);\n\n```\n\n`glTexImage3D`3D2D`texture`\n\n``` objc\n/**\n 3D\n\n @param sampler#>  description#>\n @param coord#> 3D description#>\n @param bias#> mipmipLOD description#>\n @return vec4 \n */\ntexture(sampler3D sampler, vec3 coord[, float bias]);\n\n/**\n 2D\n\n @param sampler#>  description#>\n @param coord#> 3D description#>\n @param bias#> mipmipLOD description#>\n @return vec4 \n */\ntexture(sampler2DArray sampler, vec3 coord[, float bias]);\n```\n\n> r3D\n\n# \n\nOpenGL ES 3.0\nOpenGL ES 2.0OpenGL ES 2.0OpenGL ES 2.0\nOpenGL ES 3.0Ericsson Texture CompressionETC2EACKhronosOpenGL ES 3.0EAC12ETC2342D`glCompressedTexImage2D`2D`glCompressedTexImage3D`\n\n> ETC2/EAC3D2D2D`glCompressedTexImage3D`3D\n\n``` objc\n/**\n 2D\n\n @param target#> GL_TEXTURE_2DGL_TEXTURE_CUBE_MAP_* description#>\n @param level#> mip description#>\n @param internalformat#>  description#>\n @param width#>  description#>\n @param height#>  description#>\n @param border#> OpenGL ES0 description#>\n @param imageSize#>  description#>\n @param data#> imageSize description#>\n @return void\n */\nglCompressedTexImage2D(GLenum target, GLint level, GLenum internalformat, GLsizei width, GLsizei height, GLint border, GLsizei imageSize, const GLvoid *data);\n\n/**\n 2D\n\n @param target#> GL_TEXTURE_2DGL_TEXTURE_CUBE_MAP_* description#>\n @param level#> mip description#>\n @param internalformat#> OpenGL ES 3.0 description#>\n @param width#>  description#>\n @param height#>  description#>\n @param border#> OpenGL ES0 description#>\n @param imageSize#>  description#>\n @param data#> imageSize description#>\n @return void\n */\nglCompressedTexImage3D(GLenum target, GLint level, GLenum internalformat, GLsizei width, GLsizei height, GLint border, GLsizei imageSize, const GLvoid *data);\n\n/**\n 2D3D\n\n @param target#> GL_TEXTURE_3DGL_TEXTURE_2D_ARRAY description#>\n @param level#> mip description#>\n @param internalformat#> OpenGL ES 3.0 description#>\n @param width#>  description#>\n @param height#>  description#>\n @param depth#> 2D description#>\n @param border#> OpenGL ES0 description#>\n @param imageSize#>  description#>\n @param data#> imageSize description#>\n @return void\n */\nglCompressedTexImage3D(GLenum target, GLint level, GLenum internalformat, GLsizei width, GLsizei height, GLsizei depth, GLint border, GLsizei imageSize, const GLvoid *data);\n```\n\nOpenGL ES 3.0ETCETC4x4ETCETCbpp`sizeInBytes = max(width, 4) * max(height, 4) * bpp / 8`\n\n | | \n- | - | -\nGL_COMPRESSED_R11_EAC | 4 | GL_RED\nGL_COMPRESSED_SIGNED_R11_EAC | 4 | GL_RED\nGL_COMPRESSED_RG11_EAC | 8 | GL_RG\nGL_COMPRESSED_SIGNED_RG11_EAC | 8 | GL_RG\nGL_COMPRESSED_RGB8_ETC2 | 4 | GL_RGB\nGL_COMPRESSED_SRGB8_ETC2 | 4 | sRGBGL_RGB\nGL_COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2 | 4 | GL_RGBA1alpha\nGL_COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2 | 4 | sRGBGL_RGBA1alpha\nGL_COMPRESSED_RGBA8_ETC2_EAC | 8 | GL_RGBA\nGL_COMPRESSED_SRGBA8_ETC2_EAC | 8 | sRGBGL_RGBA\n\n\n\nOpenGL ES 3.0OpenGL ES 3.0`GL_INVALID_ENUM`OpenGL ES 3.0\n`glGetIntegerv``GL_NUM_COMPRESSED_TEXTURE_FORMATS``glGetIntegerv``GL_COMPRESSED_TEXTURE_FORMATS``GLenum``GLenum`\n\n# \n\n`glTexImage2D`\n\n``` objc\n/**\n 2D\n\n @param target#> GL_TEXTURE_2DGL_TEXTURE_CUBE_MAP_* description#>\n @param level#> mip description#>\n @param xoffset#> x description#>\n @param yoffset#> y description#>\n @param width#>  description#>\n @param height#>  description#>\n @param format#>  description#>\n @param type#>  description#>\n @param pixels#>  description#>\n @return void\n */\nglTexSubImage2D(GLenum target, GLint level, GLint xoffset, GLint yoffset, GLsizei width, GLsizei height, GLenum format, GLenum type, const GLvoid *pixels);\n```\n\n(xoffset, yoffset)(xoffset+width-1, yoffset+height-1)`pixels``glPixelStorei``GL_UNPACK_ALIGNMENT`\n\n2D\n\n``` objc\n/**\n 2D\n\n @param target#> GL_TEXTURE_2DGL_TEXTURE_CUBE_MAP_* description#>\n @param level#> mip description#>\n @param xoffset#> x description#>\n @param yoffset#> y description#>\n @param width#>  description#>\n @param height#>  description#>\n @param format#>  description#>\n @param imageSize#>  description#>\n @param data#>  description#>\n @return void\n */\nglCompressedTexSubImage2D(GLenum target, GLint level, GLint xoffset, GLint yoffset, GLsizei width, GLsizei height, GLenum format, GLsizei imageSize, const GLvoid *data);\n```\n\n2D`glTexSubImage3D`3D2D\n\n``` objc\n/**\n 3D\n\n @param target#> GL_TEXTURE_3DGL_TEXTURE_2D_ARRAY description#>\n @param level#> mip description#>\n @param xoffset#> x description#>\n @param yoffset#> y description#>\n @param zoffset#> z description#>\n @param width#>  description#>\n @param height#>  description#>\n @param depth#>  description#>\n @param format#>  description#>\n @param type#>  description#>\n @param pixels#>  description#>\n @return void\n */\nglTexSubImage3D(GLenum target, GLint level, GLint xoffset, GLint yoffset, GLint zoffset, GLsizei width, GLsizei height, GLsizei depth, GLenum format, GLenum type, const GLvoid *pixels);\n```\n\n`glTexSubImage3D``glTexSubImage2D``zoffset``depth`2D`glCompressedTexSubImage3D`3D3DETC2/EAC2D2D\n\n``` objc\n/**\n 3D\n\n @param target#> GL_TEXTURE_3DGL_TEXTURE_2D_ARRAY description#>\n @param level#> mip description#>\n @param xoffset#> x description#>\n @param yoffset#> y description#>\n @param zoffset#> z description#>\n @param width#>  description#>\n @param height#>  description#>\n @param depth#>  description#>\n @param format#>  description#>\n @param imageSize#>  description#>\n @param data#>  description#>\n @return void\n */\nglCompressedTexSubImage3D(GLenum target, GLint level, GLint xoffset, GLint yoffset, GLint zoffset, GLsizei width, GLsizei height, GLsizei depth, GLenum format, GLsizei imageSize, const GLvoid *data);\n```\n\n# \n\nOpenGL ES 3.0-\n\n`glReadBuffer`EGL`glReadBuffer``GL_BACK`--OpenGL ES 3.0EGLOpenGL ES 3.0`eglSwapBuffers`EGLEGL pbufferpbuffer`GL_COLOR_ATTACHMENTi``glReadBuffer`\n\n``` objc\n/**\n \n\n @param mode#> glReadPixelsglCopyTexImage2DglCopyTexSubImage2DglCopyTexSubImage3DGL_BACKGL_COLOR_ATTACHMENTiGL_NONE description#>\n @return void\n */\nglReadBuffer(GLenum mode);\n```\n\n`glCopyTexImage2D``glCopyTexSubImage2D``glCopyTexSubImage3D`\n\n``` objc\n/**\n 2D\n\n @param target#> GL_TEXTURE_CUBE_MAP_2DGL_TEXTURE_CUBE_MAP_* description#>\n @param level#> mip description#>\n @param internalformat#>  description#>\n @param x#> x description#>\n @param y#> y description#>\n @param width#>  description#>\n @param height#>  description#>\n @param border#> OpenGL ES 3.00 description#>\n @return void\n */\nglCopyTexImage2D(GLenum target, GLint level, GLenum internalformat, GLint x, GLint y, GLsizei width, GLsizei height, GLint border);\n```\n\n(x, y)(x+width-1, y+height-1)\n`glCopyTexSubImage2D`\n\n``` objc\n/**\n 2D\n\n @param target#> GL_TEXTURE_2DGL_TEXTURE_CUBE_MAP_* description#>\n @param level#> mip description#>\n @param xoffset#> x description#>\n @param yoffset#> y description#>\n @param x#> x description#>\n @param y#> y description#>\n @param width#>  description#>\n @param height#>  description#>\n @return void\n */\nglCopyTexSubImage2D(GLenum target, GLint level, GLint xoffset, GLint yoffset, GLint x, GLint y, GLsizei width, GLsizei height);\n```\n\n(x, y)(x+width-1, y+height-1)(xoffset, yoffset)(xoffset+width-1, yoffset+height-1)\n`glCopyTexSubImage3D`3D2D\n\n``` objc\n/**\n 3D2D\n\n @param target#> GL_TEXTURE_3DGL_TEXTURE_2D_ARRAY description#>\n @param level#> mip description#>\n @param xoffset#> x description#>\n @param yoffset#> y description#>\n @param zoffset#> z description#>\n @param x#> x description#>\n @param y#> y description#>\n @param width#>  description#>\n @param height#>  description#>\n @return void\n */\nglCopyTexSubImage3D(GLenum target, GLint level, GLint xoffset, GLint yoffset, GLint zoffset, GLint x, GLint y, GLsizei width, GLsizei height);\n```\n\n\n\n# \n\n`glTexParameter[i|f][v]`LOD`glTexParameter[i|f][v]`API`glTexParameter[i|f][v]`OpenGL ES 3.0`glTexParameter[i|f][v]`API\n\n\n\n``` objc\n/**\n \n\n @param count#>  description#>\n @param samplers#> nID description#>\n @return void\n */\nglGenSamplers(GLsizei count, GLuint *samplers);\n```\n\n\n\n``` objc\n/**\n \n\n @param count#>  description#>\n @param samplers#> nID description#>\n @return void\n */\nglDeleteSamplers(GLsizei count, const GLuint *samplers);\n```\n\nID`glTexParameter[i|f][v]`\n\n``` objc\n/**\n \n\n @param unit#>  description#>\n @param sampler#>  description#>\n @return void\n */\nglBindSampler(GLuint unit, GLuint sampler);\n```\n\n`glBindSampler``sampler`0`glSampler[f|i][v]``glSamplerParameter[f|i][v]``glTexParameter[i|f][v]`\n\n``` objc\nglSamplerParameteri(GLuint sampler, GLenum pname, GLint param);\nglSamplerParameteriv(GLuint sampler, GLenum pname, const GLint *param);\nglSamplerParameterf(GLuint sampler, GLenum pname, GLfloat param);\nglSamplerParameterfv(GLuint sampler, GLenum pname, const GLfloat *param);\n```\n\n# \n\nOpenGL ES 3.0`glTexImage2D``glTexImage3D`mipOpenGL ESmip\n\nOpenGL ES`glTexSubImage2D``glTexSubImage3D``glGenerateMipMap`\n`glBindTexture``glTexStorage2D``glTexStorage3D`\n\n``` objc\n/**\n \n\n @param target#> GL_TEXTURE_2DGL_TEXTURE_CUBE_MAP_*GL_TEXTURE_3DGL_TEXTURE_2D_ARRAY description#>\n @param levels#> mip description#>\n @param internalformat#>  description#>\n @param width#>  description#>\n @param height#>  description#>\n @return void\n */\nglTexStorage2D/3D(GLenum target, GLsizei levels, GLenum internalformat, GLsizei width, GLsizei height);\n```\n\n`glTexImage*``glCompressedTexImage*``glCopyTexImage*``glTexStorage*``GL_INVALID_OPERATION``glTexSubImage2D``glTexSubImage3D``glGenerateMipMap`\n`glTexStorage*`OpenGL ES`GL_TEXTURE_IMMUTABLE_FORMAT``GL_TRUE``GL_TEXTURE_IMMUTABLE_LEVELS``glTexStorage*``glGetTexParameter[i|f][v]``glTexStorage*`\n\n# \n\nGPUCPUGPUOpenGL ES 3.0`GL_PIXEL_UNPACK_BUFFER``glTexImage*``glTexSubImage*``glCompressedTexImage*``glCompressedTexSubImage*``glVertexAttribPointer`VBO\nGPUOpenGL`glTexSubImage*`GPU/\n\n# \n\nOpenGL ES 3.0","source":"_posts/2019/opengl-es-texture-0810.md","raw":"---\ntitle: \"OpenGL ES--\"\ncatalog: true\ntoc_nav_num: true\ndate: 2019-08-10 16:38:20\nsubtitle: \"About OpenGL ES\"\nheader-img: \"/img/article_header/article_header.png\"\nbusuanzi: true\ntags:\n- iOS\n\n---\n\n> OpenGL ES 3.0\n\n# \n\n3DOpenGL ES 3.02D2D3D\n\n\n## 2D\n\n2DOpenGL ESTexeltexture pixelsOpenGL ES\n\n | \n- | -\nGL_RED | ()\nGL_RG | ()\nGL_RGB | ()\nGL_RGBA | (Alpha)\nGL_LUMINANCE | ()\nGL_LUMINANCE_ALPHA | (Alpha)\nGL_ALPHA | (Alpha)\nGL_DEPTH_COMPONENT | ()\nGL_DEPTH_STENCIL | ()\nGL_RED_INTEGER | ()\nGL_RG_INTEGER | ()\nGL_RGB_INTEGER | ()\nGL_RGBA_INTERGER | (Alpha)\n\n2D3D2D2D(s, t)(u, v)\n\n![2D](/img/article/20190810/1.png)\n\n`st`(0.0, 0.0)`st`(1.0, 1.0)[0.0, 1.0]\n\n## \n\n2DOpenGL ES 3.062D3D6(+X, -X, +Y, -Y, +Z, -Z)\n3D(s, t, r)(s, t, r)3D(x, y, z)3D2D(s, t)3D\n\n![3D](/img/article/20190810/2.png)\n\n2D3D2D\n\n## 3D\n\nOpenGL ES 3.03D3D2D3(s, t, r)3Dr3D(s, t)2D3D2D3Dmip\n\n![3D](/img/article/20190810/3.png)\n\n## 2D\n\nOpenGL ES 3.02D2D3D2D2D2D3D3D2Dmip2Dmip2Dmip3D3Dmip\n\n2D3D(s, t, r)r2D(s, t)2D\n\n## \n\nOpenGL ES`glGenTextures`\n\n``` objc\n/**\n \n\n @param n#>  description#>\n @param textures#> nID description#>\n @return void\n */\nglGenTextures(GLsizei n, GLuint *textures);\n```\n\n`glGenTextures``glDeleteTextures`\n\n``` objc\n/**\n \n\n @param n#>  description#>\n @param textures#> nID description#>\n @return void\n */\nglDeleteTextures(GLsizei n, const GLuint *textures);\n```\n\n`glGenTextures`ID(`glTexImage2D``glTexParameter`)`glBindTexture`\n\n``` objc\n/**\n \n\n @param target#> GL_TEXTURE_2DGL_TEXTURE_3DGL_TEXTURE_2D_ARRAYGL_TEXTURE_CUBE_MAP description#>\n @param texture#>  description#>\n @return void\n */\nglBindTexture(GLenum target, GLuint texture);\n```\n\n2D`glTexImage2D`OpenGL ES 3.02D(`glTexStorage2D`)`glTexSubImage2D`--`glTexImage2D`--\n\n``` objc\n/**\n 2D\n\n @param target#> GL_TEXTURE_2DGL_TEXTURE_CUBE_MAP_POSITIVE_(X, Y, Z)GL_TEXTURE_CUBE_MAP_NEGATIVE_(X, Y, Z) description#>\n @param level#> mip0mip description#>\n @param internalformat#> GL_RGBAGL_RGBGL_LUMINANCE_ALPHAGL_LUMINANCEGL_ALPHAGL_RGBGL_DEPTH_COMPONENT16 description#>\n @param width#>  description#>\n @param height#>  description#>\n @param border#> OpenGL ESOpenGL0 description#>\n @param format#> GL_RED(_INTEGER)GL_RG(_INTEGER)GL_RGB(_INTERGER)GL_RGBA(_INTEGER)GL_DEPTH_COMPONENTGL_DEPTH_STENCILGL_LUMINANCE_ALPHAGL_ALPHA description#>\n @param type#>  description#>\n @param pixels#> width*height*`glPixelStorei`GL_UNPACK_ALIGHMENT description#>\n @return void\n */\nglTexImage2D(GLenum target, GLint level, GLint internalformat, GLsizei width, GLsizei height, GLint border, GLenum format, GLenum type, const GLvoid *pixels);\n```\n\nRGB 2x2 2D\n\n``` objc\nGLuint textureId;\nGLubyte pixels[] = {\n    255, 0, 0,\n    0, 255, 0,\n    0, 0, 255,\n    255, 255, 0\n};\n\n// User tightly packed data\nglPixelStorei(GL_UNPACK_ALIGNMENT, 1);\n\n// Generate a texture object\nglGenTextures(1, &textureId);\n\n// Bind the texture object\nglBindTexture(GL_TEXTURE_2D, textureId);\n\n// Load the texture\nglTexImage2D(GL_TEXTURE_2D, 0, GL_RGB, 2, 2, 0, GL_RGB, GL_UNSIGNED_BYTE, pixels);\n\n// Set the filtering mode\nglTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_NEAREST);\nglTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_NEAREST);\n```\n\n`pixels`2x2RGB[0, 255]8[0, 255][0.0, 1.0]\n`glTexImage2D``glPixelStorei``glTexImage2D``GL_UNPACK_ALIGNMENT`44\n1\n\n``` objc\n/**\n \n\n @param pname#> glTexImage2DglTexImage3DglTexSubImage2DglTexSubImage3DGL_UNPACK_ROW_LENGTHGL_UNPACK_IMAGE_HEIGHTGL_UNPACK_SKIP_PIXELSGL_UNPACK_SKIP_ROWSGL_UNPACK_SKIP_IMAGESGL_UNPACK_ALIGNMENTglReadPixelsGL_PACK_ROW_LENGTHGL_PACK_IMAGE_HEIGHTGL_PACK_SKIP_PIXELSGL_PACK_SKIP_ROWSGL_PACK_SKIP_IMAGESGL_PACK_ALIGNMENT description#>\n @param param#>  description#>\n @return void\n */\nglPixelStorei(GLenum pname, GLint param);\n```\n\n`glPixelStorei``GL_PACK_xxxx``glReadPixels``glPixelStorei``GL_UNPACK_ALIGNMENT`\n\n |  | \n- | - | -\nGL_UNPACK_ALIGNMENT GL_PACK_ALIGNMENT | 4 | 41\nGL_UNPACK_ROW_LENGTH GL_PACK_ROW_LENGTH | 0 | 00\nGL_UNPACK_IMAGE_HEIGHT GL_PACK_IMAGE_HEIGHT | 0 | 03D3D0\nGL_UNPACK_SKIP_PIXELS GL_PACK_SKIP_PIXELS | 0 | 0\nGL_UNPACK_SKIP_ROWS GL_PACK_SKIP_ROWS | 0 | 0\nGL_UNPACK_SKIP_IMAGES GL_PACK_SKIP_IMAGES | 0 | 03D\n\n`glTexParameteri``GL_NEAREST`mipmip`GL_LINEAR`mip\n\n## mip\n\n2D2DOpenGL ES2D`GL_NEAREST`\nOpenGL ESmipmipmappingmip--mipmip1x1mipmip4\n[GenMipMap2D](https://github.com/danginsburg/opengles3-book/blob/master/Chapter_9/MipMap2D/MipMap2D.c)mipRGB8mipmip`glTexImage2D`\nmipmipmip\n\n``` objc\nglTexImage2D(GL_TEXTURE_2D, 0, GL_RGB, width, height, 0, GL_RGB, GL_UNSIGNED_BYTE, pixels);\nint level = 1;\nGLubyte *prevImage = &pixels[0];\nGLubyte *newImage;\nwhile (width > 1 && height > 1) {\n    int newWidth, newHeight;\n    \n    // Generate the next mipmap level\n    GenMipMap2D(prevImage, &newImage, width, height, &newWidth, &newHeight);\n    \n    // Load the mipmap level\n    glTexImage2D(GL_TEXTURE_2D, level, GL_RGB, newWidth, newHeight, 0, GL_RGB, GL_UNSIGNED_BYTE, newImage);\n    \n    // Free the previous image\n    free(prevImage);\n    \n    // Set the previous image for the next iteration\n    prevImage = newImage;\n    level += 1;\n    \n    // Half the width and height\n    width = newWidth;\n    height = newHeight;\n}\nfree(newImage);\n```\n\nAPImip\n`glTexParameter[i|f][v]`\n\n``` objc\nglTexParameteri(GLenum target, GLenum pname, GLint param)\nglTexParameteriv(GLenum target, GLenum pname, const GLint *params);\nglTexParameterf(GLenum target, GLenum pname, GLfloat param);\nglTexParameterfv(GLenum target, GLenum pname, const GLfloat *params);\n```\n\n`pname``GL_TEXTURE_MAG_FILTER``param``GL_NEAREST``GL_LINEAR``GL_NEAREST``GL_LINEAR`4\n`pname``GL_TEXTURE_MIN_FILTER``param`\n- `GL_NEAREST` -- \n- `GL_LINEAR` -- \n- `GL_NEAREST_MIPMAP_NEAREST` -- mip\n- `GL_NEAREST_MIPMAP_LINEAR` -- mip\n- `GL_LINEAR_MIPMAP_NEAREST` -- mip\n- `GL_LINEAR_MIPMAP_LINEAR` -- mip\n\n> `GL_NEAREST``GL_LINEAR`mipmip\n\nmipmip\n\n### \n\nOpenGL ES 3.0OpenGL ES 2.0OpenGL ES 3.0--OpenGL ES 3.0\n\n## mip\n\nmipOpenGL ES 3.0`glGenerateMipmap`mip\n\n``` objc\n/**\n mip\n\n @param target#> mipGL_TEXTURE_2DGL_TEXTURE_3DGL_TEXTURE_2D_ARRAYGL_TEXTURE_CUBE_MAP description#>\n @return void\n */\nglGenerateMipmap(GLenum target);\n\n```\n\n`glGenerateMipmap`0mip2D0002D2D3Dmip\nOpenGL ES 3.0mipmip\nmipCPUmip`glGenerateMipmap`CPUmip\n\n## \n\n[0.0, 1.0]`glTexParameter[i|f][v]`str`GL_TEXTURE_WRAP_S`s[0.0, 1.0]`GL_TEXTURE_WRAP_T`t`GL_TEXTURE_WRAP_R`rr3D2DOpenGL ES\n\n | \n- | -\nGL_REPEAT | \nGL_CLAMP_TO_EDGE | \nGL_MIRRORED_REPEAT | \n\n`GL_CLAMP_TO_DEGE`\n\n## \n\nSwizzleRRGRGBRGBA`GL_RED`(0, 0, 0, R)(R, R, R, 1)(R, 0, 0, 1)RGBA`glTexParameter[i|f][v]``GL_TEXTURE_SWIZZLE_R``GL_TEXTURE_SWIZZLE_G``GL_TEXTURE_SWIZZLE_B``GL_TEXTURE_SWIZZLE_A`RGBA`GL_RED``GL_GREEN``GL_BLUE``GL_ALPHA``GL_ZERO``GL_ONE`01\n\n## \n\nmipGPSmipOpenGL ES 3.0`glTexParameter[i|f][v]``GL_TEXTURE_BASE_LEVEL`mip0mip`GL_TEXTURE_MAX_LEVEL`mip1000mip\nmipOpenGL ESLODmipmip`GL_TEXTURE_MIN_LOD``GL_TEXTURE_MAX_LOD`LODmipLODmipmipLOD\n\n## \n\n`GL_TEXTURE_COMPARE_FUNC``GL_TEXTURE_COMPARE_MODE`PCFPCF01\n`GL_TEXTURE_COMPARE_MODE``GL_NONE``GL_COMPARE_REF_TO_TEXTURE`(s, t, r)r91`GL_TEXTURE_COMPARE_FUNC``GL_LEQUAL``GL_GEQUAL``GL_LESS``GL_GREATER``GL_EQUAL``GL_NOTEQUAL``GL_ALWAYS``GL_NEVER`\n\n## \n\nOpenGL ES 3.0OpenGL ES 2.0\n2D`glTexImage2D`OpenGL ESOpenGL ES\n\n`glTexImage2D`\n\n |  |  | \n- | - | - | -\nGL_RGB | GL_RGB | GL_UNSIGNED_BYTE | 8/8/8 RGB 24- \nGL_RGB | GL_RGB | GL_UNSIGNED_SHORT_5_6_5 | 5/6/5 RGB 16- \nGL_RGBA | GL_RGBA | GL_UNSIGNED_BYTE | 8/8/8/8 RGBA 32- \nGL_RGBA | GL_RGBA | GL_UNSIGNED_SHORT_4_4_4_4 | 4/4/4/4 RGBA 16- \nGL_RGBA | GL_RGBA | GL_UNSIGNED_SHORT_5_5_5_1 | 5/5/5/1 RGBA 16- \nGL_LUMINANCE_ALPHA | GL_LUMINANCE_ALPHA | GL_UNSIGNED_BYTE | 8/8 LA 16- \nGL_LUMINANCE | GL_LUMINANCE | GL_UNSIGNED_BYTE | 8L 8- \nGL_ALPHA | GL_ALPHA | GL_UNSIGNED_BYTE | 8A 8- \n\n\n\n### \n\n[0.0, 1.0]*_SNORM[-1.0, 1.0]`GL_UNSIGNED_BYTE``GL_R8`8([0, 255])[0.0, 1.0]`GL_BYTE``GL_R8_SNORM`8[-128, 127][-1.0, 1.0]\n\n![glTexImage2D](/img/article/20190810/4.png)\n\n### \n\nOpenGL ES 3.01632RRGRGBRGBA1~4OpenGL ES 3.016\n\n![glTexImage2D](/img/article/20190810/5.png)\n\n### \n\n\nRRGRGBAcolor attachmentAlpha\n\n![glTexImage2D](/img/article/20190810/6.png)\n![glTexImage2D](/img/article/20190810/7.png)\n\n### \n\nRGBHDROpenGL ES 3.0`GL_RGB9_E5`3RGB5515RGB9\n\n![](/img/article/20190810/8.png)\n\n### sRGB\n\nOpenGL ES 3.0sRGBsRGBsRGB\nsRGBsRGBsRGBsRGBsRGB\nsRGBsRGBsRGBsRGBsRGB`pow(value, 2.0)`sRGB->`(value, 1/2.2)`->sRGBsRGBsRGB\n\n |  |  |  | R | F\n- | - | - | - | - | -\nGL_SRGB8 | GL_RGB | GL_UNSIGNED_BYTE | 8/8/8 SRGB | | X\nGL_SRGB8_ALPHA8 | GL_RGBA | GL_UNSIGNED_BYTE | 8/8/8/8 RGBA | X | X\n\n### \n\nOpenGL ES 3.0OpenGL ES 3.0\n\n |  | \n- | - | -\nGL_DEPTH_COMPONENT16 | GL_DEPTH_COMPONENT | GL_UNSIGNED_SHORT\nGL_DEPTH_COMPONENT16 | GL_DEPTH_COMPONENT | GL_UNSIGNED_INTp\nGL_DEPTH_COMPONENT24 | GL_DEPTH_COMPONENT | GL_UNSIGNED_INT\nGL_DEPTH_COMPONENT43F | GL_DEPTH_COMPONENT | GL_FLOAT\nGL_DEPTH24_STENCIL8 | GL_DEPTH_STENCIL | GL_UNSIGNED_INT_24_8\nGL_DEPTH32F_STENCIL8 | GL_DEPTH_STENCIL | GL_FLOAT_32_UNSIGNED_INT_24_8_REV\n\n## \n\n2D\n\n``` objc\n// Vertex shader\n# version 300 es\nlayout(location = 0) in vec4 a_position;\nlayout(location = 1) in vec2 a_texCoord;\nout vec2 v_texCoord;\nvoid main()\n{\n    gl_Position = a_position;\n    v_texCoord = a_texCoord;\n}\n```\n\n``` objc\n// Fragment shader\n# version 300 es\nprecision mediump float;\nin vec2 v_texCoord;\nlayout(location = 0) out vec4 outColor;\nuniform sampler2D s_texture;\nvoid main()\n{\n    outColor = texture(s_texture, v_texCoord);\n}\n```\n\n`sampler2D``s_texture`0`GL_TEXTURE0`1`GL_TEXTURE1`OpenGL ES 3.0 API`glActiveTexture`\n\n``` objc\n/**\n \n\n @param texture#> GL_TEXTURE0, 1, 2 description#>\n @return void\n */\nglActiveTexture(GLenum texture);\n```\n\n`glActiveTexture``glBindTexture`OpenGL ES`GL_MAX_TEXTURE_IMAGE_UNITS``glGetintegerv``GL_MAX_VERTEX_TEXTURE_IMAGE_UNITS``glGetintegerv`\n\n`glBindTexture``glUniformli``texture``texture`\n\n``` objc\n/**\n 2D\n\n @param sampler#>  description#>\n @param coord#> 2D description#>\n @param bias#> mipmipLOD description#>\n @return vec4 \n */\ntexture(sampler2D sampler, vec2 coord[, float bias]);\n```\n\n`texture``vec4``vec4`[](/article/2019/opengl-es-texture-0810/#)\n\n | \n- | -\nGL_RED | (R, 0.0 0.0, 1.0)\nGL_RG | (R, G, 0.0, 1.0)\nGL_RGB | (R, G, B, 1.0)\nGL_RGBA | (R, G, B, A)\nGL_LUMINANCE | (L, L, L, 1.0)\nGL_LUMINANCE_ALPHA | (L, L, L, A)\nGL_ALPHA | (0.0, 0.0, 0.0, A)\n\n\n\n``` objc\n- (void)setupVertices {\n    \n    GLfloat vertices[] = {\n        -1.0, -1.0, 0,\n        0, 0,\n        -1.0, 1.0, 0,\n        0, 1,\n        1.0, -1.0, 0,\n        1, 0,\n        1.0, 1.0, 0,\n        1, 1\n    };\n    \n    // \n    GLuint texture = [self createTextureWithImage:[UIImage imageNamed:@\"9\"]];\n    \n    GLuint program = [self createProgram];\n    glUseProgram(program);\n    glViewport(0, 0, [self getViewportWidth], [self getViewportHeight]);\n    \n    glClear(GL_COLOR_BUFFER_BIT);\n    glClearColor(0.0, 0.0, 0.0, 1.0);\n    \n    // \n    glActiveTexture(GL_TEXTURE0);\n    int textureLocation = glGetUniformLocation(program, \"s_texture\");\n    glBindTexture(GL_TEXTURE_2D, texture);\n    glUniform1i(textureLocation, 0);\n    \n    GLuint vbo;\n    glGenBuffers(1, &vbo);\n    glBindBuffer(GL_ARRAY_BUFFER, vbo);\n    glBufferData(GL_ARRAY_BUFFER, sizeof(vertices), vertices, GL_STATIC_DRAW);\n    \n    glEnableVertexAttribArray(0);\n    glVertexAttribPointer(0, 3, GL_FLOAT, GL_FALSE, sizeof(GLfloat)*5, 0);\n    glEnableVertexAttribArray(1);\n    glVertexAttribPointer(1, 2, GL_FLOAT, GL_FALSE, sizeof(GLfloat)*5, (GLvoid *)(sizeof(GLfloat)*3));\n    \n    glDrawArrays(GL_TRIANGLE_STRIP, 0, 4);\n    \n    [self.context presentRenderbuffer:GL_RENDERBUFFER];\n}\n\n\n- (GLuint)createTextureWithImage:(UIImage *)image {\n    //  UIImage  CGImageRef\n    CGImageRef cgImageRef = [image CGImage];\n    GLuint width = (GLuint)CGImageGetWidth(cgImageRef);\n    GLuint height = (GLuint)CGImageGetHeight(cgImageRef);\n    CGRect rect = CGRectMake(0, 0, width, height);\n    \n    // \n    CGColorSpaceRef colorSpace = CGColorSpaceCreateDeviceRGB();\n    //  xx4RGBA\n    void *imageData = malloc(width * height * 4);\n    /**\n     \n\n     @param data#>  description#>\n     @param width#>  description#>\n     @param height#>  description#>\n     @param bitsPerComponent#> 32RGBA8 description#>\n     @param bytesPerRow#> bit description#>\n     @param space#>  description#>\n     @param bitmapInfo#> bitmap description#>\n     @return \n     */\n    CGContextRef context = CGBitmapContextCreate(imageData, width, height, 8, width * 4, colorSpace, kCGImageAlphaPremultipliedLast | kCGBitmapByteOrder32Big);\n    // -\n    CGContextTranslateCTM(context, 0, height);\n    CGContextScaleCTM(context, 1.0f, -1.0f);\n    CGColorSpaceRelease(colorSpace);\n    CGContextClearRect(context, rect);\n    CGContextDrawImage(context, rect, cgImageRef);\n    \n    // \n    GLuint textureID;\n    glGenTextures(1, &textureID);\n    glBindTexture(GL_TEXTURE_2D, textureID);\n    glTexImage2D(GL_TEXTURE_2D, 0, GL_RGBA, width, height, 0, GL_RGBA, GL_UNSIGNED_BYTE, imageData); // \n    \n    // \n    glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_WRAP_S, GL_CLAMP_TO_EDGE);\n    glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_WRAP_T, GL_CLAMP_TO_EDGE);\n    glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_LINEAR);\n    glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_LINEAR);\n    \n    // \n    glBindTexture(GL_TEXTURE_2D, 0);\n    \n    // \n    CGContextRelease(context);\n    free(imageData);\n    \n    return textureID;\n}\n```\n\n## \n\n2D`GL_TEXTURE_CUBE_MAP_POSITIVE_(X|Y|Z)``GL_TEXTURE_CUBE_NEGATIVE_(X|Y|Z)``glTexImage2D`\n\n``` objc\n// Vertex shader\n#version 300 es\nlayout(location = 0) in vec4 a_position;\nlayout(location = 1) in vec3 a_normal;\nout vec3 v_normal;\nvoid mian()\n{\n    gl_Position = a_position;\n    v_normal = a_normal;\n}\n```\n\n``` objc\n// Fragment shader\n#version 300 es\nprecision mediump float;\nin vec3 v_normal;\nlayout(location = 0) out vec4 outColor;\nuniform samplerCube s_texture;\nvoid main()\n{\n    outColor = texture(s_texture, v_normal);\n}\n```\n\n`texture``texture`\n\n``` objc\n/**\n \n\n @param sampler#>  description#>\n @param coord#> 3D description#>\n @param bias#> mipmipLOD description#>\n @return vec4 \n */\ntexture(samplerCube sampler, vec3 coord[, float bias]);\n```\n\n2D32`sampleCube`2D\n\n## 3D2D\n\n2DOpenGL ES 3.03D2D3D2D`glTexImage3D``glTexImage2D`\n\n``` objc\n/**\n 3D2D\n\n @param target#> GL_TEXTURE_3DGL_TEXTURE_2D_ARRAY description#>\n @param level#> mip0mip description#>\n @param internalformat#>  description#>\n @param width#>  description#>\n @param height#>  description#>\n @param depth#> 3D description#>\n @param border#> OpenGL ES0 description#>\n @param format#>  description#>\n @param type#>  description#>\n @param pixels#> width*height*depth2D description#>\n @return void\n */\nglTexImage3D(GLenum target, GLint level, GLint internalformat, GLsizei width, GLsizei height, GLsizei depth, GLint border, GLenum format, GLenum type, const GLvoid *pixels);\n\n```\n\n`glTexImage3D`3D2D`texture`\n\n``` objc\n/**\n 3D\n\n @param sampler#>  description#>\n @param coord#> 3D description#>\n @param bias#> mipmipLOD description#>\n @return vec4 \n */\ntexture(sampler3D sampler, vec3 coord[, float bias]);\n\n/**\n 2D\n\n @param sampler#>  description#>\n @param coord#> 3D description#>\n @param bias#> mipmipLOD description#>\n @return vec4 \n */\ntexture(sampler2DArray sampler, vec3 coord[, float bias]);\n```\n\n> r3D\n\n# \n\nOpenGL ES 3.0\nOpenGL ES 2.0OpenGL ES 2.0OpenGL ES 2.0\nOpenGL ES 3.0Ericsson Texture CompressionETC2EACKhronosOpenGL ES 3.0EAC12ETC2342D`glCompressedTexImage2D`2D`glCompressedTexImage3D`\n\n> ETC2/EAC3D2D2D`glCompressedTexImage3D`3D\n\n``` objc\n/**\n 2D\n\n @param target#> GL_TEXTURE_2DGL_TEXTURE_CUBE_MAP_* description#>\n @param level#> mip description#>\n @param internalformat#>  description#>\n @param width#>  description#>\n @param height#>  description#>\n @param border#> OpenGL ES0 description#>\n @param imageSize#>  description#>\n @param data#> imageSize description#>\n @return void\n */\nglCompressedTexImage2D(GLenum target, GLint level, GLenum internalformat, GLsizei width, GLsizei height, GLint border, GLsizei imageSize, const GLvoid *data);\n\n/**\n 2D\n\n @param target#> GL_TEXTURE_2DGL_TEXTURE_CUBE_MAP_* description#>\n @param level#> mip description#>\n @param internalformat#> OpenGL ES 3.0 description#>\n @param width#>  description#>\n @param height#>  description#>\n @param border#> OpenGL ES0 description#>\n @param imageSize#>  description#>\n @param data#> imageSize description#>\n @return void\n */\nglCompressedTexImage3D(GLenum target, GLint level, GLenum internalformat, GLsizei width, GLsizei height, GLint border, GLsizei imageSize, const GLvoid *data);\n\n/**\n 2D3D\n\n @param target#> GL_TEXTURE_3DGL_TEXTURE_2D_ARRAY description#>\n @param level#> mip description#>\n @param internalformat#> OpenGL ES 3.0 description#>\n @param width#>  description#>\n @param height#>  description#>\n @param depth#> 2D description#>\n @param border#> OpenGL ES0 description#>\n @param imageSize#>  description#>\n @param data#> imageSize description#>\n @return void\n */\nglCompressedTexImage3D(GLenum target, GLint level, GLenum internalformat, GLsizei width, GLsizei height, GLsizei depth, GLint border, GLsizei imageSize, const GLvoid *data);\n```\n\nOpenGL ES 3.0ETCETC4x4ETCETCbpp`sizeInBytes = max(width, 4) * max(height, 4) * bpp / 8`\n\n | | \n- | - | -\nGL_COMPRESSED_R11_EAC | 4 | GL_RED\nGL_COMPRESSED_SIGNED_R11_EAC | 4 | GL_RED\nGL_COMPRESSED_RG11_EAC | 8 | GL_RG\nGL_COMPRESSED_SIGNED_RG11_EAC | 8 | GL_RG\nGL_COMPRESSED_RGB8_ETC2 | 4 | GL_RGB\nGL_COMPRESSED_SRGB8_ETC2 | 4 | sRGBGL_RGB\nGL_COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2 | 4 | GL_RGBA1alpha\nGL_COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2 | 4 | sRGBGL_RGBA1alpha\nGL_COMPRESSED_RGBA8_ETC2_EAC | 8 | GL_RGBA\nGL_COMPRESSED_SRGBA8_ETC2_EAC | 8 | sRGBGL_RGBA\n\n\n\nOpenGL ES 3.0OpenGL ES 3.0`GL_INVALID_ENUM`OpenGL ES 3.0\n`glGetIntegerv``GL_NUM_COMPRESSED_TEXTURE_FORMATS``glGetIntegerv``GL_COMPRESSED_TEXTURE_FORMATS``GLenum``GLenum`\n\n# \n\n`glTexImage2D`\n\n``` objc\n/**\n 2D\n\n @param target#> GL_TEXTURE_2DGL_TEXTURE_CUBE_MAP_* description#>\n @param level#> mip description#>\n @param xoffset#> x description#>\n @param yoffset#> y description#>\n @param width#>  description#>\n @param height#>  description#>\n @param format#>  description#>\n @param type#>  description#>\n @param pixels#>  description#>\n @return void\n */\nglTexSubImage2D(GLenum target, GLint level, GLint xoffset, GLint yoffset, GLsizei width, GLsizei height, GLenum format, GLenum type, const GLvoid *pixels);\n```\n\n(xoffset, yoffset)(xoffset+width-1, yoffset+height-1)`pixels``glPixelStorei``GL_UNPACK_ALIGNMENT`\n\n2D\n\n``` objc\n/**\n 2D\n\n @param target#> GL_TEXTURE_2DGL_TEXTURE_CUBE_MAP_* description#>\n @param level#> mip description#>\n @param xoffset#> x description#>\n @param yoffset#> y description#>\n @param width#>  description#>\n @param height#>  description#>\n @param format#>  description#>\n @param imageSize#>  description#>\n @param data#>  description#>\n @return void\n */\nglCompressedTexSubImage2D(GLenum target, GLint level, GLint xoffset, GLint yoffset, GLsizei width, GLsizei height, GLenum format, GLsizei imageSize, const GLvoid *data);\n```\n\n2D`glTexSubImage3D`3D2D\n\n``` objc\n/**\n 3D\n\n @param target#> GL_TEXTURE_3DGL_TEXTURE_2D_ARRAY description#>\n @param level#> mip description#>\n @param xoffset#> x description#>\n @param yoffset#> y description#>\n @param zoffset#> z description#>\n @param width#>  description#>\n @param height#>  description#>\n @param depth#>  description#>\n @param format#>  description#>\n @param type#>  description#>\n @param pixels#>  description#>\n @return void\n */\nglTexSubImage3D(GLenum target, GLint level, GLint xoffset, GLint yoffset, GLint zoffset, GLsizei width, GLsizei height, GLsizei depth, GLenum format, GLenum type, const GLvoid *pixels);\n```\n\n`glTexSubImage3D``glTexSubImage2D``zoffset``depth`2D`glCompressedTexSubImage3D`3D3DETC2/EAC2D2D\n\n``` objc\n/**\n 3D\n\n @param target#> GL_TEXTURE_3DGL_TEXTURE_2D_ARRAY description#>\n @param level#> mip description#>\n @param xoffset#> x description#>\n @param yoffset#> y description#>\n @param zoffset#> z description#>\n @param width#>  description#>\n @param height#>  description#>\n @param depth#>  description#>\n @param format#>  description#>\n @param imageSize#>  description#>\n @param data#>  description#>\n @return void\n */\nglCompressedTexSubImage3D(GLenum target, GLint level, GLint xoffset, GLint yoffset, GLint zoffset, GLsizei width, GLsizei height, GLsizei depth, GLenum format, GLsizei imageSize, const GLvoid *data);\n```\n\n# \n\nOpenGL ES 3.0-\n\n`glReadBuffer`EGL`glReadBuffer``GL_BACK`--OpenGL ES 3.0EGLOpenGL ES 3.0`eglSwapBuffers`EGLEGL pbufferpbuffer`GL_COLOR_ATTACHMENTi``glReadBuffer`\n\n``` objc\n/**\n \n\n @param mode#> glReadPixelsglCopyTexImage2DglCopyTexSubImage2DglCopyTexSubImage3DGL_BACKGL_COLOR_ATTACHMENTiGL_NONE description#>\n @return void\n */\nglReadBuffer(GLenum mode);\n```\n\n`glCopyTexImage2D``glCopyTexSubImage2D``glCopyTexSubImage3D`\n\n``` objc\n/**\n 2D\n\n @param target#> GL_TEXTURE_CUBE_MAP_2DGL_TEXTURE_CUBE_MAP_* description#>\n @param level#> mip description#>\n @param internalformat#>  description#>\n @param x#> x description#>\n @param y#> y description#>\n @param width#>  description#>\n @param height#>  description#>\n @param border#> OpenGL ES 3.00 description#>\n @return void\n */\nglCopyTexImage2D(GLenum target, GLint level, GLenum internalformat, GLint x, GLint y, GLsizei width, GLsizei height, GLint border);\n```\n\n(x, y)(x+width-1, y+height-1)\n`glCopyTexSubImage2D`\n\n``` objc\n/**\n 2D\n\n @param target#> GL_TEXTURE_2DGL_TEXTURE_CUBE_MAP_* description#>\n @param level#> mip description#>\n @param xoffset#> x description#>\n @param yoffset#> y description#>\n @param x#> x description#>\n @param y#> y description#>\n @param width#>  description#>\n @param height#>  description#>\n @return void\n */\nglCopyTexSubImage2D(GLenum target, GLint level, GLint xoffset, GLint yoffset, GLint x, GLint y, GLsizei width, GLsizei height);\n```\n\n(x, y)(x+width-1, y+height-1)(xoffset, yoffset)(xoffset+width-1, yoffset+height-1)\n`glCopyTexSubImage3D`3D2D\n\n``` objc\n/**\n 3D2D\n\n @param target#> GL_TEXTURE_3DGL_TEXTURE_2D_ARRAY description#>\n @param level#> mip description#>\n @param xoffset#> x description#>\n @param yoffset#> y description#>\n @param zoffset#> z description#>\n @param x#> x description#>\n @param y#> y description#>\n @param width#>  description#>\n @param height#>  description#>\n @return void\n */\nglCopyTexSubImage3D(GLenum target, GLint level, GLint xoffset, GLint yoffset, GLint zoffset, GLint x, GLint y, GLsizei width, GLsizei height);\n```\n\n\n\n# \n\n`glTexParameter[i|f][v]`LOD`glTexParameter[i|f][v]`API`glTexParameter[i|f][v]`OpenGL ES 3.0`glTexParameter[i|f][v]`API\n\n\n\n``` objc\n/**\n \n\n @param count#>  description#>\n @param samplers#> nID description#>\n @return void\n */\nglGenSamplers(GLsizei count, GLuint *samplers);\n```\n\n\n\n``` objc\n/**\n \n\n @param count#>  description#>\n @param samplers#> nID description#>\n @return void\n */\nglDeleteSamplers(GLsizei count, const GLuint *samplers);\n```\n\nID`glTexParameter[i|f][v]`\n\n``` objc\n/**\n \n\n @param unit#>  description#>\n @param sampler#>  description#>\n @return void\n */\nglBindSampler(GLuint unit, GLuint sampler);\n```\n\n`glBindSampler``sampler`0`glSampler[f|i][v]``glSamplerParameter[f|i][v]``glTexParameter[i|f][v]`\n\n``` objc\nglSamplerParameteri(GLuint sampler, GLenum pname, GLint param);\nglSamplerParameteriv(GLuint sampler, GLenum pname, const GLint *param);\nglSamplerParameterf(GLuint sampler, GLenum pname, GLfloat param);\nglSamplerParameterfv(GLuint sampler, GLenum pname, const GLfloat *param);\n```\n\n# \n\nOpenGL ES 3.0`glTexImage2D``glTexImage3D`mipOpenGL ESmip\n\nOpenGL ES`glTexSubImage2D``glTexSubImage3D``glGenerateMipMap`\n`glBindTexture``glTexStorage2D``glTexStorage3D`\n\n``` objc\n/**\n \n\n @param target#> GL_TEXTURE_2DGL_TEXTURE_CUBE_MAP_*GL_TEXTURE_3DGL_TEXTURE_2D_ARRAY description#>\n @param levels#> mip description#>\n @param internalformat#>  description#>\n @param width#>  description#>\n @param height#>  description#>\n @return void\n */\nglTexStorage2D/3D(GLenum target, GLsizei levels, GLenum internalformat, GLsizei width, GLsizei height);\n```\n\n`glTexImage*``glCompressedTexImage*``glCopyTexImage*``glTexStorage*``GL_INVALID_OPERATION``glTexSubImage2D``glTexSubImage3D``glGenerateMipMap`\n`glTexStorage*`OpenGL ES`GL_TEXTURE_IMMUTABLE_FORMAT``GL_TRUE``GL_TEXTURE_IMMUTABLE_LEVELS``glTexStorage*``glGetTexParameter[i|f][v]``glTexStorage*`\n\n# \n\nGPUCPUGPUOpenGL ES 3.0`GL_PIXEL_UNPACK_BUFFER``glTexImage*``glTexSubImage*``glCompressedTexImage*``glCompressedTexSubImage*``glVertexAttribPointer`VBO\nGPUOpenGL`glTexSubImage*`GPU/\n\n# \n\nOpenGL ES 3.0","slug":"2019/opengl-es-texture-0810","published":1,"updated":"2021-06-21T12:34:52.097Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckszp3ne1001zifntxdzqxbku","content":"<blockquote>\n<p>OpenGL ES 3.0</p>\n</blockquote>\n<h1 id=\"\"></h1>\n<p>3DOpenGL ES 3.02D2D3D<br>\n</p>\n<h2 id=\"2d\">2D</h2>\n<p>2DOpenGL ESTexeltexture pixelsOpenGL ES</p>\n<table>\n<thead>\n<tr>\n<th></th>\n<th></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>GL_RED</td>\n<td>()</td>\n</tr>\n<tr>\n<td>GL_RG</td>\n<td>()</td>\n</tr>\n<tr>\n<td>GL_RGB</td>\n<td>()</td>\n</tr>\n<tr>\n<td>GL_RGBA</td>\n<td>(Alpha)</td>\n</tr>\n<tr>\n<td>GL_LUMINANCE</td>\n<td>()</td>\n</tr>\n<tr>\n<td>GL_LUMINANCE_ALPHA</td>\n<td>(Alpha)</td>\n</tr>\n<tr>\n<td>GL_ALPHA</td>\n<td>(Alpha)</td>\n</tr>\n<tr>\n<td>GL_DEPTH_COMPONENT</td>\n<td>()</td>\n</tr>\n<tr>\n<td>GL_DEPTH_STENCIL</td>\n<td>()</td>\n</tr>\n<tr>\n<td>GL_RED_INTEGER</td>\n<td>()</td>\n</tr>\n<tr>\n<td>GL_RG_INTEGER</td>\n<td>()</td>\n</tr>\n<tr>\n<td>GL_RGB_INTEGER</td>\n<td>()</td>\n</tr>\n<tr>\n<td>GL_RGBA_INTERGER</td>\n<td>(Alpha)</td>\n</tr>\n</tbody>\n</table>\n<p>2D3D2D2D(s, t)(u, v)</p>\n<p><img src=\"/img/article/20190810/1.png\" alt=\"2D\"></p>\n<p><code>st</code>(0.0, 0.0)<code>st</code>(1.0, 1.0)[0.0, 1.0]</p>\n<h2 id=\"\"></h2>\n<p>2DOpenGL ES 3.062D3D6(+X, -X, +Y, -Y, +Z, -Z)<br>\n3D(s, t, r)(s, t, r)3D(x, y, z)3D2D(s, t)3D</p>\n<p><img src=\"/img/article/20190810/2.png\" alt=\"3D\"></p>\n<p>2D3D2D</p>\n<h2 id=\"3d\">3D</h2>\n<p>OpenGL ES 3.03D3D2D3(s, t, r)3Dr3D(s, t)2D3D2D3Dmip</p>\n<p><img src=\"/img/article/20190810/3.png\" alt=\"3D\"></p>\n<h2 id=\"2d\">2D</h2>\n<p>OpenGL ES 3.02D2D3D2D2D2D3D3D2Dmip2Dmip2Dmip3D3Dmip</p>\n<p>2D3D(s, t, r)r2D(s, t)2D</p>\n<h2 id=\"\"></h2>\n<p>OpenGL ES<code>glGenTextures</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param n#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param textures#&gt; nID description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glGenTextures(GLsizei n, GLuint *textures);</span><br></pre></td></tr></table></figure>\n<p><code>glGenTextures</code><code>glDeleteTextures</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param n#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param textures#&gt; nID description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glDeleteTextures(GLsizei n, <span class=\"keyword\">const</span> GLuint *textures);</span><br></pre></td></tr></table></figure>\n<p><code>glGenTextures</code>ID(<code>glTexImage2D</code><code>glTexParameter</code>)<code>glBindTexture</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param target#&gt; GL_TEXTURE_2DGL_TEXTURE_3DGL_TEXTURE_2D_ARRAYGL_TEXTURE_CUBE_MAP description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param texture#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glBindTexture(GLenum target, GLuint texture);</span><br></pre></td></tr></table></figure>\n<p>2D<code>glTexImage2D</code>OpenGL ES 3.02D(<code>glTexStorage2D</code>)<code>glTexSubImage2D</code><code>glTexImage2D</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> 2D</span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param target#&gt; GL_TEXTURE_2DGL_TEXTURE_CUBE_MAP_POSITIVE_(X, Y, Z)GL_TEXTURE_CUBE_MAP_NEGATIVE_(X, Y, Z) description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param level#&gt; mip0mip description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param internalformat#&gt; GL_RGBAGL_RGBGL_LUMINANCE_ALPHAGL_LUMINANCEGL_ALPHAGL_RGBGL_DEPTH_COMPONENT16 description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param width#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param height#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param border#&gt; OpenGL ESOpenGL0 description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param format#&gt; GL_RED(_INTEGER)GL_RG(_INTEGER)GL_RGB(_INTERGER)GL_RGBA(_INTEGER)GL_DEPTH_COMPONENTGL_DEPTH_STENCILGL_LUMINANCE_ALPHAGL_ALPHA description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param type#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param pixels#&gt; width*height*`glPixelStorei`GL_UNPACK_ALIGHMENT description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glTexImage2D(GLenum target, GLint level, GLint internalformat, GLsizei width, GLsizei height, GLint border, GLenum format, GLenum type, <span class=\"keyword\">const</span> GLvoid *pixels);</span><br></pre></td></tr></table></figure>\n<p>RGB 2x2 2D</p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">GLuint textureId;</span><br><span class=\"line\">GLubyte pixels[] = &#123;</span><br><span class=\"line\">    <span class=\"number\">255</span>, <span class=\"number\">0</span>, <span class=\"number\">0</span>,</span><br><span class=\"line\">    <span class=\"number\">0</span>, <span class=\"number\">255</span>, <span class=\"number\">0</span>,</span><br><span class=\"line\">    <span class=\"number\">0</span>, <span class=\"number\">0</span>, <span class=\"number\">255</span>,</span><br><span class=\"line\">    <span class=\"number\">255</span>, <span class=\"number\">255</span>, <span class=\"number\">0</span></span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// User tightly packed data</span></span><br><span class=\"line\">glPixelStorei(GL_UNPACK_ALIGNMENT, <span class=\"number\">1</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// Generate a texture object</span></span><br><span class=\"line\">glGenTextures(<span class=\"number\">1</span>, &amp;textureId);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// Bind the texture object</span></span><br><span class=\"line\">glBindTexture(GL_TEXTURE_2D, textureId);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// Load the texture</span></span><br><span class=\"line\">glTexImage2D(GL_TEXTURE_2D, <span class=\"number\">0</span>, GL_RGB, <span class=\"number\">2</span>, <span class=\"number\">2</span>, <span class=\"number\">0</span>, GL_RGB, GL_UNSIGNED_BYTE, pixels);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// Set the filtering mode</span></span><br><span class=\"line\">glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_NEAREST);</span><br><span class=\"line\">glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_NEAREST);</span><br></pre></td></tr></table></figure>\n<p><code>pixels</code>2x2RGB[0, 255]8[0, 255][0.0, 1.0]<br>\n<code>glTexImage2D</code><code>glPixelStorei</code><code>glTexImage2D</code><code>GL_UNPACK_ALIGNMENT</code>44<br>\n1</p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param pname#&gt; glTexImage2DglTexImage3DglTexSubImage2DglTexSubImage3DGL_UNPACK_ROW_LENGTHGL_UNPACK_IMAGE_HEIGHTGL_UNPACK_SKIP_PIXELSGL_UNPACK_SKIP_ROWSGL_UNPACK_SKIP_IMAGESGL_UNPACK_ALIGNMENTglReadPixelsGL_PACK_ROW_LENGTHGL_PACK_IMAGE_HEIGHTGL_PACK_SKIP_PIXELSGL_PACK_SKIP_ROWSGL_PACK_SKIP_IMAGESGL_PACK_ALIGNMENT description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param param#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glPixelStorei(GLenum pname, GLint param);</span><br></pre></td></tr></table></figure>\n<p><code>glPixelStorei</code><code>GL_PACK_xxxx</code><code>glReadPixels</code><code>glPixelStorei</code><code>GL_UNPACK_ALIGNMENT</code></p>\n<table>\n<thead>\n<tr>\n<th></th>\n<th></th>\n<th></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>GL_UNPACK_ALIGNMENT GL_PACK_ALIGNMENT</td>\n<td>4</td>\n<td>41</td>\n</tr>\n<tr>\n<td>GL_UNPACK_ROW_LENGTH GL_PACK_ROW_LENGTH</td>\n<td>0</td>\n<td>00</td>\n</tr>\n<tr>\n<td>GL_UNPACK_IMAGE_HEIGHT GL_PACK_IMAGE_HEIGHT</td>\n<td>0</td>\n<td>03D3D0</td>\n</tr>\n<tr>\n<td>GL_UNPACK_SKIP_PIXELS GL_PACK_SKIP_PIXELS</td>\n<td>0</td>\n<td>0</td>\n</tr>\n<tr>\n<td>GL_UNPACK_SKIP_ROWS GL_PACK_SKIP_ROWS</td>\n<td>0</td>\n<td>0</td>\n</tr>\n<tr>\n<td>GL_UNPACK_SKIP_IMAGES GL_PACK_SKIP_IMAGES</td>\n<td>0</td>\n<td>03D</td>\n</tr>\n</tbody>\n</table>\n<p><code>glTexParameteri</code><code>GL_NEAREST</code>mipmip<code>GL_LINEAR</code>mip</p>\n<h2 id=\"mip\">mip</h2>\n<p>2D2DOpenGL ES2D<code>GL_NEAREST</code><br>\nOpenGL ESmipmipmappingmipmipmip1x1mipmip4<br>\n<a href=\"https://github.com/danginsburg/opengles3-book/blob/master/Chapter_9/MipMap2D/MipMap2D.c\" target=\"_blank\" rel=\"noopener\">GenMipMap2D</a>mipRGB8mipmip<code>glTexImage2D</code><br>\nmipmipmip</p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">glTexImage2D(GL_TEXTURE_2D, <span class=\"number\">0</span>, GL_RGB, width, height, <span class=\"number\">0</span>, GL_RGB, GL_UNSIGNED_BYTE, pixels);</span><br><span class=\"line\"><span class=\"keyword\">int</span> level = <span class=\"number\">1</span>;</span><br><span class=\"line\">GLubyte *prevImage = &amp;pixels[<span class=\"number\">0</span>];</span><br><span class=\"line\">GLubyte *newImage;</span><br><span class=\"line\"><span class=\"keyword\">while</span> (width &gt; <span class=\"number\">1</span> &amp;&amp; height &gt; <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> newWidth, newHeight;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">// Generate the next mipmap level</span></span><br><span class=\"line\">    GenMipMap2D(prevImage, &amp;newImage, width, height, &amp;newWidth, &amp;newHeight);</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">// Load the mipmap level</span></span><br><span class=\"line\">    glTexImage2D(GL_TEXTURE_2D, level, GL_RGB, newWidth, newHeight, <span class=\"number\">0</span>, GL_RGB, GL_UNSIGNED_BYTE, newImage);</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">// Free the previous image</span></span><br><span class=\"line\">    free(prevImage);</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">// Set the previous image for the next iteration</span></span><br><span class=\"line\">    prevImage = newImage;</span><br><span class=\"line\">    level += <span class=\"number\">1</span>;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">// Half the width and height</span></span><br><span class=\"line\">    width = newWidth;</span><br><span class=\"line\">    height = newHeight;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">free(newImage);</span><br></pre></td></tr></table></figure>\n<p>APImip<br>\n<code>glTexParameter[i|f][v]</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">glTexParameteri(GLenum target, GLenum pname, GLint param)</span><br><span class=\"line\">glTexParameteriv(GLenum target, GLenum pname, <span class=\"keyword\">const</span> GLint *params);</span><br><span class=\"line\">glTexParameterf(GLenum target, GLenum pname, GLfloat param);</span><br><span class=\"line\">glTexParameterfv(GLenum target, GLenum pname, <span class=\"keyword\">const</span> GLfloat *params);</span><br></pre></td></tr></table></figure>\n<p><code>pname</code><code>GL_TEXTURE_MAG_FILTER</code><code>param</code><code>GL_NEAREST</code><code>GL_LINEAR</code><code>GL_NEAREST</code><code>GL_LINEAR</code>4<br>\n<code>pname</code><code>GL_TEXTURE_MIN_FILTER</code><code>param</code></p>\n<ul>\n<li><code>GL_NEAREST</code>  </li>\n<li><code>GL_LINEAR</code>  </li>\n<li><code>GL_NEAREST_MIPMAP_NEAREST</code>  mip</li>\n<li><code>GL_NEAREST_MIPMAP_LINEAR</code>  mip</li>\n<li><code>GL_LINEAR_MIPMAP_NEAREST</code>  mip</li>\n<li><code>GL_LINEAR_MIPMAP_LINEAR</code>  mip</li>\n</ul>\n<blockquote>\n<p><code>GL_NEAREST</code><code>GL_LINEAR</code>mipmip</p>\n</blockquote>\n<p>mipmip</p>\n<h3 id=\"\"></h3>\n<p>OpenGL ES 3.0OpenGL ES 2.0OpenGL ES 3.0OpenGL ES 3.0</p>\n<h2 id=\"mip\">mip</h2>\n<p>mipOpenGL ES 3.0<code>glGenerateMipmap</code>mip</p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> mip</span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param target#&gt; mipGL_TEXTURE_2DGL_TEXTURE_3DGL_TEXTURE_2D_ARRAYGL_TEXTURE_CUBE_MAP description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glGenerateMipmap(GLenum target);</span><br></pre></td></tr></table></figure>\n<p><code>glGenerateMipmap</code>0mip2D0002D2D3Dmip<br>\nOpenGL ES 3.0mipmip<br>\nmipCPUmip<code>glGenerateMipmap</code>CPUmip</p>\n<h2 id=\"\"></h2>\n<p>[0.0, 1.0]<code>glTexParameter[i|f][v]</code>str<code>GL_TEXTURE_WRAP_S</code>s[0.0, 1.0]<code>GL_TEXTURE_WRAP_T</code>t<code>GL_TEXTURE_WRAP_R</code>rr3D2DOpenGL ES</p>\n<table>\n<thead>\n<tr>\n<th></th>\n<th></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>GL_REPEAT</td>\n<td></td>\n</tr>\n<tr>\n<td>GL_CLAMP_TO_EDGE</td>\n<td></td>\n</tr>\n<tr>\n<td>GL_MIRRORED_REPEAT</td>\n<td></td>\n</tr>\n</tbody>\n</table>\n<p><code>GL_CLAMP_TO_DEGE</code></p>\n<h2 id=\"\"></h2>\n<p>SwizzleRRGRGBRGBA<code>GL_RED</code>(0, 0, 0, R)(R, R, R, 1)(R, 0, 0, 1)RGBA<code>glTexParameter[i|f][v]</code><code>GL_TEXTURE_SWIZZLE_R</code><code>GL_TEXTURE_SWIZZLE_G</code><code>GL_TEXTURE_SWIZZLE_B</code><code>GL_TEXTURE_SWIZZLE_A</code>RGBA<code>GL_RED</code><code>GL_GREEN</code><code>GL_BLUE</code><code>GL_ALPHA</code><code>GL_ZERO</code><code>GL_ONE</code>01</p>\n<h2 id=\"\"></h2>\n<p>mipGPSmipOpenGL ES 3.0<code>glTexParameter[i|f][v]</code><code>GL_TEXTURE_BASE_LEVEL</code>mip0mip<code>GL_TEXTURE_MAX_LEVEL</code>mip1000mip<br>\nmipOpenGL ESLODmipmip<code>GL_TEXTURE_MIN_LOD</code><code>GL_TEXTURE_MAX_LOD</code>LODmipLODmipmipLOD</p>\n<h2 id=\"\"></h2>\n<p><code>GL_TEXTURE_COMPARE_FUNC</code><code>GL_TEXTURE_COMPARE_MODE</code>PCFPCF01<br>\n<code>GL_TEXTURE_COMPARE_MODE</code><code>GL_NONE</code><code>GL_COMPARE_REF_TO_TEXTURE</code>(s, t, r)r91<code>GL_TEXTURE_COMPARE_FUNC</code><code>GL_LEQUAL</code><code>GL_GEQUAL</code><code>GL_LESS</code><code>GL_GREATER</code><code>GL_EQUAL</code><code>GL_NOTEQUAL</code><code>GL_ALWAYS</code><code>GL_NEVER</code></p>\n<h2 id=\"\"></h2>\n<p>OpenGL ES 3.0OpenGL ES 2.0<br>\n2D<code>glTexImage2D</code>OpenGL ESOpenGL ES</p>\n<p><code>glTexImage2D</code></p>\n<table>\n<thead>\n<tr>\n<th></th>\n<th></th>\n<th></th>\n<th></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>GL_RGB</td>\n<td>GL_RGB</td>\n<td>GL_UNSIGNED_BYTE</td>\n<td>8/8/8 RGB 24- </td>\n</tr>\n<tr>\n<td>GL_RGB</td>\n<td>GL_RGB</td>\n<td>GL_UNSIGNED_SHORT_5_6_5</td>\n<td>5/6/5 RGB 16- </td>\n</tr>\n<tr>\n<td>GL_RGBA</td>\n<td>GL_RGBA</td>\n<td>GL_UNSIGNED_BYTE</td>\n<td>8/8/8/8 RGBA 32- </td>\n</tr>\n<tr>\n<td>GL_RGBA</td>\n<td>GL_RGBA</td>\n<td>GL_UNSIGNED_SHORT_4_4_4_4</td>\n<td>4/4/4/4 RGBA 16- </td>\n</tr>\n<tr>\n<td>GL_RGBA</td>\n<td>GL_RGBA</td>\n<td>GL_UNSIGNED_SHORT_5_5_5_1</td>\n<td>5/5/5/1 RGBA 16- </td>\n</tr>\n<tr>\n<td>GL_LUMINANCE_ALPHA</td>\n<td>GL_LUMINANCE_ALPHA</td>\n<td>GL_UNSIGNED_BYTE</td>\n<td>8/8 LA 16- </td>\n</tr>\n<tr>\n<td>GL_LUMINANCE</td>\n<td>GL_LUMINANCE</td>\n<td>GL_UNSIGNED_BYTE</td>\n<td>8L 8- </td>\n</tr>\n<tr>\n<td>GL_ALPHA</td>\n<td>GL_ALPHA</td>\n<td>GL_UNSIGNED_BYTE</td>\n<td>8A 8- </td>\n</tr>\n</tbody>\n</table>\n<p></p>\n<h3 id=\"\"></h3>\n<p>[0.0, 1.0]*_SNORM[-1.0, 1.0]<code>GL_UNSIGNED_BYTE</code><code>GL_R8</code>8([0, 255])[0.0, 1.0]<code>GL_BYTE</code><code>GL_R8_SNORM</code>8[-128, 127][-1.0, 1.0]</p>\n<p><img src=\"/img/article/20190810/4.png\" alt=\"glTexImage2D\"></p>\n<h3 id=\"\"></h3>\n<p>OpenGL ES 3.01632RRGRGBRGBA1~4OpenGL ES 3.016</p>\n<p><img src=\"/img/article/20190810/5.png\" alt=\"glTexImage2D\"></p>\n<h3 id=\"\"></h3>\n<p><br>\nRRGRGBAcolor attachmentAlpha</p>\n<p><img src=\"/img/article/20190810/6.png\" alt=\"glTexImage2D\"><br>\n<img src=\"/img/article/20190810/7.png\" alt=\"glTexImage2D\"></p>\n<h3 id=\"\"></h3>\n<p>RGBHDROpenGL ES 3.0<code>GL_RGB9_E5</code>3RGB5515RGB9</p>\n<p><img src=\"/img/article/20190810/8.png\" alt=\"\"></p>\n<h3 id=\"srgb\">sRGB</h3>\n<p>OpenGL ES 3.0sRGBsRGBsRGB<br>\nsRGBsRGBsRGBsRGBsRGB<br>\nsRGBsRGBsRGBsRGBsRGB<code>pow(value, 2.0)</code>sRGB-&gt;<code>(value, 1/2.2)</code>-&gt;sRGBsRGBsRGB</p>\n<table>\n<thead>\n<tr>\n<th></th>\n<th></th>\n<th></th>\n<th></th>\n<th>R</th>\n<th>F</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>GL_SRGB8</td>\n<td>GL_RGB</td>\n<td>GL_UNSIGNED_BYTE</td>\n<td>8/8/8 SRGB</td>\n<td></td>\n<td>X</td>\n</tr>\n<tr>\n<td>GL_SRGB8_ALPHA8</td>\n<td>GL_RGBA</td>\n<td>GL_UNSIGNED_BYTE</td>\n<td>8/8/8/8 RGBA</td>\n<td>X</td>\n<td>X</td>\n</tr>\n</tbody>\n</table>\n<h3 id=\"\"></h3>\n<p>OpenGL ES 3.0OpenGL ES 3.0</p>\n<table>\n<thead>\n<tr>\n<th></th>\n<th></th>\n<th></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>GL_DEPTH_COMPONENT16</td>\n<td>GL_DEPTH_COMPONENT</td>\n<td>GL_UNSIGNED_SHORT</td>\n</tr>\n<tr>\n<td>GL_DEPTH_COMPONENT16</td>\n<td>GL_DEPTH_COMPONENT</td>\n<td>GL_UNSIGNED_INTp</td>\n</tr>\n<tr>\n<td>GL_DEPTH_COMPONENT24</td>\n<td>GL_DEPTH_COMPONENT</td>\n<td>GL_UNSIGNED_INT</td>\n</tr>\n<tr>\n<td>GL_DEPTH_COMPONENT43F</td>\n<td>GL_DEPTH_COMPONENT</td>\n<td>GL_FLOAT</td>\n</tr>\n<tr>\n<td>GL_DEPTH24_STENCIL8</td>\n<td>GL_DEPTH_STENCIL</td>\n<td>GL_UNSIGNED_INT_24_8</td>\n</tr>\n<tr>\n<td>GL_DEPTH32F_STENCIL8</td>\n<td>GL_DEPTH_STENCIL</td>\n<td>GL_FLOAT_32_UNSIGNED_INT_24_8_REV</td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"\"></h2>\n<p>2D</p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// Vertex shader</span></span><br><span class=\"line\"><span class=\"meta\"># version 300 es</span></span><br><span class=\"line\">layout(location = <span class=\"number\">0</span>) <span class=\"keyword\">in</span> vec4 a_position;</span><br><span class=\"line\">layout(location = <span class=\"number\">1</span>) <span class=\"keyword\">in</span> vec2 a_texCoord;</span><br><span class=\"line\"><span class=\"keyword\">out</span> vec2 v_texCoord;</span><br><span class=\"line\"><span class=\"keyword\">void</span> main()</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    gl_Position = a_position;</span><br><span class=\"line\">    v_texCoord = a_texCoord;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// Fragment shader</span></span><br><span class=\"line\"><span class=\"meta\"># version 300 es</span></span><br><span class=\"line\">precision mediump <span class=\"keyword\">float</span>;</span><br><span class=\"line\"><span class=\"keyword\">in</span> vec2 v_texCoord;</span><br><span class=\"line\">layout(location = <span class=\"number\">0</span>) <span class=\"keyword\">out</span> vec4 outColor;</span><br><span class=\"line\">uniform sampler2D s_texture;</span><br><span class=\"line\"><span class=\"keyword\">void</span> main()</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    outColor = texture(s_texture, v_texCoord);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><code>sampler2D</code><code>s_texture</code>0<code>GL_TEXTURE0</code>1<code>GL_TEXTURE1</code>OpenGL ES 3.0 API<code>glActiveTexture</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param texture#&gt; GL_TEXTURE0, 1, 2 description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glActiveTexture(GLenum texture);</span><br></pre></td></tr></table></figure>\n<p><code>glActiveTexture</code><code>glBindTexture</code>OpenGL ES<code>GL_MAX_TEXTURE_IMAGE_UNITS</code><code>glGetintegerv</code><code>GL_MAX_VERTEX_TEXTURE_IMAGE_UNITS</code><code>glGetintegerv</code></p>\n<p><code>glBindTexture</code><code>glUniformli</code><code>texture</code><code>texture</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> 2D</span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param sampler#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param coord#&gt; 2D description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param bias#&gt; mipmipLOD description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return vec4 </span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">texture(sampler2D sampler, vec2 coord[, <span class=\"keyword\">float</span> bias]);</span><br></pre></td></tr></table></figure>\n<p><code>texture</code><code>vec4</code><code>vec4</code><a href=\"/article/2019/opengl-es-texture-0810/#%E7%BA%B9%E7%90%86%E8%B0%83%E9%85%8D\"></a></p>\n<table>\n<thead>\n<tr>\n<th></th>\n<th></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>GL_RED</td>\n<td>(R, 0.0 0.0, 1.0)</td>\n</tr>\n<tr>\n<td>GL_RG</td>\n<td>(R, G, 0.0, 1.0)</td>\n</tr>\n<tr>\n<td>GL_RGB</td>\n<td>(R, G, B, 1.0)</td>\n</tr>\n<tr>\n<td>GL_RGBA</td>\n<td>(R, G, B, A)</td>\n</tr>\n<tr>\n<td>GL_LUMINANCE</td>\n<td>(L, L, L, 1.0)</td>\n</tr>\n<tr>\n<td>GL_LUMINANCE_ALPHA</td>\n<td>(L, L, L, A)</td>\n</tr>\n<tr>\n<td>GL_ALPHA</td>\n<td>(0.0, 0.0, 0.0, A)</td>\n</tr>\n</tbody>\n</table>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">- (<span class=\"keyword\">void</span>)setupVertices &#123;</span><br><span class=\"line\">    </span><br><span class=\"line\">    GLfloat vertices[] = &#123;</span><br><span class=\"line\">        <span class=\"number\">-1.0</span>, <span class=\"number\">-1.0</span>, <span class=\"number\">0</span>,</span><br><span class=\"line\">        <span class=\"number\">0</span>, <span class=\"number\">0</span>,</span><br><span class=\"line\">        <span class=\"number\">-1.0</span>, <span class=\"number\">1.0</span>, <span class=\"number\">0</span>,</span><br><span class=\"line\">        <span class=\"number\">0</span>, <span class=\"number\">1</span>,</span><br><span class=\"line\">        <span class=\"number\">1.0</span>, <span class=\"number\">-1.0</span>, <span class=\"number\">0</span>,</span><br><span class=\"line\">        <span class=\"number\">1</span>, <span class=\"number\">0</span>,</span><br><span class=\"line\">        <span class=\"number\">1.0</span>, <span class=\"number\">1.0</span>, <span class=\"number\">0</span>,</span><br><span class=\"line\">        <span class=\"number\">1</span>, <span class=\"number\">1</span></span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    GLuint texture = [<span class=\"keyword\">self</span> createTextureWithImage:[<span class=\"built_in\">UIImage</span> imageNamed:<span class=\"string\">@\"9\"</span>]];</span><br><span class=\"line\">    </span><br><span class=\"line\">    GLuint program = [<span class=\"keyword\">self</span> createProgram];</span><br><span class=\"line\">    glUseProgram(program);</span><br><span class=\"line\">    glViewport(<span class=\"number\">0</span>, <span class=\"number\">0</span>, [<span class=\"keyword\">self</span> getViewportWidth], [<span class=\"keyword\">self</span> getViewportHeight]);</span><br><span class=\"line\">    </span><br><span class=\"line\">    glClear(GL_COLOR_BUFFER_BIT);</span><br><span class=\"line\">    glClearColor(<span class=\"number\">0.0</span>, <span class=\"number\">0.0</span>, <span class=\"number\">0.0</span>, <span class=\"number\">1.0</span>);</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    glActiveTexture(GL_TEXTURE0);</span><br><span class=\"line\">    <span class=\"keyword\">int</span> textureLocation = glGetUniformLocation(program, <span class=\"string\">\"s_texture\"</span>);</span><br><span class=\"line\">    glBindTexture(GL_TEXTURE_2D, texture);</span><br><span class=\"line\">    glUniform1i(textureLocation, <span class=\"number\">0</span>);</span><br><span class=\"line\">    </span><br><span class=\"line\">    GLuint vbo;</span><br><span class=\"line\">    glGenBuffers(<span class=\"number\">1</span>, &amp;vbo);</span><br><span class=\"line\">    glBindBuffer(GL_ARRAY_BUFFER, vbo);</span><br><span class=\"line\">    glBufferData(GL_ARRAY_BUFFER, <span class=\"keyword\">sizeof</span>(vertices), vertices, GL_STATIC_DRAW);</span><br><span class=\"line\">    </span><br><span class=\"line\">    glEnableVertexAttribArray(<span class=\"number\">0</span>);</span><br><span class=\"line\">    glVertexAttribPointer(<span class=\"number\">0</span>, <span class=\"number\">3</span>, GL_FLOAT, GL_FALSE, <span class=\"keyword\">sizeof</span>(GLfloat)*<span class=\"number\">5</span>, <span class=\"number\">0</span>);</span><br><span class=\"line\">    glEnableVertexAttribArray(<span class=\"number\">1</span>);</span><br><span class=\"line\">    glVertexAttribPointer(<span class=\"number\">1</span>, <span class=\"number\">2</span>, GL_FLOAT, GL_FALSE, <span class=\"keyword\">sizeof</span>(GLfloat)*<span class=\"number\">5</span>, (GLvoid *)(<span class=\"keyword\">sizeof</span>(GLfloat)*<span class=\"number\">3</span>));</span><br><span class=\"line\">    </span><br><span class=\"line\">    glDrawArrays(GL_TRIANGLE_STRIP, <span class=\"number\">0</span>, <span class=\"number\">4</span>);</span><br><span class=\"line\">    </span><br><span class=\"line\">    [<span class=\"keyword\">self</span>.context presentRenderbuffer:GL_RENDERBUFFER];</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">- (GLuint)createTextureWithImage:(<span class=\"built_in\">UIImage</span> *)image &#123;</span><br><span class=\"line\">    <span class=\"comment\">//  UIImage  CGImageRef</span></span><br><span class=\"line\">    <span class=\"built_in\">CGImageRef</span> cgImageRef = [image <span class=\"built_in\">CGImage</span>];</span><br><span class=\"line\">    GLuint width = (GLuint)<span class=\"built_in\">CGImageGetWidth</span>(cgImageRef);</span><br><span class=\"line\">    GLuint height = (GLuint)<span class=\"built_in\">CGImageGetHeight</span>(cgImageRef);</span><br><span class=\"line\">    <span class=\"built_in\">CGRect</span> rect = <span class=\"built_in\">CGRectMake</span>(<span class=\"number\">0</span>, <span class=\"number\">0</span>, width, height);</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"built_in\">CGColorSpaceRef</span> colorSpace = <span class=\"built_in\">CGColorSpaceCreateDeviceRGB</span>();</span><br><span class=\"line\">    <span class=\"comment\">//  xx4RGBA</span></span><br><span class=\"line\">    <span class=\"keyword\">void</span> *imageData = malloc(width * height * <span class=\"number\">4</span>);</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\">     @param data#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\">     @param width#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\">     @param height#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\">     @param bitsPerComponent#&gt; 32RGBA8 description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\">     @param bytesPerRow#&gt; bit description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\">     @param space#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\">     @param bitmapInfo#&gt; bitmap description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\">     @return </span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"built_in\">CGContextRef</span> context = <span class=\"built_in\">CGBitmapContextCreate</span>(imageData, width, height, <span class=\"number\">8</span>, width * <span class=\"number\">4</span>, colorSpace, kCGImageAlphaPremultipliedLast | kCGBitmapByteOrder32Big);</span><br><span class=\"line\">    <span class=\"comment\">// -</span></span><br><span class=\"line\">    <span class=\"built_in\">CGContextTranslateCTM</span>(context, <span class=\"number\">0</span>, height);</span><br><span class=\"line\">    <span class=\"built_in\">CGContextScaleCTM</span>(context, <span class=\"number\">1.0</span>f, <span class=\"number\">-1.0</span>f);</span><br><span class=\"line\">    <span class=\"built_in\">CGColorSpaceRelease</span>(colorSpace);</span><br><span class=\"line\">    <span class=\"built_in\">CGContextClearRect</span>(context, rect);</span><br><span class=\"line\">    <span class=\"built_in\">CGContextDrawImage</span>(context, rect, cgImageRef);</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    GLuint textureID;</span><br><span class=\"line\">    glGenTextures(<span class=\"number\">1</span>, &amp;textureID);</span><br><span class=\"line\">    glBindTexture(GL_TEXTURE_2D, textureID);</span><br><span class=\"line\">    glTexImage2D(GL_TEXTURE_2D, <span class=\"number\">0</span>, GL_RGBA, width, height, <span class=\"number\">0</span>, GL_RGBA, GL_UNSIGNED_BYTE, imageData); <span class=\"comment\">// </span></span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_WRAP_S, GL_CLAMP_TO_EDGE);</span><br><span class=\"line\">    glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_WRAP_T, GL_CLAMP_TO_EDGE);</span><br><span class=\"line\">    glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_LINEAR);</span><br><span class=\"line\">    glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_LINEAR);</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    glBindTexture(GL_TEXTURE_2D, <span class=\"number\">0</span>);</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"built_in\">CGContextRelease</span>(context);</span><br><span class=\"line\">    free(imageData);</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">return</span> textureID;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"\"></h2>\n<p>2D<code>GL_TEXTURE_CUBE_MAP_POSITIVE_(X|Y|Z)</code><code>GL_TEXTURE_CUBE_NEGATIVE_(X|Y|Z)</code><code>glTexImage2D</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// Vertex shader</span></span><br><span class=\"line\"><span class=\"meta\">#version 300 es</span></span><br><span class=\"line\">layout(location = <span class=\"number\">0</span>) <span class=\"keyword\">in</span> vec4 a_position;</span><br><span class=\"line\">layout(location = <span class=\"number\">1</span>) <span class=\"keyword\">in</span> vec3 a_normal;</span><br><span class=\"line\"><span class=\"keyword\">out</span> vec3 v_normal;</span><br><span class=\"line\"><span class=\"keyword\">void</span> mian()</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    gl_Position = a_position;</span><br><span class=\"line\">    v_normal = a_normal;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// Fragment shader</span></span><br><span class=\"line\"><span class=\"meta\">#version 300 es</span></span><br><span class=\"line\">precision mediump <span class=\"keyword\">float</span>;</span><br><span class=\"line\"><span class=\"keyword\">in</span> vec3 v_normal;</span><br><span class=\"line\">layout(location = <span class=\"number\">0</span>) <span class=\"keyword\">out</span> vec4 outColor;</span><br><span class=\"line\">uniform samplerCube s_texture;</span><br><span class=\"line\"><span class=\"keyword\">void</span> main()</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    outColor = texture(s_texture, v_normal);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><code>texture</code><code>texture</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param sampler#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param coord#&gt; 3D description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param bias#&gt; mipmipLOD description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return vec4 </span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">texture(samplerCube sampler, vec3 coord[, <span class=\"keyword\">float</span> bias]);</span><br></pre></td></tr></table></figure>\n<p>2D32<code>sampleCube</code>2D</p>\n<h2 id=\"3d2d\">3D2D</h2>\n<p>2DOpenGL ES 3.03D2D3D2D<code>glTexImage3D</code><code>glTexImage2D</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> 3D2D</span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param target#&gt; GL_TEXTURE_3DGL_TEXTURE_2D_ARRAY description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param level#&gt; mip0mip description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param internalformat#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param width#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param height#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param depth#&gt; 3D description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param border#&gt; OpenGL ES0 description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param format#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param type#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param pixels#&gt; width*height*depth2D description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glTexImage3D(GLenum target, GLint level, GLint internalformat, GLsizei width, GLsizei height, GLsizei depth, GLint border, GLenum format, GLenum type, <span class=\"keyword\">const</span> GLvoid *pixels);</span><br></pre></td></tr></table></figure>\n<p><code>glTexImage3D</code>3D2D<code>texture</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> 3D</span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param sampler#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param coord#&gt; 3D description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param bias#&gt; mipmipLOD description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return vec4 </span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">texture(sampler3D sampler, vec3 coord[, <span class=\"keyword\">float</span> bias]);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> 2D</span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param sampler#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param coord#&gt; 3D description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param bias#&gt; mipmipLOD description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return vec4 </span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">texture(sampler2DArray sampler, vec3 coord[, <span class=\"keyword\">float</span> bias]);</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>r3D</p>\n</blockquote>\n<h1 id=\"\"></h1>\n<p>OpenGL ES 3.0<br>\nOpenGL ES 2.0OpenGL ES 2.0OpenGL ES 2.0<br>\nOpenGL ES 3.0Ericsson Texture CompressionETC2EACKhronosOpenGL ES 3.0EAC12ETC2342D<code>glCompressedTexImage2D</code>2D<code>glCompressedTexImage3D</code></p>\n<blockquote>\n<p>ETC2/EAC3D2D2D<code>glCompressedTexImage3D</code>3D</p>\n</blockquote>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> 2D</span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param target#&gt; GL_TEXTURE_2DGL_TEXTURE_CUBE_MAP_* description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param level#&gt; mip description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param internalformat#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param width#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param height#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param border#&gt; OpenGL ES0 description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param imageSize#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param data#&gt; imageSize description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glCompressedTexImage2D(GLenum target, GLint level, GLenum internalformat, GLsizei width, GLsizei height, GLint border, GLsizei imageSize, <span class=\"keyword\">const</span> GLvoid *data);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> 2D</span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param target#&gt; GL_TEXTURE_2DGL_TEXTURE_CUBE_MAP_* description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param level#&gt; mip description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param internalformat#&gt; OpenGL ES 3.0 description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param width#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param height#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param border#&gt; OpenGL ES0 description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param imageSize#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param data#&gt; imageSize description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glCompressedTexImage3D(GLenum target, GLint level, GLenum internalformat, GLsizei width, GLsizei height, GLint border, GLsizei imageSize, <span class=\"keyword\">const</span> GLvoid *data);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> 2D3D</span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param target#&gt; GL_TEXTURE_3DGL_TEXTURE_2D_ARRAY description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param level#&gt; mip description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param internalformat#&gt; OpenGL ES 3.0 description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param width#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param height#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param depth#&gt; 2D description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param border#&gt; OpenGL ES0 description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param imageSize#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param data#&gt; imageSize description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glCompressedTexImage3D(GLenum target, GLint level, GLenum internalformat, GLsizei width, GLsizei height, GLsizei depth, GLint border, GLsizei imageSize, <span class=\"keyword\">const</span> GLvoid *data);</span><br></pre></td></tr></table></figure>\n<p>OpenGL ES 3.0ETCETC4x4ETCETCbpp<code>sizeInBytes = max(width, 4) * max(height, 4) * bpp / 8</code></p>\n<table>\n<thead>\n<tr>\n<th></th>\n<th></th>\n<th></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>GL_COMPRESSED_R11_EAC</td>\n<td>4</td>\n<td>GL_RED</td>\n</tr>\n<tr>\n<td>GL_COMPRESSED_SIGNED_R11_EAC</td>\n<td>4</td>\n<td>GL_RED</td>\n</tr>\n<tr>\n<td>GL_COMPRESSED_RG11_EAC</td>\n<td>8</td>\n<td>GL_RG</td>\n</tr>\n<tr>\n<td>GL_COMPRESSED_SIGNED_RG11_EAC</td>\n<td>8</td>\n<td>GL_RG</td>\n</tr>\n<tr>\n<td>GL_COMPRESSED_RGB8_ETC2</td>\n<td>4</td>\n<td>GL_RGB</td>\n</tr>\n<tr>\n<td>GL_COMPRESSED_SRGB8_ETC2</td>\n<td>4</td>\n<td>sRGBGL_RGB</td>\n</tr>\n<tr>\n<td>GL_COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2</td>\n<td>4</td>\n<td>GL_RGBA1alpha</td>\n</tr>\n<tr>\n<td>GL_COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2</td>\n<td>4</td>\n<td>sRGBGL_RGBA1alpha</td>\n</tr>\n<tr>\n<td>GL_COMPRESSED_RGBA8_ETC2_EAC</td>\n<td>8</td>\n<td>GL_RGBA</td>\n</tr>\n<tr>\n<td>GL_COMPRESSED_SRGBA8_ETC2_EAC</td>\n<td>8</td>\n<td>sRGBGL_RGBA</td>\n</tr>\n</tbody>\n</table>\n<p></p>\n<p>OpenGL ES 3.0OpenGL ES 3.0<code>GL_INVALID_ENUM</code>OpenGL ES 3.0<br>\n<code>glGetIntegerv</code><code>GL_NUM_COMPRESSED_TEXTURE_FORMATS</code><code>glGetIntegerv</code><code>GL_COMPRESSED_TEXTURE_FORMATS</code><code>GLenum</code><code>GLenum</code></p>\n<h1 id=\"\"></h1>\n<p><code>glTexImage2D</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> 2D</span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param target#&gt; GL_TEXTURE_2DGL_TEXTURE_CUBE_MAP_* description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param level#&gt; mip description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param xoffset#&gt; x description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param yoffset#&gt; y description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param width#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param height#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param format#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param type#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param pixels#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glTexSubImage2D(GLenum target, GLint level, GLint xoffset, GLint yoffset, GLsizei width, GLsizei height, GLenum format, GLenum type, <span class=\"keyword\">const</span> GLvoid *pixels);</span><br></pre></td></tr></table></figure>\n<p>(xoffset, yoffset)(xoffset+width-1, yoffset+height-1)<code>pixels</code><code>glPixelStorei</code><code>GL_UNPACK_ALIGNMENT</code></p>\n<p>2D</p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> 2D</span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param target#&gt; GL_TEXTURE_2DGL_TEXTURE_CUBE_MAP_* description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param level#&gt; mip description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param xoffset#&gt; x description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param yoffset#&gt; y description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param width#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param height#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param format#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param imageSize#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param data#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glCompressedTexSubImage2D(GLenum target, GLint level, GLint xoffset, GLint yoffset, GLsizei width, GLsizei height, GLenum format, GLsizei imageSize, <span class=\"keyword\">const</span> GLvoid *data);</span><br></pre></td></tr></table></figure>\n<p>2D<code>glTexSubImage3D</code>3D2D</p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> 3D</span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param target#&gt; GL_TEXTURE_3DGL_TEXTURE_2D_ARRAY description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param level#&gt; mip description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param xoffset#&gt; x description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param yoffset#&gt; y description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param zoffset#&gt; z description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param width#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param height#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param depth#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param format#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param type#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param pixels#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glTexSubImage3D(GLenum target, GLint level, GLint xoffset, GLint yoffset, GLint zoffset, GLsizei width, GLsizei height, GLsizei depth, GLenum format, GLenum type, <span class=\"keyword\">const</span> GLvoid *pixels);</span><br></pre></td></tr></table></figure>\n<p><code>glTexSubImage3D</code><code>glTexSubImage2D</code><code>zoffset</code><code>depth</code>2D<code>glCompressedTexSubImage3D</code>3D3DETC2/EAC2D2D</p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> 3D</span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param target#&gt; GL_TEXTURE_3DGL_TEXTURE_2D_ARRAY description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param level#&gt; mip description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param xoffset#&gt; x description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param yoffset#&gt; y description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param zoffset#&gt; z description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param width#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param height#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param depth#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param format#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param imageSize#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param data#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glCompressedTexSubImage3D(GLenum target, GLint level, GLint xoffset, GLint yoffset, GLint zoffset, GLsizei width, GLsizei height, GLsizei depth, GLenum format, GLsizei imageSize, <span class=\"keyword\">const</span> GLvoid *data);</span><br></pre></td></tr></table></figure>\n<h1 id=\"\"></h1>\n<p>OpenGL ES 3.0-</p>\n<p><code>glReadBuffer</code>EGL<code>glReadBuffer</code><code>GL_BACK</code>OpenGL ES 3.0EGLOpenGL ES 3.0<code>eglSwapBuffers</code>EGLEGL pbufferpbuffer<code>GL_COLOR_ATTACHMENTi</code><code>glReadBuffer</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param mode#&gt; glReadPixelsglCopyTexImage2DglCopyTexSubImage2DglCopyTexSubImage3DGL_BACKGL_COLOR_ATTACHMENTiGL_NONE description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glReadBuffer(GLenum mode);</span><br></pre></td></tr></table></figure>\n<p><code>glCopyTexImage2D</code><code>glCopyTexSubImage2D</code><code>glCopyTexSubImage3D</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> 2D</span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param target#&gt; GL_TEXTURE_CUBE_MAP_2DGL_TEXTURE_CUBE_MAP_* description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param level#&gt; mip description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param internalformat#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param x#&gt; x description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param y#&gt; y description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param width#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param height#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param border#&gt; OpenGL ES 3.00 description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glCopyTexImage2D(GLenum target, GLint level, GLenum internalformat, GLint x, GLint y, GLsizei width, GLsizei height, GLint border);</span><br></pre></td></tr></table></figure>\n<p>(x, y)(x+width-1, y+height-1)<br>\n<code>glCopyTexSubImage2D</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> 2D</span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param target#&gt; GL_TEXTURE_2DGL_TEXTURE_CUBE_MAP_* description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param level#&gt; mip description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param xoffset#&gt; x description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param yoffset#&gt; y description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param x#&gt; x description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param y#&gt; y description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param width#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param height#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glCopyTexSubImage2D(GLenum target, GLint level, GLint xoffset, GLint yoffset, GLint x, GLint y, GLsizei width, GLsizei height);</span><br></pre></td></tr></table></figure>\n<p>(x, y)(x+width-1, y+height-1)(xoffset, yoffset)(xoffset+width-1, yoffset+height-1)<br>\n<code>glCopyTexSubImage3D</code>3D2D</p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> 3D2D</span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param target#&gt; GL_TEXTURE_3DGL_TEXTURE_2D_ARRAY description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param level#&gt; mip description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param xoffset#&gt; x description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param yoffset#&gt; y description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param zoffset#&gt; z description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param x#&gt; x description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param y#&gt; y description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param width#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param height#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glCopyTexSubImage3D(GLenum target, GLint level, GLint xoffset, GLint yoffset, GLint zoffset, GLint x, GLint y, GLsizei width, GLsizei height);</span><br></pre></td></tr></table></figure>\n<p></p>\n<h1 id=\"\"></h1>\n<p><code>glTexParameter[i|f][v]</code>LOD<code>glTexParameter[i|f][v]</code>API<code>glTexParameter[i|f][v]</code>OpenGL ES 3.0<code>glTexParameter[i|f][v]</code>API</p>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param count#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param samplers#&gt; nID description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glGenSamplers(GLsizei count, GLuint *samplers);</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param count#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param samplers#&gt; nID description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glDeleteSamplers(GLsizei count, <span class=\"keyword\">const</span> GLuint *samplers);</span><br></pre></td></tr></table></figure>\n<p>ID<code>glTexParameter[i|f][v]</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param unit#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param sampler#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glBindSampler(GLuint unit, GLuint sampler);</span><br></pre></td></tr></table></figure>\n<p><code>glBindSampler</code><code>sampler</code>0<code>glSampler[f|i][v]</code><code>glSamplerParameter[f|i][v]</code><code>glTexParameter[i|f][v]</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">glSamplerParameteri(GLuint sampler, GLenum pname, GLint param);</span><br><span class=\"line\">glSamplerParameteriv(GLuint sampler, GLenum pname, <span class=\"keyword\">const</span> GLint *param);</span><br><span class=\"line\">glSamplerParameterf(GLuint sampler, GLenum pname, GLfloat param);</span><br><span class=\"line\">glSamplerParameterfv(GLuint sampler, GLenum pname, <span class=\"keyword\">const</span> GLfloat *param);</span><br></pre></td></tr></table></figure>\n<h1 id=\"\"></h1>\n<p>OpenGL ES 3.0<code>glTexImage2D</code><code>glTexImage3D</code>mipOpenGL ESmip</p>\n<p>OpenGL ES<code>glTexSubImage2D</code><code>glTexSubImage3D</code><code>glGenerateMipMap</code><br>\n<code>glBindTexture</code><code>glTexStorage2D</code><code>glTexStorage3D</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param target#&gt; GL_TEXTURE_2DGL_TEXTURE_CUBE_MAP_*GL_TEXTURE_3DGL_TEXTURE_2D_ARRAY description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param levels#&gt; mip description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param internalformat#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param width#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param height#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glTexStorage2D/<span class=\"number\">3</span>D(GLenum target, GLsizei levels, GLenum internalformat, GLsizei width, GLsizei height);</span><br></pre></td></tr></table></figure>\n<p><code>glTexImage*</code><code>glCompressedTexImage*</code><code>glCopyTexImage*</code><code>glTexStorage*</code><code>GL_INVALID_OPERATION</code><code>glTexSubImage2D</code><code>glTexSubImage3D</code><code>glGenerateMipMap</code><br>\n<code>glTexStorage*</code>OpenGL ES<code>GL_TEXTURE_IMMUTABLE_FORMAT</code><code>GL_TRUE</code><code>GL_TEXTURE_IMMUTABLE_LEVELS</code><code>glTexStorage*</code><code>glGetTexParameter[i|f][v]</code><code>glTexStorage*</code></p>\n<h1 id=\"\"></h1>\n<p>GPUCPUGPUOpenGL ES 3.0<code>GL_PIXEL_UNPACK_BUFFER</code><code>glTexImage*</code><code>glTexSubImage*</code><code>glCompressedTexImage*</code><code>glCompressedTexSubImage*</code><code>glVertexAttribPointer</code>VBO<br>\nGPUOpenGL<code>glTexSubImage*</code>GPU/</p>\n<h1 id=\"\"></h1>\n<p>OpenGL ES 3.0</p>\n","site":{"data":{}},"excerpt":"","more":"<blockquote>\n<p>OpenGL ES 3.0</p>\n</blockquote>\n<h1></h1>\n<p>3DOpenGL ES 3.02D2D3D<br>\n</p>\n<h2>2D</h2>\n<p>2DOpenGL ESTexeltexture pixelsOpenGL ES</p>\n<table>\n<thead>\n<tr>\n<th></th>\n<th></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>GL_RED</td>\n<td>()</td>\n</tr>\n<tr>\n<td>GL_RG</td>\n<td>()</td>\n</tr>\n<tr>\n<td>GL_RGB</td>\n<td>()</td>\n</tr>\n<tr>\n<td>GL_RGBA</td>\n<td>(Alpha)</td>\n</tr>\n<tr>\n<td>GL_LUMINANCE</td>\n<td>()</td>\n</tr>\n<tr>\n<td>GL_LUMINANCE_ALPHA</td>\n<td>(Alpha)</td>\n</tr>\n<tr>\n<td>GL_ALPHA</td>\n<td>(Alpha)</td>\n</tr>\n<tr>\n<td>GL_DEPTH_COMPONENT</td>\n<td>()</td>\n</tr>\n<tr>\n<td>GL_DEPTH_STENCIL</td>\n<td>()</td>\n</tr>\n<tr>\n<td>GL_RED_INTEGER</td>\n<td>()</td>\n</tr>\n<tr>\n<td>GL_RG_INTEGER</td>\n<td>()</td>\n</tr>\n<tr>\n<td>GL_RGB_INTEGER</td>\n<td>()</td>\n</tr>\n<tr>\n<td>GL_RGBA_INTERGER</td>\n<td>(Alpha)</td>\n</tr>\n</tbody>\n</table>\n<p>2D3D2D2D(s, t)(u, v)</p>\n<p><img src=\"/img/article/20190810/1.png\" alt=\"2D\"></p>\n<p><code>st</code>(0.0, 0.0)<code>st</code>(1.0, 1.0)[0.0, 1.0]</p>\n<h2></h2>\n<p>2DOpenGL ES 3.062D3D6(+X, -X, +Y, -Y, +Z, -Z)<br>\n3D(s, t, r)(s, t, r)3D(x, y, z)3D2D(s, t)3D</p>\n<p><img src=\"/img/article/20190810/2.png\" alt=\"3D\"></p>\n<p>2D3D2D</p>\n<h2>3D</h2>\n<p>OpenGL ES 3.03D3D2D3(s, t, r)3Dr3D(s, t)2D3D2D3Dmip</p>\n<p><img src=\"/img/article/20190810/3.png\" alt=\"3D\"></p>\n<h2>2D</h2>\n<p>OpenGL ES 3.02D2D3D2D2D2D3D3D2Dmip2Dmip2Dmip3D3Dmip</p>\n<p>2D3D(s, t, r)r2D(s, t)2D</p>\n<h2></h2>\n<p>OpenGL ES<code>glGenTextures</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param n#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param textures#&gt; nID description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glGenTextures(GLsizei n, GLuint *textures);</span><br></pre></td></tr></table></figure>\n<p><code>glGenTextures</code><code>glDeleteTextures</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param n#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param textures#&gt; nID description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glDeleteTextures(GLsizei n, <span class=\"keyword\">const</span> GLuint *textures);</span><br></pre></td></tr></table></figure>\n<p><code>glGenTextures</code>ID(<code>glTexImage2D</code><code>glTexParameter</code>)<code>glBindTexture</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param target#&gt; GL_TEXTURE_2DGL_TEXTURE_3DGL_TEXTURE_2D_ARRAYGL_TEXTURE_CUBE_MAP description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param texture#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glBindTexture(GLenum target, GLuint texture);</span><br></pre></td></tr></table></figure>\n<p>2D<code>glTexImage2D</code>OpenGL ES 3.02D(<code>glTexStorage2D</code>)<code>glTexSubImage2D</code><code>glTexImage2D</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> 2D</span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param target#&gt; GL_TEXTURE_2DGL_TEXTURE_CUBE_MAP_POSITIVE_(X, Y, Z)GL_TEXTURE_CUBE_MAP_NEGATIVE_(X, Y, Z) description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param level#&gt; mip0mip description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param internalformat#&gt; GL_RGBAGL_RGBGL_LUMINANCE_ALPHAGL_LUMINANCEGL_ALPHAGL_RGBGL_DEPTH_COMPONENT16 description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param width#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param height#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param border#&gt; OpenGL ESOpenGL0 description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param format#&gt; GL_RED(_INTEGER)GL_RG(_INTEGER)GL_RGB(_INTERGER)GL_RGBA(_INTEGER)GL_DEPTH_COMPONENTGL_DEPTH_STENCILGL_LUMINANCE_ALPHAGL_ALPHA description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param type#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param pixels#&gt; width*height*`glPixelStorei`GL_UNPACK_ALIGHMENT description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glTexImage2D(GLenum target, GLint level, GLint internalformat, GLsizei width, GLsizei height, GLint border, GLenum format, GLenum type, <span class=\"keyword\">const</span> GLvoid *pixels);</span><br></pre></td></tr></table></figure>\n<p>RGB 2x2 2D</p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">GLuint textureId;</span><br><span class=\"line\">GLubyte pixels[] = &#123;</span><br><span class=\"line\">    <span class=\"number\">255</span>, <span class=\"number\">0</span>, <span class=\"number\">0</span>,</span><br><span class=\"line\">    <span class=\"number\">0</span>, <span class=\"number\">255</span>, <span class=\"number\">0</span>,</span><br><span class=\"line\">    <span class=\"number\">0</span>, <span class=\"number\">0</span>, <span class=\"number\">255</span>,</span><br><span class=\"line\">    <span class=\"number\">255</span>, <span class=\"number\">255</span>, <span class=\"number\">0</span></span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// User tightly packed data</span></span><br><span class=\"line\">glPixelStorei(GL_UNPACK_ALIGNMENT, <span class=\"number\">1</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// Generate a texture object</span></span><br><span class=\"line\">glGenTextures(<span class=\"number\">1</span>, &amp;textureId);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// Bind the texture object</span></span><br><span class=\"line\">glBindTexture(GL_TEXTURE_2D, textureId);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// Load the texture</span></span><br><span class=\"line\">glTexImage2D(GL_TEXTURE_2D, <span class=\"number\">0</span>, GL_RGB, <span class=\"number\">2</span>, <span class=\"number\">2</span>, <span class=\"number\">0</span>, GL_RGB, GL_UNSIGNED_BYTE, pixels);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// Set the filtering mode</span></span><br><span class=\"line\">glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_NEAREST);</span><br><span class=\"line\">glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_NEAREST);</span><br></pre></td></tr></table></figure>\n<p><code>pixels</code>2x2RGB[0, 255]8[0, 255][0.0, 1.0]<br>\n<code>glTexImage2D</code><code>glPixelStorei</code><code>glTexImage2D</code><code>GL_UNPACK_ALIGNMENT</code>44<br>\n1</p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param pname#&gt; glTexImage2DglTexImage3DglTexSubImage2DglTexSubImage3DGL_UNPACK_ROW_LENGTHGL_UNPACK_IMAGE_HEIGHTGL_UNPACK_SKIP_PIXELSGL_UNPACK_SKIP_ROWSGL_UNPACK_SKIP_IMAGESGL_UNPACK_ALIGNMENTglReadPixelsGL_PACK_ROW_LENGTHGL_PACK_IMAGE_HEIGHTGL_PACK_SKIP_PIXELSGL_PACK_SKIP_ROWSGL_PACK_SKIP_IMAGESGL_PACK_ALIGNMENT description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param param#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glPixelStorei(GLenum pname, GLint param);</span><br></pre></td></tr></table></figure>\n<p><code>glPixelStorei</code><code>GL_PACK_xxxx</code><code>glReadPixels</code><code>glPixelStorei</code><code>GL_UNPACK_ALIGNMENT</code></p>\n<table>\n<thead>\n<tr>\n<th></th>\n<th></th>\n<th></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>GL_UNPACK_ALIGNMENT GL_PACK_ALIGNMENT</td>\n<td>4</td>\n<td>41</td>\n</tr>\n<tr>\n<td>GL_UNPACK_ROW_LENGTH GL_PACK_ROW_LENGTH</td>\n<td>0</td>\n<td>00</td>\n</tr>\n<tr>\n<td>GL_UNPACK_IMAGE_HEIGHT GL_PACK_IMAGE_HEIGHT</td>\n<td>0</td>\n<td>03D3D0</td>\n</tr>\n<tr>\n<td>GL_UNPACK_SKIP_PIXELS GL_PACK_SKIP_PIXELS</td>\n<td>0</td>\n<td>0</td>\n</tr>\n<tr>\n<td>GL_UNPACK_SKIP_ROWS GL_PACK_SKIP_ROWS</td>\n<td>0</td>\n<td>0</td>\n</tr>\n<tr>\n<td>GL_UNPACK_SKIP_IMAGES GL_PACK_SKIP_IMAGES</td>\n<td>0</td>\n<td>03D</td>\n</tr>\n</tbody>\n</table>\n<p><code>glTexParameteri</code><code>GL_NEAREST</code>mipmip<code>GL_LINEAR</code>mip</p>\n<h2>mip</h2>\n<p>2D2DOpenGL ES2D<code>GL_NEAREST</code><br>\nOpenGL ESmipmipmappingmipmipmip1x1mipmip4<br>\n<a href=\"https://github.com/danginsburg/opengles3-book/blob/master/Chapter_9/MipMap2D/MipMap2D.c\" target=\"_blank\" rel=\"noopener\">GenMipMap2D</a>mipRGB8mipmip<code>glTexImage2D</code><br>\nmipmipmip</p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">glTexImage2D(GL_TEXTURE_2D, <span class=\"number\">0</span>, GL_RGB, width, height, <span class=\"number\">0</span>, GL_RGB, GL_UNSIGNED_BYTE, pixels);</span><br><span class=\"line\"><span class=\"keyword\">int</span> level = <span class=\"number\">1</span>;</span><br><span class=\"line\">GLubyte *prevImage = &amp;pixels[<span class=\"number\">0</span>];</span><br><span class=\"line\">GLubyte *newImage;</span><br><span class=\"line\"><span class=\"keyword\">while</span> (width &gt; <span class=\"number\">1</span> &amp;&amp; height &gt; <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> newWidth, newHeight;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">// Generate the next mipmap level</span></span><br><span class=\"line\">    GenMipMap2D(prevImage, &amp;newImage, width, height, &amp;newWidth, &amp;newHeight);</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">// Load the mipmap level</span></span><br><span class=\"line\">    glTexImage2D(GL_TEXTURE_2D, level, GL_RGB, newWidth, newHeight, <span class=\"number\">0</span>, GL_RGB, GL_UNSIGNED_BYTE, newImage);</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">// Free the previous image</span></span><br><span class=\"line\">    free(prevImage);</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">// Set the previous image for the next iteration</span></span><br><span class=\"line\">    prevImage = newImage;</span><br><span class=\"line\">    level += <span class=\"number\">1</span>;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">// Half the width and height</span></span><br><span class=\"line\">    width = newWidth;</span><br><span class=\"line\">    height = newHeight;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">free(newImage);</span><br></pre></td></tr></table></figure>\n<p>APImip<br>\n<code>glTexParameter[i|f][v]</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">glTexParameteri(GLenum target, GLenum pname, GLint param)</span><br><span class=\"line\">glTexParameteriv(GLenum target, GLenum pname, <span class=\"keyword\">const</span> GLint *params);</span><br><span class=\"line\">glTexParameterf(GLenum target, GLenum pname, GLfloat param);</span><br><span class=\"line\">glTexParameterfv(GLenum target, GLenum pname, <span class=\"keyword\">const</span> GLfloat *params);</span><br></pre></td></tr></table></figure>\n<p><code>pname</code><code>GL_TEXTURE_MAG_FILTER</code><code>param</code><code>GL_NEAREST</code><code>GL_LINEAR</code><code>GL_NEAREST</code><code>GL_LINEAR</code>4<br>\n<code>pname</code><code>GL_TEXTURE_MIN_FILTER</code><code>param</code></p>\n<ul>\n<li><code>GL_NEAREST</code>  </li>\n<li><code>GL_LINEAR</code>  </li>\n<li><code>GL_NEAREST_MIPMAP_NEAREST</code>  mip</li>\n<li><code>GL_NEAREST_MIPMAP_LINEAR</code>  mip</li>\n<li><code>GL_LINEAR_MIPMAP_NEAREST</code>  mip</li>\n<li><code>GL_LINEAR_MIPMAP_LINEAR</code>  mip</li>\n</ul>\n<blockquote>\n<p><code>GL_NEAREST</code><code>GL_LINEAR</code>mipmip</p>\n</blockquote>\n<p>mipmip</p>\n<h3></h3>\n<p>OpenGL ES 3.0OpenGL ES 2.0OpenGL ES 3.0OpenGL ES 3.0</p>\n<h2>mip</h2>\n<p>mipOpenGL ES 3.0<code>glGenerateMipmap</code>mip</p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> mip</span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param target#&gt; mipGL_TEXTURE_2DGL_TEXTURE_3DGL_TEXTURE_2D_ARRAYGL_TEXTURE_CUBE_MAP description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glGenerateMipmap(GLenum target);</span><br></pre></td></tr></table></figure>\n<p><code>glGenerateMipmap</code>0mip2D0002D2D3Dmip<br>\nOpenGL ES 3.0mipmip<br>\nmipCPUmip<code>glGenerateMipmap</code>CPUmip</p>\n<h2></h2>\n<p>[0.0, 1.0]<code>glTexParameter[i|f][v]</code>str<code>GL_TEXTURE_WRAP_S</code>s[0.0, 1.0]<code>GL_TEXTURE_WRAP_T</code>t<code>GL_TEXTURE_WRAP_R</code>rr3D2DOpenGL ES</p>\n<table>\n<thead>\n<tr>\n<th></th>\n<th></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>GL_REPEAT</td>\n<td></td>\n</tr>\n<tr>\n<td>GL_CLAMP_TO_EDGE</td>\n<td></td>\n</tr>\n<tr>\n<td>GL_MIRRORED_REPEAT</td>\n<td></td>\n</tr>\n</tbody>\n</table>\n<p><code>GL_CLAMP_TO_DEGE</code></p>\n<h2></h2>\n<p>SwizzleRRGRGBRGBA<code>GL_RED</code>(0, 0, 0, R)(R, R, R, 1)(R, 0, 0, 1)RGBA<code>glTexParameter[i|f][v]</code><code>GL_TEXTURE_SWIZZLE_R</code><code>GL_TEXTURE_SWIZZLE_G</code><code>GL_TEXTURE_SWIZZLE_B</code><code>GL_TEXTURE_SWIZZLE_A</code>RGBA<code>GL_RED</code><code>GL_GREEN</code><code>GL_BLUE</code><code>GL_ALPHA</code><code>GL_ZERO</code><code>GL_ONE</code>01</p>\n<h2></h2>\n<p>mipGPSmipOpenGL ES 3.0<code>glTexParameter[i|f][v]</code><code>GL_TEXTURE_BASE_LEVEL</code>mip0mip<code>GL_TEXTURE_MAX_LEVEL</code>mip1000mip<br>\nmipOpenGL ESLODmipmip<code>GL_TEXTURE_MIN_LOD</code><code>GL_TEXTURE_MAX_LOD</code>LODmipLODmipmipLOD</p>\n<h2></h2>\n<p><code>GL_TEXTURE_COMPARE_FUNC</code><code>GL_TEXTURE_COMPARE_MODE</code>PCFPCF01<br>\n<code>GL_TEXTURE_COMPARE_MODE</code><code>GL_NONE</code><code>GL_COMPARE_REF_TO_TEXTURE</code>(s, t, r)r91<code>GL_TEXTURE_COMPARE_FUNC</code><code>GL_LEQUAL</code><code>GL_GEQUAL</code><code>GL_LESS</code><code>GL_GREATER</code><code>GL_EQUAL</code><code>GL_NOTEQUAL</code><code>GL_ALWAYS</code><code>GL_NEVER</code></p>\n<h2></h2>\n<p>OpenGL ES 3.0OpenGL ES 2.0<br>\n2D<code>glTexImage2D</code>OpenGL ESOpenGL ES</p>\n<p><code>glTexImage2D</code></p>\n<table>\n<thead>\n<tr>\n<th></th>\n<th></th>\n<th></th>\n<th></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>GL_RGB</td>\n<td>GL_RGB</td>\n<td>GL_UNSIGNED_BYTE</td>\n<td>8/8/8 RGB 24- </td>\n</tr>\n<tr>\n<td>GL_RGB</td>\n<td>GL_RGB</td>\n<td>GL_UNSIGNED_SHORT_5_6_5</td>\n<td>5/6/5 RGB 16- </td>\n</tr>\n<tr>\n<td>GL_RGBA</td>\n<td>GL_RGBA</td>\n<td>GL_UNSIGNED_BYTE</td>\n<td>8/8/8/8 RGBA 32- </td>\n</tr>\n<tr>\n<td>GL_RGBA</td>\n<td>GL_RGBA</td>\n<td>GL_UNSIGNED_SHORT_4_4_4_4</td>\n<td>4/4/4/4 RGBA 16- </td>\n</tr>\n<tr>\n<td>GL_RGBA</td>\n<td>GL_RGBA</td>\n<td>GL_UNSIGNED_SHORT_5_5_5_1</td>\n<td>5/5/5/1 RGBA 16- </td>\n</tr>\n<tr>\n<td>GL_LUMINANCE_ALPHA</td>\n<td>GL_LUMINANCE_ALPHA</td>\n<td>GL_UNSIGNED_BYTE</td>\n<td>8/8 LA 16- </td>\n</tr>\n<tr>\n<td>GL_LUMINANCE</td>\n<td>GL_LUMINANCE</td>\n<td>GL_UNSIGNED_BYTE</td>\n<td>8L 8- </td>\n</tr>\n<tr>\n<td>GL_ALPHA</td>\n<td>GL_ALPHA</td>\n<td>GL_UNSIGNED_BYTE</td>\n<td>8A 8- </td>\n</tr>\n</tbody>\n</table>\n<p></p>\n<h3></h3>\n<p>[0.0, 1.0]*_SNORM[-1.0, 1.0]<code>GL_UNSIGNED_BYTE</code><code>GL_R8</code>8([0, 255])[0.0, 1.0]<code>GL_BYTE</code><code>GL_R8_SNORM</code>8[-128, 127][-1.0, 1.0]</p>\n<p><img src=\"/img/article/20190810/4.png\" alt=\"glTexImage2D\"></p>\n<h3></h3>\n<p>OpenGL ES 3.01632RRGRGBRGBA1~4OpenGL ES 3.016</p>\n<p><img src=\"/img/article/20190810/5.png\" alt=\"glTexImage2D\"></p>\n<h3></h3>\n<p><br>\nRRGRGBAcolor attachmentAlpha</p>\n<p><img src=\"/img/article/20190810/6.png\" alt=\"glTexImage2D\"><br>\n<img src=\"/img/article/20190810/7.png\" alt=\"glTexImage2D\"></p>\n<h3></h3>\n<p>RGBHDROpenGL ES 3.0<code>GL_RGB9_E5</code>3RGB5515RGB9</p>\n<p><img src=\"/img/article/20190810/8.png\" alt=\"\"></p>\n<h3>sRGB</h3>\n<p>OpenGL ES 3.0sRGBsRGBsRGB<br>\nsRGBsRGBsRGBsRGBsRGB<br>\nsRGBsRGBsRGBsRGBsRGB<code>pow(value, 2.0)</code>sRGB-&gt;<code>(value, 1/2.2)</code>-&gt;sRGBsRGBsRGB</p>\n<table>\n<thead>\n<tr>\n<th></th>\n<th></th>\n<th></th>\n<th></th>\n<th>R</th>\n<th>F</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>GL_SRGB8</td>\n<td>GL_RGB</td>\n<td>GL_UNSIGNED_BYTE</td>\n<td>8/8/8 SRGB</td>\n<td></td>\n<td>X</td>\n</tr>\n<tr>\n<td>GL_SRGB8_ALPHA8</td>\n<td>GL_RGBA</td>\n<td>GL_UNSIGNED_BYTE</td>\n<td>8/8/8/8 RGBA</td>\n<td>X</td>\n<td>X</td>\n</tr>\n</tbody>\n</table>\n<h3></h3>\n<p>OpenGL ES 3.0OpenGL ES 3.0</p>\n<table>\n<thead>\n<tr>\n<th></th>\n<th></th>\n<th></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>GL_DEPTH_COMPONENT16</td>\n<td>GL_DEPTH_COMPONENT</td>\n<td>GL_UNSIGNED_SHORT</td>\n</tr>\n<tr>\n<td>GL_DEPTH_COMPONENT16</td>\n<td>GL_DEPTH_COMPONENT</td>\n<td>GL_UNSIGNED_INTp</td>\n</tr>\n<tr>\n<td>GL_DEPTH_COMPONENT24</td>\n<td>GL_DEPTH_COMPONENT</td>\n<td>GL_UNSIGNED_INT</td>\n</tr>\n<tr>\n<td>GL_DEPTH_COMPONENT43F</td>\n<td>GL_DEPTH_COMPONENT</td>\n<td>GL_FLOAT</td>\n</tr>\n<tr>\n<td>GL_DEPTH24_STENCIL8</td>\n<td>GL_DEPTH_STENCIL</td>\n<td>GL_UNSIGNED_INT_24_8</td>\n</tr>\n<tr>\n<td>GL_DEPTH32F_STENCIL8</td>\n<td>GL_DEPTH_STENCIL</td>\n<td>GL_FLOAT_32_UNSIGNED_INT_24_8_REV</td>\n</tr>\n</tbody>\n</table>\n<h2></h2>\n<p>2D</p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// Vertex shader</span></span><br><span class=\"line\"><span class=\"meta\"># version 300 es</span></span><br><span class=\"line\">layout(location = <span class=\"number\">0</span>) <span class=\"keyword\">in</span> vec4 a_position;</span><br><span class=\"line\">layout(location = <span class=\"number\">1</span>) <span class=\"keyword\">in</span> vec2 a_texCoord;</span><br><span class=\"line\"><span class=\"keyword\">out</span> vec2 v_texCoord;</span><br><span class=\"line\"><span class=\"keyword\">void</span> main()</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    gl_Position = a_position;</span><br><span class=\"line\">    v_texCoord = a_texCoord;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// Fragment shader</span></span><br><span class=\"line\"><span class=\"meta\"># version 300 es</span></span><br><span class=\"line\">precision mediump <span class=\"keyword\">float</span>;</span><br><span class=\"line\"><span class=\"keyword\">in</span> vec2 v_texCoord;</span><br><span class=\"line\">layout(location = <span class=\"number\">0</span>) <span class=\"keyword\">out</span> vec4 outColor;</span><br><span class=\"line\">uniform sampler2D s_texture;</span><br><span class=\"line\"><span class=\"keyword\">void</span> main()</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    outColor = texture(s_texture, v_texCoord);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><code>sampler2D</code><code>s_texture</code>0<code>GL_TEXTURE0</code>1<code>GL_TEXTURE1</code>OpenGL ES 3.0 API<code>glActiveTexture</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param texture#&gt; GL_TEXTURE0, 1, 2 description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glActiveTexture(GLenum texture);</span><br></pre></td></tr></table></figure>\n<p><code>glActiveTexture</code><code>glBindTexture</code>OpenGL ES<code>GL_MAX_TEXTURE_IMAGE_UNITS</code><code>glGetintegerv</code><code>GL_MAX_VERTEX_TEXTURE_IMAGE_UNITS</code><code>glGetintegerv</code></p>\n<p><code>glBindTexture</code><code>glUniformli</code><code>texture</code><code>texture</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> 2D</span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param sampler#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param coord#&gt; 2D description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param bias#&gt; mipmipLOD description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return vec4 </span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">texture(sampler2D sampler, vec2 coord[, <span class=\"keyword\">float</span> bias]);</span><br></pre></td></tr></table></figure>\n<p><code>texture</code><code>vec4</code><code>vec4</code><a href=\"/article/2019/opengl-es-texture-0810/#%E7%BA%B9%E7%90%86%E8%B0%83%E9%85%8D\"></a></p>\n<table>\n<thead>\n<tr>\n<th></th>\n<th></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>GL_RED</td>\n<td>(R, 0.0 0.0, 1.0)</td>\n</tr>\n<tr>\n<td>GL_RG</td>\n<td>(R, G, 0.0, 1.0)</td>\n</tr>\n<tr>\n<td>GL_RGB</td>\n<td>(R, G, B, 1.0)</td>\n</tr>\n<tr>\n<td>GL_RGBA</td>\n<td>(R, G, B, A)</td>\n</tr>\n<tr>\n<td>GL_LUMINANCE</td>\n<td>(L, L, L, 1.0)</td>\n</tr>\n<tr>\n<td>GL_LUMINANCE_ALPHA</td>\n<td>(L, L, L, A)</td>\n</tr>\n<tr>\n<td>GL_ALPHA</td>\n<td>(0.0, 0.0, 0.0, A)</td>\n</tr>\n</tbody>\n</table>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">- (<span class=\"keyword\">void</span>)setupVertices &#123;</span><br><span class=\"line\">    </span><br><span class=\"line\">    GLfloat vertices[] = &#123;</span><br><span class=\"line\">        <span class=\"number\">-1.0</span>, <span class=\"number\">-1.0</span>, <span class=\"number\">0</span>,</span><br><span class=\"line\">        <span class=\"number\">0</span>, <span class=\"number\">0</span>,</span><br><span class=\"line\">        <span class=\"number\">-1.0</span>, <span class=\"number\">1.0</span>, <span class=\"number\">0</span>,</span><br><span class=\"line\">        <span class=\"number\">0</span>, <span class=\"number\">1</span>,</span><br><span class=\"line\">        <span class=\"number\">1.0</span>, <span class=\"number\">-1.0</span>, <span class=\"number\">0</span>,</span><br><span class=\"line\">        <span class=\"number\">1</span>, <span class=\"number\">0</span>,</span><br><span class=\"line\">        <span class=\"number\">1.0</span>, <span class=\"number\">1.0</span>, <span class=\"number\">0</span>,</span><br><span class=\"line\">        <span class=\"number\">1</span>, <span class=\"number\">1</span></span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    GLuint texture = [<span class=\"keyword\">self</span> createTextureWithImage:[<span class=\"built_in\">UIImage</span> imageNamed:<span class=\"string\">@\"9\"</span>]];</span><br><span class=\"line\">    </span><br><span class=\"line\">    GLuint program = [<span class=\"keyword\">self</span> createProgram];</span><br><span class=\"line\">    glUseProgram(program);</span><br><span class=\"line\">    glViewport(<span class=\"number\">0</span>, <span class=\"number\">0</span>, [<span class=\"keyword\">self</span> getViewportWidth], [<span class=\"keyword\">self</span> getViewportHeight]);</span><br><span class=\"line\">    </span><br><span class=\"line\">    glClear(GL_COLOR_BUFFER_BIT);</span><br><span class=\"line\">    glClearColor(<span class=\"number\">0.0</span>, <span class=\"number\">0.0</span>, <span class=\"number\">0.0</span>, <span class=\"number\">1.0</span>);</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    glActiveTexture(GL_TEXTURE0);</span><br><span class=\"line\">    <span class=\"keyword\">int</span> textureLocation = glGetUniformLocation(program, <span class=\"string\">\"s_texture\"</span>);</span><br><span class=\"line\">    glBindTexture(GL_TEXTURE_2D, texture);</span><br><span class=\"line\">    glUniform1i(textureLocation, <span class=\"number\">0</span>);</span><br><span class=\"line\">    </span><br><span class=\"line\">    GLuint vbo;</span><br><span class=\"line\">    glGenBuffers(<span class=\"number\">1</span>, &amp;vbo);</span><br><span class=\"line\">    glBindBuffer(GL_ARRAY_BUFFER, vbo);</span><br><span class=\"line\">    glBufferData(GL_ARRAY_BUFFER, <span class=\"keyword\">sizeof</span>(vertices), vertices, GL_STATIC_DRAW);</span><br><span class=\"line\">    </span><br><span class=\"line\">    glEnableVertexAttribArray(<span class=\"number\">0</span>);</span><br><span class=\"line\">    glVertexAttribPointer(<span class=\"number\">0</span>, <span class=\"number\">3</span>, GL_FLOAT, GL_FALSE, <span class=\"keyword\">sizeof</span>(GLfloat)*<span class=\"number\">5</span>, <span class=\"number\">0</span>);</span><br><span class=\"line\">    glEnableVertexAttribArray(<span class=\"number\">1</span>);</span><br><span class=\"line\">    glVertexAttribPointer(<span class=\"number\">1</span>, <span class=\"number\">2</span>, GL_FLOAT, GL_FALSE, <span class=\"keyword\">sizeof</span>(GLfloat)*<span class=\"number\">5</span>, (GLvoid *)(<span class=\"keyword\">sizeof</span>(GLfloat)*<span class=\"number\">3</span>));</span><br><span class=\"line\">    </span><br><span class=\"line\">    glDrawArrays(GL_TRIANGLE_STRIP, <span class=\"number\">0</span>, <span class=\"number\">4</span>);</span><br><span class=\"line\">    </span><br><span class=\"line\">    [<span class=\"keyword\">self</span>.context presentRenderbuffer:GL_RENDERBUFFER];</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">- (GLuint)createTextureWithImage:(<span class=\"built_in\">UIImage</span> *)image &#123;</span><br><span class=\"line\">    <span class=\"comment\">//  UIImage  CGImageRef</span></span><br><span class=\"line\">    <span class=\"built_in\">CGImageRef</span> cgImageRef = [image <span class=\"built_in\">CGImage</span>];</span><br><span class=\"line\">    GLuint width = (GLuint)<span class=\"built_in\">CGImageGetWidth</span>(cgImageRef);</span><br><span class=\"line\">    GLuint height = (GLuint)<span class=\"built_in\">CGImageGetHeight</span>(cgImageRef);</span><br><span class=\"line\">    <span class=\"built_in\">CGRect</span> rect = <span class=\"built_in\">CGRectMake</span>(<span class=\"number\">0</span>, <span class=\"number\">0</span>, width, height);</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"built_in\">CGColorSpaceRef</span> colorSpace = <span class=\"built_in\">CGColorSpaceCreateDeviceRGB</span>();</span><br><span class=\"line\">    <span class=\"comment\">//  xx4RGBA</span></span><br><span class=\"line\">    <span class=\"keyword\">void</span> *imageData = malloc(width * height * <span class=\"number\">4</span>);</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\">     @param data#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\">     @param width#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\">     @param height#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\">     @param bitsPerComponent#&gt; 32RGBA8 description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\">     @param bytesPerRow#&gt; bit description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\">     @param space#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\">     @param bitmapInfo#&gt; bitmap description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\">     @return </span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"built_in\">CGContextRef</span> context = <span class=\"built_in\">CGBitmapContextCreate</span>(imageData, width, height, <span class=\"number\">8</span>, width * <span class=\"number\">4</span>, colorSpace, kCGImageAlphaPremultipliedLast | kCGBitmapByteOrder32Big);</span><br><span class=\"line\">    <span class=\"comment\">// -</span></span><br><span class=\"line\">    <span class=\"built_in\">CGContextTranslateCTM</span>(context, <span class=\"number\">0</span>, height);</span><br><span class=\"line\">    <span class=\"built_in\">CGContextScaleCTM</span>(context, <span class=\"number\">1.0</span>f, <span class=\"number\">-1.0</span>f);</span><br><span class=\"line\">    <span class=\"built_in\">CGColorSpaceRelease</span>(colorSpace);</span><br><span class=\"line\">    <span class=\"built_in\">CGContextClearRect</span>(context, rect);</span><br><span class=\"line\">    <span class=\"built_in\">CGContextDrawImage</span>(context, rect, cgImageRef);</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    GLuint textureID;</span><br><span class=\"line\">    glGenTextures(<span class=\"number\">1</span>, &amp;textureID);</span><br><span class=\"line\">    glBindTexture(GL_TEXTURE_2D, textureID);</span><br><span class=\"line\">    glTexImage2D(GL_TEXTURE_2D, <span class=\"number\">0</span>, GL_RGBA, width, height, <span class=\"number\">0</span>, GL_RGBA, GL_UNSIGNED_BYTE, imageData); <span class=\"comment\">// </span></span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_WRAP_S, GL_CLAMP_TO_EDGE);</span><br><span class=\"line\">    glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_WRAP_T, GL_CLAMP_TO_EDGE);</span><br><span class=\"line\">    glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_LINEAR);</span><br><span class=\"line\">    glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_LINEAR);</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    glBindTexture(GL_TEXTURE_2D, <span class=\"number\">0</span>);</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"built_in\">CGContextRelease</span>(context);</span><br><span class=\"line\">    free(imageData);</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">return</span> textureID;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2></h2>\n<p>2D<code>GL_TEXTURE_CUBE_MAP_POSITIVE_(X|Y|Z)</code><code>GL_TEXTURE_CUBE_NEGATIVE_(X|Y|Z)</code><code>glTexImage2D</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// Vertex shader</span></span><br><span class=\"line\"><span class=\"meta\">#version 300 es</span></span><br><span class=\"line\">layout(location = <span class=\"number\">0</span>) <span class=\"keyword\">in</span> vec4 a_position;</span><br><span class=\"line\">layout(location = <span class=\"number\">1</span>) <span class=\"keyword\">in</span> vec3 a_normal;</span><br><span class=\"line\"><span class=\"keyword\">out</span> vec3 v_normal;</span><br><span class=\"line\"><span class=\"keyword\">void</span> mian()</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    gl_Position = a_position;</span><br><span class=\"line\">    v_normal = a_normal;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// Fragment shader</span></span><br><span class=\"line\"><span class=\"meta\">#version 300 es</span></span><br><span class=\"line\">precision mediump <span class=\"keyword\">float</span>;</span><br><span class=\"line\"><span class=\"keyword\">in</span> vec3 v_normal;</span><br><span class=\"line\">layout(location = <span class=\"number\">0</span>) <span class=\"keyword\">out</span> vec4 outColor;</span><br><span class=\"line\">uniform samplerCube s_texture;</span><br><span class=\"line\"><span class=\"keyword\">void</span> main()</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    outColor = texture(s_texture, v_normal);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><code>texture</code><code>texture</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param sampler#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param coord#&gt; 3D description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param bias#&gt; mipmipLOD description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return vec4 </span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">texture(samplerCube sampler, vec3 coord[, <span class=\"keyword\">float</span> bias]);</span><br></pre></td></tr></table></figure>\n<p>2D32<code>sampleCube</code>2D</p>\n<h2>3D2D</h2>\n<p>2DOpenGL ES 3.03D2D3D2D<code>glTexImage3D</code><code>glTexImage2D</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> 3D2D</span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param target#&gt; GL_TEXTURE_3DGL_TEXTURE_2D_ARRAY description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param level#&gt; mip0mip description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param internalformat#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param width#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param height#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param depth#&gt; 3D description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param border#&gt; OpenGL ES0 description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param format#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param type#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param pixels#&gt; width*height*depth2D description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glTexImage3D(GLenum target, GLint level, GLint internalformat, GLsizei width, GLsizei height, GLsizei depth, GLint border, GLenum format, GLenum type, <span class=\"keyword\">const</span> GLvoid *pixels);</span><br></pre></td></tr></table></figure>\n<p><code>glTexImage3D</code>3D2D<code>texture</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> 3D</span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param sampler#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param coord#&gt; 3D description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param bias#&gt; mipmipLOD description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return vec4 </span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">texture(sampler3D sampler, vec3 coord[, <span class=\"keyword\">float</span> bias]);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> 2D</span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param sampler#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param coord#&gt; 3D description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param bias#&gt; mipmipLOD description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return vec4 </span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">texture(sampler2DArray sampler, vec3 coord[, <span class=\"keyword\">float</span> bias]);</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>r3D</p>\n</blockquote>\n<h1></h1>\n<p>OpenGL ES 3.0<br>\nOpenGL ES 2.0OpenGL ES 2.0OpenGL ES 2.0<br>\nOpenGL ES 3.0Ericsson Texture CompressionETC2EACKhronosOpenGL ES 3.0EAC12ETC2342D<code>glCompressedTexImage2D</code>2D<code>glCompressedTexImage3D</code></p>\n<blockquote>\n<p>ETC2/EAC3D2D2D<code>glCompressedTexImage3D</code>3D</p>\n</blockquote>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> 2D</span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param target#&gt; GL_TEXTURE_2DGL_TEXTURE_CUBE_MAP_* description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param level#&gt; mip description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param internalformat#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param width#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param height#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param border#&gt; OpenGL ES0 description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param imageSize#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param data#&gt; imageSize description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glCompressedTexImage2D(GLenum target, GLint level, GLenum internalformat, GLsizei width, GLsizei height, GLint border, GLsizei imageSize, <span class=\"keyword\">const</span> GLvoid *data);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> 2D</span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param target#&gt; GL_TEXTURE_2DGL_TEXTURE_CUBE_MAP_* description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param level#&gt; mip description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param internalformat#&gt; OpenGL ES 3.0 description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param width#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param height#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param border#&gt; OpenGL ES0 description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param imageSize#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param data#&gt; imageSize description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glCompressedTexImage3D(GLenum target, GLint level, GLenum internalformat, GLsizei width, GLsizei height, GLint border, GLsizei imageSize, <span class=\"keyword\">const</span> GLvoid *data);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> 2D3D</span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param target#&gt; GL_TEXTURE_3DGL_TEXTURE_2D_ARRAY description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param level#&gt; mip description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param internalformat#&gt; OpenGL ES 3.0 description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param width#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param height#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param depth#&gt; 2D description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param border#&gt; OpenGL ES0 description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param imageSize#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param data#&gt; imageSize description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glCompressedTexImage3D(GLenum target, GLint level, GLenum internalformat, GLsizei width, GLsizei height, GLsizei depth, GLint border, GLsizei imageSize, <span class=\"keyword\">const</span> GLvoid *data);</span><br></pre></td></tr></table></figure>\n<p>OpenGL ES 3.0ETCETC4x4ETCETCbpp<code>sizeInBytes = max(width, 4) * max(height, 4) * bpp / 8</code></p>\n<table>\n<thead>\n<tr>\n<th></th>\n<th></th>\n<th></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>GL_COMPRESSED_R11_EAC</td>\n<td>4</td>\n<td>GL_RED</td>\n</tr>\n<tr>\n<td>GL_COMPRESSED_SIGNED_R11_EAC</td>\n<td>4</td>\n<td>GL_RED</td>\n</tr>\n<tr>\n<td>GL_COMPRESSED_RG11_EAC</td>\n<td>8</td>\n<td>GL_RG</td>\n</tr>\n<tr>\n<td>GL_COMPRESSED_SIGNED_RG11_EAC</td>\n<td>8</td>\n<td>GL_RG</td>\n</tr>\n<tr>\n<td>GL_COMPRESSED_RGB8_ETC2</td>\n<td>4</td>\n<td>GL_RGB</td>\n</tr>\n<tr>\n<td>GL_COMPRESSED_SRGB8_ETC2</td>\n<td>4</td>\n<td>sRGBGL_RGB</td>\n</tr>\n<tr>\n<td>GL_COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2</td>\n<td>4</td>\n<td>GL_RGBA1alpha</td>\n</tr>\n<tr>\n<td>GL_COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2</td>\n<td>4</td>\n<td>sRGBGL_RGBA1alpha</td>\n</tr>\n<tr>\n<td>GL_COMPRESSED_RGBA8_ETC2_EAC</td>\n<td>8</td>\n<td>GL_RGBA</td>\n</tr>\n<tr>\n<td>GL_COMPRESSED_SRGBA8_ETC2_EAC</td>\n<td>8</td>\n<td>sRGBGL_RGBA</td>\n</tr>\n</tbody>\n</table>\n<p></p>\n<p>OpenGL ES 3.0OpenGL ES 3.0<code>GL_INVALID_ENUM</code>OpenGL ES 3.0<br>\n<code>glGetIntegerv</code><code>GL_NUM_COMPRESSED_TEXTURE_FORMATS</code><code>glGetIntegerv</code><code>GL_COMPRESSED_TEXTURE_FORMATS</code><code>GLenum</code><code>GLenum</code></p>\n<h1></h1>\n<p><code>glTexImage2D</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> 2D</span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param target#&gt; GL_TEXTURE_2DGL_TEXTURE_CUBE_MAP_* description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param level#&gt; mip description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param xoffset#&gt; x description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param yoffset#&gt; y description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param width#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param height#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param format#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param type#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param pixels#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glTexSubImage2D(GLenum target, GLint level, GLint xoffset, GLint yoffset, GLsizei width, GLsizei height, GLenum format, GLenum type, <span class=\"keyword\">const</span> GLvoid *pixels);</span><br></pre></td></tr></table></figure>\n<p>(xoffset, yoffset)(xoffset+width-1, yoffset+height-1)<code>pixels</code><code>glPixelStorei</code><code>GL_UNPACK_ALIGNMENT</code></p>\n<p>2D</p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> 2D</span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param target#&gt; GL_TEXTURE_2DGL_TEXTURE_CUBE_MAP_* description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param level#&gt; mip description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param xoffset#&gt; x description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param yoffset#&gt; y description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param width#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param height#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param format#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param imageSize#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param data#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glCompressedTexSubImage2D(GLenum target, GLint level, GLint xoffset, GLint yoffset, GLsizei width, GLsizei height, GLenum format, GLsizei imageSize, <span class=\"keyword\">const</span> GLvoid *data);</span><br></pre></td></tr></table></figure>\n<p>2D<code>glTexSubImage3D</code>3D2D</p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> 3D</span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param target#&gt; GL_TEXTURE_3DGL_TEXTURE_2D_ARRAY description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param level#&gt; mip description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param xoffset#&gt; x description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param yoffset#&gt; y description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param zoffset#&gt; z description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param width#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param height#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param depth#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param format#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param type#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param pixels#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glTexSubImage3D(GLenum target, GLint level, GLint xoffset, GLint yoffset, GLint zoffset, GLsizei width, GLsizei height, GLsizei depth, GLenum format, GLenum type, <span class=\"keyword\">const</span> GLvoid *pixels);</span><br></pre></td></tr></table></figure>\n<p><code>glTexSubImage3D</code><code>glTexSubImage2D</code><code>zoffset</code><code>depth</code>2D<code>glCompressedTexSubImage3D</code>3D3DETC2/EAC2D2D</p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> 3D</span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param target#&gt; GL_TEXTURE_3DGL_TEXTURE_2D_ARRAY description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param level#&gt; mip description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param xoffset#&gt; x description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param yoffset#&gt; y description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param zoffset#&gt; z description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param width#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param height#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param depth#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param format#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param imageSize#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param data#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glCompressedTexSubImage3D(GLenum target, GLint level, GLint xoffset, GLint yoffset, GLint zoffset, GLsizei width, GLsizei height, GLsizei depth, GLenum format, GLsizei imageSize, <span class=\"keyword\">const</span> GLvoid *data);</span><br></pre></td></tr></table></figure>\n<h1></h1>\n<p>OpenGL ES 3.0-</p>\n<p><code>glReadBuffer</code>EGL<code>glReadBuffer</code><code>GL_BACK</code>OpenGL ES 3.0EGLOpenGL ES 3.0<code>eglSwapBuffers</code>EGLEGL pbufferpbuffer<code>GL_COLOR_ATTACHMENTi</code><code>glReadBuffer</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param mode#&gt; glReadPixelsglCopyTexImage2DglCopyTexSubImage2DglCopyTexSubImage3DGL_BACKGL_COLOR_ATTACHMENTiGL_NONE description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glReadBuffer(GLenum mode);</span><br></pre></td></tr></table></figure>\n<p><code>glCopyTexImage2D</code><code>glCopyTexSubImage2D</code><code>glCopyTexSubImage3D</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> 2D</span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param target#&gt; GL_TEXTURE_CUBE_MAP_2DGL_TEXTURE_CUBE_MAP_* description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param level#&gt; mip description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param internalformat#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param x#&gt; x description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param y#&gt; y description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param width#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param height#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param border#&gt; OpenGL ES 3.00 description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glCopyTexImage2D(GLenum target, GLint level, GLenum internalformat, GLint x, GLint y, GLsizei width, GLsizei height, GLint border);</span><br></pre></td></tr></table></figure>\n<p>(x, y)(x+width-1, y+height-1)<br>\n<code>glCopyTexSubImage2D</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> 2D</span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param target#&gt; GL_TEXTURE_2DGL_TEXTURE_CUBE_MAP_* description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param level#&gt; mip description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param xoffset#&gt; x description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param yoffset#&gt; y description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param x#&gt; x description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param y#&gt; y description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param width#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param height#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glCopyTexSubImage2D(GLenum target, GLint level, GLint xoffset, GLint yoffset, GLint x, GLint y, GLsizei width, GLsizei height);</span><br></pre></td></tr></table></figure>\n<p>(x, y)(x+width-1, y+height-1)(xoffset, yoffset)(xoffset+width-1, yoffset+height-1)<br>\n<code>glCopyTexSubImage3D</code>3D2D</p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> 3D2D</span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param target#&gt; GL_TEXTURE_3DGL_TEXTURE_2D_ARRAY description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param level#&gt; mip description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param xoffset#&gt; x description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param yoffset#&gt; y description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param zoffset#&gt; z description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param x#&gt; x description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param y#&gt; y description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param width#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param height#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glCopyTexSubImage3D(GLenum target, GLint level, GLint xoffset, GLint yoffset, GLint zoffset, GLint x, GLint y, GLsizei width, GLsizei height);</span><br></pre></td></tr></table></figure>\n<p></p>\n<h1></h1>\n<p><code>glTexParameter[i|f][v]</code>LOD<code>glTexParameter[i|f][v]</code>API<code>glTexParameter[i|f][v]</code>OpenGL ES 3.0<code>glTexParameter[i|f][v]</code>API</p>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param count#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param samplers#&gt; nID description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glGenSamplers(GLsizei count, GLuint *samplers);</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param count#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param samplers#&gt; nID description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glDeleteSamplers(GLsizei count, <span class=\"keyword\">const</span> GLuint *samplers);</span><br></pre></td></tr></table></figure>\n<p>ID<code>glTexParameter[i|f][v]</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param unit#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param sampler#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glBindSampler(GLuint unit, GLuint sampler);</span><br></pre></td></tr></table></figure>\n<p><code>glBindSampler</code><code>sampler</code>0<code>glSampler[f|i][v]</code><code>glSamplerParameter[f|i][v]</code><code>glTexParameter[i|f][v]</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">glSamplerParameteri(GLuint sampler, GLenum pname, GLint param);</span><br><span class=\"line\">glSamplerParameteriv(GLuint sampler, GLenum pname, <span class=\"keyword\">const</span> GLint *param);</span><br><span class=\"line\">glSamplerParameterf(GLuint sampler, GLenum pname, GLfloat param);</span><br><span class=\"line\">glSamplerParameterfv(GLuint sampler, GLenum pname, <span class=\"keyword\">const</span> GLfloat *param);</span><br></pre></td></tr></table></figure>\n<h1></h1>\n<p>OpenGL ES 3.0<code>glTexImage2D</code><code>glTexImage3D</code>mipOpenGL ESmip</p>\n<p>OpenGL ES<code>glTexSubImage2D</code><code>glTexSubImage3D</code><code>glGenerateMipMap</code><br>\n<code>glBindTexture</code><code>glTexStorage2D</code><code>glTexStorage3D</code></p>\n<figure class=\"highlight objc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\"> @param target#&gt; GL_TEXTURE_2DGL_TEXTURE_CUBE_MAP_*GL_TEXTURE_3DGL_TEXTURE_2D_ARRAY description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param levels#&gt; mip description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param internalformat#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param width#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @param height#&gt;  description#&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> @return void</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">glTexStorage2D/<span class=\"number\">3</span>D(GLenum target, GLsizei levels, GLenum internalformat, GLsizei width, GLsizei height);</span><br></pre></td></tr></table></figure>\n<p><code>glTexImage*</code><code>glCompressedTexImage*</code><code>glCopyTexImage*</code><code>glTexStorage*</code><code>GL_INVALID_OPERATION</code><code>glTexSubImage2D</code><code>glTexSubImage3D</code><code>glGenerateMipMap</code><br>\n<code>glTexStorage*</code>OpenGL ES<code>GL_TEXTURE_IMMUTABLE_FORMAT</code><code>GL_TRUE</code><code>GL_TEXTURE_IMMUTABLE_LEVELS</code><code>glTexStorage*</code><code>glGetTexParameter[i|f][v]</code><code>glTexStorage*</code></p>\n<h1></h1>\n<p>GPUCPUGPUOpenGL ES 3.0<code>GL_PIXEL_UNPACK_BUFFER</code><code>glTexImage*</code><code>glTexSubImage*</code><code>glCompressedTexImage*</code><code>glCompressedTexSubImage*</code><code>glVertexAttribPointer</code>VBO<br>\nGPUOpenGL<code>glTexSubImage*</code>GPU/</p>\n<h1></h1>\n<p>OpenGL ES 3.0</p>\n"},{"title":"RealityKit - AR","catalog":true,"toc_nav_num":true,"date":"2021-08-30T12:19:02.000Z","subtitle":"RealityKit AR with the Device's Camera","header-img":"/img/article_header/article_header.png","busuanzi":true,"_content":"\n# \n\n[](/article/2021/realitykit-0621)`RealityKit`AR\n\n# \n\n## ARView\n\n`arView``cameraMode``ar``nonAr`\n``` swift\nprivate lazy var arView: ARView = {\n    let vi = ARView(frame: view.bounds, \n                    cameraMode: .ar, \n                    automaticallyConfigureSession: true)\n    return vi\n}()\n```\n`renderOptions`\n``` swift\n...\n    vi.renderOptions = [.disableCameraGrain, \n                        .disableHDR, \n                        .disableMotionBlur,\n                        .disableDepthOfField,\n                        .disableFaceOcclusions,\n                        .disablePersonOcclusion, \n                        .disableGroundingShadows, \n                        .disableAREnvironmentLighting]\n...\n```\ndebug\n``` swift\n...\n    vi.debugOptions = [.showWorldOrigin]\n...\n```\n`arView`\n``` swift\noverride func viewDidLoad() {\n    super.viewDidLoad()\n\n    view.addSubview(arView)\n}\n```\n\n## ARCoachingOverlayView\n\nAR\n``` swift\nprivate lazy var coachingOverlay: ARCoachingOverlayView = {\n    let c = ARCoachingOverlayView(frame: arView.bounds)\n    c.session = arView.session\n    arView.addSubview(c)\n}()\n```\n`ARCoachingOverlayView``ARCoachingOverlayView`\n``` swift\n...\n    c.delegate = self\n    c.goal = .horizontalPlane\n    c.activatesAutomatically = false\n...\n```\n\n``` swift\nextension UIViewController: ARCoachingOverlayViewDelegate {\n\n    /// coachingOverlayView\n    func coachingOverlayViewWillActivate(_ coachingOverlayView: ARCoachingOverlayView) { }\n    \n    /// coachingOverlayView\n    func coachingOverlayViewDidDeactivate(_ coachingOverlayView: ARCoachingOverlayView) { }\n\n    /// coachingOverlayView\n    func coachingOverlayViewDidRequestSessionReset(_ coachingOverlayView: ARCoachingOverlayView) { }\n}\n```\n\n``` swift\n...\n    c.setActive(true, animated: true)\n...\n```\n`arView`\n``` swift\n...\n    arView.addSubview(coachingOverlay)\n...\n```\n\n## \n\n\n![](/img/article/20210830/1.png)\n\n# \n\n`ARSession``ARSession``ARView`\n``` swift\nprivate var session: ARSession {\n    arView.session\n}\n```\n`session``ARWorldTrackingConfiguration`\n``` swift\nprivate func setupARSession() {\n    let configuration = ARWorldTrackingConfiguration()\n    configuration.planeDetection = [.horizontal]\n    configuration.environmentTexturing = .automatic\n    session.run(configuration, options: [])\n}\n```\n`session`\n``` swift\n...\n    session.delegate = self\n...\n```\n\n``` swift\nextension UIViewController: ARSessionDelegate {\n    \n    /// \n    func session(_ session: ARSession, didUpdate frame: ARFrame) { }\n    \n    /// ()\n    func session(_ session: ARSession, didAdd anchors: [ARAnchor]) { }\n    \n    /// \n    func session(_ session: ARSession, didUpdate anchors: [ARAnchor]) { }\n\n    /// \n    func session(_ session: ARSession, didRemove anchors: [ARAnchor]) { }\n}\n```\ndemo\n\n# \n\n## Entity\n`AnchorEntity``Entity``HasAnchoring``ModelEntity``Combine``USDZ``OBJ`\n``` swift\nclass ShoeEntity: Entity, HasAnchoring {\n    private var cancels: Set<AnyCancellable> = .init()\n    \n    required init(name: String) {\n        super.init()\n        \n        loadEntity(name: name)\n    }\n    \n    private func loadEntity(name: String) {\n        Entity.loadModelAsync(named: name).sink { error in\n            debugPrint(error)\n        } receiveValue: { [weak self] entity in\n            self?.addChild(entity)\n        }.store(in: &cancels)\n    }\n    \n    required init() {\n        fatalError(\"init() has not been implemented\")\n    }\n}\n```\n\n```\nprivate lazy var shoeEntity: ShoeEntity = .init(name: \"shoe.usdz\")\n```\n## \n\n``` swift\nfunc session(_ session: ARSession, didAdd anchors: [ARAnchor]) {\n    guard let anchor = anchors.filter({ $0 is ARPlaneAnchor }).first as? ARPlaneAnchor,\n          anchor.alignment == .horizontal else {\n        return\n    }\n    coachingOverlay.setActive(false, animated: true)\n    shoeEntity.transform.matrix = anchor.transform\n    arView.scene.addAnchor(shoeEntity)\n}\n```\n\n# \n\n![](/img/article/20210830/2.mp4)\n\n# \n\n`RealityKit`\n","source":"_posts/2021/realitykit-live-ar-0830.md","raw":"---\ntitle: \"RealityKit - AR\"\ncatalog: true\ntoc_nav_num: true\ndate: 2021-08-30 20:19:02\nsubtitle: \"RealityKit AR with the Device's Camera\"\nheader-img: \"/img/article_header/article_header.png\"\nbusuanzi: true\ntags:\n- iOS - Swift\n\n---\n\n# \n\n[](/article/2021/realitykit-0621)`RealityKit`AR\n\n# \n\n## ARView\n\n`arView``cameraMode``ar``nonAr`\n``` swift\nprivate lazy var arView: ARView = {\n    let vi = ARView(frame: view.bounds, \n                    cameraMode: .ar, \n                    automaticallyConfigureSession: true)\n    return vi\n}()\n```\n`renderOptions`\n``` swift\n...\n    vi.renderOptions = [.disableCameraGrain, \n                        .disableHDR, \n                        .disableMotionBlur,\n                        .disableDepthOfField,\n                        .disableFaceOcclusions,\n                        .disablePersonOcclusion, \n                        .disableGroundingShadows, \n                        .disableAREnvironmentLighting]\n...\n```\ndebug\n``` swift\n...\n    vi.debugOptions = [.showWorldOrigin]\n...\n```\n`arView`\n``` swift\noverride func viewDidLoad() {\n    super.viewDidLoad()\n\n    view.addSubview(arView)\n}\n```\n\n## ARCoachingOverlayView\n\nAR\n``` swift\nprivate lazy var coachingOverlay: ARCoachingOverlayView = {\n    let c = ARCoachingOverlayView(frame: arView.bounds)\n    c.session = arView.session\n    arView.addSubview(c)\n}()\n```\n`ARCoachingOverlayView``ARCoachingOverlayView`\n``` swift\n...\n    c.delegate = self\n    c.goal = .horizontalPlane\n    c.activatesAutomatically = false\n...\n```\n\n``` swift\nextension UIViewController: ARCoachingOverlayViewDelegate {\n\n    /// coachingOverlayView\n    func coachingOverlayViewWillActivate(_ coachingOverlayView: ARCoachingOverlayView) { }\n    \n    /// coachingOverlayView\n    func coachingOverlayViewDidDeactivate(_ coachingOverlayView: ARCoachingOverlayView) { }\n\n    /// coachingOverlayView\n    func coachingOverlayViewDidRequestSessionReset(_ coachingOverlayView: ARCoachingOverlayView) { }\n}\n```\n\n``` swift\n...\n    c.setActive(true, animated: true)\n...\n```\n`arView`\n``` swift\n...\n    arView.addSubview(coachingOverlay)\n...\n```\n\n## \n\n\n![](/img/article/20210830/1.png)\n\n# \n\n`ARSession``ARSession``ARView`\n``` swift\nprivate var session: ARSession {\n    arView.session\n}\n```\n`session``ARWorldTrackingConfiguration`\n``` swift\nprivate func setupARSession() {\n    let configuration = ARWorldTrackingConfiguration()\n    configuration.planeDetection = [.horizontal]\n    configuration.environmentTexturing = .automatic\n    session.run(configuration, options: [])\n}\n```\n`session`\n``` swift\n...\n    session.delegate = self\n...\n```\n\n``` swift\nextension UIViewController: ARSessionDelegate {\n    \n    /// \n    func session(_ session: ARSession, didUpdate frame: ARFrame) { }\n    \n    /// ()\n    func session(_ session: ARSession, didAdd anchors: [ARAnchor]) { }\n    \n    /// \n    func session(_ session: ARSession, didUpdate anchors: [ARAnchor]) { }\n\n    /// \n    func session(_ session: ARSession, didRemove anchors: [ARAnchor]) { }\n}\n```\ndemo\n\n# \n\n## Entity\n`AnchorEntity``Entity``HasAnchoring``ModelEntity``Combine``USDZ``OBJ`\n``` swift\nclass ShoeEntity: Entity, HasAnchoring {\n    private var cancels: Set<AnyCancellable> = .init()\n    \n    required init(name: String) {\n        super.init()\n        \n        loadEntity(name: name)\n    }\n    \n    private func loadEntity(name: String) {\n        Entity.loadModelAsync(named: name).sink { error in\n            debugPrint(error)\n        } receiveValue: { [weak self] entity in\n            self?.addChild(entity)\n        }.store(in: &cancels)\n    }\n    \n    required init() {\n        fatalError(\"init() has not been implemented\")\n    }\n}\n```\n\n```\nprivate lazy var shoeEntity: ShoeEntity = .init(name: \"shoe.usdz\")\n```\n## \n\n``` swift\nfunc session(_ session: ARSession, didAdd anchors: [ARAnchor]) {\n    guard let anchor = anchors.filter({ $0 is ARPlaneAnchor }).first as? ARPlaneAnchor,\n          anchor.alignment == .horizontal else {\n        return\n    }\n    coachingOverlay.setActive(false, animated: true)\n    shoeEntity.transform.matrix = anchor.transform\n    arView.scene.addAnchor(shoeEntity)\n}\n```\n\n# \n\n![](/img/article/20210830/2.mp4)\n\n# \n\n`RealityKit`\n","slug":"2021/realitykit-live-ar-0830","published":1,"updated":"2021-08-31T10:43:27.557Z","_id":"cksztn2dz0002kvntn1by4bc8","comments":1,"layout":"post","photos":[],"link":"","content":"<h1 id=\"\"></h1>\n<p><a href=\"/article/2021/realitykit-0621\"></a><code>RealityKit</code>AR</p>\n<h1 id=\"\"></h1>\n<h2 id=\"arview\">ARView</h2>\n<p><code>arView</code><code>cameraMode</code><code>ar</code><code>nonAr</code></p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"built_in\">lazy</span> <span class=\"keyword\">var</span> arView: <span class=\"type\">ARView</span> = &#123;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> vi = <span class=\"type\">ARView</span>(frame: view.bounds, </span><br><span class=\"line\">                    cameraMode: .ar, </span><br><span class=\"line\">                    automaticallyConfigureSession: <span class=\"literal\">true</span>)</span><br><span class=\"line\">    <span class=\"keyword\">return</span> vi</span><br><span class=\"line\">&#125;()</span><br></pre></td></tr></table></figure>\n<p><code>renderOptions</code></p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">...</span><br><span class=\"line\">    vi.renderOptions = [.disableCameraGrain, </span><br><span class=\"line\">                        .disableHDR, </span><br><span class=\"line\">                        .disableMotionBlur,</span><br><span class=\"line\">                        .disableDepthOfField,</span><br><span class=\"line\">                        .disableFaceOcclusions,</span><br><span class=\"line\">                        .disablePersonOcclusion, </span><br><span class=\"line\">                        .disableGroundingShadows, </span><br><span class=\"line\">                        .disableAREnvironmentLighting]</span><br><span class=\"line\">...</span><br></pre></td></tr></table></figure>\n<p>debug</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">...</span><br><span class=\"line\">    vi.debugOptions = [.showWorldOrigin]</span><br><span class=\"line\">...</span><br></pre></td></tr></table></figure>\n<p><code>arView</code></p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">override</span> <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">viewDidLoad</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">super</span>.viewDidLoad()</span><br><span class=\"line\"></span><br><span class=\"line\">    view.addSubview(arView)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"arcoachingoverlayview\">ARCoachingOverlayView</h2>\n<p>AR</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"built_in\">lazy</span> <span class=\"keyword\">var</span> coachingOverlay: <span class=\"type\">ARCoachingOverlayView</span> = &#123;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> <span class=\"built_in\">c</span> = <span class=\"type\">ARCoachingOverlayView</span>(frame: arView.bounds)</span><br><span class=\"line\">    <span class=\"built_in\">c</span>.session = arView.session</span><br><span class=\"line\">    arView.addSubview(<span class=\"built_in\">c</span>)</span><br><span class=\"line\">&#125;()</span><br></pre></td></tr></table></figure>\n<p><code>ARCoachingOverlayView</code><code>ARCoachingOverlayView</code></p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">...</span><br><span class=\"line\">    <span class=\"built_in\">c</span>.delegate = <span class=\"keyword\">self</span></span><br><span class=\"line\">    <span class=\"built_in\">c</span>.goal = .horizontalPlane</span><br><span class=\"line\">    <span class=\"built_in\">c</span>.activatesAutomatically = <span class=\"literal\">false</span></span><br><span class=\"line\">...</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">extension</span> <span class=\"title\">UIViewController</span>: <span class=\"title\">ARCoachingOverlayViewDelegate</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/// coachingOverlayView</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">coachingOverlayViewWillActivate</span><span class=\"params\">(<span class=\"number\">_</span> coachingOverlayView: ARCoachingOverlayView)</span></span> &#123; &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">/// coachingOverlayView</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">coachingOverlayViewDidDeactivate</span><span class=\"params\">(<span class=\"number\">_</span> coachingOverlayView: ARCoachingOverlayView)</span></span> &#123; &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/// coachingOverlayView</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">coachingOverlayViewDidRequestSessionReset</span><span class=\"params\">(<span class=\"number\">_</span> coachingOverlayView: ARCoachingOverlayView)</span></span> &#123; &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">...</span><br><span class=\"line\">    <span class=\"built_in\">c</span>.setActive(<span class=\"literal\">true</span>, animated: <span class=\"literal\">true</span>)</span><br><span class=\"line\">...</span><br></pre></td></tr></table></figure>\n<p><code>arView</code></p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">...</span><br><span class=\"line\">    arView.addSubview(coachingOverlay)</span><br><span class=\"line\">...</span><br></pre></td></tr></table></figure>\n<h2 id=\"\"></h2>\n<p><br>\n<img src=\"/img/article/20210830/1.png\" alt=\"\"></p>\n<h1 id=\"\"></h1>\n<p><code>ARSession</code><code>ARSession</code><code>ARView</code></p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">var</span> session: <span class=\"type\">ARSession</span> &#123;</span><br><span class=\"line\">    arView.session</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><code>session</code><code>ARWorldTrackingConfiguration</code></p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">setupARSession</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> configuration = <span class=\"type\">ARWorldTrackingConfiguration</span>()</span><br><span class=\"line\">    configuration.planeDetection = [.horizontal]</span><br><span class=\"line\">    configuration.environmentTexturing = .automatic</span><br><span class=\"line\">    session.run(configuration, options: [])</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><code>session</code></p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">...</span><br><span class=\"line\">    session.delegate = <span class=\"keyword\">self</span></span><br><span class=\"line\">...</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">extension</span> <span class=\"title\">UIViewController</span>: <span class=\"title\">ARSessionDelegate</span> </span>&#123;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">/// </span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">session</span><span class=\"params\">(<span class=\"number\">_</span> session: ARSession, didUpdate frame: ARFrame)</span></span> &#123; &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">/// ()</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">session</span><span class=\"params\">(<span class=\"number\">_</span> session: ARSession, didAdd anchors: [ARAnchor])</span></span> &#123; &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">/// </span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">session</span><span class=\"params\">(<span class=\"number\">_</span> session: ARSession, didUpdate anchors: [ARAnchor])</span></span> &#123; &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/// </span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">session</span><span class=\"params\">(<span class=\"number\">_</span> session: ARSession, didRemove anchors: [ARAnchor])</span></span> &#123; &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>demo</p>\n<h1 id=\"\"></h1>\n<h2 id=\"entity\">Entity</h2>\n<p><code>AnchorEntity</code><code>Entity</code><code>HasAnchoring</code><code>ModelEntity</code><code>Combine</code><code>USDZ</code><code>OBJ</code></p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">ShoeEntity</span>: <span class=\"title\">Entity</span>, <span class=\"title\">HasAnchoring</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">var</span> cancels: <span class=\"type\">Set</span>&lt;<span class=\"type\">AnyCancellable</span>&gt; = .<span class=\"keyword\">init</span>()</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">required</span> <span class=\"keyword\">init</span>(name: <span class=\"type\">String</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">super</span>.<span class=\"keyword\">init</span>()</span><br><span class=\"line\">        </span><br><span class=\"line\">        loadEntity(name: name)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">loadEntity</span><span class=\"params\">(name: String)</span></span> &#123;</span><br><span class=\"line\">        <span class=\"type\">Entity</span>.loadModelAsync(named: name).sink &#123; error <span class=\"keyword\">in</span></span><br><span class=\"line\">            <span class=\"built_in\">debugPrint</span>(error)</span><br><span class=\"line\">        &#125; receiveValue: &#123; [<span class=\"keyword\">weak</span> <span class=\"keyword\">self</span>] entity <span class=\"keyword\">in</span></span><br><span class=\"line\">            <span class=\"keyword\">self</span>?.addChild(entity)</span><br><span class=\"line\">        &#125;.store(<span class=\"keyword\">in</span>: &amp;cancels)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">required</span> <span class=\"keyword\">init</span>() &#123;</span><br><span class=\"line\">        <span class=\"built_in\">fatalError</span>(<span class=\"string\">\"init() has not been implemented\"</span>)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">private lazy var shoeEntity: ShoeEntity = .init(name: &quot;shoe.usdz&quot;)</span><br></pre></td></tr></table></figure>\n<h2 id=\"\"></h2>\n<p></p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">session</span><span class=\"params\">(<span class=\"number\">_</span> session: ARSession, didAdd anchors: [ARAnchor])</span></span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">guard</span> <span class=\"keyword\">let</span> anchor = anchors.<span class=\"built_in\">filter</span>(&#123; $<span class=\"number\">0</span> <span class=\"keyword\">is</span> <span class=\"type\">ARPlaneAnchor</span> &#125;).first <span class=\"keyword\">as</span>? <span class=\"type\">ARPlaneAnchor</span>,</span><br><span class=\"line\">          anchor.alignment == .horizontal <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    coachingOverlay.setActive(<span class=\"literal\">false</span>, animated: <span class=\"literal\">true</span>)</span><br><span class=\"line\">    shoeEntity.transform.matrix = anchor.transform</span><br><span class=\"line\">    arView.scene.addAnchor(shoeEntity)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h1 id=\"\"></h1>\n<p><img src=\"/img/article/20210830/2.mp4\" alt=\"\"></p>\n<h1 id=\"\"></h1>\n<p><code>RealityKit</code><br>\n</p>\n","site":{"data":{}},"excerpt":"","more":"<h1></h1>\n<p><a href=\"/article/2021/realitykit-0621\"></a><code>RealityKit</code>AR</p>\n<h1></h1>\n<h2>ARView</h2>\n<p><code>arView</code><code>cameraMode</code><code>ar</code><code>nonAr</code></p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"built_in\">lazy</span> <span class=\"keyword\">var</span> arView: <span class=\"type\">ARView</span> = &#123;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> vi = <span class=\"type\">ARView</span>(frame: view.bounds, </span><br><span class=\"line\">                    cameraMode: .ar, </span><br><span class=\"line\">                    automaticallyConfigureSession: <span class=\"literal\">true</span>)</span><br><span class=\"line\">    <span class=\"keyword\">return</span> vi</span><br><span class=\"line\">&#125;()</span><br></pre></td></tr></table></figure>\n<p><code>renderOptions</code></p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">...</span><br><span class=\"line\">    vi.renderOptions = [.disableCameraGrain, </span><br><span class=\"line\">                        .disableHDR, </span><br><span class=\"line\">                        .disableMotionBlur,</span><br><span class=\"line\">                        .disableDepthOfField,</span><br><span class=\"line\">                        .disableFaceOcclusions,</span><br><span class=\"line\">                        .disablePersonOcclusion, </span><br><span class=\"line\">                        .disableGroundingShadows, </span><br><span class=\"line\">                        .disableAREnvironmentLighting]</span><br><span class=\"line\">...</span><br></pre></td></tr></table></figure>\n<p>debug</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">...</span><br><span class=\"line\">    vi.debugOptions = [.showWorldOrigin]</span><br><span class=\"line\">...</span><br></pre></td></tr></table></figure>\n<p><code>arView</code></p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">override</span> <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">viewDidLoad</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">super</span>.viewDidLoad()</span><br><span class=\"line\"></span><br><span class=\"line\">    view.addSubview(arView)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2>ARCoachingOverlayView</h2>\n<p>AR</p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"built_in\">lazy</span> <span class=\"keyword\">var</span> coachingOverlay: <span class=\"type\">ARCoachingOverlayView</span> = &#123;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> <span class=\"built_in\">c</span> = <span class=\"type\">ARCoachingOverlayView</span>(frame: arView.bounds)</span><br><span class=\"line\">    <span class=\"built_in\">c</span>.session = arView.session</span><br><span class=\"line\">    arView.addSubview(<span class=\"built_in\">c</span>)</span><br><span class=\"line\">&#125;()</span><br></pre></td></tr></table></figure>\n<p><code>ARCoachingOverlayView</code><code>ARCoachingOverlayView</code></p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">...</span><br><span class=\"line\">    <span class=\"built_in\">c</span>.delegate = <span class=\"keyword\">self</span></span><br><span class=\"line\">    <span class=\"built_in\">c</span>.goal = .horizontalPlane</span><br><span class=\"line\">    <span class=\"built_in\">c</span>.activatesAutomatically = <span class=\"literal\">false</span></span><br><span class=\"line\">...</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">extension</span> <span class=\"title\">UIViewController</span>: <span class=\"title\">ARCoachingOverlayViewDelegate</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/// coachingOverlayView</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">coachingOverlayViewWillActivate</span><span class=\"params\">(<span class=\"number\">_</span> coachingOverlayView: ARCoachingOverlayView)</span></span> &#123; &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">/// coachingOverlayView</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">coachingOverlayViewDidDeactivate</span><span class=\"params\">(<span class=\"number\">_</span> coachingOverlayView: ARCoachingOverlayView)</span></span> &#123; &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/// coachingOverlayView</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">coachingOverlayViewDidRequestSessionReset</span><span class=\"params\">(<span class=\"number\">_</span> coachingOverlayView: ARCoachingOverlayView)</span></span> &#123; &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">...</span><br><span class=\"line\">    <span class=\"built_in\">c</span>.setActive(<span class=\"literal\">true</span>, animated: <span class=\"literal\">true</span>)</span><br><span class=\"line\">...</span><br></pre></td></tr></table></figure>\n<p><code>arView</code></p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">...</span><br><span class=\"line\">    arView.addSubview(coachingOverlay)</span><br><span class=\"line\">...</span><br></pre></td></tr></table></figure>\n<h2></h2>\n<p><br>\n<img src=\"/img/article/20210830/1.png\" alt=\"\"></p>\n<h1></h1>\n<p><code>ARSession</code><code>ARSession</code><code>ARView</code></p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">var</span> session: <span class=\"type\">ARSession</span> &#123;</span><br><span class=\"line\">    arView.session</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><code>session</code><code>ARWorldTrackingConfiguration</code></p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">setupARSession</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> configuration = <span class=\"type\">ARWorldTrackingConfiguration</span>()</span><br><span class=\"line\">    configuration.planeDetection = [.horizontal]</span><br><span class=\"line\">    configuration.environmentTexturing = .automatic</span><br><span class=\"line\">    session.run(configuration, options: [])</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><code>session</code></p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">...</span><br><span class=\"line\">    session.delegate = <span class=\"keyword\">self</span></span><br><span class=\"line\">...</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">extension</span> <span class=\"title\">UIViewController</span>: <span class=\"title\">ARSessionDelegate</span> </span>&#123;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">/// </span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">session</span><span class=\"params\">(<span class=\"number\">_</span> session: ARSession, didUpdate frame: ARFrame)</span></span> &#123; &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">/// ()</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">session</span><span class=\"params\">(<span class=\"number\">_</span> session: ARSession, didAdd anchors: [ARAnchor])</span></span> &#123; &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">/// </span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">session</span><span class=\"params\">(<span class=\"number\">_</span> session: ARSession, didUpdate anchors: [ARAnchor])</span></span> &#123; &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/// </span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">session</span><span class=\"params\">(<span class=\"number\">_</span> session: ARSession, didRemove anchors: [ARAnchor])</span></span> &#123; &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>demo</p>\n<h1></h1>\n<h2>Entity</h2>\n<p><code>AnchorEntity</code><code>Entity</code><code>HasAnchoring</code><code>ModelEntity</code><code>Combine</code><code>USDZ</code><code>OBJ</code></p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">ShoeEntity</span>: <span class=\"title\">Entity</span>, <span class=\"title\">HasAnchoring</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">var</span> cancels: <span class=\"type\">Set</span>&lt;<span class=\"type\">AnyCancellable</span>&gt; = .<span class=\"keyword\">init</span>()</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">required</span> <span class=\"keyword\">init</span>(name: <span class=\"type\">String</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">super</span>.<span class=\"keyword\">init</span>()</span><br><span class=\"line\">        </span><br><span class=\"line\">        loadEntity(name: name)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">loadEntity</span><span class=\"params\">(name: String)</span></span> &#123;</span><br><span class=\"line\">        <span class=\"type\">Entity</span>.loadModelAsync(named: name).sink &#123; error <span class=\"keyword\">in</span></span><br><span class=\"line\">            <span class=\"built_in\">debugPrint</span>(error)</span><br><span class=\"line\">        &#125; receiveValue: &#123; [<span class=\"keyword\">weak</span> <span class=\"keyword\">self</span>] entity <span class=\"keyword\">in</span></span><br><span class=\"line\">            <span class=\"keyword\">self</span>?.addChild(entity)</span><br><span class=\"line\">        &#125;.store(<span class=\"keyword\">in</span>: &amp;cancels)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">required</span> <span class=\"keyword\">init</span>() &#123;</span><br><span class=\"line\">        <span class=\"built_in\">fatalError</span>(<span class=\"string\">\"init() has not been implemented\"</span>)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">private lazy var shoeEntity: ShoeEntity = .init(name: &quot;shoe.usdz&quot;)</span><br></pre></td></tr></table></figure>\n<h2></h2>\n<p></p>\n<figure class=\"highlight swift\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">session</span><span class=\"params\">(<span class=\"number\">_</span> session: ARSession, didAdd anchors: [ARAnchor])</span></span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">guard</span> <span class=\"keyword\">let</span> anchor = anchors.<span class=\"built_in\">filter</span>(&#123; $<span class=\"number\">0</span> <span class=\"keyword\">is</span> <span class=\"type\">ARPlaneAnchor</span> &#125;).first <span class=\"keyword\">as</span>? <span class=\"type\">ARPlaneAnchor</span>,</span><br><span class=\"line\">          anchor.alignment == .horizontal <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    coachingOverlay.setActive(<span class=\"literal\">false</span>, animated: <span class=\"literal\">true</span>)</span><br><span class=\"line\">    shoeEntity.transform.matrix = anchor.transform</span><br><span class=\"line\">    arView.scene.addAnchor(shoeEntity)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h1></h1>\n<p><img src=\"/img/article/20210830/2.mp4\" alt=\"\"></p>\n<h1></h1>\n<p><code>RealityKit</code><br>\n</p>\n"}],"PostAsset":[],"PostCategory":[],"PostTag":[{"post_id":"ckszp3ncz0008ifntj1uliqcn","tag_id":"ckszp3ncw0006ifnt91n6bjx1","_id":"ckszp3nd3000bifntphqkt3fc"},{"post_id":"ckszp3ncr0004ifnt7dskl8yk","tag_id":"ckszp3ncw0006ifnt91n6bjx1","_id":"ckszp3nd4000difnt2z6wzvjw"},{"post_id":"ckszp3ncu0005ifnt4fot484z","tag_id":"ckszp3ncw0006ifnt91n6bjx1","_id":"ckszp3nd6000gifnta27txx2u"},{"post_id":"ckszp3nd6000hifnter210uu6","tag_id":"ckszp3ncw0006ifnt91n6bjx1","_id":"ckszp3nd8000kifntste5gv3m"},{"post_id":"ckszp3ncy0007ifntjtxk1haj","tag_id":"ckszp3ncw0006ifnt91n6bjx1","_id":"ckszp3nd9000mifntstnruluc"},{"post_id":"ckszp3nd7000iifntomx14y1l","tag_id":"ckszp3ncw0006ifnt91n6bjx1","_id":"ckszp3nda000pifntt6wpb73c"},{"post_id":"ckszp3nd8000lifntgxke0csi","tag_id":"ckszp3ncw0006ifnt91n6bjx1","_id":"ckszp3ndb000rifnti9xk7uxz"},{"post_id":"ckszp3nd00009ifntzkqo6g27","tag_id":"ckszp3nd8000jifnt4vbpsa9n","_id":"ckszp3ndc000uifntjcvxdty0"},{"post_id":"ckszp3nd9000nifntkwsuyej2","tag_id":"ckszp3ncw0006ifnt91n6bjx1","_id":"ckszp3nde000wifnt04jpceih"},{"post_id":"ckszp3nda000qifntcgyuhydl","tag_id":"ckszp3ncw0006ifnt91n6bjx1","_id":"ckszp3ndf000yifntp3mlwhrg"},{"post_id":"ckszp3nd3000cifntxih0rn22","tag_id":"ckszp3nda000oifntc0dykn2z","_id":"ckszp3ndg0010ifntsomh581c"},{"post_id":"ckszp3ndb000sifnt5rbgqlb9","tag_id":"ckszp3ncw0006ifnt91n6bjx1","_id":"ckszp3ndh0012ifnta67bqsbt"},{"post_id":"ckszp3ndd000vifntl9b334rm","tag_id":"ckszp3ncw0006ifnt91n6bjx1","_id":"ckszp3ndi0014ifntldqe0hdm"},{"post_id":"ckszp3nd4000eifnto182kh5u","tag_id":"ckszp3nda000oifntc0dykn2z","_id":"ckszp3ndj0016ifnt8nbamk5c"},{"post_id":"ckszp3nde000xifnt6emdmy4g","tag_id":"ckszp3ncw0006ifnt91n6bjx1","_id":"ckszp3ndk0018ifnt58i3jbum"},{"post_id":"ckszp3ndf000zifnt5qn9ga66","tag_id":"ckszp3ncw0006ifnt91n6bjx1","_id":"ckszp3ndl001aifntnj15k69k"},{"post_id":"ckszp3ndg0011ifnt8nkyveqq","tag_id":"ckszp3ncw0006ifnt91n6bjx1","_id":"ckszp3ndm001cifnts8yg6w7s"},{"post_id":"ckszp3ndh0013ifnt3qauohoi","tag_id":"ckszp3ncw0006ifnt91n6bjx1","_id":"ckszp3ndn001fifntmv38pmc5"},{"post_id":"ckszp3ndi0015ifntgcux7a4k","tag_id":"ckszp3ncw0006ifnt91n6bjx1","_id":"ckszp3ndo001hifnt25ms7b69"},{"post_id":"ckszp3ndj0017ifntmu76zye6","tag_id":"ckszp3nda000oifntc0dykn2z","_id":"ckszp3ndo001jifntv9f1z5za"},{"post_id":"ckszp3ndk0019ifnt44rgw4th","tag_id":"ckszp3ncw0006ifnt91n6bjx1","_id":"ckszp3ndq001mifntua7a1ldn"},{"post_id":"ckszp3ndl001bifnt25vphiu5","tag_id":"ckszp3ndn001eifnt0ab0982w","_id":"ckszp3ndr001oifntn1z51rhj"},{"post_id":"ckszp3ndo001kifntx4cx8ahv","tag_id":"ckszp3nda000oifntc0dykn2z","_id":"ckszp3nds001rifntrx334qg6"},{"post_id":"ckszp3ndq001nifntul8qymgj","tag_id":"ckszp3nda000oifntc0dykn2z","_id":"ckszp3nds001sifnt115gy0ov"},{"post_id":"ckszp3ndm001difnt93mw1sge","tag_id":"ckszp3ndp001lifntj8v4boaa","_id":"ckszp3ndt001uifnty95z6fry"},{"post_id":"ckszp3ndn001gifntvbe86ip1","tag_id":"ckszp3ndp001lifntj8v4boaa","_id":"ckszp3ndt001wifntop00uky2"},{"post_id":"ckszp3ndo001iifntoioxih2w","tag_id":"ckszp3ndp001lifntj8v4boaa","_id":"ckszp3ndt001xifnt8kj8dgl9"},{"post_id":"ckszp3ndz001yifnt26widzhc","tag_id":"ckszp3ncw0006ifnt91n6bjx1","_id":"ckszp3ne20020ifntf7aswyvd"},{"post_id":"ckszp3ne1001zifntxdzqxbku","tag_id":"ckszp3ncw0006ifnt91n6bjx1","_id":"ckszp3ne20021ifntcgtrdj95"},{"post_id":"cksztn2dz0002kvntn1by4bc8","tag_id":"ckszp3nda000oifntc0dykn2z","_id":"cksztn2dz0003kvntvrravkz8"}],"Tag":[{"name":"iOS","_id":"ckszp3ncw0006ifnt91n6bjx1"},{"name":"GitHub","_id":"ckszp3nd8000jifnt4vbpsa9n"},{"name":"iOS - Swift","_id":"ckszp3nda000oifntc0dykn2z"},{"name":"Tech","_id":"ckszp3ndn001eifnt0ab0982w"},{"name":"iOS - Objective-C","_id":"ckszp3ndp001lifntj8v4boaa"}]}}